import{s as Re,n as te,o as We,b as Gt,f as Wt,r as Vt,i as I}from"../chunks/scheduler.ba2ce6c0.js";import{S as Ve,i as Fe,g as d,h as u,j as k,f as p,k as x,a as oe,y as Ft,r as yt,s as b,u as Et,c as C,z as R,x as l,v as bt,A as T,d as Ct,t as At,w as Rt}from"../chunks/index.8040907f.js";var U=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(U||{}),P=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(P||{}),se=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ONE=1]="KILL_ONE",e[e.REACH_CELL=2]="REACH_CELL",e))(se||{}),Bt=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.DOOR="Door",e.NOTE="Note",e))(Bt||{}),O=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(O||{});const jt="0",qt="#",Yt=" ",zt=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),Ce=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1}),ke=(e,t,n,o)=>{let s=P.LORD,a=2,r=2,c=4,f=4;switch(e){case U.ORCH:{s=P.APPRENTICE,r=0,c=2,f=1;break}case U.TROLL:{s=P.KNIGHT,r=1,c=3,f=2;break}}return e===U.YELLOW_DARK_LORD&&(a=3),{type:e,level:s,colour:t,actions:a,defense:r,health:c,experience:f,name:e.valueOf()+" ("+t+")",movement:3,position:{x:n,y:o}}},Jt={name:"Second cave",beaten:!1,winConditions:[{type:se.REACH_CELL,targetCell:{x:0,y:0},fulfilled:!1}],startingPositions:[{x:0,y:2},{x:0,y:3},{x:0,y:4},{x:1,y:3}],discoveredRooms:["A"],layout:{grid:["AAA","A A","AAA","AAA","AAA"],doors:[],monsters:[],secrets:[]}},Dt={name:"Troll cave",beaten:!1,winConditions:[{type:se.KILL_ALL,fulfilled:!1}],nextDungeon:Jt,startingPositions:[{x:0,y:7},{x:0,y:8},{x:0,y:9},{x:1,y:8}],discoveredRooms:["A"],layout:{grid:["     CCCC","     CCCC","     CCCC","      E  ","      E  ","      E  ","      BB ","AAA   BB ","AAADDDBB ","AAA   BB "],doors:[Ce(O.RIGHT,2,8),Ce(O.RIGHT,5,8),Ce(O.UP,6,6),Ce(O.UP,6,3)],monsters:[ke(U.ORCH,"green",5,8),ke(U.ORCH,"yellow",7,9),ke(U.ORCH,"red",6,4),ke(U.ORCH,"red",8,2),ke(U.TROLL,"green",5,0)],secrets:[zt(Bt.NOTE,"Welcome to Drakriddarna",1,8)]}},Tt=e=>{e.actionLog.push("Game saved."),localStorage.setItem("state",JSON.stringify(e))},Qt=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),t.actionLog.push("Game loaded."),t}},Zt=()=>{const e=[Ae("Fearik","orange"),Ae("Helbran","red"),Ae("Siedel","green"),Ae("Wulf","lightblue")];return Pt(e,Dt),{heroes:e,dungeon:Dt,currentActor:e[0],actionLog:["Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."]}},Ae=(e,t)=>({name:e,actions:2,movement:3,defense:0,level:P.APPRENTICE,health:7,colour:t,experience:0}),Pt=(e,t)=>{e.forEach((n,o)=>n.position=t.startingPositions[o])},Le=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},Xt=(e,t,n)=>e.dungeon.layout.monsters.some(o=>{var s;return o.position.x===t&&((s=o.position)==null?void 0:s.y)===n&&o.health>0}),A=(e,t)=>{const n=t.currentActor;if(n.actions===0)return;let o=n.position.x,s=n.position.y;switch(e){case"UL":o=n.position.x-1,s=n.position.y-1;break;case"U":s=n.position.y-1;break;case"UR":o=n.position.x+1,s=n.position.y-1;break;case"L":o=n.position.x-1;break;case"R":o=n.position.x+1;break;case"DL":o=n.position.x-1,s=n.position.y+1;break;case"D":s=n.position.y+1;break;case"DR":o=n.position.x+1,s=n.position.y+1;break}const a=t.heroes.some(f=>f.position.x===o&&f.position.y===s),r=!Ut(t.dungeon.layout,o,s),c=Xt(t,o,s);if(!a&&!r){const f=St(t.dungeon,o,s);f?f&&(c?tn(n,t,o,s):Ht(n,o,s,1)):on(t,n,o,s)&&en(n,t,o,s)}else t.actionLog.push(n.name+" could not make that move");n.movement===0&&(n.actions--,n.movement=3)},Ht=(e,t,n,o)=>{e.position.x=t,e.position.y=n,e.movement-=o},en=(e,t,n,o)=>{const s=Te(t.dungeon.layout.grid,n,o);s&&t.dungeon.discoveredRooms.push(s),Ht(e,e.position.x,e.position.y,1),t.actionLog.push(e.name+" opened a door")},tn=(e,t,n,o)=>{if(e.actions===1&&e.movement!==3){t.actionLog.push(e.name+" has no actions left to attack");return}const s=t.dungeon.layout.monsters.find(a=>{var r;return a.position.x===n&&((r=a.position)==null?void 0:r.y)===o});if(s){const a=De(e.level,3),r=Math.max(a-s.defense,0);t.actionLog.push(e.name+" attacked "+s.name+" for "+r+" damage ("+a+"-"+s.defense+"="+r+")"),s.health-=r,s.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(c=>c!=s),t.actionLog.push(e.name+" killed "+s.name),e.experience+=s.experience),(e==null?void 0:e.actions)>1&&(e==null?void 0:e.movement)<3?e.actions-=2:e.actions--}},De=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case P.APPRENTICE:n=n.filter(o=>o===6);break;case P.KNIGHT:case P.HERO:n=n.filter(o=>o>=5);break;case P.LORD:case P.MASTER:n=n.filter(o=>o>=4);break}return n.length},Ot=e=>{const t=e.currentActor;if(!$t(t)){e.actionLog.push(t.name+" has no actions left to pick lock");return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(De(t.level,1)>=1?(n.locked=!1,e.actionLog.push(t.name+" managed to pick the lock")):e.actionLog.push(t.name+" failed to pick the lock"),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--,t.movement=3)},It=e=>{const t=e.currentActor;if(!$t(t)){e.actionLog.push(t.name+" has no actions left to search");return}const n=De(t.level,1);if(n>=1){const o=e.dungeon.layout.secrets.find(s=>Mt(s.position,t.position.x,t.position.y));o?e.actionLog.push(t.name+" searched ("+n+") and found "+o.name):(e.actionLog.push(t.name+" searched ("+n+") but found nothing"),console.log("found no secret"))}else e.actionLog.push(t.name+" searched ("+n+") but found nothing");(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--,t.movement=3},xt=e=>{if(nn(e),e.currentActor!==void 0){e.actionLog.push(e.currentActor.name+" ended their turn");let n=e.heroes.indexOf(e.currentActor)+1;n===e.heroes.length&&(an(e),n=0),e.currentActor.actions=2,e.currentActor.movement=3,e.currentActor=e.heroes[n],e.actionLog.push(e.currentActor.name+" started their turn")}},nn=e=>{e.dungeon.winConditions.forEach(t=>{switch(t.type){case se.KILL_ALL:const n=e.dungeon.layout.monsters.map(s=>s.health).reduce((s,a)=>s+a,0);t.fulfilled=n<=0;break;case se.REACH_CELL:t.fulfilled=e.heroes.some(s=>{var a;s.position.x===((a=t.targetCell)==null?void 0:a.x)&&(s.position.y,t.targetCell.y)});break;case se.KILL_ONE:const o=e.dungeon.layout.monsters.find(s=>s.name===t.targetMonster);t.fulfilled=o.health===0;break}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,n)=>t&&n,!0),e.dungeon.beaten&&(e.actionLog.push("All win conditions have been fulfilled"),e.actionLog.push("You have cleared "+e.dungeon.name))},on=(e,t,n,o)=>{var a;const s=e.dungeon.layout.doors.find(r=>{var c;return r.x===((c=t.position)==null?void 0:c.x)&&r.y===t.position.y});if(s&&!s.locked){const r=sn(t.position.x,(a=t.position)==null?void 0:a.y,n,o);if(s.side===r)return s.open=!0,!0}return s.locked&&e.actionLog.push("Door is locked"),!1},sn=(e,t,n,o)=>{if(e===n){if(t>o)return O.UP;if(t<o)return O.DOWN}if(t===o){if(e>n)return O.LEFT;if(e<n)return O.RIGHT}},Ut=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const s=Te(e.grid,t,n);(s===jt||s===qt||s===Yt)&&(o=!1)}return o},St=(e,t,n)=>{const o=Te(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},Te=(e,t,n)=>{let o;return e.forEach((s,a)=>{Le(s).forEach((r,c)=>{a===n&&c===t&&(o=r)})}),o},Mt=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,an=e=>{const t=e.dungeon.layout.monsters.filter(n=>{var s;const o=Te(e.dungeon.layout.grid,(s=n.position)==null?void 0:s.x,n.position.y);return e.dungeon.discoveredRooms.includes(o)&&n.health>0});t.length===0&&e.actionLog.push("No monsters can act"),t.forEach(n=>{const o=n.actions;for(;n.actions>0;){e.actionLog.push(n.name+" acted ");const s=e.heroes.filter(a=>{var r;return Mt(n.position,(r=a.position)==null?void 0:r.x,a.position.y)});if(s.length>0){const a=Math.floor(Math.random()*s.length);cn(e,n,s[a])}else rn(e,n)}n.actions=o})};function Nt(e,t){return Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2))}const rn=(e,t)=>{const n=e.heroes.map(s=>({hero:s,dist:Nt(s.position,t.position)})).sort((s,a)=>s.dist-a.dist)[0],o=ln(e,t.position);if(o.length>0){const s=o.map(a=>({pos:a,dist:Nt(a,n.hero.position)})).sort((a,r)=>a.dist-r.dist)[0].pos;t.position=s,e.actionLog.push(t.name+" moved towards "+n.hero.name+" ("+s.x+","+s.y+")")}else e.actionLog.push(t.name+" could not move");t.actions--};let ln=(e,t)=>{const n=t.x,o=t.y,s=[];for(let a=n-1;a<=n+1;a++)for(let r=o-1;r<=o+1;r++)a===n&&r===o||Ut(e.dungeon.layout,a,r)&&St(e.dungeon,a,r)&&s.push({x:a,y:r});return s.filter(a=>!e.heroes.find(r=>r.position.x===a.x&&r.position.y===a.y)).filter(a=>!e.dungeon.layout.monsters.find(c=>c.position.x===a.x&&c.position.y===a.y))};const cn=(e,t,n)=>{if(t.actions===1&&t.movement!==3){e.actionLog.push(n.name+" has no actions left to attack");return}if(n){const o=De(t.level,3),s=Math.max(o-n.defense,0);e.actionLog.push(t.name+" attacked "+n.name+" for "+s+" damage ("+o+"-"+n.defense+"="+s+")"),n.health-=s,n.health<=0&&(e.actionLog.push(t.name+" killed "+n.name),e.heroes=e.heroes.filter(a=>a!==n)),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--}},$t=e=>e.movement<3?e.actions>1:e.actions>0;function dn(e){let t;return{c(){t=d("canvas"),this.h()},l(n){t=u(n,"CANVAS",{width:!0,height:!0,id:!0}),k(t).forEach(p),this.h()},h(){x(t,"width","860"),x(t,"height","750"),x(t,"id","gameBoard")},m(n,o){oe(n,t,o)},p:te,i:te,o:te,d(n){n&&p(t)}}}function un(e,t,n){let{state:o}=t;We(()=>{s(),setInterval(s,10)});const s=()=>{if(!o||!document)return;const i=document.getElementById("gameBoard"),v=i.getContext("2d");v.clearRect(0,0,i.width,i.height),o.dungeon.layout.grid.forEach((h,g)=>{Le(h).forEach((L,_)=>a(v,L,_,g))}),o.dungeon.layout.grid.forEach((h,g)=>{Le(h).forEach((L,_)=>r(v,L,_,g))}),o.dungeon.layout.grid.forEach((h,g)=>{Le(h).forEach((L,_)=>c(v,L,_,g))}),o.dungeon.layout.grid.forEach((h,g)=>{Le(h).forEach((L,_)=>f(v,L,_,g))})},a=(i,v,h,g)=>{i.beginPath(),m(v)?i.fillStyle="black":i.fillStyle="lightgrey",i.fillRect(h*32,g*32,32,32),i.stroke()},r=(i,v,h,g)=>{i.beginPath(),i.rect(h*32,g*32,32,32),i.font="7px Arial",i.fillText(h+","+g,h*32+1,g*32+30),i.stroke()},c=(i,v,h,g)=>{const L=E(h,g);if(L&&!L.open&&!m(v))switch(i.fillStyle="brown",L.side){case O.RIGHT:{i.fillRect(h*32+30,g*32,4,32),L.locked&&(i.fillStyle="grey",i.fillRect(h*32+28,g*32+12,8,8));break}case O.LEFT:{i.fillRect(h*32-2,g*32,4,32),L.locked&&(i.fillStyle="grey",i.fillRect(h*32-4,g*32+12,8,8));break}case O.UP:{i.fillRect(h*32,g*32-2,32,4),L.locked&&(i.fillStyle="grey",i.fillRect(h*32+12,g*32-4,8,8));break}case O.DOWN:{i.fillRect(h*32,g*32+30,32,4),L.locked&&(i.fillStyle="grey",i.fillRect(h*32+12,g*32+28,8,8));break}}},f=(i,v,h,g)=>{i.beginPath();const L=o.heroes.find(_=>_.position.x===h&&_.position.y===g);if(L)i.beginPath(),i.arc(h*32+16,g*32+16,13,0,2*Math.PI),i.fillStyle=L.colour,i.fill();else{const _=o.dungeon.layout.monsters.find(B=>B.position.x===h&&B.position.y===g);if(_&&_.health>0&&!m(v)){i.beginPath(),i.fillStyle=_.colour,i.arc(h*32+16,g*32+16,10,0,2*Math.PI),i.fill(),i.font="7px Arial",i.fillStyle="black";const B=_.name[0]+"("+_.health+")";i.fillText(B,h*32+8,g*32+16)}}i.stroke()},m=i=>i===" "||!o.dungeon.discoveredRooms.includes(i),E=(i,v)=>o.dungeon.layout.doors.find(h=>h.x===i&&h.y===v);return e.$$set=i=>{"state"in i&&n(0,o=i.state)},[o]}class fn extends Ve{constructor(t){super(),Fe(this,t,un,dn,Re,{state:0})}}function hn(e){let t;return{c(){t=d("canvas"),this.h()},l(n){t=u(n,"CANVAS",{id:!0,height:!0,width:!0}),k(t).forEach(p),this.h()},h(){x(t,"id","characterBoard"),x(t,"height","750"),x(t,"width","260")},m(n,o){oe(n,t,o)},p:te,i:te,o:te,d(n){n&&p(t)}}}const ne=180;function gn(e,t,n){let{state:o}=t;We(()=>{s(),setInterval(s,100)});const s=()=>{if(!o||!document)return;const c=document.getElementById("characterBoard"),f=c.getContext("2d");f.clearRect(0,0,c.width,c.height),f.stroke(),o.heroes.forEach((m,E)=>a(f,c,m,E)),o.heroes.forEach((m,E)=>r(f,m,E))},a=(c,f,m,E)=>{c.fillStyle=m.colour,c.fillRect(12,E*ne+12,f.width,ne-12),c.stroke(),c.fillStyle="black"},r=(c,f,m)=>{const i=(f===o.currentActor?"> "+f.name:f.name)+" - "+f.level+" ("+f.experience+")";c.strokeStyle="black",c.font="18px Arial",c.fillText(i,16,m*ne+30),c.fillText("HP: "+f.health,16,m*ne+50),c.fillText("Actions: "+f.actions,16,m*ne+70),c.fillText("Moves: "+f.movement,16,m*ne+90),c.stroke()};return e.$$set=c=>{"state"in c&&n(0,o=c.state)},[o]}class mn extends Ve{constructor(t){super(),Fe(this,t,gn,hn,Re,{state:0})}}function wt(e){let t,n='<canvas width="860" height="100" id="logs"></canvas>';return{c(){t=d("div"),t.innerHTML=n,this.h()},l(o){t=u(o,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-xcon9n"&&(t.innerHTML=n),this.h()},h(){x(t,"class","log svelte-60nygp")},m(o,s){oe(o,t,s)},p:te,d(o){o&&p(t)}}}function pn(e){let t,n,o,s,a,r,c,f,m,E,i,v,h,g,L="UL",_,B,G,je="U",Oe,ie,W,qe="UR",Ie,ae,V,Ye="Next",xe,N,re,F,ze="L",Ne,_e,we,le,j,Je="R",Be,ce,q,Qe="Search",Pe,w,de,Y,Ze="DL",He,ue,z,Xe="D",Ue,fe,J,et="DR",Se,he,Q,tt="Pick lock",Me,Z,ge,X,nt="Save",$e,me,ee,ot="Load",Ke,st=e[0].actionLog,ye,Ge,it;o=new mn({props:{state:e[0]}});function Kt(y){e[1](y)}let at={};e[0]!==void 0&&(at.state=e[0]),r=new fn({props:at}),Gt.push(()=>Ft(r,"state",Kt));let H=wt();return{c(){t=d("div"),n=d("div"),yt(o.$$.fragment),s=b(),a=d("div"),yt(r.$$.fragment),f=b(),m=d("div"),E=d("div"),i=d("table"),v=d("tr"),h=d("td"),g=d("button"),g.textContent=L,_=b(),B=d("td"),G=d("button"),G.textContent=je,Oe=b(),ie=d("td"),W=d("button"),W.textContent=qe,Ie=b(),ae=d("td"),V=d("button"),V.textContent=Ye,xe=b(),N=d("tr"),re=d("td"),F=d("button"),F.textContent=ze,Ne=b(),_e=d("td"),we=b(),le=d("td"),j=d("button"),j.textContent=Je,Be=b(),ce=d("td"),q=d("button"),q.textContent=Qe,Pe=b(),w=d("tr"),de=d("td"),Y=d("button"),Y.textContent=Ze,He=b(),ue=d("td"),z=d("button"),z.textContent=Xe,Ue=b(),fe=d("td"),J=d("button"),J.textContent=et,Se=b(),he=d("td"),Q=d("button"),Q.textContent=tt,Me=b(),Z=d("tr"),ge=d("td"),X=d("button"),X.textContent=nt,$e=b(),me=d("td"),ee=d("button"),ee.textContent=ot,Ke=b(),H.c(),this.h()},l(y){t=u(y,"DIV",{class:!0});var D=k(t);n=u(D,"DIV",{class:!0});var pe=k(n);Et(o.$$.fragment,pe),pe.forEach(p),s=C(D),a=u(D,"DIV",{class:!0});var ve=k(a);Et(r.$$.fragment,ve),ve.forEach(p),D.forEach(p),f=C(y),m=u(y,"DIV",{class:!0});var Ee=k(m);E=u(Ee,"DIV",{class:!0});var rt=k(E);i=u(rt,"TABLE",{});var S=k(i);v=u(S,"TR",{});var M=k(v);h=u(M,"TD",{});var lt=k(h);g=u(lt,"BUTTON",{"data-svelte-h":!0}),R(g)!=="svelte-fw3uxo"&&(g.textContent=L),lt.forEach(p),_=C(M),B=u(M,"TD",{});var ct=k(B);G=u(ct,"BUTTON",{"data-svelte-h":!0}),R(G)!=="svelte-1jeoia6"&&(G.textContent=je),ct.forEach(p),Oe=C(M),ie=u(M,"TD",{});var dt=k(ie);W=u(dt,"BUTTON",{"data-svelte-h":!0}),R(W)!=="svelte-1p8c8vc"&&(W.textContent=qe),dt.forEach(p),Ie=C(M),ae=u(M,"TD",{});var ut=k(ae);V=u(ut,"BUTTON",{"data-svelte-h":!0}),R(V)!=="svelte-1rtxc14"&&(V.textContent=Ye),ut.forEach(p),M.forEach(p),xe=C(S),N=u(S,"TR",{});var $=k(N);re=u($,"TD",{});var ft=k(re);F=u(ft,"BUTTON",{"data-svelte-h":!0}),R(F)!=="svelte-10dnpu6"&&(F.textContent=ze),ft.forEach(p),Ne=C($),_e=u($,"TD",{}),k(_e).forEach(p),we=C($),le=u($,"TD",{});var ht=k(le);j=u(ht,"BUTTON",{"data-svelte-h":!0}),R(j)!=="svelte-12287ni"&&(j.textContent=Je),ht.forEach(p),Be=C($),ce=u($,"TD",{});var gt=k(ce);q=u(gt,"BUTTON",{"data-svelte-h":!0}),R(q)!=="svelte-cps1bu"&&(q.textContent=Qe),gt.forEach(p),$.forEach(p),Pe=C(S),w=u(S,"TR",{});var K=k(w);de=u(K,"TD",{});var mt=k(de);Y=u(mt,"BUTTON",{"data-svelte-h":!0}),R(Y)!=="svelte-1ji074i"&&(Y.textContent=Ze),mt.forEach(p),He=C(K),ue=u(K,"TD",{});var pt=k(ue);z=u(pt,"BUTTON",{"data-svelte-h":!0}),R(z)!=="svelte-li5tq6"&&(z.textContent=Xe),pt.forEach(p),Ue=C(K),fe=u(K,"TD",{});var vt=k(fe);J=u(vt,"BUTTON",{"data-svelte-h":!0}),R(J)!=="svelte-3esmwe"&&(J.textContent=et),vt.forEach(p),Se=C(K),he=u(K,"TD",{});var kt=k(he);Q=u(kt,"BUTTON",{"data-svelte-h":!0}),R(Q)!=="svelte-sacog4"&&(Q.textContent=tt),kt.forEach(p),K.forEach(p),Me=C(S),Z=u(S,"TR",{});var be=k(Z);ge=u(be,"TD",{});var Lt=k(ge);X=u(Lt,"BUTTON",{"data-svelte-h":!0}),R(X)!=="svelte-1vr5zyk"&&(X.textContent=nt),Lt.forEach(p),$e=C(be),me=u(be,"TD",{});var _t=k(me);ee=u(_t,"BUTTON",{"data-svelte-h":!0}),R(ee)!=="svelte-1m2jkw7"&&(ee.textContent=ot),_t.forEach(p),be.forEach(p),S.forEach(p),rt.forEach(p),Ke=C(Ee),H.l(Ee),Ee.forEach(p),this.h()},h(){x(n,"class","characterSide svelte-60nygp"),x(a,"class","boardSide svelte-60nygp"),x(t,"class","container svelte-60nygp"),x(E,"class","commands svelte-60nygp"),x(m,"class","container svelte-60nygp")},m(y,D){oe(y,t,D),l(t,n),bt(o,n,null),l(t,s),l(t,a),bt(r,a,null),oe(y,f,D),oe(y,m,D),l(m,E),l(E,i),l(i,v),l(v,h),l(h,g),l(v,_),l(v,B),l(B,G),l(v,Oe),l(v,ie),l(ie,W),l(v,Ie),l(v,ae),l(ae,V),l(i,xe),l(i,N),l(N,re),l(re,F),l(N,Ne),l(N,_e),l(N,we),l(N,le),l(le,j),l(N,Be),l(N,ce),l(ce,q),l(i,Pe),l(i,w),l(w,de),l(de,Y),l(w,He),l(w,ue),l(ue,z),l(w,Ue),l(w,fe),l(fe,J),l(w,Se),l(w,he),l(he,Q),l(i,Me),l(i,Z),l(Z,ge),l(ge,X),l(Z,$e),l(Z,me),l(me,ee),l(m,Ke),H.m(m,null),ye=!0,Ge||(it=[T(g,"click",function(){I(A("UL",e[0]))&&A("UL",e[0]).apply(this,arguments)}),T(G,"click",function(){I(A("U",e[0]))&&A("U",e[0]).apply(this,arguments)}),T(W,"click",function(){I(A("UR",e[0]))&&A("UR",e[0]).apply(this,arguments)}),T(V,"click",function(){I(xt(e[0]))&&xt(e[0]).apply(this,arguments)}),T(F,"click",function(){I(A("L",e[0]))&&A("L",e[0]).apply(this,arguments)}),T(j,"click",function(){I(A("R",e[0]))&&A("R",e[0]).apply(this,arguments)}),T(q,"click",function(){I(It(e[0]))&&It(e[0]).apply(this,arguments)}),T(Y,"click",function(){I(A("DL",e[0]))&&A("DL",e[0]).apply(this,arguments)}),T(z,"click",function(){I(A("D",e[0]))&&A("D",e[0]).apply(this,arguments)}),T(J,"click",function(){I(A("DR",e[0]))&&A("DR",e[0]).apply(this,arguments)}),T(Q,"click",function(){I(Ot(e[0]))&&Ot(e[0]).apply(this,arguments)}),T(X,"click",function(){I(Tt(e[0]))&&Tt(e[0]).apply(this,arguments)}),T(ee,"click",e[2])],Ge=!0)},p(y,[D]){e=y;const pe={};D&1&&(pe.state=e[0]),o.$set(pe);const ve={};!c&&D&1&&(c=!0,ve.state=e[0],Wt(()=>c=!1)),r.$set(ve),D&1&&Re(st,st=e[0].actionLog)?(H.d(1),H=wt(),H.c(),H.m(m,null)):H.p(e,D)},i(y){ye||(Ct(o.$$.fragment,y),Ct(r.$$.fragment,y),ye=!0)},o(y){At(o.$$.fragment,y),At(r.$$.fragment,y),ye=!1},d(y){y&&(p(t),p(f),p(m)),Rt(o),Rt(r),H.d(y),Ge=!1,Vt(it)}}}function vn(e,t,n){let o=Zt();We(()=>{a(),setInterval(a,500),setInterval(s,1e3)});const s=()=>{o.dungeon.beaten&&o.dungeon.nextDungeon&&(n(0,o.dungeon=o.dungeon.nextDungeon,o),Pt(o.heroes,o.dungeon))},a=()=>{if(!o||!document)return;const f=document.getElementById("logs"),m=f.getContext("2d");m.clearRect(0,0,f.width,f.height),o.actionLog.slice(-10).reverse().forEach((E,i)=>{m.font="12px Arial",m.fillStyle="black",m.fillText("> "+E,2,(i+1)*12+2),m.stroke()})};function r(f){o=f,n(0,o)}return[o,r,()=>n(0,o=Qt())]}class _n extends Ve{constructor(t){super(),Fe(this,t,vn,pn,Re,{})}}export{_n as component};
