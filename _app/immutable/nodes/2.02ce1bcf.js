import{s as Qe,n as ce,o as bt,b as Et,f as It,r as Rn}from"../chunks/scheduler.bc760b9c.js";import{S as tt,i as nt,g as f,h as A,j as p,f as u,k as Q,a as H,x as c,y as W,s as T,m as b,c as B,n as D,o as ae,z as V,p as ot,t as z,b as rt,d as K,e as ge,A as Gt,B as yt,r as Je,u as Se,v as ze,w as et,l as tn,C as Zn}from"../chunks/index.54d4ae92.js";const jn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function mt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var te=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(te||{}),le=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(le||{}),oe=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(oe||{}),Ke=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(Ke||{}),Re=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(Re||{}),G=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(G||{}),w=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e[e.MAGIC=3]="MAGIC",e))(w||{});const Nt=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:w.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:w.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:w.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:w.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:w.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Lt=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:w.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:w.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:w.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Jn=[{name:"Chain mail",type:w.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:w.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:w.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],nn=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:w.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:w.ARMOUR,movementReduction:0,value:0}],Sn="0",Qn="@",Wt=" ",wt="#",Rt=(e,n,t,o)=>({type:e,name:n,position:{x:t,y:o},found:!1}),zn=(e,n,t,o)=>({type:e,name:o.name,position:{x:n,y:t},found:!1,item:o}),be=(e,n,t)=>({side:e,x:n,y:t,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),on=(e,n,t)=>({...be(e,n,t),hidden:!0}),$e=(e,n,t,o)=>{const r=Object.values(te).indexOf(n),s=Object.keys(te)[r];let i=oe.LORD,a=2,l=2,d=4,v=4,h=4,m=Lt[0],E,I=nn[0];switch(e){case le.ORCH:{i=oe.APPRENTICE,l=0,d=2,v=2,h=1,E=Lt[1];break}case le.TROLL:{i=oe.KNIGHT,l=1,d=3,v=3,h=2,m=Lt[2],I=nn[1];break}}return e===le.YELLOW_DARK_LORD&&(a=3),{type:e,level:i,colour:n,actions:a,defense:l,health:d,maxHealth:v,experience:h,name:e+" ("+s+")",movement:3,maxMovement:3,position:{x:t,y:o},weapon:m,armour:I,incapacitated:!1,inventory:[],rangedWeapon:E}},eo=e=>{const n=e.currentActor,t=n.inventory.filter(l=>{var d;return(d=l.properties)==null?void 0:d[an]}).map(l=>{var d;return g(e,`${n.name} used the effect of ${l.name} when searching`),(d=l.properties)==null?void 0:d[an]}).reduce((l,d)=>l+d,0),o=_t(n.level,1+t);let r,s,i,a;o>=1?(r=fo(e,n,o),r||(s=io(e,n,o)),!r&&!s&&(i=ao(e,n,o)),!r&&!s&&!i&&(a=lo(e,n,o)),!r&&!s&&!i&&!a&&g(e,`${n.name} searched but found nothing`)):g(e,`${n.name} searched but found nothing`)},Hn=e=>{const n=e.currentActor;if(!n)return!1;const t=e.dungeon.layout.secrets.filter(o=>o.type===Re.TRAP_DOOR).filter(o=>!o.found).find(o=>Ct(o.position,n.position));return t?(Bt(e,to(t),n,!1),g(e,`${n.name} fell into a pit and is incapacitated for one turn.`),n.movement=0,n.actions=0,n.incapacitated=!0,t.found=!0,!0):!1},Pn=(e,n)=>{const t=e.itemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.itemDeck.splice(t,1)},wn=(e,n)=>{const t=e.magicItemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.magicItemDeck.splice(t,1)},to=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:te.Red,maxHealth:0,name:"Trap Door",level:oe.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:w.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),no=(e,n)=>e.dungeon.layout.doors.filter(t=>t.hidden).find(t=>Tt({x:t.x,y:t.y},n.x,n.y)),oo=(e,n)=>e.dungeon.layout.doors.filter(t=>t.trapped).find(t=>t.x===n.x&&t.y===n.y),ro=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).find(t=>Tt(t.position,n.x,n.y)),so=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).filter(t=>t.type===Re.TRAP_DOOR).find(t=>Tt(t.position,n.x,n.y)),io=(e,n,t)=>no(e,n.position)?(g(e,`${n.name} searched (${t}) and found a hidden door`),!0):!1,ao=(e,n,t)=>{const o=oo(e,n.position);return o?(g(e,`${n.name} searched (${t}) and found a trap in a door`),o.trapped=!1,!0):!1},lo=(e,n,t)=>{const o=ro(e,n.position);if(o){switch(g(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,o.type){case Re.EQUIPMENT:{let r=o.item??co(e);if(r.amountInDeck>0)switch(Pn(e,r),g(e,`${n.name} equipped (${r.name})`),r.type){case w.ARMOUR:n.armour&&n.inventory.push(n.armour),n.armour=r;break;case w.SHIELD:n.shield&&n.inventory.push(n.shield),n.shield=r;break;case w.WEAPON:n.weapon&&n.inventory.push(n.weapon),n.weapon=r;break}break}case Re.MAGIC_ITEM:{let r=o.item??uo(e);r.amountInDeck>0&&(wn(e,r),g(e,`${n.name} found (${r.name})`),n.inventory.push(r),r.pickup&&r.pickup(e,r,n));break}}return!0}return!1},co=e=>{const n=e.itemDeck.length,t=Math.floor(Math.random()*n);return e.itemDeck[t]},uo=e=>{const n=e.magicItemDeck.length,t=Math.floor(Math.random()*n);return e.magicItemDeck[t]},fo=(e,n,t)=>{const o=so(e,n.position);return o?(g(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,!0):!1},Ot=(e,n)=>(Nt[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:oe.APPRENTICE,health:7,maxHealth:7,colour:n,experience:0,position:{x:-1,y:-1},weapon:Nt[0],incapacitated:!1,inventory:[]}),re=(e,n)=>{const t=n.currentActor;if(!t||t.actions===0)return;const o={x:t.position.x,y:t.position.y};switch(e){case"UL":o.x=t.position.x-1,o.y=t.position.y-1;break;case"U":o.y=t.position.y-1;break;case"UR":o.x=t.position.x+1,o.y=t.position.y-1;break;case"L":o.x=t.position.x-1;break;case"R":o.x=t.position.x+1;break;case"DL":o.x=t.position.x-1,o.y=t.position.y+1;break;case"D":o.y=t.position.y+1;break;case"DR":o.x=t.position.x+1,o.y=t.position.y+1;break}const r=$t(n,o.x,o.y),s=!Mt(n.dungeon.layout,o.x,o.y),i=Kt(n,o.x,o.y);if(!r&&!s){const a=Xt(n.dungeon,o.x,o.y);a?a&&(i?Ln(t,n,o):xn(t,n,o.x,o.y,1)):go(n,t,o.x,o.y)&&vt(t,n,o.x,o.y)}else g(n,`${t.name} could not make that move`);Hn(n)||Ht(t)},xt=e=>{const n=e.currentActor;if(!n)return;if(!pt(n)){g(e,`${n.name} has no actions left to pick lock`);return}const t=e.dungeon.layout.doors.find(o=>o.x===n.position.x&&o.y===n.position.y);t&&t.locked&&(_t(n.level,1)>=1?(t.locked=!1,g(e,`${n.name} managed to pick the lock`)):g(e,`${n.name} failed to pick the lock`),n.actions>1&&n.movement<3?n.actions-=2:n.actions--,n.movement=Ve(n),n.actions==0&&(n.movement=0))},Mn=e=>{e.heroes.forEach((n,t)=>{n.position=e.dungeon.startingPositions[t],n.movement=Ve(n),n.actions=2,n.health=n.maxHealth})},ne=e=>e.heroes.filter(n=>n.health>0),rn=e=>{const n=e.currentActor;n&&(n.actions--,n.movement=Ve(n),n.actions===0&&Qt(e))},pt=e=>e.movement<Ve(e)?e.actions>1:e.actions>0,vt=(e,n,t,o)=>{const r=Dt(n.dungeon.layout.grid,t,o);r&&n.dungeon.discoveredRooms.push(r),xn(e,n,e.position.x,e.position.y,1),g(n,`${e.name} opened a door`)},Ln=(e,n,t)=>{if(e.actions===1&&e.movement!==3){g(n,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&Io(n,e)){g(n,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const o=Eo(n,t);o&&(Bt(n,e,o,!1),o.health<=0&&vo(n,o,e),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},Ut=e=>{const n=e.currentActor;if(n){if(!pt(n)){g(e,`${n.name} has no actions left to search`);return}eo(e),n.actions>1&&n.movement<Ve(n)?n.actions-=2:n.actions--,n.actions==0&&(n.movement=0)}},Kt=(e,n,t)=>e.dungeon.layout.monsters.some(o=>o.position.x===n&&o.position.y===t&&o.health>0),$t=(e,n,t)=>ne(e).some(o=>o.position.x===n&&o.position.y===t),Ht=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=Ve(e))),e.actions==0&&(e.movement=0)},Ao=e=>{ne(e).forEach(n=>{const t=n.level;n.experience>=28?n.level=oe.MASTER:n.experience>=18?n.level=oe.LORD:n.experience>=10?n.level=oe.HERO:n.experience>=4&&(n.level=oe.KNIGHT),t!==n.level&&g(e,`${n.name} leveled up to ${n.level}`)})},mo=e=>{ne(e).forEach(n=>n.experience+=4)},po=e=>{yo(e).forEach(n=>{n.experience=0,n.health=n.maxHealth,n.movement=n.maxMovement,n.actions=2})},Nn=(e,n,t)=>!t.open&&!t.hidden&&(!t.locked||t.locked&&n)&&e.movement>0,xn=(e,n,t,o,r)=>{e.position.x=t,e.position.y=o;const s=n.dungeon.layout.notes.find(a=>Ct(a.position,e.position));s&&(n.dungeon.layout.doors.some(l=>l.hidden&&Ct(s.position,{x:l.x,y:l.y}))||g(n,`${e.name} reads: ${s.message}`)),n.dungeon.layout.monsters.some(a=>Tt(e.position,a.position.x,a.position.y))?(g(n,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=r},go=(e,n,t,o)=>{const r=e.dungeon.layout.doors.find(i=>i.x===n.position.x&&i.y===n.position.y),s=n.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[Un]});if(r&&Nn(n,s,r)){r.locked&&s&&g(e,`${n.name} broke the locked door`);const i=ho(n.position.x,n.position.y,t,o);if(r.side===i)return r.open=!0,r.trapped&&Bt(e,Yn(r),n,!1),!0}return r&&r.locked&&g(e,"Door is locked"),!1},ho=(e,n,t,o)=>{if(e===t){if(n>o)return G.UP;if(n<o)return G.DOWN}if(n===o){if(e>t)return G.LEFT;if(e<t)return G.RIGHT}},vo=(e,n,t)=>{e.dungeon.layout.monsters=e.dungeon.layout.monsters.filter(o=>o!=n),g(e,`${t.name} killed ${n.name}`),e.dungeon.killCount++,t.experience+=n.experience},Eo=(e,n)=>e.dungeon.layout.monsters.find(t=>Ct(t.position,n)),Io=(e,n)=>qn(e,n).filter(t=>t!==n).length>0,yo=e=>e.heroes.filter(n=>n.health<=0),Ne="USED",sn="ATTACK_BONUS",an="SEARCH_BONUS",Un="BREAK_LOCK",ko="RE_ROLL_ATTACK",ln="DESCRIPTION",cn="ACTIVE",un="MOVEMENT_BONUS",dn="ACTIONS_BONUS",Gn="RESET_ON",Wn="NEXT_TURN",_o="TRADE",Kn="NEXT_SCENARIO",$n=[{name:"Healing Herbs",type:w.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,ACTIVE:!0,DESCRIPTION:"Chance to heal up to 3 wounds on one hero.",RESET_ON:[_o,Kn]},effect:"magicHerbsOnUse",reset:"magicHerbsOnReset"},{name:"Thousand League Boots",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives one additional step for each move action.",MOVEMENT_BONUS:1},pickup:"movementBonusOnPickup",drop:"movementBonusOnDrop"},{name:"Giants Glove",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional attack die. Breaks locked doors.",BREAK_DOOR:!0,ATTACK_BONUS:1}},{name:"Ring of Precision",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"May re-roll one completely missed attack.",RE_ROLL_ATTACK:!0}},{name:"Crown of Wisdom",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional die roll when searching.",SEARCH_BONUS:1}},{name:"Sword of Chaos",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"A sword with a will of it's own. Use at your own peril."},effect:"chaosSwordOnUse"},{name:"Potion of Speed",type:w.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives 2 additional actions. Can only be used once.",USED:!1,ACTIONS_BONUS:2,ACTIVE:!0},effect:"potionOfSpeedOnUse"},{name:"Necklace of Light",type:w.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,RESET_ON:[Wn]},effect:"necklaceOfLightOnUse",reset:"necklaceOfLightOnReset"}],Co={movementBonusOnPickup:(e,n,t)=>{var o,r;t.maxMovement+=(o=n.properties)==null?void 0:o[un],t.movement+=(r=n.properties)==null?void 0:r[un]}},bo={magicHerbsOnUse:(e,n,t,o)=>{if(!o){g(e,"No target was selected.");return}if(!pt(t)){g(e,`${t.name} has no actions left.`);return}if(n.properties){if(n.properties[Ne]){g(e,`${n.name} has no uses left.`);return}n.properties[Ne]=!0;let r=Math.min(_t(t.level,3),o.maxHealth-o.health);o.health+=r,g(e,`${t.name} used ${n.name} on ${o.name}, restoring ${r} HP`),t.actions--,t.movement=t.maxMovement}},chaosSwordOnUse:(e,n,t,o)=>{},potionOfSpeedOnUse:(e,n,t)=>{var o,r,s;(o=n.properties)!=null&&o[Ne]?g(e,`${n.name} has been consumed.`):(t.actions+=(r=n.properties)==null?void 0:r[dn],n.properties&&(n.properties[Ne]=!0),g(e,`${t.name} used ${n.name}, adding ${(s=n.properties)==null?void 0:s[dn]} actions`))},necklaceOfLightOnUse:(e,n,t,o)=>{var r;if(!o){g(e,"No target was selected.");return}if(!pt(t)){g(e,`${t.name} has no actions left.`);return}n.properties&&!((r=n.properties)!=null&&r[Ne])&&(n.properties[Ne]=!0,o.ignoredByMonsters=!0,t.actions--)}},Vn={magicHerbsOnReset:(e,n)=>{n.properties&&(n.properties[Ne]=!1)},necklaceOfLightOnUse:(e,n)=>{n.properties&&(n.properties[Ne]=!1),e.heroes.forEach(t=>t.ignoredByMonsters=!1)}},Xn={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:Ke.KILL_ALL,fulfilled:!1},{type:Ke.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:2,y:5},{x:1,y:4},{x:1,y:5},{x:1,y:6}],discoveredRooms:["A"],layout:{grid:["            ######","            #EEEE#","         ####EEEE#","##### ####DDDEEEE#","#AAA###CCCC#######","#AAABBBCCCC###GGG#","#AAA###CCCCFFFGGG#","##### #CCCC###GGG#","      #CCCC#######","      #CCCCHHHIII#","      ########III#","             #III#","             #####"],doors:[be(G.RIGHT,3,5),be(G.RIGHT,6,5),be(G.RIGHT,10,6),be(G.RIGHT,13,6),be(G.RIGHT,10,9),be(G.RIGHT,13,9),be(G.RIGHT,12,3),on(G.UP,9,4),on(G.RIGHT,15,2)],monsters:[$e(le.ORCH,te.Blue,10,8),$e(le.ORCH,te.Red,13,9),$e(le.TROLL,te.Red,16,2),$e(le.TROLL,te.Yellow,14,7)],secrets:[Rt(Re.EQUIPMENT,"Random Equipment",10,5),Rt(Re.EQUIPMENT,"Random Equipment",13,1),Rt(Re.EQUIPMENT,"Random Equipment",16,10),zn(Re.MAGIC_ITEM,16,6,$n[0])],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}],items:[]},killCount:0},Do={name:"Troll cave",beaten:!1,winConditions:[{type:Ke.KILL_ALL,fulfilled:!1}],nextDungeon:Xn,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[be(G.RIGHT,3,9),be(G.RIGHT,6,9),be(G.UP,7,7),be(G.UP,7,4)],monsters:[$e(le.ORCH,te.Green,6,9),$e(le.ORCH,te.Yellow,8,10),$e(le.ORCH,te.Red,7,5),$e(le.ORCH,te.Red,9,3),$e(le.TROLL,te.Green,6,1)],secrets:[Rt(Re.NOTE,"Welcome to Drakriddarna",3,9)],notes:[],items:[]},killCount:0},To=[{name:"Large shield",type:w.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:w.SHIELD,amountInDeck:2,dice:1,value:1}],Bo=()=>{const e=[];return $n.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},Oo=()=>{const e=[];return Nt.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),Jn.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),To.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},At={name:"Treasure of the Ice Dragon",dungeons:[Do,Xn],itemDeck:Oo(),magicItemDeck:Bo(),heroes:[Ot("Fearik",te.Yellow),Ot("Helbran",te.Red),Ot("Siedel",te.Green),Ot("Wulf",te.Blue)]},Ro=e=>{const n=Mo(e);n.length===0&&g(e,"No monsters can act"),n.forEach(t=>{const o=t.actions;for(g(e,`${t.name} acted `);t.actions>0;){const r=qn(e,t).filter(a=>!a.ignoredByMonsters),s=wo(e,t);switch(Qo(e,t,r,s)){case"MELEE_ATTACK":{const a=Po(r);fn(e,t,a,!1);break}case"RANGED_ATTACK":{const a=Ho(s,t);fn(e,t,a,!0);break}case"MOVE":{No(e,t);break}}t.movement=Ve(t)}t.actions=o,t.movement=Ve(t)})},Qo=(e,n,t,o)=>t.length>0?"MELEE_ATTACK":n.rangedWeapon&&o.length>0&&n.rangedWeapon?Math.random()<.1?(g(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":"MOVE",Ho=(e,n)=>e.filter(t=>!t.shield).sort(t=>kt(n.position,t.position)).sort((t,o)=>o.health-t.health||kt(n.position,t.position)-kt(n.position,o.position))[0],Po=e=>e.sort((n,t)=>t.health-n.health)[0],wo=(e,n)=>ne(e).filter(t=>!t.ignoredByMonsters).filter(t=>{const o={x:n.position.x*48-24,y:n.position.y*48-24},r={x:t.position.x*48-24,y:t.position.y*48-24};return Yt(o,n.position,r,t.position,e,[])}),Mo=e=>e.dungeon.layout.monsters.filter(n=>{const t=Dt(e.dungeon.layout.grid,n.position.x,n.position.y);return t&&e.dungeon.discoveredRooms.includes(t)&&n.health>0}),fn=(e,n,t,o)=>{Bt(e,n,t,o),(n==null?void 0:n.actions)>1&&(n==null?void 0:n.movement)<3?n.actions-=2:n.actions--},Lo=(e,n)=>ne(e).map(t=>({hero:t,dist:kt(t.position,n.position)})).sort((t,o)=>t.dist-o.dist)[0],No=(e,n)=>{const t=Lo(e,n);for(;n.movement>0;){if(t.dist>1){const o=xo(e,n.position);if(o.length>0){const r=o.map(s=>({pos:s,dist:kt(s,t.hero.position)})).sort((s,i)=>s.dist-i.dist)[0].pos;n.position=r,g(e,`${n.name} moved towards ${t.hero.name} (${r.x},${r.y})`)}else g(e,`${n.name} could not move`)}n.movement--}n.actions--},xo=(e,n)=>{const t=n.x,o=n.y,r=[];for(let s=t-1;s<=t+1;s++)for(let i=o-1;i<=o+1;i++)s===t&&i===o||Mt(e.dungeon.layout,s,i)&&Xt(e.dungeon,s,i)&&r.push({x:s,y:i});return r.filter(s=>!ne(e).find(i=>i.position.x===s.x&&i.position.y===s.y)).filter(s=>!e.dungeon.layout.monsters.some(i=>i.position.x===s.x&&i.position.y===s.y))},Uo=(e,n)=>{if(n.effect&&e.currentActor){const t=bo[n.effect];t(e,n,e.currentActor,e.targetActor),e.targetActor=void 0}},Go=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>$o(t)).forEach(t=>{if(t.reset){const o=Vn[t.reset];o(e,t)}})})},Wo=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>Ko(t)).forEach(t=>{if(t.reset){const o=Vn[t.reset];o(e,t)}})})},Ko=e=>e.properties?(e.properties[Gn]??[]).some(t=>t===Wn):!1,$o=e=>e.properties?(e.properties[Gn]??[]).some(t=>t===Kn):!1,An=e=>{g(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},mn=()=>{const e=localStorage.getItem("state");if(e){const n=JSON.parse(e);return n.currentActor=n.heroes.find(t=>{var o;return t.name===((o=n.currentActor)==null?void 0:o.name)}),g(n,"Game loaded."),n}},Vo=()=>{const e={heroes:At.heroes,dungeon:At.dungeons[0],currentActor:At.heroes[0],actionLog:[`Playing '${At.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:pn(At.itemDeck),magicItemDeck:pn(At.magicItemDeck),settings:{cellSize:48,debug:!1}};return Mn(e),e},pn=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},Vt=e=>{let n=[];for(let t=0;t<e.length;t++)n.push(e[t]);return n},_t=(e,n)=>{let t=[];for(let o=0;o<n;o++)t.push(Math.floor(Math.random()*6)+1);switch(e){case oe.APPRENTICE:t=t.filter(o=>o===5);break;case oe.KNIGHT:case oe.HERO:t=t.filter(o=>o>=4);break;case oe.LORD:case oe.MASTER:t=t.filter(o=>o>=3);break}return t.length},Ve=e=>{var n;return e.maxMovement-(((n=e.armour)==null?void 0:n.movementReduction)??0)},Qt=e=>{if(Xo(e),e.currentActor!==void 0){g(e,`${e.currentActor.name} ended their turn`);let t=ne(e).indexOf(e.currentActor)+1;t===ne(e).length&&(Ro(e),t=0,Wo(e)),ne(e)[t].incapacitated&&(g(e,`${ne(e)[t].name} is no longer incapacitated.`),ne(e)[t].incapacitated=!1,t++),e.currentActor.actions=2,e.currentActor.movement=Ve(e.currentActor),e.currentActor=ne(e)[t],g(e,`${e.currentActor.name} started their turn`)}},Xo=e=>{var n;e.dungeon.winConditions.forEach(t=>{var o;switch(t.type){case Ke.KILL_ALL:{const r=e.dungeon.layout.monsters.map(s=>s.health).reduce((s,i)=>s+i,0);t.fulfilled=r<=0;break}case Ke.REACH_CELL:{t.fulfilled=ne(e).some(r=>{var s;return r.position.x===((s=t.targetCell)==null?void 0:s.x)&&r.position.y===t.targetCell.y});break}case Ke.KILL_ALL_OF_TYPE:{t.fulfilled=e.dungeon.layout.monsters.filter(r=>r.type===t.targetMonsterType).some(r=>r.health>0);break}case Ke.OPEN_DOOR:{t.fulfilled=((o=e.dungeon.layout.doors.find(r=>{var s,i;return r.x===((s=t.targetCell)==null?void 0:s.x)&&r.y===((i=t.targetCell)==null?void 0:i.y)}))==null?void 0:o.open)??!1;break}case Ke.KILL_AT_LEAST:{t.fulfilled=(t.killMinCount?t.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,o)=>t&&o,!0),e.dungeon.beaten&&(g(e,"All win conditions have been fulfilled"),g(e,`You have cleared ${e.dungeon.name}`),g(e,`Press 'Next' to move on to the next level: ${(n=e.dungeon.nextDungeon)==null?void 0:n.name}`))},Yn=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:te.Red,maxHealth:0,name:"Door",level:oe.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:w.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Mt=(e,n,t)=>{let o=!0;if(n<0||n>=e.grid[0].length||t<0||t>=e.grid.length)o=!1;else{const r=Dt(e.grid,n,t);(r===Sn||r===Qn||r===Wt||r===wt)&&(o=!1)}return o},Xt=(e,n,t)=>{const o=Dt(e.layout.grid,n,t);return o?e.discoveredRooms.includes(o):!1},Dt=(e,n,t)=>{let o;return e.forEach((r,s)=>{Vt(r).forEach((i,a)=>{s===t&&a===n&&(o=i)})}),o},Tt=(e,n,t)=>e.x===n&&e.y===t||e.x===n-1&&e.y===t||e.x===n-1&&e.y===t-1||e.x===n&&e.y===t-1||e.x===n+1&&e.y===t-1||e.x===n+1&&e.y===t||e.x===n+1&&e.y===t+1||e.x===n&&e.y===t+1||e.x===n-1&&e.y===t+1,Yo=(e,n,t,o)=>{var s;const r=((s=o.armour)==null?void 0:s.defense)??o.defense;return`${e} damage (${n}-(${r}+${t})=${e})`},Ct=(e,n)=>e.x===n.x&&e.y===n.y,g=(e,n)=>{e.actionLog=[n,...e.actionLog]},Bt=(e,n,t,o)=>{var h,m;let r=n.weapon;o&&n.rangedWeapon&&(r=n.rangedWeapon);let s=0,i=0;r.ignoresArmour?t.armour&&g(e,`${t.name}'s armour was useless against ${r.name} `):s=((h=t.armour)==null?void 0:h.defense)??t.defense,r.ignoresShield?t.shield&&g(e,`${t.name}'s shield was useless against ${r.name} `):i=_t(t.level,((m=t.shield)==null?void 0:m.dice)??0);const a=n.inventory.some(E=>{var I;return g(e,`${n.name} used the effect of ${E.name} when attacking`),(I=E.properties)==null?void 0:I[ko]}),l=n.inventory.filter(E=>{var I;return(I=E==null?void 0:E.properties)==null?void 0:I[sn]}).map(E=>{var I;return g(e,`${n.name} used the effect of ${E.name} when attacking`),(I=E.properties)==null?void 0:I[sn]}).reduce((E,I)=>E+I,0),d=_t(n.level,r.dice+l);let v=Math.max(d-(s+i),0);v===0&&a&&(g(e,`${n.name} missed but got another chance`),v=Math.max(d-(s+i),0)),t.health-=v,g(e,`${n.name} attacked ${t.name} with ${r.name} for ${Yo(v,d,i,t)}`),t.health<=0&&(g(e,`${n.name} killed ${t.name}`),t.health=0,t.level=oe.APPRENTICE)},qo=(e,n)=>{const t=document.getElementById("gameBoardContainer"),o=document.getElementById("gameBoard");if(t&&o){const r=e.x*n,s=e.y*n,i=o.offsetWidth,a=o.offsetHeight;t.scrollLeft=Math.round(r/i),t.scrollTop=Math.round(s/a),console.log(`scrolling to ${t.scrollLeft} x ${t.scrollTop}`)}},Fo=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],mo(e),Ao(e),po(e),Mn(e),Go(e),qo({x:e.dungeon.startingPositions[0].x,y:e.dungeon.startingPositions[0].y},e.settings.cellSize))},kt=(e,n)=>Math.sqrt(Math.pow(e.x-(n==null?void 0:n.x),2)+Math.pow(e.y-(n==null?void 0:n.y),2)),Yt=(e,n,t,o,r,s)=>{const i=Zo(e,t),a={x:Math.round((i.x+24)/48),y:Math.round((i.y+24)/48)},l=Dt(r.dungeon.layout.grid,a.x,a.y);return a.x===o.x&&a.y===o.y?(s.push(a),!0):l===wt||l===Qn?!1:(a.x===n.x&&a.y===n.y||s.some(d=>d.x===a.x&&d.y===a.y)||s.push(a),Yt(i,n,t,o,r,s))},Zo=(e,n)=>{const t=e.x,o=e.y,r=n.x-t,s=n.y-o,i=r/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2),a=s/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2);let l=Math.round(i+t),d=Math.round(a+o);return{x:l,y:d}},qn=(e,n)=>ne(e).filter(t=>Tt(n.position,t.position.x,t.position.y)),jo="data:image/png;base64,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",Jo="data:image/png;base64,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",So=(e,n)=>{const t=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),r=Math.min(t,o),s=Math.max(t,o),i=r,a=s-r;let l=Math.sqrt(2);return a===0&&(l=1),Math.floor(l*i+a)},zo=(e,n)=>{const t=e.currentActor,o=e.dungeon.layout.items.find(s=>Ct(s.position,t.position));if(o){const s=o.item;s.type===w.MAGIC?wn(e,s):Pn(e,s);const i=e.dungeon.layout.items.indexOf(o);if(e.dungeon.layout.items.splice(i,1),g(e,`${t.name} picked up ${s.name}`),t.inventory.push(s),s.pickup){const a=Co[s.pickup];a(e,s,t)}return}const r=e.dungeon.layout.doors.find(s=>s.x===t.position.x&&s.y===t.position.y);if(r){const s=t.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[Un]});if(Nn(t,s,r)){switch(r.locked&&s&&g(e,`${t.name} broke the locked door`),r.open=!0,r.trapped&&Bt(e,Yn(r),t,!1),r.side){case G.RIGHT:vt(t,e,n.x+1,n.y);break;case G.LEFT:vt(t,e,n.x-1,n.y);break;case G.DOWN:vt(t,e,n.x,n.y+1);break;case G.UP:vt(t,e,n.x,n.y-1);break}Ht(t)}else if(r.locked&&!r.hidden){if(!pt(t)){g(e,`${t.name} has no actions left`);return}g(e,"Door is locked"),xt(e),Ht(t)}}else{if(!pt(t)){g(e,`${t.name} has no actions left`);return}Ut(e)}},er=(e,n)=>{const t=e.currentActor;if(t.actions===0){g(e,`${t.name} has no actions left`);return}const o=Mt(e.dungeon.layout,n.x,n.y),r=So(t.position,n);if(console.log("distance: "+r),o){const s=$t(e,n.x,n.y),i=Kt(e,n.x,n.y);if(!s&&!i&&r<=t.movement){if(t.position=n,t.movement-=r,Hn(e))return}else i&&(r<=t.weapon.range?Ln(t,e,n):g(e,"Monster is out of range"))}Ht(t)},tr=(e,n,t)=>{const o=document.getElementById("gameBoard");if(!o)return;const r=o.getBoundingClientRect(),s=Math.min(Math.floor((e.clientX-r.left)/n),t.dungeon.layout.grid[0].length-1),i=Math.min(Math.floor((e.clientY-r.top)/n),t.dungeon.layout.grid.length-1),a=t.dungeon.layout.grid[i][s],l=t.currentActor;s===l.position.x&&i===l.position.y?zo(t,{x:s,y:i}):t.dungeon.discoveredRooms.includes(a)&&er(t,{x:s,y:i})},nr=(e,n,t,o,r)=>{ne(o).forEach(i=>{or(e,i,n,t)}),ar(e,o,t),lr(e,o,t)},or=(e,n,t,o)=>{const r=n.position.x,s=n.position.y;e.drawImage(t,4*16,0,16,16,r*o,s*o,o,o),rr(e,n,r,s,o),ir(e,n,r,s,o),sr(e,n,r,s,o)},rr=(e,n,t,o,r)=>{const s=e.fillStyle,i=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let a=0;a<n.actions;a++)e.fillRect(t*r+4+6*a,o*r+r-12,5,5),e.rect(t*r+4+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle="blue";for(let a=0;a<n.movement;a++)e.fillRect(t*r+r-22+6*a,o*r+r-12,5,5),e.rect(t*r+r-22+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle=s,e.strokeStyle=i},sr=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t*r+4,o*r,r-8,4),e.fillStyle="green",e.fillRect(t*r+4,o*r,(r-8)*(n.health/n.maxHealth),4),e.rect(t*r+4,o*r,r-8,4),e.stroke()},ir=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(t*r+4,o*r+(r-6),r-8,4),e.stroke()},ar=(e,n,t)=>{const o=n.currentActor;if(o){for(let r=o.position.x-o.movement;r<=o.position.x+o.movement;r++)for(let s=o.position.y-o.movement;s<=o.position.y+o.movement;s++)if(Xt(n.dungeon,r,s)){const a=Kt(n,r,s),l=$t(n,r,s),d=Mt(n.dungeon.layout,r,s);!l&&!a&&d&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(r*t,s*t,t,t),e.stroke())}}},lr=(e,n,t)=>{const o=n.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t+t/3,o.position.y*t),e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t,o.position.y*t+t/3),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3,o.position.y*t+t),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t+t),e.stroke(),e.lineWidth=1)},cr=(e,n,t,o,r)=>{o.dungeon.layout.monsters.forEach(s=>{ur(e,n,o,s,t,r)})},ur=(e,n,t,o,r,s)=>{const i=t.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&hr(i,t)){switch(o.type){case le.ORCH:dr(e,n,r,o);break;case le.TROLL:fr(e,n,r,o);break;default:Ar(e,n,r,o);break}mr(e,o,r),pr(e,o,r),gr(e,o,t.heroes,t,r,s)}},dr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},fr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},Ar=(e,n,t,o)=>{e.drawImage(n,16,16,16,16,o.position.x*t,o.position.y*t,t,t)},mr=(e,n,t)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(n.position.x*t+4,n.position.y*t+(t-6),t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},pr=(e,n,t)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n.position.x*t+4,n.position.y*t,t-8,4),e.fillStyle="green",e.fillRect(n.position.x*t+4,n.position.y*t,(t-8)*(n.health/n.maxHealth),4),e.rect(n.position.x*t+4,n.position.y*t,t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},gr=(e,n,t,o,r,s)=>{s&&t.forEach(i=>{const a=[],l={x:n.position.x*48-24,y:n.position.y*48-24},d={x:i.position.x*48-24,y:i.position.y*48-24};if(Yt(l,n.position,d,i.position,o,a)){const h=n.position.x,m=n.position.y,E=i.position.x,I=i.position.y;e.beginPath(),e.strokeStyle=n.colour,e.lineWidth=2,e.moveTo(h*r+r/2,m*r+r/2),e.lineTo(E*r+r/2,I*r+r/2),e.stroke(),e.lineWidth=1}})},hr=(e,n)=>n.dungeon.discoveredRooms.includes(e),vr=(e,n,t,o,r)=>{o.dungeon.layout.doors.forEach(s=>{br(e,n,t,o,s,r)})},Er=(e,n,t,o,r)=>{o.dungeon.layout.grid.forEach((s,i)=>{Vt(s).forEach((a,l)=>{yr(e,n,o,a,l,i,t),Cr(e,a,o,l,i,t,r)})})},Ir=(e,n,t,o)=>{o.dungeon.layout.secrets.filter(r=>r.found).forEach(r=>{switch(r.type){case Re.TRAP_DOOR:kr(e,n,t,r);break;default:_r(e,n,t,r);break}})},yr=(e,n,t,o,r,s,i)=>{Dr(o)||!t.dungeon.discoveredRooms.includes(o)&&o!==Wt?t.dungeon.discoveredRooms.some(a=>Tr(r,s,a,t))?e.drawImage(n,48,0,48,48,r*i,s*i,i,i):gn(e,r,s,i):Pt(o,t)?gn(e,r,s,i):e.drawImage(n,0,0,48,48,r*i,s*i,i,i)},gn=(e,n,t,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(n*o,t*o,o,o),e.stroke()},kr=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,3*48,0,48,48,r*t,s*t,t,t)},_r=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,4*48,0,48,48,r*t,s*t,t,t)},Cr=(e,n,t,o,r,s,i)=>{!i&&(Pt(n,t)||n===wt)||(e.beginPath(),e.strokeStyle="black",e.rect(o*s,r*s,s,s),i&&(e.font="7px Arial",e.fillText(o+","+r,o*s+3,r*s+(s-3))),e.stroke())},br=(e,n,t,o,r,s)=>{const i=o.dungeon.layout.grid[r.y][r.x];if(r&&!r.hidden&&!r.open&&!Pt(i,o))switch(e.fillStyle="brown",r.side){case G.RIGHT:{e.fillRect(r.x*t+(t-2),r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t-4),r.y*t+(t/2-4),8,8));break}case G.LEFT:{e.fillRect(r.x*t-2,r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t-4,r.y*t+(t/2-4),8,8));break}case G.UP:{e.fillRect(r.x*t,r.y*t-2,t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t-4,8,8));break}case G.DOWN:{e.fillRect(r.x*t,r.y*t+(t-2),t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t+(t-4),8,8));break}}s&&!Pt(i,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${r.hidden?"H":"-"}/${r.trapped?"T"+r.trapAttacks:"-"}/${r.locked?"L":"-"}]`,r.x*t,r.y*t+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(r.x*t,r.y*t,t,t))},Dr=e=>e===wt,Pt=(e,n)=>e===Wt||!n.dungeon.discoveredRooms.includes(e),Tr=(e,n,t,o)=>{if(!o)return;const r=Math.max(e-1,0),s=Math.max(n-1,0),i=Math.min(n+1,o.dungeon.layout.grid.length-1),a=Math.min(e+1,o.dungeon.layout.grid[0].length-1);for(let l=r;l<=a;l++)for(let d=s;d<=i;d++){const v=o.dungeon.layout.grid[d];if(Vt(v)[l]===t)return!0}return!1},Br=(e,n,t,o)=>{o.dungeon.layout.items.forEach(r=>{switch(r.item.type){case w.MAGIC:Or(e,n,t,r);break}})},Or=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,0,48,48,48,r*t,s*t,t,t)};function Rr(e){let n,t,o,r;return{c(){n=f("div"),t=f("canvas"),this.h()},l(s){n=A(s,"DIV",{style:!0,class:!0,id:!0});var i=p(n);t=A(i,"CANVAS",{width:!0,height:!0,id:!0}),p(t).forEach(u),i.forEach(u),this.h()},h(){Q(t,"width",e[0]*40),Q(t,"height",e[0]*30),Q(t,"id","gameBoard"),Q(n,"style",e[2]()),Q(n,"class","dungeon svelte-a4uhtl"),Q(n,"id","gameBoardContainer")},m(s,i){H(s,n,i),c(n,t),o||(r=W(t,"click",e[1]),o=!0)},p:ce,i:ce,o:ce,d(s){s&&u(n),o=!1,r()}}}function Qr(e,n,t){let{state:o}=n,{debugMode:r}=n,s,i;const a=(o==null?void 0:o.settings.cellSize)??48;i=window.innerHeight,s=document.getElementById("footer").offsetHeight,bt(()=>{const h=new Image;h.src=jo;const m=new Image;m.src=Jo,setInterval(()=>l(h,m),10)});const l=(h,m)=>{if(!o||!document)return;const E=document.getElementById("gameBoard"),I=E.getContext("2d");I.clearRect(0,0,E.width,E.height),I.fillStyle="black",I.fillRect(0,0,E.width,E.height),Er(I,h,a,o,r),Ir(I,h,a,o),Br(I,h,a,o),vr(I,h,a,o,r),cr(I,m,a,o,r),nr(I,m,a,o)},d=h=>{tr(h,a,o)},v=()=>`max-height: ${i-s-20}px; max-width: ${a*40}`;return e.$$set=h=>{"state"in h&&t(3,o=h.state),"debugMode"in h&&t(4,r=h.debugMode)},[a,d,v,o,r]}class Hr extends tt{constructor(n){super(),nt(this,n,Qr,Rr,Qe,{state:3,debugMode:4})}}function hn(e){let n,t="Use",o,r;return{c(){n=f("button"),n.textContent=t},l(s){n=A(s,"BUTTON",{"data-svelte-h":!0}),V(n)!=="svelte-3f43k6"&&(n.textContent=t)},m(s,i){H(s,n,i),o||(r=W(n,"click",e[2]),o=!0)},p:ce,d(s){s&&u(n),o=!1,r()}}}function Pr(e){var E,I,X;let n,t,o,r=e[0].name+"",s,i,a,l,d,v=((E=e[0].properties)==null?void 0:E[ln])+"",h,m=((I=e[0].properties)==null?void 0:I[cn])&&!((X=e[0].properties)!=null&&X[Ne])&&hn(e);return{c(){n=f("div"),t=f("span"),m&&m.c(),o=T(),s=b(r),i=T(),a=f("div"),l=f("span"),d=b("¬†"),h=b(v),this.h()},l(_){n=A(_,"DIV",{class:!0});var P=p(n);t=A(P,"SPAN",{class:!0});var Y=p(t);m&&m.l(Y),o=B(Y),s=D(Y,r),Y.forEach(u),i=B(P),a=A(P,"DIV",{class:!0});var O=p(a);l=A(O,"SPAN",{class:!0});var N=p(l);d=D(N,"¬†"),h=D(N,v),N.forEach(u),O.forEach(u),P.forEach(u),this.h()},h(){Q(t,"class","svelte-16r3uh2"),Q(l,"class","svelte-16r3uh2"),Q(a,"class","description svelte-16r3uh2"),Q(n,"class","item-card svelte-16r3uh2")},m(_,P){H(_,n,P),c(n,t),m&&m.m(t,null),c(t,o),c(t,s),c(n,i),c(n,a),c(a,l),c(l,d),c(l,h)},p(_,[P]){var Y,O,N;(Y=_[0].properties)!=null&&Y[cn]&&!((O=_[0].properties)!=null&&O[Ne])?m?m.p(_,P):(m=hn(_),m.c(),m.m(t,o)):m&&(m.d(1),m=null),P&1&&r!==(r=_[0].name+"")&&ae(s,r),P&1&&v!==(v=((N=_[0].properties)==null?void 0:N[ln])+"")&&ae(h,v)},i:ce,o:ce,d(_){_&&u(n),m&&m.d()}}}function wr(e,n,t){let{item:o}=n,{state:r}=n;const s=()=>Uo(r,o);return e.$$set=i=>{"item"in i&&t(0,o=i.item),"state"in i&&t(1,r=i.state)},[o,r,s]}class Mr extends tt{constructor(n){super(),nt(this,n,wr,Pr,Qe,{item:0,state:1})}}function vn(e,n,t){const o=e.slice();return o[5]=n[t],o[6]=n,o[7]=t,o}function En(e){let n,t,o;function r(i){e[3](i,e[5],e[6],e[7])}let s={state:e[1]};return e[5]!==void 0&&(s.item=e[5]),n=new Mr({props:s}),Et.push(()=>yt(n,"item",r)),{c(){Je(n.$$.fragment)},l(i){Se(n.$$.fragment,i)},m(i,a){ze(n,i,a),o=!0},p(i,a){e=i;const l={};a&2&&(l.state=e[1]),!t&&a&1&&(t=!0,l.item=e[5],It(()=>t=!1)),n.$set(l)},i(i){o||(K(n.$$.fragment,i),o=!0)},o(i){z(n.$$.fragment,i),o=!1},d(i){et(n,i)}}}function In(e){let n,t,o=mt(e[0]),r=[];for(let i=0;i<o.length;i+=1)r[i]=En(vn(e,o,i));const s=i=>z(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=ge()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=ge()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);H(i,n,a),t=!0},p(i,a){if(a&3){o=mt(i[0]);let l;for(l=0;l<o.length;l+=1){const d=vn(i,o,l);r[l]?(r[l].p(d,a),K(r[l],1)):(r[l]=En(d),r[l].c(),K(r[l],1),r[l].m(n.parentNode,n))}for(ot(),l=o.length;l<r.length;l+=1)s(l);rt()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)K(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)z(r[a]);t=!1},d(i){i&&u(n),Gt(r,i)}}}function Lr(e){let n,t,o="Inventory",r,s=e[2],i,a=In(e);return{c(){n=f("div"),t=f("span"),t.textContent=o,r=T(),a.c(),this.h()},l(l){n=A(l,"DIV",{class:!0});var d=p(n);t=A(d,"SPAN",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-5cqt1m"&&(t.textContent=o),r=B(d),a.l(d),d.forEach(u),this.h()},h(){Q(t,"class","svelte-17j3oea"),Q(n,"class","inventory svelte-17j3oea")},m(l,d){H(l,n,d),c(n,t),c(n,r),a.m(n,null),i=!0},p(l,[d]){d&4&&Qe(s,s=l[2])?(ot(),z(a,1,1,ce),rt(),a=In(l),a.c(),K(a,1),a.m(n,null)):a.p(l,d)},i(l){i||(K(a),i=!0)},o(l){z(a),i=!1},d(l){l&&u(n),a.d(l)}}}function Nr(e,n,t){let{inventory:o}=n,{state:r}=n,s=!1;bt(()=>{i(),setInterval(i,100)});const i=()=>{t(2,s=!s)};function a(l,d,v,h){v[h]=l,t(0,o)}return e.$$set=l=>{"inventory"in l&&t(0,o=l.inventory),"state"in l&&t(1,r=l.state)},[o,r,s,a]}class xr extends tt{constructor(n){super(),nt(this,n,Nr,Lr,Qe,{inventory:0,state:1})}}function yn(e){let n;return{c(){n=b("*")},l(t){n=D(t,"*")},m(t,o){H(t,n,o)},d(t){t&&u(n)}}}function Ur(e){let n;return{c(){n=b("Unselect")},l(t){n=D(t,"Unselect")},m(t,o){H(t,n,o)},d(t){t&&u(n)}}}function Gr(e){let n;return{c(){n=b("Target")},l(t){n=D(t,"Target")},m(t,o){H(t,n,o)},d(t){t&&u(n)}}}function Wr(e){let n;return{c(){n=b("None (0)")},l(t){n=D(t,"None (0)")},m(t,o){H(t,n,o)},p:ce,d(t){t&&u(n)}}}function Kr(e){let n=e[0].armour.name+"",t,o,r=e[0].armour.defense+"",s,i;return{c(){t=b(n),o=b(" ("),s=b(r),i=b(")")},l(a){t=D(a,n),o=D(a," ("),s=D(a,r),i=D(a,")")},m(a,l){H(a,t,l),H(a,o,l),H(a,s,l),H(a,i,l)},p(a,l){l&1&&n!==(n=a[0].armour.name+"")&&ae(t,n),l&1&&r!==(r=a[0].armour.defense+"")&&ae(s,r)},d(a){a&&(u(t),u(o),u(s),u(i))}}}function $r(e){let n;return{c(){n=b("None (0)")},l(t){n=D(t,"None (0)")},m(t,o){H(t,n,o)},p:ce,d(t){t&&u(n)}}}function Vr(e){let n=e[0].shield.name+"",t,o,r=e[0].shield.dice+"",s,i;return{c(){t=b(n),o=b(" ("),s=b(r),i=b(")")},l(a){t=D(a,n),o=D(a," ("),s=D(a,r),i=D(a,")")},m(a,l){H(a,t,l),H(a,o,l),H(a,s,l),H(a,i,l)},p(a,l){l&1&&n!==(n=a[0].shield.name+"")&&ae(t,n),l&1&&r!==(r=a[0].shield.dice+"")&&ae(s,r)},d(a){a&&(u(t),u(o),u(s),u(i))}}}function kn(e){let n,t,o,r;function s(a){e[4](a)}let i={state:e[1]};return e[0].inventory!==void 0&&(i.inventory=e[0].inventory),t=new xr({props:i}),Et.push(()=>yt(t,"inventory",s)),{c(){n=f("div"),Je(t.$$.fragment),this.h()},l(a){n=A(a,"DIV",{class:!0});var l=p(n);Se(t.$$.fragment,l),l.forEach(u),this.h()},h(){Q(n,"class","equipment")},m(a,l){H(a,n,l),ze(t,n,null),r=!0},p(a,l){const d={};l&2&&(d.state=a[1]),!o&&l&1&&(o=!0,d.inventory=a[0].inventory,It(()=>o=!1)),t.$set(d)},i(a){r||(K(t.$$.fragment,a),r=!0)},o(a){z(t.$$.fragment,a),r=!1},d(a){a&&u(n),et(t)}}}function _n(e){let n,t,o,r=e[0].name+"",s,i,a,l,d=e[0].level+"",v,h,m=e[0].experience+"",E,I,X,_,P,Y,O,N,x=e[0].health+"",M,ue,j,y,R=e[0].actions+"",L,q,F,de,U=e[0].movement+"",He,Pe,Z,De="Equipment:",Te,he,fe,xe,ve=e[0].weapon.name+"",qe,Fe,Be=e[0].weapon.dice+"",Ie,st,Ze,Ae,Oe,it,ye,se,Ue,J,at,lt,S=e[1].targetActor===e[0]&&yn();function we(k,C){return k[1].targetActor!==k[0]?Gr:Ur}let je=we(e),Ee=je(e);function Xe(k,C){return k[0].armour?Kr:Wr}let ke=Xe(e),me=ke(e);function ct(k,C){return k[0].shield?Vr:$r}let Me=ct(e),ee=Me(e),$=e[0]===e[1].currentActor&&kn(e);return{c(){n=f("div"),t=f("div"),o=f("b"),S&&S.c(),s=b(r),i=b(" -"),a=T(),l=f("b"),v=b(d),h=b(" ("),E=b(m),I=b(")"),X=T(),_=f("span"),P=f("button"),Ee.c(),Y=T(),O=f("span"),N=b("HP: "),M=b(x),ue=T(),j=f("span"),y=b("Actions: "),L=b(R),q=T(),F=f("span"),de=b("Moves: "),He=b(U),Pe=T(),Z=f("span"),Z.textContent=De,Te=T(),he=f("div"),fe=f("span"),xe=b("üó°Ô∏è "),qe=b(ve),Fe=b(" ("),Ie=b(Be),st=b(")"),Ze=T(),Ae=f("span"),Oe=b(`üß±
      `),me.c(),it=T(),ye=f("span"),se=b(`üõ°Ô∏è
      `),ee.c(),Ue=T(),$&&$.c(),this.h()},l(k){n=A(k,"DIV",{class:!0,style:!0});var C=p(n);t=A(C,"DIV",{class:!0});var Le=p(t);o=A(Le,"B",{class:!0});var ie=p(o);S&&S.l(ie),s=D(ie,r),i=D(ie," -"),ie.forEach(u),a=B(Le),l=A(Le,"B",{class:!0});var pe=p(l);v=D(pe,d),h=D(pe," ("),E=D(pe,m),I=D(pe,")"),pe.forEach(u),Le.forEach(u),X=B(C),_=A(C,"SPAN",{class:!0});var gt=p(_);P=A(gt,"BUTTON",{});var ht=p(P);Ee.l(ht),ht.forEach(u),gt.forEach(u),Y=B(C),O=A(C,"SPAN",{class:!0});var ut=p(O);N=D(ut,"HP: "),M=D(ut,x),ut.forEach(u),ue=B(C),j=A(C,"SPAN",{class:!0});var dt=p(j);y=D(dt,"Actions: "),L=D(dt,R),dt.forEach(u),q=B(C),F=A(C,"SPAN",{class:!0});var _e=p(F);de=D(_e,"Moves: "),He=D(_e,U),_e.forEach(u),Pe=B(C),Z=A(C,"SPAN",{class:!0,"data-svelte-h":!0}),V(Z)!=="svelte-1ue18fw"&&(Z.textContent=De),Te=B(C),he=A(C,"DIV",{class:!0});var Ge=p(he);fe=A(Ge,"SPAN",{class:!0});var We=p(fe);xe=D(We,"üó°Ô∏è "),qe=D(We,ve),Fe=D(We," ("),Ie=D(We,Be),st=D(We,")"),We.forEach(u),Ze=B(Ge),Ae=A(Ge,"SPAN",{class:!0});var ft=p(Ae);Oe=D(ft,`üß±
      `),me.l(ft),ft.forEach(u),it=B(Ge),ye=A(Ge,"SPAN",{class:!0});var Ce=p(ye);se=D(Ce,`üõ°Ô∏è
      `),ee.l(Ce),Ce.forEach(u),Ge.forEach(u),Ue=B(C),$&&$.l(C),C.forEach(u),this.h()},h(){Q(o,"class","svelte-pgtred"),Q(l,"class","svelte-pgtred"),Q(t,"class","hero-title svelte-pgtred"),Q(_,"class","svelte-pgtred"),Q(O,"class","svelte-pgtred"),Q(j,"class","svelte-pgtred"),Q(F,"class","svelte-pgtred"),Q(Z,"class","svelte-pgtred"),Q(fe,"class","svelte-pgtred"),Q(Ae,"class","svelte-pgtred"),Q(ye,"class","svelte-pgtred"),Q(he,"class","equipment"),Q(n,"class","hero-card svelte-pgtred"),tn(n,"background-color",e[0].colour)},m(k,C){H(k,n,C),c(n,t),c(t,o),S&&S.m(o,null),c(o,s),c(o,i),c(t,a),c(t,l),c(l,v),c(l,h),c(l,E),c(l,I),c(n,X),c(n,_),c(_,P),Ee.m(P,null),c(n,Y),c(n,O),c(O,N),c(O,M),c(n,ue),c(n,j),c(j,y),c(j,L),c(n,q),c(n,F),c(F,de),c(F,He),c(n,Pe),c(n,Z),c(n,Te),c(n,he),c(he,fe),c(fe,xe),c(fe,qe),c(fe,Fe),c(fe,Ie),c(fe,st),c(he,Ze),c(he,Ae),c(Ae,Oe),me.m(Ae,null),c(he,it),c(he,ye),c(ye,se),ee.m(ye,null),c(n,Ue),$&&$.m(n,null),J=!0,at||(lt=W(P,"click",e[3]),at=!0)},p(k,C){k[1].targetActor===k[0]?S||(S=yn(),S.c(),S.m(o,s)):S&&(S.d(1),S=null),(!J||C&1)&&r!==(r=k[0].name+"")&&ae(s,r),(!J||C&1)&&d!==(d=k[0].level+"")&&ae(v,d),(!J||C&1)&&m!==(m=k[0].experience+"")&&ae(E,m),je!==(je=we(k))&&(Ee.d(1),Ee=je(k),Ee&&(Ee.c(),Ee.m(P,null))),(!J||C&1)&&x!==(x=k[0].health+"")&&ae(M,x),(!J||C&1)&&R!==(R=k[0].actions+"")&&ae(L,R),(!J||C&1)&&U!==(U=k[0].movement+"")&&ae(He,U),(!J||C&1)&&ve!==(ve=k[0].weapon.name+"")&&ae(qe,ve),(!J||C&1)&&Be!==(Be=k[0].weapon.dice+"")&&ae(Ie,Be),ke===(ke=Xe(k))&&me?me.p(k,C):(me.d(1),me=ke(k),me&&(me.c(),me.m(Ae,null))),Me===(Me=ct(k))&&ee?ee.p(k,C):(ee.d(1),ee=Me(k),ee&&(ee.c(),ee.m(ye,null))),k[0]===k[1].currentActor?$?($.p(k,C),C&3&&K($,1)):($=kn(k),$.c(),K($,1),$.m(n,null)):$&&(ot(),z($,1,1,()=>{$=null}),rt()),(!J||C&1)&&tn(n,"background-color",k[0].colour)},i(k){J||(K($),J=!0)},o(k){z($),J=!1},d(k){k&&u(n),S&&S.d(),Ee.d(),me.d(),ee.d(),$&&$.d(),at=!1,lt()}}}function Xr(e){let n=e[1].targetActor,t,o,r=_n(e);return{c(){r.c(),t=ge()},l(s){r.l(s),t=ge()},m(s,i){r.m(s,i),H(s,t,i),o=!0},p(s,[i]){i&2&&Qe(n,n=s[1].targetActor)?(ot(),z(r,1,1,ce),rt(),r=_n(s),r.c(),K(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(K(r),o=!0)},o(s){z(r),o=!1},d(s){s&&u(t),r.d(s)}}}function Yr(e,n,t){let{hero:o}=n,{state:r}=n;const s=l=>{r.targetActor&&l===r.targetActor?t(1,r.targetActor=void 0,r):t(1,r.targetActor=l,r)},i=()=>s(o);function a(l){e.$$.not_equal(o.inventory,l)&&(o.inventory=l,t(0,o))}return e.$$set=l=>{"hero"in l&&t(0,o=l.hero),"state"in l&&t(1,r=l.state)},[o,r,s,i,a]}class Fn extends tt{constructor(n){super(),nt(this,n,Yr,Xr,Qe,{hero:0,state:1})}}function Cn(e,n,t){const o=e.slice();return o[3]=n[t],o[5]=t,o}function qr(e){let n,t,o,r;return t=new Fn({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),Je(t.$$.fragment),o=T(),this.h()},l(s){n=A(s,"DIV",{class:!0});var i=p(n);Se(t.$$.fragment,i),o=B(i),i.forEach(u),this.h()},h(){Q(n,"class","not-current-actor svelte-gyascg")},m(s,i){H(s,n,i),ze(t,n,null),c(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(K(t.$$.fragment,s),r=!0)},o(s){z(t.$$.fragment,s),r=!1},d(s){s&&u(n),et(t)}}}function Fr(e){let n,t,o,r;return t=new Fn({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),Je(t.$$.fragment),o=T(),this.h()},l(s){n=A(s,"DIV",{class:!0});var i=p(n);Se(t.$$.fragment,i),o=B(i),i.forEach(u),this.h()},h(){Q(n,"class","is-current-actor svelte-gyascg")},m(s,i){H(s,n,i),ze(t,n,null),c(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(K(t.$$.fragment,s),r=!0)},o(s){z(t.$$.fragment,s),r=!1},d(s){s&&u(n),et(t)}}}function bn(e){let n,t,o,r;const s=[Fr,qr],i=[];function a(l,d){return l[3]===l[0].currentActor?0:1}return n=a(e),t=i[n]=s[n](e),{c(){t.c(),o=ge()},l(l){t.l(l),o=ge()},m(l,d){i[n].m(l,d),H(l,o,d),r=!0},p(l,d){let v=n;n=a(l),n===v?i[n].p(l,d):(ot(),z(i[v],1,1,()=>{i[v]=null}),rt(),t=i[n],t?t.p(l,d):(t=i[n]=s[n](l),t.c()),K(t,1),t.m(o.parentNode,o))},i(l){r||(K(t),r=!0)},o(l){z(t),r=!1},d(l){l&&u(o),i[n].d(l)}}}function Dn(e){let n=e[1],t,o,r=bn(e);return{c(){r.c(),t=ge()},l(s){r.l(s),t=ge()},m(s,i){r.m(s,i),H(s,t,i),o=!0},p(s,i){i&2&&Qe(n,n=s[1])?(ot(),z(r,1,1,ce),rt(),r=bn(s),r.c(),K(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(K(r),o=!0)},o(s){z(r),o=!1},d(s){s&&u(t),r.d(s)}}}function Zr(e){let n,t,o=mt(ne(e[0])),r=[];for(let i=0;i<o.length;i+=1)r[i]=Dn(Cn(e,o,i));const s=i=>z(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=ge()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=ge()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);H(i,n,a),t=!0},p(i,[a]){if(a&3){o=mt(ne(i[0]));let l;for(l=0;l<o.length;l+=1){const d=Cn(i,o,l);r[l]?(r[l].p(d,a),K(r[l],1)):(r[l]=Dn(d),r[l].c(),K(r[l],1),r[l].m(n.parentNode,n))}for(ot(),l=o.length;l<r.length;l+=1)s(l);rt()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)K(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)z(r[a]);t=!1},d(i){i&&u(n),Gt(r,i)}}}function jr(e,n,t){let{state:o}=n,r=!1;bt(()=>{s(),setInterval(s,100)});const s=()=>{t(1,r=!r)};return e.$$set=i=>{"state"in i&&t(0,o=i.state)},[o,r]}class Jr extends tt{constructor(n){super(),nt(this,n,jr,Zr,Qe,{state:0})}}function Tn(e,n,t){const o=e.slice();return o[2]=n[t],o[4]=t,o}function Sr(e){let n,t,o=e[2]+"",r;return{c(){n=f("p"),t=b(">"),r=b(o),this.h()},l(s){n=A(s,"P",{class:!0});var i=p(n);t=D(i,">"),r=D(i,o),i.forEach(u),this.h()},h(){Q(n,"class","svelte-axhg6g")},m(s,i){H(s,n,i),c(n,t),c(n,r)},p(s,i){i&1&&o!==(o=s[2]+"")&&ae(r,o)},d(s){s&&u(n)}}}function Bn(e){let n,t=e[4]<25&&Sr(e);return{c(){t&&t.c(),n=ge()},l(o){t&&t.l(o),n=ge()},m(o,r){t&&t.m(o,r),H(o,n,r)},p(o,r){o[4]<25&&t.p(o,r)},d(o){o&&u(n),t&&t.d(o)}}}function On(e){let n,t=mt(e[0]),o=[];for(let r=0;r<t.length;r+=1)o[r]=Bn(Tn(e,t,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();n=ge()},l(r){for(let s=0;s<o.length;s+=1)o[s].l(r);n=ge()},m(r,s){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(r,s);H(r,n,s)},p(r,s){if(s&1){t=mt(r[0]);let i;for(i=0;i<t.length;i+=1){const a=Tn(r,t,i);o[i]?o[i].p(a,s):(o[i]=Bn(a),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=t.length}},d(r){r&&u(n),Gt(o,r)}}}function zr(e){let n,t=e[0],o=On(e);return{c(){n=f("div"),o.c(),this.h()},l(r){n=A(r,"DIV",{class:!0});var s=p(n);o.l(s),s.forEach(u),this.h()},h(){Q(n,"class","log svelte-axhg6g")},m(r,s){H(r,n,s),o.m(n,null)},p(r,[s]){s&1&&Qe(t,t=r[0])?(o.d(1),o=On(r),o.c(),o.m(n,null)):o.p(r,s)},i:ce,o:ce,d(r){r&&u(n),o.d(r)}}}function es(e,n,t){let o=[],{state:r}=n;return bt(()=>{setInterval(()=>{t(0,o=r.actionLog)},500)}),e.$$set=s=>{"state"in s&&t(1,r=s.state)},[o,r]}class ts extends tt{constructor(n){super(),nt(this,n,es,zr,Qe,{state:1})}}const{window:ns}=jn;function os(e){let n,t,o,r,s="UL",i,a,l,d="U",v,h,m,E="UR",I,X,_,P="Next",Y,O,N,x,M="L",ue,j,y,R,L,q="R",F,de,U,He="Search",Pe,Z,De,Te,he="DL",fe,xe,ve,qe="D",Fe,Be,Ie,st="DR",Ze,Ae,Oe,it="Pick lock",ye,se,Ue,J,at="Save",lt,S,we,je="Load",Ee,Xe,ke,me="Debug",ct,Me,ee,$="End action",k,C;return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=T(),a=f("td"),l=f("button"),l.textContent=d,v=T(),h=f("td"),m=f("button"),m.textContent=E,I=T(),X=f("td"),_=f("button"),_.textContent=P,Y=T(),O=f("tr"),N=f("td"),x=f("button"),x.textContent=M,ue=T(),j=f("td"),y=T(),R=f("td"),L=f("button"),L.textContent=q,F=T(),de=f("td"),U=f("button"),U.textContent=He,Pe=T(),Z=f("tr"),De=f("td"),Te=f("button"),Te.textContent=he,fe=T(),xe=f("td"),ve=f("button"),ve.textContent=qe,Fe=T(),Be=f("td"),Ie=f("button"),Ie.textContent=st,Ze=T(),Ae=f("td"),Oe=f("button"),Oe.textContent=it,ye=T(),se=f("tr"),Ue=f("td"),J=f("button"),J.textContent=at,lt=T(),S=f("td"),we=f("button"),we.textContent=je,Ee=T(),Xe=f("td"),ke=f("button"),ke.textContent=me,ct=T(),Me=f("td"),ee=f("button"),ee.textContent=$},l(Le){n=A(Le,"TABLE",{});var ie=p(n);t=A(ie,"TR",{});var pe=p(t);o=A(pe,"TD",{});var gt=p(o);r=A(gt,"BUTTON",{"data-svelte-h":!0}),V(r)!=="svelte-1vu0fc2"&&(r.textContent=s),gt.forEach(u),i=B(pe),a=A(pe,"TD",{});var ht=p(a);l=A(ht,"BUTTON",{"data-svelte-h":!0}),V(l)!=="svelte-m1j18o"&&(l.textContent=d),ht.forEach(u),v=B(pe),h=A(pe,"TD",{});var ut=p(h);m=A(ut,"BUTTON",{"data-svelte-h":!0}),V(m)!=="svelte-8eygoe"&&(m.textContent=E),ut.forEach(u),I=B(pe),X=A(pe,"TD",{});var dt=p(X);_=A(dt,"BUTTON",{"data-svelte-h":!0}),V(_)!=="svelte-1axp1ke"&&(_.textContent=P),dt.forEach(u),pe.forEach(u),Y=B(ie),O=A(ie,"TR",{});var _e=p(O);N=A(_e,"TD",{});var Ge=p(N);x=A(Ge,"BUTTON",{"data-svelte-h":!0}),V(x)!=="svelte-amyars"&&(x.textContent=M),Ge.forEach(u),ue=B(_e),j=A(_e,"TD",{}),p(j).forEach(u),y=B(_e),R=A(_e,"TD",{});var We=p(R);L=A(We,"BUTTON",{"data-svelte-h":!0}),V(L)!=="svelte-2zfta0"&&(L.textContent=q),We.forEach(u),F=B(_e),de=A(_e,"TD",{});var ft=p(de);U=A(ft,"BUTTON",{"data-svelte-h":!0}),V(U)!=="svelte-1kis6k4"&&(U.textContent=He),ft.forEach(u),_e.forEach(u),Pe=B(ie),Z=A(ie,"TR",{});var Ce=p(Z);De=A(Ce,"TD",{});var qt=p(De);Te=A(qt,"BUTTON",{"data-svelte-h":!0}),V(Te)!=="svelte-57p0uk"&&(Te.textContent=he),qt.forEach(u),fe=B(Ce),xe=A(Ce,"TD",{});var Ft=p(xe);ve=A(Ft,"BUTTON",{"data-svelte-h":!0}),V(ve)!=="svelte-1nly394"&&(ve.textContent=qe),Ft.forEach(u),Fe=B(Ce),Be=A(Ce,"TD",{});var Zt=p(Be);Ie=A(Zt,"BUTTON",{"data-svelte-h":!0}),V(Ie)!=="svelte-7ds02w"&&(Ie.textContent=st),Zt.forEach(u),Ze=B(Ce),Ae=A(Ce,"TD",{});var jt=p(Ae);Oe=A(jt,"BUTTON",{"data-svelte-h":!0}),V(Oe)!=="svelte-90j6ve"&&(Oe.textContent=it),jt.forEach(u),Ce.forEach(u),ye=B(ie),se=A(ie,"TR",{});var Ye=p(se);Ue=A(Ye,"TD",{});var Jt=p(Ue);J=A(Jt,"BUTTON",{"data-svelte-h":!0}),V(J)!=="svelte-fxtyz6"&&(J.textContent=at),Jt.forEach(u),lt=B(Ye),S=A(Ye,"TD",{});var St=p(S);we=A(St,"BUTTON",{"data-svelte-h":!0}),V(we)!=="svelte-1m2jkw7"&&(we.textContent=je),St.forEach(u),Ee=B(Ye),Xe=A(Ye,"TD",{});var zt=p(Xe);ke=A(zt,"BUTTON",{"data-svelte-h":!0}),V(ke)!=="svelte-5alhx0"&&(ke.textContent=me),zt.forEach(u),ct=B(Ye),Me=A(Ye,"TD",{});var en=p(Me);ee=A(en,"BUTTON",{"data-svelte-h":!0}),V(ee)!=="svelte-1de77je"&&(ee.textContent=$),en.forEach(u),Ye.forEach(u),ie.forEach(u)},m(Le,ie){H(Le,n,ie),c(n,t),c(t,o),c(o,r),c(t,i),c(t,a),c(a,l),c(t,v),c(t,h),c(h,m),c(t,I),c(t,X),c(X,_),c(n,Y),c(n,O),c(O,N),c(N,x),c(O,ue),c(O,j),c(O,y),c(O,R),c(R,L),c(O,F),c(O,de),c(de,U),c(n,Pe),c(n,Z),c(Z,De),c(De,Te),c(Z,fe),c(Z,xe),c(xe,ve),c(Z,Fe),c(Z,Be),c(Be,Ie),c(Z,Ze),c(Z,Ae),c(Ae,Oe),c(n,ye),c(n,se),c(se,Ue),c(Ue,J),c(se,lt),c(se,S),c(S,we),c(se,Ee),c(se,Xe),c(Xe,ke),c(se,ct),c(se,Me),c(Me,ee),k||(C=[W(r,"click",e[12]),W(l,"click",e[13]),W(m,"click",e[14]),W(_,"click",e[15]),W(x,"click",e[16]),W(L,"click",e[17]),W(U,"click",e[18]),W(Te,"click",e[19]),W(ve,"click",e[20]),W(Ie,"click",e[21]),W(Oe,"click",e[22]),W(J,"click",e[23]),W(we,"click",e[24]),W(ke,"click",e[25]),W(ee,"click",e[26])],k=!0)},p:ce,d(Le){Le&&u(n),k=!1,Rn(C)}}}function rs(e){let n,t,o,r,s="Next",i,a,l,d="End action",v,h,m,E,I="Save",X,_,P,Y="Load",O,N,x,M,ue="Debug",j,y;return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=T(),a=f("td"),l=f("button"),l.textContent=d,v=T(),h=f("tr"),m=f("td"),E=f("button"),E.textContent=I,X=T(),_=f("td"),P=f("button"),P.textContent=Y,O=T(),N=f("tr"),x=f("td"),M=f("button"),M.textContent=ue},l(R){n=A(R,"TABLE",{});var L=p(n);t=A(L,"TR",{});var q=p(t);o=A(q,"TD",{});var F=p(o);r=A(F,"BUTTON",{"data-svelte-h":!0}),V(r)!=="svelte-1axp1ke"&&(r.textContent=s),F.forEach(u),i=B(q),a=A(q,"TD",{});var de=p(a);l=A(de,"BUTTON",{"data-svelte-h":!0}),V(l)!=="svelte-1de77je"&&(l.textContent=d),de.forEach(u),q.forEach(u),v=B(L),h=A(L,"TR",{});var U=p(h);m=A(U,"TD",{});var He=p(m);E=A(He,"BUTTON",{"data-svelte-h":!0}),V(E)!=="svelte-fxtyz6"&&(E.textContent=I),He.forEach(u),X=B(U),_=A(U,"TD",{});var Pe=p(_);P=A(Pe,"BUTTON",{"data-svelte-h":!0}),V(P)!=="svelte-1m2jkw7"&&(P.textContent=Y),Pe.forEach(u),U.forEach(u),O=B(L),N=A(L,"TR",{});var Z=p(N);x=A(Z,"TD",{});var De=p(x);M=A(De,"BUTTON",{"data-svelte-h":!0}),V(M)!=="svelte-5alhx0"&&(M.textContent=ue),De.forEach(u),Z.forEach(u),L.forEach(u)},m(R,L){H(R,n,L),c(n,t),c(t,o),c(o,r),c(t,i),c(t,a),c(a,l),c(n,v),c(n,h),c(h,m),c(m,E),c(h,X),c(h,_),c(_,P),c(n,O),c(n,N),c(N,x),c(x,M),j||(y=[W(r,"click",e[7]),W(l,"click",e[8]),W(E,"click",e[9]),W(P,"click",e[10]),W(M,"click",e[11])],j=!0)},p:ce,d(R){R&&u(n),j=!1,Rn(y)}}}function ss(e){let n,t,o,r,s,i,a,l,d,v,h,m,E,I,X,_;o=new Jr({props:{state:e[0]}});function P(y){e[5](y)}function Y(y){e[6](y)}let O={};e[0]!==void 0&&(O.state=e[0]),e[1]!==void 0&&(O.debugMode=e[1]),s=new Hr({props:O}),Et.push(()=>yt(s,"state",P)),Et.push(()=>yt(s,"debugMode",Y));function N(y,R){return y[2]<600?rs:os}let x=N(e),M=x(e);function ue(y){e[27](y)}let j={};return e[0]!==void 0&&(j.state=e[0]),m=new ts({props:j}),Et.push(()=>yt(m,"state",ue)),{c(){n=f("div"),t=f("div"),Je(o.$$.fragment),r=T(),Je(s.$$.fragment),l=T(),d=f("div"),v=f("div"),M.c(),h=T(),Je(m.$$.fragment),this.h()},l(y){n=A(y,"DIV",{class:!0});var R=p(n);t=A(R,"DIV",{class:!0});var L=p(t);Se(o.$$.fragment,L),L.forEach(u),r=B(R),Se(s.$$.fragment,R),R.forEach(u),l=B(y),d=A(y,"DIV",{class:!0,id:!0});var q=p(d);v=A(q,"DIV",{class:!0});var F=p(v);M.l(F),F.forEach(u),h=B(q),Se(m.$$.fragment,q),q.forEach(u),this.h()},h(){Q(t,"class","characterSide svelte-8a7at9"),Q(n,"class","container svelte-8a7at9"),Q(v,"class","commands svelte-8a7at9"),Q(d,"class","container svelte-8a7at9"),Q(d,"id","footer")},m(y,R){H(y,n,R),c(n,t),ze(o,t,null),c(n,r),ze(s,n,null),H(y,l,R),H(y,d,R),c(d,v),M.m(v,null),c(d,h),ze(m,d,null),I=!0,X||(_=W(ns,"keydown",Zn(e[4])),X=!0)},p(y,[R]){const L={};R&1&&(L.state=y[0]),o.$set(L);const q={};!i&&R&1&&(i=!0,q.state=y[0],It(()=>i=!1)),!a&&R&2&&(a=!0,q.debugMode=y[1],It(()=>a=!1)),s.$set(q),x===(x=N(y))&&M?M.p(y,R):(M.d(1),M=x(y),M&&(M.c(),M.m(v,null)));const F={};!E&&R&1&&(E=!0,F.state=y[0],It(()=>E=!1)),m.$set(F)},i(y){I||(K(o.$$.fragment,y),K(s.$$.fragment,y),K(m.$$.fragment,y),I=!0)},o(y){z(o.$$.fragment,y),z(s.$$.fragment,y),z(m.$$.fragment,y),I=!1},d(y){y&&(u(n),u(l),u(d)),et(o),et(s),M.d(),et(m),X=!1,_()}}}function is(e,n,t){let o=Vo(),r=o.settings.debug,s;bt(()=>{setInterval(()=>Fo(o),1e3)}),s=window.innerWidth,console.log(s);const i=()=>{t(1,r=!r),t(0,o.settings.debug=r,o)};function a(U){switch(U.key){case"6":case"d":re("R",o);break;case"9":case"e":re("UR",o);break;case"8":case"w":re("U",o);break;case"7":case"q":re("UL",o);break;case"4":case"a":re("L",o);break;case"1":case"z":re("DL",o);break;case"2":case"x":re("D",o);break;case"3":case"c":re("DR",o);break;case"0":case" ":Qt(o);break;case"-":case"r":xt(o);break;case"+":case"f":Ut(o);break}}function l(U){o=U,t(0,o)}function d(U){r=U,t(1,r)}const v=()=>Qt(o),h=()=>rn(o),m=()=>An(o),E=()=>t(0,o=mn()),I=()=>i(),X=()=>re("UL",o),_=()=>re("U",o),P=()=>re("UR",o),Y=()=>Qt(o),O=()=>re("L",o),N=()=>re("R",o),x=()=>Ut(o),M=()=>re("DL",o),ue=()=>re("D",o),j=()=>re("DR",o),y=()=>xt(o),R=()=>An(o),L=()=>t(0,o=mn()),q=()=>i(),F=()=>rn(o);function de(U){o=U,t(0,o)}return[o,r,s,i,a,l,d,v,h,m,E,I,X,_,P,Y,O,N,x,M,ue,j,y,R,L,q,F,de]}class cs extends tt{constructor(n){super(),nt(this,n,is,ss,Qe,{})}}export{cs as component};
