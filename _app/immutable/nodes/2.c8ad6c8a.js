import{s as Ce,n as pe,o as _n,b as hn,f as pn,r as Jn}from"../chunks/scheduler.bc760b9c.js";import{S as Ze,i as Se,g as f,h as m,j as A,f as d,k as M,a as R,x as u,y as te,s as H,m as U,z as oe,c as P,n as G,o as fe,p as ze,t as ce,b as en,d as ae,e as _e,A as Qn,B as gn,r as je,u as Xe,v as Je,w as Qe,l as wn,C as wo}from"../chunks/index.651de1fc.js";const Lo=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function on(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var F=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(F||{}),$=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))($||{}),de=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(de||{}),ge=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(ge||{}),re=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(re||{}),T=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(T||{}),V=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e[e.MAGIC=3]="MAGIC",e))(V||{});const Ln=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:V.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:V.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:V.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:V.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:V.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Yn=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:V.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:V.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:V.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],xo=[{name:"Chain mail",type:V.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:V.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:V.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],Tt=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:V.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:V.ARMOUR,movementReduction:0,value:0}],kn=" ",an="?",An="#",ke=(e,n,t,o)=>({type:e,name:n,position:{x:t,y:o},found:!1}),vn=(e,n,t,o)=>({type:e,name:o.name,position:{x:n,y:t},found:!1,item:o}),q=(e,n,t)=>({side:e,x:n,y:t,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),No=(e,n,t,o)=>({...q(e,n,t),trapped:!0,trapAttacks:o}),Ge=(e,n,t)=>({...q(e,n,t),hidden:!0}),xn=(e,n,t)=>({...q(e,n,t),locked:!0}),Dn=(e,n,t,o)=>({...q(e,n,t),locked:!0,trapped:!0,trapAttacks:o}),Ho=(e,n,t,o)=>({...q(e,n,t),hidden:!0,trapped:!0,trapAttacks:o}),Po=(e,n,t,o,r)=>{const s=ie(e,n,t,o);return s.inventory=r,s},ie=(e,n,t,o)=>{const r=Object.values(F).indexOf(n),s=Object.keys(F)[r];let i=de.LORD,a=2,l=2,c=4,g=4,y=4,p=Yn[0],v,I=Tt[0];switch(e){case $.ORCH:{i=de.APPRENTICE,l=0,c=2,g=2,y=1,v=Yn[1];break}case $.TROLL:{i=de.KNIGHT,l=1,c=3,g=3,y=2,p=Yn[2],I=Tt[1];break}}return e===$.YELLOW_DARK_LORD&&(a=3),{type:e,level:i,colour:n,actions:a,defense:l,health:c,maxHealth:g,experience:y,name:e+" ("+s+")",movement:3,maxMovement:3,position:{x:t,y:o},weapon:p,armour:I,incapacitated:!1,inventory:[],rangedWeapon:v}},Bo=e=>{const n=e.currentActor;if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}const t=n.inventory.filter(l=>{var c;return(c=l.properties)==null?void 0:c[Dt]}).map(l=>{var c;return h(e,`${n.name} used the effect of ${l.name} when searching`),(c=l.properties)==null?void 0:c[Dt]}).reduce((l,c)=>l+c,0),o=sn(n.level,1+t);let r,s,i,a;o>=1?(r=Xo(e,n,o),r||(s=Wo(e,n,o)),!r&&!s&&(i=Yo(e,n,o)),!r&&!s&&!i&&(a=Vo(e,n,o)),!r&&!s&&!i&&!a&&h(e,`${n.name} searched but found nothing`)):h(e,`${n.name} searched but found nothing`)},eo=e=>{const n=e.currentActor;if(!n)return!1;const t=e.dungeon.layout.secrets.filter(o=>o.type===re.TRAP_DOOR).filter(o=>!o.found).find(o=>Te(o.position,n.position));return t?(Ke(e,Uo(t),n,!1),h(e,`${n.name} fell into a pit and is incapacitated for one turn.`),n.movement=0,n.actions=0,n.incapacitated=!0,t.found=!0,!0):!1},no=(e,n)=>{const t=e.itemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.itemDeck.splice(t,1)},to=(e,n)=>{const t=e.magicItemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.magicItemDeck.splice(t,1)},Uo=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:F.Red,maxHealth:0,name:"Trap Door",level:de.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:V.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),Go=(e,n)=>e.dungeon.layout.doors.filter(t=>t.hidden).find(t=>Rn({x:t.x,y:t.y},n.x,n.y)),$o=(e,n)=>e.dungeon.layout.doors.filter(t=>t.trapped).find(t=>t.x===n.x&&t.y===n.y),Ko=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).find(t=>Rn(t.position,n.x,n.y)),Fo=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).filter(t=>t.type===re.TRAP_DOOR).find(t=>Rn(t.position,n.x,n.y)),Wo=(e,n,t)=>{const o=Go(e,n.position);return o?(o.hidden=!1,h(e,`${n.name} searched (${t}) and found a hidden door`),!0):!1},Yo=(e,n,t)=>{const o=$o(e,n.position);return o?(h(e,`${n.name} searched (${t}) and found a trap in a door`),o.trapped=!1,!0):!1},Vo=(e,n,t)=>{const o=Ko(e,n.position);if(o){switch(h(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,o.type){case re.EQUIPMENT:{const r=o.item??qo(e);r.amountInDeck>0&&(no(e,r),h(e,`${n.name} equipped (${r.name})`),lo(e,r,n));break}case re.MAGIC_ITEM:{const r=o.item??jo(e);r.amountInDeck>0&&(to(e,r),h(e,`${n.name} found (${r.name})`),n.inventory.push(r),r.pickup&&zn[r.pickup](e,r,n));break}}return!0}return!1},qo=e=>{const n=e.itemDeck.length,t=Math.floor(Math.random()*n);return e.itemDeck[t]},jo=e=>{const n=e.magicItemDeck.length,t=Math.floor(Math.random()*n);return e.magicItemDeck[t]},Xo=(e,n,t)=>{const o=Fo(e,n.position);return o?(h(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,!0):!1},Cn=(e,n)=>(Ln[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:de.APPRENTICE,health:7,maxHealth:7,colour:n,experience:0,position:{x:-1,y:-1},weapon:Ln[0],incapacitated:!1,inventory:[],isInventoryOpen:!1}),he=(e,n)=>{n.reRender=!0;const t=n.currentActor;if(!t||t.actions===0)return;const o={x:t.position.x,y:t.position.y};switch(e){case"UL":o.x=t.position.x-1,o.y=t.position.y-1;break;case"U":o.y=t.position.y-1;break;case"UR":o.x=t.position.x+1,o.y=t.position.y-1;break;case"L":o.x=t.position.x-1;break;case"R":o.x=t.position.x+1;break;case"DL":o.x=t.position.x-1,o.y=t.position.y+1;break;case"D":o.y=t.position.y+1;break;case"DR":o.x=t.position.x+1,o.y=t.position.y+1;break}const r=bn(n,o.x,o.y),s=!Bn(n.dungeon.layout,o.x,o.y),i=En(n,o.x,o.y);if(!r&&!s){const a=In(n.dungeon,o.x,o.y);a?a&&(i?oo(t,n,o):co(t,n,o.x,o.y,1)):Zo(n,t,o.x,o.y)&&mn(t,n,o.x,o.y)}else h(n,`${t.name} could not make that move`);eo(n)||Sn(t)},qn=e=>{e.reRender=!0;const n=e.currentActor;if(!n)return;if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}if(!rn(n)){h(e,`${n.name} has no actions left to pick lock`);return}const t=e.dungeon.layout.doors.find(o=>o.x===n.position.x&&o.y===n.position.y);t&&t.locked&&(sn(n.level,1)>=1?(t.locked=!1,h(e,`${n.name} managed to pick the lock`)):h(e,`${n.name} failed to pick the lock`),n.actions>1&&n.movement<3?n.actions-=2:n.actions--,n.movement=Ne(n),n.actions==0&&(n.movement=0))},Zn=e=>{e.reRender=!0,e.heroes.forEach((n,t)=>{n.position=e.dungeon.startingPositions[t],n.movement=Ne(n),n.actions=2,n.health=n.maxHealth})},W=e=>e.heroes.filter(n=>n.health>0).map(n=>n),It=e=>{e.reRender=!0;const n=e.currentActor;n&&(n.actions--,n.movement=Ne(n),n.actions===0&&Mn(e))},rn=e=>e.movement<Ne(e)?e.actions>1:e.actions>0,mn=(e,n,t,o)=>{n.reRender=!0;const r=we(n.dungeon.layout.grid,t,o);r&&![An,kn,an].includes(r)&&n.dungeon.discoveredRooms.push(r),co(e,n,e.position.x,e.position.y,1),h(n,`${e.name} opened a door`)},oo=(e,n,t)=>{if(n.reRender=!0,e.actions===1&&e.movement<e.maxMovement){h(n,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&nr(n,e)){h(n,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const o=er(n,t);o&&(Ke(n,e,o,!1),o.health<=0&&zo(n,o,e),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},jn=e=>{e.reRender=!0;const n=e.currentActor;if(n){if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}if(!rn(n)){h(e,`${n.name} has no actions left to search`);return}Bo(e),n.actions>1&&n.movement<Ne(n)?n.actions-=2:n.actions--,n.actions==0&&(n.movement=0)}},En=(e,n,t)=>e.dungeon.layout.monsters.some(o=>o.position.x===n&&o.position.y===t&&o.health>0),bn=(e,n,t)=>W(e).some(o=>o.position.x===n&&o.position.y===t),Sn=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=Ne(e))),e.actions==0&&(e.movement=0)},Jo=e=>{e.reRender=!0,W(e).forEach(n=>{const t=n.level;n.experience>=28?n.level=de.MASTER:n.experience>=18?n.level=de.LORD:n.experience>=10?n.level=de.HERO:n.experience>=4&&(n.level=de.KNIGHT),t!==n.level&&h(e,`${n.name} leveled up to ${n.level}`)})},Qo=e=>{W(e).forEach(n=>n.experience+=4)},ro=e=>{tr(e).forEach(n=>{n.experience=0,n.health=n.maxHealth,n.movement=n.maxMovement,n.actions=2})},so=(e,n,t)=>!t.open&&!t.hidden&&(!t.locked||t.locked&&n)&&e.movement>0,io=(e,n)=>{const t=e.dungeon.layout.notes.find(o=>Te(o.position,n.position));t&&(e.dungeon.layout.doors.some(r=>r.hidden&&Te(t.position,{x:r.x,y:r.y}))||h(e,`${n.name} reads: ${t.message}`))},ao=(e,n)=>{const t=e.dungeon.layout.monsters.some(o=>Rn(n.position,o.position.x,o.position.y));return t&&h(e,`${n.name} walked by a monster and lost the momentum`),t},Vn=(e,n,t)=>{h(e,`${t.name} dropped ${n.name}.`),e.dungeon.layout.items.push({item:n,position:t.position}),n.drop&&po[n.drop](e,n,t)},lo=(e,n,t)=>{switch(n.type){case V.ARMOUR:t.armour&&Vn(e,t.armour,t),t.armour=n;break;case V.SHIELD:t.shield&&Vn(e,t.shield,t),t.shield=n;break;case V.WEAPON:t.weapon&&Vn(e,t.weapon,t),t.weapon=n;break;default:t.inventory.push(n);break}if(n.pickup){const o=zn[n.pickup];o(e,n,t)}},co=(e,n,t,o,r)=>{e.position.x=t,e.position.y=o,io(n,e),ao(n,e)?e.movement=0:e.movement-=r},Zo=(e,n,t,o)=>{const r=e.dungeon.layout.doors.find(i=>i.x===n.position.x&&i.y===n.position.y),s=n.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[uo]});if(r&&so(n,s,r)){r.locked&&s&&h(e,`${n.name} broke the locked door`);const i=So(n.position.x,n.position.y,t,o);if(r.side===i)return r.open=!0,r.trapped&&Ke(e,Ro(r),n,!1),!0}return r&&r.locked&&h(e,"Door is locked"),!1},So=(e,n,t,o)=>{if(e===t){if(n>o)return T.UP;if(n<o)return T.DOWN}if(n===o){if(e>t)return T.LEFT;if(e<t)return T.RIGHT}},zo=(e,n,t)=>{e.dungeon.layout.monsters=e.dungeon.layout.monsters.filter(o=>o!=n),h(e,`${t.name} killed ${n.name}`),e.dungeon.killCount++,t.experience+=n.experience},er=(e,n)=>e.dungeon.layout.monsters.find(t=>Te(t.position,n)),nr=(e,n)=>Co(e,n).filter(t=>t!==n).length>0,tr=e=>e.heroes.filter(n=>n.health<=0).map(n=>n),xe="USED",Rt="ATTACK_BONUS",Dt="SEARCH_BONUS",uo="BREAK_LOCK",Ct="RE_ROLL_ATTACK",On="DESCRIPTION",Nn="ACTIVE",Hn="MOVEMENT_BONUS",Ot="ACTIONS_BONUS",fo="RESET_ON",mo="NEXT_TURN",or="TRADE",ho="NEXT_SCENARIO",zn={movementBonusOnPickup:(e,n,t)=>{var o,r;t.maxMovement+=(o=n.properties)==null?void 0:o[Hn],t.actions>0&&(t.movement+=(r=n.properties)==null?void 0:r[Hn])}},po={movementBonusOnDrop:(e,n,t)=>{var o,r;t.maxMovement-1>0&&(t.maxMovement-=(o=n.properties)==null?void 0:o[Hn]),t.movement-1>=0&&(t.movement-=(r=n.properties)==null?void 0:r[Hn])}},rr={magicHerbsOnUse:(e,n,t,o)=>{if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}if(!o){h(e,"No target was selected.");return}if(!rn(t)){h(e,`${t.name} has no actions left.`);return}if(n.properties){if(n.properties[xe]){h(e,`${n.name} has no uses left.`);return}n.properties[xe]=!0;const r=Math.min(sn(t.level,3),o.maxHealth-o.health);o.health+=r,h(e,`${t.name} used ${n.name} on ${o.name}, restoring ${r} HP`),t.actions--,t.movement=t.maxMovement}},chaosSwordOnUse:(e,n,t,o)=>{if(n.disabled){h(e,`${n.name} cannot be used at this moment. ${t.name} tried it.`);return}},potionOfSpeedOnUse:(e,n,t)=>{var o,r,s;if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}(o=n.properties)!=null&&o[xe]?h(e,`${n.name} has been consumed.`):(t.actions+=(r=n.properties)==null?void 0:r[Ot],n.properties&&(n.properties[xe]=!0),h(e,`${t.name} used ${n.name}, adding ${(s=n.properties)==null?void 0:s[Ot]} actions`))},necklaceOfLightOnUse:(e,n,t,o)=>{var r;if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}if(!o){h(e,"No target was selected.");return}if(!rn(t)){h(e,`${t.name} has no actions left.`);return}n.properties&&!((r=n.properties)!=null&&r[xe])&&(n.properties[xe]=!0,o.ignoredByMonsters=!0,t.actions--)}},go={magicHerbsOnReset:(e,n)=>{n.properties&&(n.properties[xe]=!1)},necklaceOfLightOnUse:(e,n)=>{n.properties&&(n.properties[xe]=!1),e.heroes.forEach(t=>t.ignoredByMonsters=!1)}},sr=(e,n)=>{if(n.effect&&e.currentActor){const t=rr[n.effect];t(e,n,e.currentActor,e.targetActor),e.targetActor=void 0}},yo=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>ar(t)).forEach(t=>{if(t.reset){const o=go[t.reset];o(e,t)}})})},vo=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>ir(t)).forEach(t=>{if(t.reset){const o=go[t.reset];o(e,t)}})})},ir=e=>e.properties?(e.properties[fo]??[]).some(t=>t===mo):!1,ar=e=>e.properties?(e.properties[fo]??[]).some(t=>t===ho):!1,be=[{name:"Healing Herbs",type:V.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,ACTIVE:!0,DESCRIPTION:"Chance to heal up to 3 wounds on one hero.",RESET_ON:[or,ho]},effect:"magicHerbsOnUse",reset:"magicHerbsOnReset"},{name:"Thousand League Boots",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives one additional step for each move action.",MOVEMENT_BONUS:1},pickup:"movementBonusOnPickup",drop:"movementBonusOnDrop"},{name:"Giants Glove",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional attack die. Breaks locked doors.",BREAK_DOOR:!0,ATTACK_BONUS:1}},{name:"Ring of Precision",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"May re-roll one completely missed attack.",RE_ROLL_ATTACK:!0}},{name:"Crown of Wisdom",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional die roll when searching.",SEARCH_BONUS:1}},{name:"Sword of Chaos",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"A sword with a will of it's own. Use at your own peril."},effect:"chaosSwordOnUse"},{name:"Potion of Speed",type:V.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives 2 additional actions. Can only be used once.",USED:!1,ACTIONS_BONUS:2,ACTIVE:!0},effect:"potionOfSpeedOnUse"},{name:"Necklace of Light",type:V.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,RESET_ON:[mo],ACTIVE:!0},effect:"necklaceOfLightOnUse",reset:"necklaceOfLightOnReset"}],_o={name:"The Dread Labyrinth",beaten:!1,winConditions:[{type:ge.KILL_ALL,fulfilled:!1},{type:ge.OPEN_DOOR,targetCell:{x:18,y:4},fulfilled:!1}],startingPositions:[{x:2,y:5},{x:1,y:4},{x:1,y:5},{x:1,y:6}],discoveredRooms:["A"],layout:{grid:["       ########     ","     ###DDDEEE#     ","     #CCC##EEE#     ","######CCC##EEE######","#AAA##CCC####F#IIII#","#AAABBB#J####F#IIII#","#AAA####J##G#F#IIII#","##### ##J##GGF#IIII#","   ####KKK###F#IIII#","   #LLLKKK# #FMIIII#","   ####KKK####M#####","      #KKKMMMMM#    ","      ####MMMM##    ","         ######     "],corridors:["B","D","F","L"],pits:[{x:16,y:6},{x:17,y:6},{x:18,y:6},{x:15,y:8},{x:16,y:8},{x:17,y:8}],doors:[q(T.RIGHT,3,5),Dn(T.DOWN,6,5,1),q(T.UP,6,5),q(T.DOWN,8,4),Ge(T.UP,8,2),q(T.DOWN,8,7),q(T.LEFT,7,9),Dn(T.LEFT,4,9,1),Dn(T.RIGHT,9,11,1),Ge(T.RIGHT,14,9),Ge(T.UP,18,4),Dn(T.LEFT,14,9,1),q(T.LEFT,13,7),xn(T.UP,11,6),q(T.UP,13,4),q(T.LEFT,11,1)],monsters:[ie($.ORCH,F.Yellow,5,5),Po($.TROLL,F.Yellow,7,3,[be[3]]),ie($.ORCH,F.Red,7,11),ie($.ORCH,F.Blue,11,2),ie($.ORCH,F.Blue,14,11),ie($.YELLOW_DARK_LORD,F.Yellow,18,5)],secrets:[vn(re.MAGIC_ITEM,8,10,be[2]),ke(re.TRAP_DOOR,"Trap door",8,6),ke(re.TRAP_DOOR,"Trap door",11,1),ke(re.TRAP_DOOR,"Trap door",11,7),ke(re.TRAP_DOOR,"Trap door",13,11)],notes:[{position:{x:6,y:5},message:"An arrow on the far wall of the corridor points to the left."},{position:{x:8,y:3},message:"An arrow on the far wall of the corridor points to the right."},{position:{x:8,y:8},message:"There is a mosaic in the floor. It depicts a snake coiling around a dwarf, while battling an ice dragon. In the jaws of the snake is treasure chest."},{position:{x:14,y:10},message:"An arrow on the far wall of the corridor points to the left"}],items:[]},killCount:0},ko={name:"The Mines of Evil",nextDungeon:_o,beaten:!1,winConditions:[{type:ge.KILL_ALL,fulfilled:!1},{type:ge.OPEN_DOOR,targetCell:{x:17,y:14},fulfilled:!1}],startingPositions:[{x:2,y:14},{x:1,y:15},{x:2,y:15},{x:3,y:15}],discoveredRooms:["M"],layout:{grid:["############## #####","#AAA###CCCCCC###EEE#","#AAABBBC@CC@CDDDEEE#","#AAA###CCCCCC###EEE#","##### ##H##### #EEE#","       #H#     #EEE#","##### ##H##### #EEE#","#KKK###IIIIII# #EEE#","#KKKJJJIIIIII# ##F##","#KKK###IIIIII# ##F##","##L## #IIIIII# ##F##"," #L#  ######## #GGG#","##L##          #GGG#","#MMM#          #GGG#","#MMM#          #GGG#","#MMM#          #####","#####               "],corridors:["B","D","F","H","J","L"],doors:[q(T.UP,2,13),q(T.UP,2,10),q(T.RIGHT,3,8),xn(T.RIGHT,6,8),q(T.UP,8,7),q(T.UP,8,4),Ge(T.LEFT,7,2),q(T.LEFT,4,2),xn(T.RIGHT,12,2),q(T.RIGHT,15,2),q(T.DOWN,17,7),q(T.DOWN,17,10),Ge(T.DOWN,17,14)],monsters:[ie($.TROLL,F.Red,3,7),ie($.ORCH,F.Red,12,8),ie($.ORCH,F.Green,11,1),ie($.TROLL,F.Green,2,2),ie($.ORCH,F.Yellow,18,7),ie($.TROLL,F.Yellow,17,10)],secrets:[ke(re.EQUIPMENT,"Equipment",1,3),ke(re.EQUIPMENT,"Equipment",3,3),ke(re.EQUIPMENT,"Equipment",15,2),vn(re.MAGIC_ITEM,2,3,be[1]),vn(re.MAGIC_ITEM,16,11,be[6])],notes:[{message:"Guard room",position:{x:2,y:10}},{message:"Look in the pillar room for the armory of the dwarf king",position:{x:8,y:10}},{message:"To reach the treasure of the ice dragon, look behind the mirror in the alchemy laboratory.",position:{x:2,y:3}},{message:"A large mirror decorates the far wall of this room.",position:{x:17,y:11}}],items:[]},killCount:0},Ao={name:"The Three Gates of Power",nextDungeon:ko,beaten:!1,winConditions:[{type:ge.KILL_ALL,fulfilled:!1},{type:ge.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:2,y:5},{x:1,y:4},{x:1,y:5},{x:1,y:6}],discoveredRooms:["A"],layout:{grid:["            ######","            #EEEE#","         ####EEEE#","##### ####DDDEEEE#","#AAA###CCCC#######","#AAABBBCCCC###GGG#","#AAA###CCCCFFFGGG#","##### #CCCC###GGG#","      #CCCC#######","      #CCCCHHHIII#","      ########III#","             #III#","             #####"],corridors:["B","D","F","H"],doors:[q(T.RIGHT,3,5),q(T.RIGHT,6,5),q(T.RIGHT,10,6),q(T.RIGHT,13,6),q(T.RIGHT,10,9),q(T.RIGHT,13,9),q(T.RIGHT,12,3),Ge(T.UP,9,4),Ge(T.RIGHT,15,2)],monsters:[ie($.ORCH,F.Blue,10,8),ie($.ORCH,F.Red,13,9),ie($.TROLL,F.Red,16,2),ie($.TROLL,F.Yellow,14,7)],secrets:[ke(re.EQUIPMENT,"Random Equipment",10,5),ke(re.EQUIPMENT,"Random Equipment",13,1),ke(re.EQUIPMENT,"Random Equipment",16,10),vn(re.MAGIC_ITEM,16,6,be[0])],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}],items:[]},killCount:0},Eo={name:"Troll cave",beaten:!1,winConditions:[{type:ge.KILL_ALL,fulfilled:!1}],nextDungeon:Ao,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[q(T.RIGHT,3,9),q(T.RIGHT,6,9),q(T.UP,7,7),q(T.UP,7,4)],monsters:[ie($.ORCH,F.Green,6,9),ie($.ORCH,F.Yellow,8,10),ie($.ORCH,F.Red,7,5),ie($.ORCH,F.Red,9,3),ie($.TROLL,F.Green,6,1)],secrets:[ke(re.NOTE,"Welcome to Drakriddarna",3,9)],notes:[],items:[],corridors:["D","E"]},killCount:0,events:[1,2,3,4,5,6]},lr=[{name:"Large shield",type:V.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:V.SHIELD,amountInDeck:2,dice:1,value:1}],cr=()=>{const e=[];return be.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},ur=()=>{const e=[];return Ln.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),xo.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),lr.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},qe={name:"Treasure of the Ice Dragon",dungeons:[Eo,Ao,ko,_o],itemDeck:ur(),magicItemDeck:cr(),heroes:[Cn("Fearik",F.Yellow),Cn("Helbran",F.Red),Cn("Siedel",F.Green),Cn("Wulf",F.Blue)]},et=(e,n)=>{const t=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),r=Math.min(t,o),s=Math.max(t,o),i=r,a=s-r;let l=Math.sqrt(2);return a===0&&(l=1),Math.floor(l*i+a)},dr=(e,n)=>{e.reRender=!0;const t=e.currentActor,o=e.dungeon.layout.items.find(s=>Te(s.position,t.position));if(o){const s=o.item;s.type===V.MAGIC?to(e,s):no(e,s);const i=e.dungeon.layout.items.indexOf(o);e.dungeon.layout.items.splice(i,1),h(e,`${t.name} picked up ${s.name}`),lo(e,s,t);return}const r=e.dungeon.layout.doors.find(s=>s.x===t.position.x&&s.y===t.position.y&&!s.open);if(r&&!r.hidden){const s=t.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[uo]});if(so(t,s,r)){switch(r.locked&&s&&h(e,`${t.name} broke the locked door`),r.open=!0,r.trapped&&Ke(e,Ro(r),t,!1),r.side){case T.RIGHT:mn(t,e,n.x+1,n.y);break;case T.LEFT:mn(t,e,n.x-1,n.y);break;case T.DOWN:mn(t,e,n.x,n.y+1);break;case T.UP:mn(t,e,n.x,n.y-1);break}Sn(t)}else if(r.locked&&!r.hidden){if(!rn(t)){h(e,`${t.name} has no actions left`);return}h(e,"Door is locked"),qn(e)}}else{if(!rn(t)){h(e,`${t.name} has no actions left`);return}jn(e)}},fr=(e,n)=>{e.reRender=!0;const t=e.currentActor;if(t.actions===0){t.movement=0,h(e,`${t.name} has no actions left`);return}if(Bn(e.dungeon.layout,n.x,n.y)){const r=bn(e,n.x,n.y),s=En(e,n.x,n.y),i=et(t.position,n),a=nt(t.position,n,2,e,!0);if(!r&&!s&&i<=t.movement&&a){if(t.position=n,t.movement-=i,io(e,t),ao(e,t)&&(t.movement=0),eo(e))return}else s&&(i<=t.weapon.range?oo(t,e,n):h(e,"Monster is out of range"))}Sn(t)},mr=(e,n,t)=>{const o=document.getElementById("gameBoard");if(!o)return;const r=o.getBoundingClientRect(),s=Math.min(Math.floor((e.clientX-r.left)/n),t.dungeon.layout.grid[0].length-1),i=Math.min(Math.floor((e.clientY-r.top)/n),t.dungeon.layout.grid.length-1),a=t.dungeon.layout.grid[i][s],l=t.currentActor;s===l.position.x&&i===l.position.y?dr(t,{x:s,y:i}):$e(t.dungeon,a)&&fr(t,{x:s,y:i})},hr=e=>{const n=_r(e);n.length===0&&h(e,"No monsters can act"),n.forEach(t=>{const o=t.actions;for(h(e,`${t.name} acted `);t.actions>0;){e.reRender=!0;const r=Co(e,t).filter(c=>!c.ignoredByMonsters),s=vr(e,t),i=br(s,t),a=Tr(s,t);switch(pr(e,t,r,s,i,a)){case"MELEE_ATTACK":{const c=yr(r);Mt(e,t,c,!1);break}case"RANGED_ATTACK":{const c=gr(s,t);Mt(e,t,c,!0);break}case"MOVE":{Ar(e,t);break}case"DIAGONAL_FIRE_ATTACK":wt(e,t,i);break;case"ORTHOGONAL_FIRE_ATTACK":wt(e,t,a);break}t.movement=Ne(t)}t.actions=o,t.movement=Ne(t)})},pr=(e,n,t,o,r,s)=>t.length>0?"MELEE_ATTACK":!n.rangedWeapon&&r.length===0?"MOVE":o.length>0&&n.rangedWeapon?Math.random()<.1?(h(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":o.length>0&&r.length>0?Math.random()<.1?(h(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"DIAGONAL_FIRE_ATTACK":o.length>0&&s.length>0?Math.random()<.1?(h(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"ORTHOGONAL_FIRE_ATTACK":"MOVE",gr=(e,n)=>e.filter(t=>!t.shield).sort(t=>yn(n.position,t.position)).sort((t,o)=>o.health-t.health||yn(n.position,t.position)-yn(n.position,o.position))[0],yr=e=>e.sort((n,t)=>t.health-n.health)[0],vr=(e,n)=>W(e).filter(t=>!t.ignoredByMonsters).filter(t=>nt(n.position,t.position,48,e,!1)),_r=e=>e.dungeon.layout.monsters.filter(n=>{const t=we(e.dungeon.layout.grid,n.position.x,n.position.y);return t&&$e(e.dungeon,t)&&n.health>0}),Mt=(e,n,t,o)=>{Ke(e,n,t,o),(n==null?void 0:n.actions)>1&&(n==null?void 0:n.movement)<3?n.actions-=2:n.actions--},kr=(e,n)=>W(e).map(t=>({hero:t,dist:yn(t.position,n.position)})).sort((t,o)=>t.dist-o.dist)[0],Ar=(e,n)=>{const t=kr(e,n);for(;n.movement>0;){if(t&&t.dist>1){const o=Er(e,n.position);if(o.length>0){const r=o.map(s=>({pos:s,dist:yn(s,t.hero.position)})).sort((s,i)=>s.dist-i.dist)[0].pos;n.position=r,h(e,`${n.name} moved towards ${t.hero.name} (${r.x},${r.y})`)}else h(e,`${n.name} could not move`)}n.movement--}n.actions--},Er=(e,n)=>{const t=n.x,o=n.y,r=[];for(let s=t-1;s<=t+1;s++)for(let i=o-1;i<=o+1;i++)s===t&&i===o||Bn(e.dungeon.layout,s,i)&&In(e.dungeon,s,i)&&r.push({x:s,y:i});return r.filter(s=>!W(e).find(i=>i.position.x===s.x&&i.position.y===s.y)).filter(s=>!e.dungeon.layout.monsters.some(i=>i.position.x===s.x&&i.position.y===s.y))},br=(e,n)=>e.filter(t=>[$.YELLOW_DARK_LORD,$.BLUE_DARK_LORD].includes(n.type)&&Math.abs(n.position.x-t.position.x)===Math.abs(n.position.y-t.position.y)&&et(n.position,t.position)>1),Tr=(e,n)=>e.filter(t=>[$.RED_DARK_LORD,$.BLUE_DARK_LORD].includes(n.type)&&(n.position.x===t.position.x||n.position.y===t.position.y)&&et(n.position,t.position)>1),wt=(e,n,t)=>{t.forEach(o=>{var r,s;(r=o.armour)!=null&&r.magicProtection?h(e,`${n.name} attempted a fire attack, but ${o.name}s ${(s=o.armour)==null?void 0:s.name} deflected it.`):Ke(e,n,o,!0)})},Lt=[{name:"The Hungry Troll",number:1,description:"You suddenly hear a terrible roar echo in the halls behind you. It's the sound of a hungry troll",effect:"theHungryTroll",used:!1},{name:"The Sun Stone",number:2,description:"One of you kicks a pile of rubble, revealing a small, transparent crystal. It radiates a warm, yellow light turning all nearby trolls to stone.",effect:"sunStone",used:!1},{name:"The Time Portal",number:3,description:"You notice how everything around you seem to move slower, as if time it self had slowed down.",effect:"timePortal",used:!1},{name:"The Fountain of Youth",number:4,description:"You hear the weak sound of water running from a wall. When you taste it, you feel stronger than before",effect:"fountainOfYouth",used:!1},{name:"Sleeping Gas Cloud",number:5,description:"Noxious gas seeps through a hole in the wall, making you feel heavy and sleepy.",effect:"sleepingGasCloud",used:!1},{name:"The Lost Orch",number:6,description:"You hear a snarling filled with rage somewhere behind you. You quickly realise there were more monsters here than you thought.",effect:"theLostOrch",used:!1},{name:"The Dragons Breath",number:7,description:"The flames of your torches start to flicker and soon the dungeon is completely dark.",effect:"theDragonsBreath",used:!1},{name:"Landslide",number:8,description:"The ground starts shaking, and you hear a loud crash, as if the ceiling had fallen down.",effect:"landslide",used:!1},{name:"The Magic Node",number:9,description:"You feel a strange, powerful magic course through you. You feel invigorated by it as you press on.",effect:"fountainOfYouth",used:!1},{name:"Foresight",number:10,description:"You see before you a powerful object, hidden behind thick walls.",effect:"foresight",used:!1},{name:"Earthquake",number:11,description:"The whole room starts shaking and you are thrown to the ground. Stones fall from the ceiling and walls and with terror you realise that you ar caught in an earhtquake.",effect:"earthquake",used:!1},{name:"The Magic Storm",number:12,description:"An unsettling wind blows through the dungeon. You freeze as a green glow emanates from one of your magical items",effect:"theMagicStorm",used:!1},{name:"The Elemental Weapon",number:13,description:"A flame suddenly shoots from a silver clad stone in the ceiling, moving towards one of your weapons. The weapon becomes engulfed in flames, feeling more powerful than before.",effect:"theElementalWeapon",used:!1},{name:"The Orch Drums",number:14,description:"You hear the sound of drums from deep below you. As the sound draws nearer, you realise the orchs are on the march.",effect:"theOrchDrums",used:!1},{name:"The Symbol of Weakness",number:15,description:"You walk past a strange symbol on the wall. An evil, yellow glow emanates from it. All of you suddenly feel weaker.",effect:"theSymbolOfWeakness",used:!1}],bo=e=>e.events?Xn(Lt.filter(n=>{var t;return(t=e==null?void 0:e.events)==null?void 0:t.includes(n.number)})):Xn(Lt),To=e=>{const n=e.eventDeck.filter(t=>!t.used);return n.length>0?n[0]:(Xn(e.eventDeck),To(e))},Ir={sunStone:(e,n)=>{ve(e,n);const t=W(e).length-1,o=Math.floor(Math.random()*t),r=W(e)[o],s=we(e.dungeon.layout.grid,r.position.x,r.position.y);e.dungeon.layout.monsters.filter(i=>i.type===$.TROLL).filter(i=>we(e.dungeon.layout.grid,i.position.x,i.position.y)===s).forEach(i=>{h(e,`${i.name} was killed by the Sun Stone`),i.health=0}),n.used=!0},theHungryTroll:(e,n)=>{ve(e,n),xt(e,$.TROLL),n.used=!0},timePortal:(e,n)=>{ve(e,n),e.heroes.forEach(t=>t.actions++),n.used=!0},fountainOfYouth:(e,n)=>{ve(e,n),W(e).forEach(t=>{if(t.health<t.maxHealth){const o=sn(t.level,3);t.health+=Math.min(o,t.maxHealth-t.health)}}),n.used=!0},sleepingGasCloud:(e,n)=>{ve(e,n),W(e).forEach(t=>{t.actions=Math.max(1,t.actions-1)}),n.used=!0},theLostOrch:(e,n)=>{ve(e,n),xt(e,$.ORCH),n.used=!0},theDragonsBreath:(e,n)=>{ve(e,n),W(e).forEach(t=>t.blinded=!0),n.used=!0},landslide:(e,n)=>{ve(e,n);const t=e.dungeon.layout.corridors.filter(i=>!Lr(e,i)).filter(i=>$e(e.dungeon,i)),o=t.length-1,r=Math.floor(Math.random()*o),s=t[r];e.dungeon.collapsedCorridor=s,e.dungeon.layout.grid=e.dungeon.layout.grid.map(i=>i.replaceAll(s,an)),n.used=!0},foreSight:(e,n)=>{if(ve(e,n),e.dungeon.layout.secrets.filter(o=>o.type===re.EQUIPMENT||o.type===re.MAGIC_ITEM).filter(o=>!o.found).filter(o=>o.item).filter(o=>{const r=we(e.dungeon.layout.grid,o.position.x,o.position.y)??"";return!$e(e.dungeon,r)}).length>0){const o=e.dungeon.layout.secrets.pop();o&&o.item&&(h(e,`You sense the object is close to (${o.position.x+2},${o.position.y-1})`),e.dungeon.layout.items.push({item:o.item,position:o.position}))}n.used=!0},earthquake:(e,n)=>{ve(e,n);const t=Io(e),o={name:"boulder",type:V.WEAPON,value:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,amountInDeck:0,ignoresShield:!1,ignoresArmour:!1},r={name:"Earthquake",actions:0,health:0,maxMovement:0,position:{x:0,y:0},weapon:o,level:de.APPRENTICE,maxHealth:0,movement:0,experience:0,colour:F.Red,inventory:[],defense:0};e.dungeon.layout.monsters.filter(s=>s.type===$.TROLL).filter(s=>we(e.dungeon.layout.grid,s.position.x,s.position.y)===t).forEach(s=>Ke(e,r,s,!1)),W(e).filter(s=>we(e.dungeon.layout.grid,s.position.x,s.position.y)===t).forEach(s=>Ke(e,r,s,!1)),n.used=!0},theMagicStorm:(e,n)=>{var o;ve(e,n);const t=W(e).filter(r=>r.inventory.filter(s=>!s.disabled).some(s=>s.type===V.MAGIC));if(t.length>0){const r=t.length-1,s=Math.floor(Math.random()*r),i=t[s],a=i.inventory.filter(l=>l.type===V.MAGIC);if(a.length>0){const l=a.length-1,c=Math.floor(Math.random()*l),g=a[c];g.disabled=!0,!((o=g.properties)!=null&&o[Nn])&&g.pickup&&g.drop&&po[g.drop](e,g,i)}}n.used=!0},theElementalWeapon:(e,n)=>{ve(e,n);const t=W(e),o=t.length-1,r=Math.floor(Math.random()*o),s=t[r];s.weapon.elemental=!0,n.used=!0},theOrchDrums:(e,n)=>{ve(e,n),e.dungeon.layout.monsters.filter(t=>t.type===$.ORCH).forEach(t=>t.actions=3),n.used=!0},theSymbolOfWeakness:(e,n)=>{ve(e,n),W(e).forEach(t=>t.weakened=!0),n.used=!0}},Rr=e=>{W(e).some(n=>n.weapon.elemental)&&(h(e,"The magic storm calmed down"),W(e).forEach(n=>{n.inventory.forEach(t=>{var o;!((o=t.properties)!=null&&o[Nn])&&t.pickup&&zn[t.pickup](e,t,n),t.disabled=!1})}))},Dr=e=>{e.eventDeck.filter(t=>!t.used).length===0&&(Mr(e),Cr(e),Rr(e)),wr(e),Or(e)},Cr=e=>{const n=e.dungeon.collapsedCorridor;n&&(h(e,"The collapsed corridor cleared up."),e.dungeon.layout.grid=e.dungeon.layout.grid.map(t=>t.replaceAll(an,n)),e.dungeon.collapsedCorridor=void 0)},Or=e=>{W(e).some(n=>n.blinded)&&(h(e,"You light your torches again."),W(e).forEach(n=>n.blinded=!1))},Mr=e=>{W(e).some(n=>n.weapon.elemental)&&(h(e,"The elemental magic died off."),W(e).forEach(n=>n.weapon.elemental=!1))},wr=e=>{W(e).some(n=>n.weakened)&&(h(e,"Your strength returns to you."),W(e).forEach(n=>n.weakened=!1))},Io=e=>{const n=e.dungeon.discoveredRooms.length-1,t=Math.floor(Math.random()*n);return e.dungeon.discoveredRooms[t]},xt=(e,n)=>{const t=e.dungeon.layout.monsters.filter(a=>a.type===n);if(t.length===4)return;const r=Io(e),s=[F.Red,F.Green,F.Yellow,F.Blue];t.forEach(a=>{const l=s.indexOf(a.colour);l!==-1&&s.splice(l,1)});let i=!1;for(let a=0;a<e.dungeon.layout.grid.length;a++){const l=Tn(e.dungeon.layout.grid[a]);for(let c=0;c<l.length;c++)if(l[c]===r&&!bn(e,c,a)&&!En(e,c,a)){e.dungeon.layout.monsters.push(ie(n,s[0],c,a)),i=!0;break}if(i)break}},ve=(e,n)=>{h(e,`${n.description}`),h(e,`${n.number}. ${n.name}`)},Xn=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e.forEach(o=>o.used=!1),e},Lr=(e,n)=>{const t=[];return e.dungeon.layout.grid.forEach((o,r)=>{Tn(o).forEach((s,i)=>{s===n&&t.push(bn(e,i,r)||En(e,i,r))})}),t.some(o=>o)},Nt=e=>{e.reRender=!0,h(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Ht=()=>{const e=localStorage.getItem("state");if(e){const n=JSON.parse(e);return n.currentActor=n.heroes.find(t=>{var o;return t.name===((o=n.currentActor)==null?void 0:o.name)}),h(n,"Game loaded."),n.reRender=!0,n}},xr=()=>{const e={heroes:qe.heroes,dungeon:qe.dungeons[0],currentActor:qe.heroes[0],actionLog:[`Playing '${qe.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:Pt(qe.itemDeck),magicItemDeck:Pt(qe.magicItemDeck),settings:{cellSize:48,debug:!1},eventDeck:bo(qe.dungeons[0]),reRender:!0};return Zn(e),localStorage.setItem("autosave",JSON.stringify(e)),e},Pt=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},Tn=e=>{const n=[];for(let t=0;t<e.length;t++)n.push(e[t]);return n},sn=(e,n)=>{let t=[];for(let o=0;o<n;o++)t.push(Math.floor(Math.random()*6)+1);switch(e){case de.APPRENTICE:t=t.filter(o=>o===5);break;case de.KNIGHT:case de.HERO:t=t.filter(o=>o>=4);break;case de.LORD:case de.MASTER:t=t.filter(o=>o>=3);break}return t.length},Ne=e=>{var n;return e.maxMovement-(((n=e.armour)==null?void 0:n.movementReduction)??0)},Nr=e=>e.dungeon.winConditions.filter(n=>n.type!==ge.KILL_ALL).some(n=>!n.fulfilled),Mn=e=>{if(e.settings.debug&&console.log(e),e.reRender=!0,Pr(e),e.currentActor===void 0)return e;{h(e,`${e.currentActor.name} ended their turn`);let t=W(e).indexOf(e.currentActor)+1;if(t===W(e).length&&(hr(e),t=0,vo(e)),W(e).length===0)return Hr();if(W(e)[t].incapacitated&&(h(e,`${W(e)[t].name} is no longer incapacitated.`),W(e)[t].incapacitated=!1,t++),e.currentActor.actions=2,e.currentActor.movement=Ne(e.currentActor),e.currentActor=W(e)[t],t===0&&Nr(e)){Dr(e);const o=To(e);Ir[o.effect](e,o)}h(e,`${e.currentActor.name} started their turn`)}return e},Hr=()=>{const e=localStorage.getItem("autosave");if(e){const n=JSON.parse(e);return n.reRender=!0,ro(n),Zn(n),yo(n),vo(n),Do({x:n.dungeon.startingPositions[0].x,y:n.dungeon.startingPositions[0].y},n.settings.cellSize),n.currentActor=n.heroes.find(t=>{var o;return t.name===((o=n.currentActor)==null?void 0:o.name)}),h(n,"All the heroes fell in combat. But worry not, you can try again."),n}},Pr=e=>{var n,t;e.dungeon.winConditions.forEach(o=>{var r;switch(o.type){case ge.KILL_ALL:{const s=e.dungeon.layout.monsters.map(i=>i.health).reduce((i,a)=>i+a,0);o.fulfilled=s<=0;break}case ge.REACH_CELL:{o.fulfilled=W(e).some(s=>{var i;return s.position.x===((i=o.targetCell)==null?void 0:i.x)&&s.position.y===o.targetCell.y});break}case ge.KILL_ALL_OF_TYPE:{o.fulfilled=e.dungeon.layout.monsters.filter(s=>s.type===o.targetMonsterType).some(s=>s.health>0);break}case ge.OPEN_DOOR:{o.fulfilled=((r=e.dungeon.layout.doors.find(s=>{var i,a;return s.x===((i=o.targetCell)==null?void 0:i.x)&&s.y===((a=o.targetCell)==null?void 0:a.y)}))==null?void 0:r.open)??!1;break}case ge.KILL_AT_LEAST:{o.fulfilled=(o.killMinCount?o.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(o=>o.fulfilled).reduce((o,r)=>o&&r,!0),e.dungeon.beaten&&(h(e,"All win conditions have been fulfilled"),h(e,`You have cleared ${e.dungeon.name}`),(n=e.dungeon.nextDungeon)!=null&&n.name&&h(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},Ro=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:F.Red,maxHealth:0,name:"Door",level:de.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:V.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Bn=(e,n,t)=>{var r,s;let o=!0;if(n<0||n>=e.grid[0].length||t<0||t>=e.grid.length)o=!1;else{const i=(r=e.pits)==null?void 0:r.some(c=>Te(c,{x:n,y:t})),a=(s=e.pillars)==null?void 0:s.some(c=>Te(c,{x:n,y:t})),l=we(e.grid,n,t);(i||a||l===kn||l===An)&&(o=!1)}return o},In=(e,n,t)=>{const o=we(e.layout.grid,n,t);return o?$e(e,o):!1},$e=(e,n)=>e.discoveredRooms.includes(n),we=(e,n,t)=>{let o="";return e.forEach((r,s)=>{Tn(r).forEach((i,a)=>{s===t&&a===n&&(o=i)})}),o},Rn=(e,n,t)=>e.x===n&&e.y===t||e.x===n-1&&e.y===t||e.x===n-1&&e.y===t-1||e.x===n&&e.y===t-1||e.x===n+1&&e.y===t-1||e.x===n+1&&e.y===t||e.x===n+1&&e.y===t+1||e.x===n&&e.y===t+1||e.x===n-1&&e.y===t+1,Br=(e,n,t,o)=>{var s;const r=((s=o.armour)==null?void 0:s.defense)??o.defense;return`${e} damage (${n}-(${r}+${t})=${e})`},Te=(e,n)=>e.x===n.x&&e.y===n.y,h=(e,n)=>{e.actionLog=[n,...e.actionLog],e.reRender=!0},Ke=(e,n,t,o)=>{var b,C;let r=n.weapon;o&&n.rangedWeapon&&(r=n.rangedWeapon);let s=0,i=0;r.ignoresArmour?t.armour&&h(e,`${t.name}'s armour was useless against ${r.name} `):s=((b=t.armour)==null?void 0:b.defense)??t.defense,r.ignoresShield?t.shield&&h(e,`${t.name}'s shield was useless against ${r.name} `):i=sn(t.level,((C=t.shield)==null?void 0:C.dice)??0);const a=n.inventory.filter(L=>{var _;return(_=L==null?void 0:L.properties)==null?void 0:_[Ct]}).some(L=>{var _;return h(e,`${n.name} used the effect of ${L.name} when attacking`),(_=L.properties)==null?void 0:_[Ct]}),l=n.inventory.filter(L=>{var _;return(_=L==null?void 0:L.properties)==null?void 0:_[Rt]}).map(L=>{var _;return h(e,`${n.name} used the effect of ${L.name} when attacking`),(_=L.properties)==null?void 0:_[Rt]}).reduce((L,_)=>L+_,0),c=n.blinded?1:0,g=n.weakened?1:0,y=n.weapon.elemental?1:0,p=l+y,v=c+g,I=sn(n.level,r.dice+p-v);let D=Math.max(I-(s+i),0);D===0&&a&&(h(e,`${n.name} missed but got another chance`),D=Math.max(I-(s+i),0)),t.health-=D,h(e,`${n.name} attacked ${t.name} with ${r.name} for ${Br(D,I,i,t)}`),t.health<=0&&(h(e,`${n.name} killed ${t.name}`),t.health=0,t.level=de.APPRENTICE)},Do=(e,n)=>{const t=document.getElementById("gameBoardContainer"),o=document.getElementById("gameBoard");if(t&&o){const r=e.x*n,s=e.y*n,i=o.offsetWidth,a=o.offsetHeight;t.scrollLeft=Math.round(r/i),t.scrollTop=Math.round(s/a)}},Ur=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],e.eventDeck=bo(e.dungeon),e.reRender=!0,Qo(e),Jo(e),ro(e),Zn(e),yo(e),Do({x:e.dungeon.startingPositions[0].x,y:e.dungeon.startingPositions[0].y},e.settings.cellSize),localStorage.setItem("autosave",JSON.stringify(e)))},yn=(e,n)=>Math.sqrt(Math.pow(e.x-(n==null?void 0:n.x),2)+Math.pow(e.y-(n==null?void 0:n.y),2)),nt=(e,n,t,o,r)=>{const s={x:e.x*t-Math.floor(t/2),y:e.y*t-Math.floor(t/2)},i={x:n.x*t-Math.floor(t/2),y:n.y*t-Math.floor(t/2)};return tt(s,e,i,n,t,o,r,[])},tt=(e,n,t,o,r,s,i,a)=>{var D,b;if(isNaN(e.x)||isNaN(e.y))return!1;const l=Gr(e,t),c={x:Math.round((l.x+Math.floor(r/2))/r),y:Math.round((l.y+Math.floor(r/2))/r)};if(isNaN(c.x)||isNaN(c.y)||isNaN(l.x)||isNaN(l.y))return!1;const g=we(s.dungeon.layout.grid,c.x,c.y),y=(D=s.dungeon.layout.pits)==null?void 0:D.some(C=>Te(C,c)),p=(b=s.dungeon.layout.pillars)==null?void 0:b.some(C=>Te(C,c)),v=s.dungeon.layout.monsters.some(C=>Te(C.position,c)),I=W(s).filter(C=>!Te(C.position,n)).some(C=>Te(C.position,c));return c.x===o.x&&c.y===o.y?(a.push(c),!0):p||v||!i&&I||g===An||g===an||i&&(y||g===kn)?!1:(c.x===n.x&&c.y===n.y||a.some(C=>C.x===c.x&&C.y===c.y)||a.push(c),tt(l,n,t,o,r,s,i,a))},Gr=(e,n)=>{const t=e.x,o=e.y,r=n.x-t,s=n.y-o,i=r/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2),a=s/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2),l=Math.round(i+t),c=Math.round(a+o);return{x:l,y:c}},Co=(e,n)=>W(e).filter(t=>Rn(n.position,t.position.x,t.position.y)),$r=""+new URL("../assets/Dungeon_Tileset.be5b0045.png",import.meta.url).href,Kr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAAgCAYAAADKbvy8AAAHzUlEQVRoge2af2gURxTHvydBhGKhObRwmJSq+0e9SDQhSU24BEEukBChEYwYgxRCTLg/KqEpEUJK00BCDKJ/HCZnaAm2NSk0lkoEzz9ET+PPREPUf+5qMSf5QzmFimhLYPvH5W1m92Z3Z3YvYsEHx+7OzuftzHv7Zt7OnAccUbw+1VgWTy14eHXNxI0OHivKu2HfBV5WTw4P/PFIDfLWrUXy2UvkrVsLANjVPq7KdMKpDsXrU3M35/HvAZa8G5b4/olJJO/dzbgX7ulacd6JHo8R5BmeZFf7uO2b5FQH+8Y1V/sBAKXr1wAAZj/9AoV/nUXL6WmtPqvDDcvqIKOFe7q4fbN7edzwTvXksGBFXRAj9xcBvFgqfYHvdn6Eby+90CkggxkbJKPDyLGRM/Hn37ojrg/jDAC2DkWUG9bYDvaN75+YRGd9rfGoPZPXf1He1BAO9GQMoSTNBTlYvf8EcLFLO792TjEqtmyQnQ6SeGrBowAqAFTUBTP4jy92IfnsJVbvP4HGrYrGuGV5krdtu9ktnZj1X5S3E1E9q3iFzQVpv/77y1daGXsuIrI6jIaw4o113bA86Z+Y5B5FxS0vo0eLwHhqwYNzURUAmgtqdHOXcR4DgNyz3XxDSugwihteluUNg+GeLoS6e8FeA0Couxfhni5dXV7/ZXizYVhWT0YERpqK8WXfeSSfvdSVs8lHc7VflxQ40WElbngRVvH6VNZAZMzczXm6xCHU3asZja1n7L8sb3y+Uz0ZMP0uHa5TLx2uUxWvT/3t8l2Vvcf+nOrg2N01L9P+4yd+0JWz12VlZWpZWVkGy9NDz5Xl2fps+2X0ELeKYMrScjfnofP6U7ScnkaouxfJe3fRPzGpZXHN1X5Emoq5BhTVYeYAp7wMG+ruRd627eisrzWN5ueJpOlzzfovyos8X0QPOVEbQus3faiDKYzpYc8TSTRX+zFy4YHpA0V1mEWRG16UDfd0ZRjvn5tn0Flfa8oC0I68/ovyZs93oodES2KoYWSI0vVr0JJI6h5AdczmPxkd2eZlWKPxqJxdBGDZ/h3r0ZJIgr4Bjf0X4XfevOkZuQDTxEWmHawNMj7E2TB9nkhqYfuc6QBFotmKhp0OXuOzwWebBSDcf1Hequ9O9KyyAiNNxToFitenRpqKpZzH0yHTeJaX7bhTlkS0/zJ8ttpB97gf8iS3nr4RKpPV4ZQXMUK2WCNvVSbDO5Fs6Xkv76BI7VG9TVmJfbm3wbrhnXAr4kDF6xPe+zLjUyp/2PB61tgmIyn1DYoqA9iQn48/fvoZuw804sn8PB7HbgslUYcOlkPxF2pl8QezGB6dEnaCE94px50DZecKIxsYiupWRmR5nvOKKgPCbFFlADNXYgCA3QcaAQAb8vNR0bjHNokyGhEAFH8hDh0sF0pCnPAinJk9uTvygaEo0Bq0/Gaxk7Er5xF+uKReUBfrvKLKAFLPFgAAhcWfY3b6Bj75bBPuXrttGuHEzlyJYfeBRsxO39DxIqL4CzEWmQMA3ElcxeBAG8Yic7iTmMoqb+yDHWdY3NZY0yw0MBQFRZJQw73Lq+ux1iDCD3MQ2rKI0JZFaV00/AHASOSUVj4SOQXF65N6qYy8iNxJXMWdxFXdtYzY8Yo3vetutIcVRysyedu2I9Tdq7FcQ2hRuCSx1qDt+B0YiiLWmt5QDQxFEdqyqKsTfphjqUfx+tSTO8qwd+qy5sAn8/MAoDu3mseoUxWNewBAmicdvOEMAL7+5qSjOdTIkwPZJTU7DoC2lMn+5SIjAim0yRkAhKKHjTQA2FdZo/vFWoOmemjo3Dt1Gb+WV+Fx7DaezM9jQ36+FonsuZmQMVjHifLs/DI8OoX4g1kAy8YzOs84H8nyvP1EO47+59NZX6vt2GcspfEiieYyswiiho9dOQ8g7byiUB8+2Lq8av9qbhoz4SMAzP9UZCwjnfsqa3TnIlEgwyve5f05duHYKMb9RNpcleF5S3EUfcOj/HmWuEhTMVpOT2vXgMkcyA6fADKGQ7OOAXznAcAHW4tRFOqz1dHR3oCqYAk62hvQ0d6A6d9HdedVwRLbTNKKtxJ6q9kto+97WwBAlw3SlpATHliOJF27/YU67tDB8gzu1tM32m5MPLXgiacWPBlZKA116SzSsr86iacWPPsqazTDvh7sAZCeiANDUbwe7MGMQDJw6/4jlBZs1K6PHhvH5eM7UHX4OjraGyxZcp4VXxUsAaK3M7LYjL/wLRmzpSuS1u0vBDBlup9nxw+PTmFwoA0A0MIMi4rXpw4OtGlDpsYtRSPLUR3T/4WSQopAY+SJDl9FoT5tuATSEc3OqXZJiIjIDMMiPDuM0bF/YhK5Z7u17TPW0LI8O+yxvFOOJGMINSYwJCLOI34mfARFoT5dUhMYiloOoWzjqoIluh9bxutEtnh2DhocaENnfa22kBxpKjZ1nghPwtvNF+HYTVxWuHMgOZHNImW+vciJr+bSb26sNaglMSJ6aAgsLdioOxcVJzzNKXRNzqLN053Hz3mMdWR4EqNjRDnevAlYfMiTYqtGWwk5kTJXEecpXp/a0d6AW/cfce+XFmy0TGKywQ8OtOnWH2n+EREr3movVeS5ZltKlvuBboV1vqzzKGKOHhvXHVeK19q89B1mdu2Gt9rXc/vc9/I/lf8AumRDnk2NWWYAAAAASUVORK5CYII=",Fr=(e,n,t,o,r)=>{W(o).forEach(i=>{Wr(e,i,n,t,r)}),jr(e,o,t),Xr(e,o,t)},Wr=(e,n,t,o,r)=>{const s=n.position.x,i=n.position.y;if(e.drawImage(t,4*16,0,16,16,s*o,i*o,o,o),Yr(e,n,s,i,o),qr(e,n,s,i,o),Vr(e,n,s,i,o),r){const a=`(${s},${i})`;e.fillStyle="black",e.font="8px Arial",e.fillText(a,s*o+3,i*o+10)}},Yr=(e,n,t,o,r)=>{const s=e.fillStyle,i=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let a=0;a<n.actions;a++)e.fillRect(t*r+4+6*a,o*r+r-12,5,5),e.rect(t*r+4+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle="blue";for(let a=0;a<n.movement;a++)e.fillRect(t*r+r-22+6*a,o*r+r-12,5,5),e.rect(t*r+r-22+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle=s,e.strokeStyle=i},Vr=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t*r+4,o*r,r-8,4),e.fillStyle="green",e.fillRect(t*r+4,o*r,(r-8)*(n.health/n.maxHealth),4),e.rect(t*r+4,o*r,r-8,4),e.stroke()},qr=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(t*r+4,o*r+(r-6),r-8,4),e.stroke()},jr=(e,n,t)=>{const o=n.currentActor;if(o){for(let r=o.position.x-o.movement;r<=o.position.x+o.movement;r++)for(let s=o.position.y-o.movement;s<=o.position.y+o.movement;s++)if(In(n.dungeon,r,s)&&!(r===(o==null?void 0:o.position.x)&&s===(o==null?void 0:o.position.y))){const a=En(n,r,s),l=bn(n,r,s),c=Bn(n.dungeon.layout,r,s),g=nt(o.position,{x:r,y:s},2,n,!0);!l&&!a&&c&&g&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(r*t,s*t,t,t),e.stroke())}}},Xr=(e,n,t)=>{const o=n.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t+t/3,o.position.y*t),e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t,o.position.y*t+t/3),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3,o.position.y*t+t),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t+t),e.stroke(),e.lineWidth=1)},Jr=(e,n,t,o,r)=>{o.dungeon.layout.monsters.forEach(s=>{Qr(e,n,o,s,t,r)})},Qr=(e,n,t,o,r,s)=>{const i=t.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&$e(t.dungeon,i)){switch(o.type){case $.ORCH:Zr(e,n,r,o);break;case $.TROLL:Sr(e,n,r,o);break;default:zr(e,n,r,o);break}es(e,o,r),ns(e,o,r),ts(e,o,t.heroes,t,r,s)}},Zr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},Sr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},zr=(e,n,t,o)=>{e.drawImage(n,16,16,16,16,o.position.x*t,o.position.y*t,t,t)},es=(e,n,t)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(n.position.x*t+4,n.position.y*t+(t-6),t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ns=(e,n,t)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n.position.x*t+4,n.position.y*t,t-8,4),e.fillStyle="green",e.fillRect(n.position.x*t+4,n.position.y*t,(t-8)*(n.health/n.maxHealth),4),e.rect(n.position.x*t+4,n.position.y*t,t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ts=(e,n,t,o,r,s)=>{s&&t.forEach(i=>{const a=[],l={x:n.position.x*48-24,y:n.position.y*48-24},c={x:i.position.x*48-24,y:i.position.y*48-24};if(tt(l,n.position,c,i.position,48,o,!1,a)){const y=n.position.x,p=n.position.y,v=i.position.x,I=i.position.y;e.beginPath(),e.strokeStyle=n.colour,e.lineWidth=2,e.moveTo(y*r+r/2,p*r+r/2),e.lineTo(v*r+r/2,I*r+r/2),e.stroke(),e.lineWidth=1}})},os=(e,n,t,o,r)=>{o.dungeon.layout.doors.forEach(s=>{ms(e,n,t,o,s,r)})},rs=(e,n,t,o,r)=>{o.dungeon.layout.grid.forEach((s,i)=>{Tn(s).forEach((a,l)=>{ls(e,n,o,a,l,i,t),fs(e,a,o,l,i,t,r)})}),is(e,n,t,o,r),as(e,n,t,o,r)},ss=(e,n,t,o,r)=>{o.dungeon.layout.secrets.filter(s=>s.found).forEach(s=>{switch(s.type){case re.TRAP_DOOR:us(e,n,t,s);break;default:ds(e,n,t,s);break}}),r&&o.dungeon.layout.secrets.filter(s=>!s.found).forEach(s=>{const i=`${s.type}`;e.fillStyle="rgba(255, 50, 50, 0.28)",e.fillRect(s.position.x*t,s.position.y*t,t,t),e.fillStyle="black",e.font="12px Arial",e.fillText(i,s.position.x*t,s.position.y*t+10)})},tn=(e,n,t,o,r,s,i,a)=>{a.dungeon.discoveredRooms.some(l=>Bt(s,i,l,a))||Bt(s,i,an,a)?e.drawImage(n,t*48,o,48,48,s*r,i*r,r,r):Oo(e,s,i,r)},is=(e,n,t,o,r)=>{var s,i;(i=(s=o.dungeon.layout.pits)==null?void 0:s.filter(a=>In(o.dungeon,a.x,a.y)||r))==null||i.forEach(a=>{tn(e,n,7,0,t,a.x,a.y,o)})},as=(e,n,t,o,r)=>{var s,i;(i=(s=o.dungeon.layout.pillars)==null?void 0:s.filter(a=>In(o.dungeon,a.x,a.y)||r))==null||i.forEach(a=>{tn(e,n,6,0,t,a.x,a.y,o)})},ls=(e,n,t,o,r,s,i)=>{cs(o,t)?o===an?(tn(e,n,0,0,i,r,s,t),tn(e,n,5,0,i,r,s,t)):tn(e,n,1,0,i,r,s,t):Pn(o,t)?Oo(e,r,s,i):tn(e,n,0,0,i,r,s,t)},cs=(e,n)=>hs(e)||!$e(n.dungeon,e)&&e!==kn,Oo=(e,n,t,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(n*o,t*o,o,o),e.stroke()},us=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,3*48,0,48,48,r*t,s*t,t,t)},ds=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,4*48,0,48,48,r*t,s*t,t,t)},fs=(e,n,t,o,r,s,i)=>{!i&&(Pn(n,t)||n===An)||(e.beginPath(),e.strokeStyle="black",e.rect(o*s,r*s,s,s),i&&(e.font="7px Arial",e.fillText(`${o},${r}`,o*s+3,r*s+(s-3))),e.stroke())},ms=(e,n,t,o,r,s)=>{const i=o.dungeon.layout.grid[r.y][r.x];if(r&&!r.hidden&&!r.open&&!Pn(i,o))switch(e.fillStyle="brown",r.side){case T.RIGHT:{e.fillRect(r.x*t+(t-2),r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t-4),r.y*t+(t/2-4),8,8));break}case T.LEFT:{e.fillRect(r.x*t-2,r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t-4,r.y*t+(t/2-4),8,8));break}case T.UP:{e.fillRect(r.x*t,r.y*t-2,t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t-4,8,8));break}case T.DOWN:{e.fillRect(r.x*t,r.y*t+(t-2),t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t+(t-4),8,8));break}}s&&!Pn(i,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${r.hidden?"H":"-"}/${r.trapped?`T${r.trapAttacks}`:"-"}/${r.locked?"L":"-"}]`,r.x*t,r.y*t+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(r.x*t,r.y*t,t,t))},hs=e=>e===An,Pn=(e,n)=>e===kn||!$e(n.dungeon,e),Bt=(e,n,t,o)=>{if(!o)return;const r=Math.max(e-1,0),s=Math.max(n-1,0),i=Math.min(n+1,o.dungeon.layout.grid.length-1),a=Math.min(e+1,o.dungeon.layout.grid[0].length-1);for(let l=r;l<=a;l++)for(let c=s;c<=i;c++){const g=o.dungeon.layout.grid[c];if(Tn(g)[l]===t)return!0}return!1},ps=(e,n,t,o)=>{o.dungeon.layout.items.forEach(r=>{switch(r.item.type){case V.MAGIC:Ut(e,n,t,r);break;case V.WEAPON:Ut(e,n,t,r)}})},Ut=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,0,48,48,48,r*t,s*t,t,t)};function gs(e){let n,t,o,r;return{c(){n=f("div"),t=f("canvas"),this.h()},l(s){n=m(s,"DIV",{style:!0,class:!0,id:!0});var i=A(n);t=m(i,"CANVAS",{width:!0,height:!0,id:!0}),A(t).forEach(d),i.forEach(d),this.h()},h(){M(t,"width",e[0]*40),M(t,"height",e[0]*30),M(t,"id","gameBoard"),M(n,"style",e[2]()),M(n,"class","dungeon svelte-a4uhtl"),M(n,"id","gameBoardContainer")},m(s,i){R(s,n,i),u(n,t),o||(r=te(t,"click",e[1]),o=!0)},p:pe,i:pe,o:pe,d(s){s&&d(n),o=!1,r()}}}const Gt=10;function ys(e,n,t){let{state:o}=n,{debugMode:r}=n,s,i;const a=(o==null?void 0:o.settings.cellSize)??48;let l=0,c=0;i=window.innerHeight,s=document.getElementById("footer").offsetHeight,_n(()=>{const v=new Image;v.src=$r;const I=new Image;I.src=Kr,setInterval(()=>g(v,I),10)});const g=(v,I)=>{if(!o||!document)return;const D=document.getElementById("gameBoard"),b=D.getContext("2d");o.reRender&&(c++,l++,b.clearRect(0,0,D.width,D.height),b.fillStyle="black",b.fillRect(0,0,D.width,D.height),rs(b,v,a,o,r),ss(b,v,a,o,r),ps(b,v,a,o),os(b,v,a,o,r),Jr(b,I,a,o,r),Fr(b,I,a,o,r),r&&(b.fillStyle="white",b.font="8px Arial",b.fillText(`Re-renders: ${l}`,2,10),b.fillText(`FPS: ${c/(Gt/1e3)}`,2,20)),setTimeout(()=>{t(3,o.reRender=!1,o),c=0},Gt))},y=v=>{mr(v,a,o)},p=()=>`max-height: ${i-s-20}px; max-width: ${a*40}`;return e.$$set=v=>{"state"in v&&t(3,o=v.state),"debugMode"in v&&t(4,r=v.debugMode)},[a,y,p,o,r]}class vs extends Ze{constructor(n){super(),Se(this,n,ys,gs,Ce,{state:3,debugMode:4})}}function _s(e){let n,t="Used";return{c(){n=f("button"),n.textContent=t,this.h()},l(o){n=m(o,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-fgo135"&&(n.textContent=t),this.h()},h(){n.disabled=!0,M(n,"class","svelte-gca2x5")},m(o,r){R(o,n,r)},p:pe,d(o){o&&d(n)}}}function ks(e){let n,t="Use",o,r;return{c(){n=f("button"),n.textContent=t,this.h()},l(s){n=m(s,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-3f43k6"&&(n.textContent=t),this.h()},h(){M(n,"class","svelte-gca2x5")},m(s,i){R(s,n,i),o||(r=te(n,"click",e[2]),o=!0)},p:pe,d(s){s&&d(n),o=!1,r()}}}function As(e){var Z,j;let n,t="",o,r,s,i=e[0].name+"",a,l,c,g=((Z=e[0].properties)==null?void 0:Z[On])+"",y,p,v=((j=e[0].properties)==null?void 0:j[On])+"",I,D,b;function C(E,Y){var x,k,w;if((x=E[0].properties)!=null&&x[Nn]&&!((k=E[0].properties)!=null&&k[xe]))return ks;if((w=E[0].properties)!=null&&w[Nn])return _s}let L=C(e),_=L&&L(e);return{c(){n=f("div"),n.innerHTML=t,o=H(),r=f("div"),s=f("b"),a=U(i),l=H(),c=f("span"),y=U(g),p=H(),I=U(v),D=H(),b=f("div"),_&&_.c(),this.h()},l(E){n=m(E,"DIV",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-pn8o3r"&&(n.innerHTML=t),o=P(E),r=m(E,"DIV",{class:!0});var Y=A(r);s=m(Y,"B",{class:!0});var x=A(s);a=G(x,i),x.forEach(d),l=P(Y),c=m(Y,"SPAN",{class:!0});var k=A(c);y=G(k,g),p=P(k),I=G(k,v),k.forEach(d),Y.forEach(d),D=P(E),b=m(E,"DIV",{class:!0});var w=A(b);_&&_.l(w),w.forEach(d),this.h()},h(){M(n,"class","item item-icon svelte-gca2x5"),M(s,"class","svelte-gca2x5"),M(c,"class","svelte-gca2x5"),M(r,"class","item item-description bottom-border svelte-gca2x5"),M(b,"class","item item-action svelte-gca2x5")},m(E,Y){R(E,n,Y),R(E,o,Y),R(E,r,Y),u(r,s),u(s,a),u(r,l),u(r,c),u(c,y),u(c,p),u(c,I),R(E,D,Y),R(E,b,Y),_&&_.m(b,null)},p(E,[Y]){var x,k;Y&1&&i!==(i=E[0].name+"")&&fe(a,i),Y&1&&g!==(g=((x=E[0].properties)==null?void 0:x[On])+"")&&fe(y,g),Y&1&&v!==(v=((k=E[0].properties)==null?void 0:k[On])+"")&&fe(I,v),L===(L=C(E))&&_?_.p(E,Y):(_&&_.d(1),_=L&&L(E),_&&(_.c(),_.m(b,null)))},i:pe,o:pe,d(E){E&&(d(n),d(o),d(r),d(D),d(b)),_&&_.d()}}}function Es(e,n,t){let{item:o}=n,{state:r}=n;const s=()=>sr(r,o);return e.$$set=i=>{"item"in i&&t(0,o=i.item),"state"in i&&t(1,r=i.state)},[o,r,s]}class bs extends Ze{constructor(n){super(),Se(this,n,Es,As,Ce,{item:0,state:1})}}function $t(e,n,t){const o=e.slice();return o[5]=n[t],o[6]=n,o[7]=t,o}function Kt(e){let n,t,o;function r(i){e[3](i,e[5],e[6],e[7])}let s={state:e[1]};return e[5]!==void 0&&(s.item=e[5]),n=new bs({props:s}),hn.push(()=>gn(n,"item",r)),{c(){je(n.$$.fragment)},l(i){Xe(n.$$.fragment,i)},m(i,a){Je(n,i,a),o=!0},p(i,a){e=i;const l={};a&2&&(l.state=e[1]),!t&&a&1&&(t=!0,l.item=e[5],pn(()=>t=!1)),n.$set(l)},i(i){o||(ae(n.$$.fragment,i),o=!0)},o(i){ce(n.$$.fragment,i),o=!1},d(i){Qe(n,i)}}}function Ft(e){let n,t,o=on(e[0]),r=[];for(let i=0;i<o.length;i+=1)r[i]=Kt($t(e,o,i));const s=i=>ce(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=_e()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=_e()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);R(i,n,a),t=!0},p(i,a){if(a&3){o=on(i[0]);let l;for(l=0;l<o.length;l+=1){const c=$t(i,o,l);r[l]?(r[l].p(c,a),ae(r[l],1)):(r[l]=Kt(c),r[l].c(),ae(r[l],1),r[l].m(n.parentNode,n))}for(ze(),l=o.length;l<r.length;l+=1)s(l);en()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)ae(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)ce(r[a]);t=!1},d(i){i&&d(n),Qn(r,i)}}}function Ts(e){var g;let n,t=((g=e[1].currentActor)==null?void 0:g.name)+"",o,r,s,i,a=e[2],l,c=Ft(e);return{c(){n=f("h4"),o=U(t),r=U("s  Inventory"),s=H(),i=f("div"),c.c(),this.h()},l(y){n=m(y,"H4",{class:!0});var p=A(n);o=G(p,t),r=G(p,"s  Inventory"),p.forEach(d),s=P(y),i=m(y,"DIV",{class:!0});var v=A(i);c.l(v),v.forEach(d),this.h()},h(){M(n,"class","svelte-1sdwrze"),M(i,"class","inventory svelte-1sdwrze")},m(y,p){R(y,n,p),u(n,o),u(n,r),R(y,s,p),R(y,i,p),c.m(i,null),l=!0},p(y,[p]){var v;(!l||p&2)&&t!==(t=((v=y[1].currentActor)==null?void 0:v.name)+"")&&fe(o,t),p&4&&Ce(a,a=y[2])?(ze(),ce(c,1,1,pe),en(),c=Ft(y),c.c(),ae(c,1),c.m(i,null)):c.p(y,p)},i(y){l||(ae(c),l=!0)},o(y){ce(c),l=!1},d(y){y&&(d(n),d(s),d(i)),c.d(y)}}}function Is(e,n,t){let{inventory:o}=n,{state:r}=n,s=!1;_n(()=>{i(),setInterval(i,100)});const i=()=>{t(2,s=!s)};function a(l,c,g,y){g[y]=l,t(0,o)}return e.$$set=l=>{"inventory"in l&&t(0,o=l.inventory),"state"in l&&t(1,r=l.state)},[o,r,s,a]}class Rs extends Ze{constructor(n){super(),Se(this,n,Is,Ts,Ce,{inventory:0,state:1})}}function Wt(e){let n;return{c(){n=U("*")},l(t){n=G(t,"*")},m(t,o){R(t,n,o)},d(t){t&&d(n)}}}function Ds(e){let n;return{c(){n=U("☑")},l(t){n=G(t,"☑")},m(t,o){R(t,n,o)},d(t){t&&d(n)}}}function Cs(e){let n;return{c(){n=U("⛶")},l(t){n=G(t,"⛶")},m(t,o){R(t,n,o)},d(t){t&&d(n)}}}function Yt(e){let n,t,o,r,s;function i(l){e[7](l)}let a={state:e[1]};return e[0].inventory!==void 0&&(a.inventory=e[0].inventory),t=new Rs({props:a}),hn.push(()=>gn(t,"inventory",i)),{c(){n=f("div"),je(t.$$.fragment),this.h()},l(l){n=m(l,"DIV",{class:!0,id:!0,style:!0});var c=A(n);Xe(t.$$.fragment,c),c.forEach(d),this.h()},h(){M(n,"class","hero-inventory svelte-1jgurl5"),M(n,"id",r=e[0].name+"s-inventory"),wn(n,"display",e[2])},m(l,c){R(l,n,c),Je(t,n,null),s=!0},p(l,c){const g={};c&2&&(g.state=l[1]),!o&&c&1&&(o=!0,g.inventory=l[0].inventory,pn(()=>o=!1)),t.$set(g),(!s||c&1&&r!==(r=l[0].name+"s-inventory"))&&M(n,"id",r),(!s||c&4)&&wn(n,"display",l[2])},i(l){s||(ae(t.$$.fragment,l),s=!0)},o(l){ce(t.$$.fragment,l),s=!1},d(l){l&&d(n),Qe(t)}}}function Vt(e){let n,t,o=e[0].actions+"",r,s,i,a,l=e[0].movement+"",c,g,y,p="Equipment:",v,I,D,b,C=e[0].weapon.name+"",L,_,Z=e[0].weapon.dice+"",j,E,Y,x,k,w,B,S;function le(O,K){return O[0].armour?Ms:Os}let se=le(e),J=se(e);function ue(O,K){return O[0].shield?Ls:ws}let z=ue(e),Q=z(e);return{c(){n=f("span"),t=U("Actions: "),r=U(o),s=H(),i=f("span"),a=U("Moves: "),c=U(l),g=H(),y=f("span"),y.textContent=p,v=H(),I=f("div"),D=f("span"),b=U("🗡️ "),L=U(C),_=U(" ("),j=U(Z),E=U(")"),Y=H(),x=f("span"),k=U(`🧱
        `),J.c(),w=H(),B=f("span"),S=U(`🛡️
        `),Q.c(),this.h()},l(O){n=m(O,"SPAN",{class:!0});var K=A(n);t=G(K,"Actions: "),r=G(K,o),K.forEach(d),s=P(O),i=m(O,"SPAN",{class:!0});var ee=A(i);a=G(ee,"Moves: "),c=G(ee,l),ee.forEach(d),g=P(O),y=m(O,"SPAN",{class:!0,"data-svelte-h":!0}),oe(y)!=="svelte-1ue18fw"&&(y.textContent=p),v=P(O),I=m(O,"DIV",{class:!0});var ne=A(I);D=m(ne,"SPAN",{class:!0});var N=A(D);b=G(N,"🗡️ "),L=G(N,C),_=G(N," ("),j=G(N,Z),E=G(N,")"),N.forEach(d),Y=P(ne),x=m(ne,"SPAN",{class:!0});var X=A(x);k=G(X,`🧱
        `),J.l(X),X.forEach(d),w=P(ne),B=m(ne,"SPAN",{class:!0});var Ie=A(B);S=G(Ie,`🛡️
        `),Q.l(Ie),Ie.forEach(d),ne.forEach(d),this.h()},h(){M(n,"class","svelte-1jgurl5"),M(i,"class","svelte-1jgurl5"),M(y,"class","svelte-1jgurl5"),M(D,"class","svelte-1jgurl5"),M(x,"class","svelte-1jgurl5"),M(B,"class","svelte-1jgurl5"),M(I,"class","equipment svelte-1jgurl5")},m(O,K){R(O,n,K),u(n,t),u(n,r),R(O,s,K),R(O,i,K),u(i,a),u(i,c),R(O,g,K),R(O,y,K),R(O,v,K),R(O,I,K),u(I,D),u(D,b),u(D,L),u(D,_),u(D,j),u(D,E),u(I,Y),u(I,x),u(x,k),J.m(x,null),u(I,w),u(I,B),u(B,S),Q.m(B,null)},p(O,K){K&1&&o!==(o=O[0].actions+"")&&fe(r,o),K&1&&l!==(l=O[0].movement+"")&&fe(c,l),K&1&&C!==(C=O[0].weapon.name+"")&&fe(L,C),K&1&&Z!==(Z=O[0].weapon.dice+"")&&fe(j,Z),se===(se=le(O))&&J?J.p(O,K):(J.d(1),J=se(O),J&&(J.c(),J.m(x,null))),z===(z=ue(O))&&Q?Q.p(O,K):(Q.d(1),Q=z(O),Q&&(Q.c(),Q.m(B,null)))},d(O){O&&(d(n),d(s),d(i),d(g),d(y),d(v),d(I)),J.d(),Q.d()}}}function Os(e){let n;return{c(){n=U("None (0)")},l(t){n=G(t,"None (0)")},m(t,o){R(t,n,o)},p:pe,d(t){t&&d(n)}}}function Ms(e){let n=e[0].armour.name+"",t,o,r=e[0].armour.defense+"",s,i;return{c(){t=U(n),o=U(" ("),s=U(r),i=U(")")},l(a){t=G(a,n),o=G(a," ("),s=G(a,r),i=G(a,")")},m(a,l){R(a,t,l),R(a,o,l),R(a,s,l),R(a,i,l)},p(a,l){l&1&&n!==(n=a[0].armour.name+"")&&fe(t,n),l&1&&r!==(r=a[0].armour.defense+"")&&fe(s,r)},d(a){a&&(d(t),d(o),d(s),d(i))}}}function ws(e){let n;return{c(){n=U("None (0)")},l(t){n=G(t,"None (0)")},m(t,o){R(t,n,o)},p:pe,d(t){t&&d(n)}}}function Ls(e){let n=e[0].shield.name+"",t,o,r=e[0].shield.dice+"",s,i;return{c(){t=U(n),o=U(" ("),s=U(r),i=U(")")},l(a){t=G(a,n),o=G(a," ("),s=G(a,r),i=G(a,")")},m(a,l){R(a,t,l),R(a,o,l),R(a,s,l),R(a,i,l)},p(a,l){l&1&&n!==(n=a[0].shield.name+"")&&fe(t,n),l&1&&r!==(r=a[0].shield.dice+"")&&fe(s,r)},d(a){a&&(d(t),d(o),d(s),d(i))}}}function qt(e){let n,t,o,r=e[0].name+"",s,i,a,l,c=e[0].level+"",g,y,p=e[0].experience+"",v,I,D,b,C,L,_,Z="🎒",j,E,Y,x,k,w,B=e[0].health+"",S,le,se,J,ue,z=e[1].targetActor===e[0]&&Wt();function Q(N,X){return N[1].targetActor!==N[0]?Cs:Ds}let O=Q(e),K=O(e),ee=e[1].currentActor==e[0]&&Yt(e),ne=e[1].currentActor==e[0]&&Vt(e);return{c(){n=f("div"),t=f("div"),o=f("b"),z&&z.c(),s=U(r),i=U(" -"),a=H(),l=f("b"),g=U(c),y=U(" ("),v=U(p),I=U(")"),D=H(),b=f("div"),C=f("button"),K.c(),L=H(),_=f("button"),_.textContent=Z,j=H(),E=f("div"),ee&&ee.c(),Y=H(),x=f("div"),k=f("span"),w=U("HP: "),S=U(B),le=H(),ne&&ne.c(),this.h()},l(N){n=m(N,"DIV",{class:!0,style:!0});var X=A(n);t=m(X,"DIV",{class:!0});var Ie=A(t);o=m(Ie,"B",{class:!0});var He=A(o);z&&z.l(He),s=G(He,r),i=G(He," -"),He.forEach(d),a=P(Ie),l=m(Ie,"B",{class:!0});var Re=A(l);g=G(Re,c),y=G(Re," ("),v=G(Re,p),I=G(Re,")"),Re.forEach(d),Ie.forEach(d),D=P(X),b=m(X,"DIV",{class:!0});var Ae=A(b);C=m(Ae,"BUTTON",{title:!0});var ln=A(C);K.l(ln),ln.forEach(d),L=P(Ae),_=m(Ae,"BUTTON",{title:!0,"data-svelte-h":!0}),oe(_)!=="svelte-qrm7uk"&&(_.textContent=Z),Ae.forEach(d),j=P(X),E=m(X,"DIV",{class:!0});var nn=A(E);ee&&ee.l(nn),nn.forEach(d),Y=P(X),x=m(X,"DIV",{class:!0});var Oe=A(x);k=m(Oe,"SPAN",{class:!0});var De=A(k);w=G(De,"HP: "),S=G(De,B),De.forEach(d),le=P(Oe),ne&&ne.l(Oe),Oe.forEach(d),X.forEach(d),this.h()},h(){M(o,"class","svelte-1jgurl5"),M(l,"class","svelte-1jgurl5"),M(t,"class","hero-title svelte-1jgurl5"),M(C,"title","select target hero"),M(_,"title","Open inventory"),M(b,"class","hero-action-buttons svelte-1jgurl5"),M(E,"class","hero-information svelte-1jgurl5"),M(k,"class","svelte-1jgurl5"),M(x,"class","hero-stats-and-equipmnet svelte-1jgurl5"),M(n,"class","hero-card svelte-1jgurl5"),wn(n,"background-color",e[0].colour)},m(N,X){R(N,n,X),u(n,t),u(t,o),z&&z.m(o,null),u(o,s),u(o,i),u(t,a),u(t,l),u(l,g),u(l,y),u(l,v),u(l,I),u(n,D),u(n,b),u(b,C),K.m(C,null),u(b,L),u(b,_),u(n,j),u(n,E),ee&&ee.m(E,null),u(n,Y),u(n,x),u(x,k),u(k,w),u(k,S),u(x,le),ne&&ne.m(x,null),se=!0,J||(ue=[te(C,"click",e[5]),te(_,"click",e[6])],J=!0)},p(N,X){N[1].targetActor===N[0]?z||(z=Wt(),z.c(),z.m(o,s)):z&&(z.d(1),z=null),(!se||X&1)&&r!==(r=N[0].name+"")&&fe(s,r),(!se||X&1)&&c!==(c=N[0].level+"")&&fe(g,c),(!se||X&1)&&p!==(p=N[0].experience+"")&&fe(v,p),O!==(O=Q(N))&&(K.d(1),K=O(N),K&&(K.c(),K.m(C,null))),N[1].currentActor==N[0]?ee?(ee.p(N,X),X&3&&ae(ee,1)):(ee=Yt(N),ee.c(),ae(ee,1),ee.m(E,null)):ee&&(ze(),ce(ee,1,1,()=>{ee=null}),en()),(!se||X&1)&&B!==(B=N[0].health+"")&&fe(S,B),N[1].currentActor==N[0]?ne?ne.p(N,X):(ne=Vt(N),ne.c(),ne.m(x,null)):ne&&(ne.d(1),ne=null),(!se||X&1)&&wn(n,"background-color",N[0].colour)},i(N){se||(ae(ee),se=!0)},o(N){ce(ee),se=!1},d(N){N&&d(n),z&&z.d(),K.d(),ee&&ee.d(),ne&&ne.d(),J=!1,Jn(ue)}}}function xs(e){let n=e[1].targetActor,t,o,r=qt(e);return{c(){r.c(),t=_e()},l(s){r.l(s),t=_e()},m(s,i){r.m(s,i),R(s,t,i),o=!0},p(s,[i]){i&2&&Ce(n,n=s[1].targetActor)?(ze(),ce(r,1,1,pe),en(),r=qt(s),r.c(),ae(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(ae(r),o=!0)},o(s){ce(r),o=!1},d(s){s&&d(t),r.d(s)}}}function Ns(e,n,t){let{hero:o}=n,{state:r}=n,s="none";const i=p=>{r.targetActor&&p===r.targetActor?t(1,r.targetActor=void 0,r):t(1,r.targetActor=p,r)},a=p=>{const v=document.getElementById(p.name+"s-inventory");console.log(p.isInventoryOpen),v!=null&&(p.isInventoryOpen=!p.isInventoryOpen,l(),v.style.display=s)},l=()=>{o.isInventoryOpen?t(2,s="inline-block"):t(2,s="none")};l();const c=()=>i(o),g=()=>a(o);function y(p){e.$$.not_equal(o.inventory,p)&&(o.inventory=p,t(0,o))}return e.$$set=p=>{"hero"in p&&t(0,o=p.hero),"state"in p&&t(1,r=p.state)},[o,r,s,i,a,c,g,y]}class Mo extends Ze{constructor(n){super(),Se(this,n,Ns,xs,Ce,{hero:0,state:1})}}function jt(e,n,t){const o=e.slice();return o[3]=n[t],o[5]=t,o}function Hs(e){let n,t,o,r;return t=new Mo({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),je(t.$$.fragment),o=H(),this.h()},l(s){n=m(s,"DIV",{class:!0});var i=A(n);Xe(t.$$.fragment,i),o=P(i),i.forEach(d),this.h()},h(){M(n,"class","not-current-actor svelte-gyascg")},m(s,i){R(s,n,i),Je(t,n,null),u(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(ae(t.$$.fragment,s),r=!0)},o(s){ce(t.$$.fragment,s),r=!1},d(s){s&&d(n),Qe(t)}}}function Ps(e){let n,t,o,r;return t=new Mo({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),je(t.$$.fragment),o=H(),this.h()},l(s){n=m(s,"DIV",{class:!0});var i=A(n);Xe(t.$$.fragment,i),o=P(i),i.forEach(d),this.h()},h(){M(n,"class","is-current-actor svelte-gyascg")},m(s,i){R(s,n,i),Je(t,n,null),u(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(ae(t.$$.fragment,s),r=!0)},o(s){ce(t.$$.fragment,s),r=!1},d(s){s&&d(n),Qe(t)}}}function Xt(e){let n,t,o,r;const s=[Ps,Hs],i=[];function a(l,c){return l[3]===l[0].currentActor?0:1}return n=a(e),t=i[n]=s[n](e),{c(){t.c(),o=_e()},l(l){t.l(l),o=_e()},m(l,c){i[n].m(l,c),R(l,o,c),r=!0},p(l,c){let g=n;n=a(l),n===g?i[n].p(l,c):(ze(),ce(i[g],1,1,()=>{i[g]=null}),en(),t=i[n],t?t.p(l,c):(t=i[n]=s[n](l),t.c()),ae(t,1),t.m(o.parentNode,o))},i(l){r||(ae(t),r=!0)},o(l){ce(t),r=!1},d(l){l&&d(o),i[n].d(l)}}}function Jt(e){let n=e[1],t,o,r=Xt(e);return{c(){r.c(),t=_e()},l(s){r.l(s),t=_e()},m(s,i){r.m(s,i),R(s,t,i),o=!0},p(s,i){i&2&&Ce(n,n=s[1])?(ze(),ce(r,1,1,pe),en(),r=Xt(s),r.c(),ae(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(ae(r),o=!0)},o(s){ce(r),o=!1},d(s){s&&d(t),r.d(s)}}}function Bs(e){let n,t,o=on(W(e[0])),r=[];for(let i=0;i<o.length;i+=1)r[i]=Jt(jt(e,o,i));const s=i=>ce(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=_e()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=_e()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);R(i,n,a),t=!0},p(i,[a]){if(a&3){o=on(W(i[0]));let l;for(l=0;l<o.length;l+=1){const c=jt(i,o,l);r[l]?(r[l].p(c,a),ae(r[l],1)):(r[l]=Jt(c),r[l].c(),ae(r[l],1),r[l].m(n.parentNode,n))}for(ze(),l=o.length;l<r.length;l+=1)s(l);en()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)ae(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)ce(r[a]);t=!1},d(i){i&&d(n),Qn(r,i)}}}function Us(e,n,t){let{state:o}=n,r=!1;_n(()=>{s(),setInterval(s,100)});const s=()=>{o.reRender&&t(1,r=!r)};return e.$$set=i=>{"state"in i&&t(0,o=i.state)},[o,r]}class Gs extends Ze{constructor(n){super(),Se(this,n,Us,Bs,Ce,{state:0})}}function Qt(e,n,t){const o=e.slice();return o[3]=n[t],o[5]=t,o}function $s(e){let n,t,o=e[3]+"",r;return{c(){n=f("p"),t=U(">"),r=U(o),this.h()},l(s){n=m(s,"P",{class:!0});var i=A(n);t=G(i,">"),r=G(i,o),i.forEach(d),this.h()},h(){M(n,"class","svelte-axhg6g")},m(s,i){R(s,n,i),u(n,t),u(n,r)},p(s,i){i&1&&o!==(o=s[3]+"")&&fe(r,o)},d(s){s&&d(n)}}}function Zt(e){let n,t=e[5]<25&&$s(e);return{c(){t&&t.c(),n=_e()},l(o){t&&t.l(o),n=_e()},m(o,r){t&&t.m(o,r),R(o,n,r)},p(o,r){o[5]<25&&t.p(o,r)},d(o){o&&d(n),t&&t.d(o)}}}function St(e){let n,t=on(e[0].actionLog),o=[];for(let r=0;r<t.length;r+=1)o[r]=Zt(Qt(e,t,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();n=_e()},l(r){for(let s=0;s<o.length;s+=1)o[s].l(r);n=_e()},m(r,s){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(r,s);R(r,n,s)},p(r,s){if(s&1){t=on(r[0].actionLog);let i;for(i=0;i<t.length;i+=1){const a=Qt(r,t,i);o[i]?o[i].p(a,s):(o[i]=Zt(a),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=t.length}},d(r){r&&d(n),Qn(o,r)}}}function Ks(e){let n,t=e[1],o=St(e);return{c(){n=f("div"),o.c(),this.h()},l(r){n=m(r,"DIV",{class:!0});var s=A(n);o.l(s),s.forEach(d),this.h()},h(){M(n,"class","log svelte-axhg6g")},m(r,s){R(r,n,s),o.m(n,null)},p(r,[s]){s&2&&Ce(t,t=r[1])?(o.d(1),o=St(r),o.c(),o.m(n,null)):o.p(r,s)},i:pe,o:pe,d(r){r&&d(n),o.d(r)}}}function Fs(e,n,t){let{state:o}=n,r=!1;_n(()=>{s(),setInterval(s,500)});const s=()=>{o.reRender&&t(1,r=!r)};return e.$$set=i=>{"state"in i&&t(0,o=i.state)},[o,r]}class Ws extends Ze{constructor(n){super(),Se(this,n,Fs,Ks,Ce,{state:0})}}const Ys={name:"Testing Grounds",beaten:!1,winConditions:[{type:ge.KILL_ALL,fulfilled:!1}],nextDungeon:Eo,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A","D"],layout:{grid:["###########","#CCCCCCCCC#","#CCCCCCCCC#","#CCCCCCCCC#","#######E###","  #####E#  ","  #FFFFE## ","###F###AA# ","#AAAAAAAA#D","#AAAAAAAA#D","#AAAAAAAA#D","##G####### "," #G#       "," #G#       "," ###       "],pillars:[{x:8,y:3},{x:7,y:9}],pits:[{x:6,y:3},{x:6,y:2}],corridors:["G","E","F"],doors:[Ho(T.UP,3,8,1),xn(T.LEFT,7,6),No(T.UP,7,7,1),q(T.UP,7,4),Ge(T.DOWN,2,10)],monsters:[ie($.ORCH,F.Green,1,1),ie($.ORCH,F.Red,4,9),ie($.TROLL,F.Green,5,1)],secrets:[ke(re.TRAP_DOOR,"Welcome to Drakriddarna",3,9),ke(re.EQUIPMENT,"Random Equipment",1,10),vn(re.EQUIPMENT,5,10,Ln[2])],notes:[],items:[{item:be[0],position:{x:3,y:10}},{item:be[1],position:{x:4,y:10}},{item:be[6],position:{x:5,y:10}},{item:be[2],position:{x:6,y:10}},{item:be[3],position:{x:7,y:10}},{item:be[4],position:{x:8,y:10}}]},killCount:0};const{window:Vs}=Lo;function qs(e){let n,t,o,r,s="UL",i,a,l,c="U",g,y,p,v="UR",I,D,b,C="Next",L,_,Z,j,E="L",Y,x,k,w,B,S="R",le,se,J,ue="Search",z,Q,O,K,ee="DL",ne,N,X,Ie="D",He,Re,Ae,ln="DR",nn,Oe,De,ot="Pick lock",Un,ye,cn,Fe,rt="Save",Gn,un,We,st="Load",$n,dn,Ye,it="Debug",Kn,fn,Ve,at="End action",Fn,Wn,lt,me=e[1]&&zt(e);return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=H(),a=f("td"),l=f("button"),l.textContent=c,g=H(),y=f("td"),p=f("button"),p.textContent=v,I=H(),D=f("td"),b=f("button"),b.textContent=C,L=H(),_=f("tr"),Z=f("td"),j=f("button"),j.textContent=E,Y=H(),x=f("td"),k=H(),w=f("td"),B=f("button"),B.textContent=S,le=H(),se=f("td"),J=f("button"),J.textContent=ue,z=H(),Q=f("tr"),O=f("td"),K=f("button"),K.textContent=ee,ne=H(),N=f("td"),X=f("button"),X.textContent=Ie,He=H(),Re=f("td"),Ae=f("button"),Ae.textContent=ln,nn=H(),Oe=f("td"),De=f("button"),De.textContent=ot,Un=H(),ye=f("tr"),cn=f("td"),Fe=f("button"),Fe.textContent=rt,Gn=H(),un=f("td"),We=f("button"),We.textContent=st,$n=H(),dn=f("td"),Ye=f("button"),Ye.textContent=it,Kn=H(),fn=f("td"),Ve=f("button"),Ve.textContent=at,Fn=H(),me&&me.c()},l(Le){n=m(Le,"TABLE",{});var Ee=A(n);t=m(Ee,"TR",{});var Pe=A(t);o=m(Pe,"TD",{});var ct=A(o);r=m(ct,"BUTTON",{"data-svelte-h":!0}),oe(r)!=="svelte-1vu0fc2"&&(r.textContent=s),ct.forEach(d),i=P(Pe),a=m(Pe,"TD",{});var ut=A(a);l=m(ut,"BUTTON",{"data-svelte-h":!0}),oe(l)!=="svelte-m1j18o"&&(l.textContent=c),ut.forEach(d),g=P(Pe),y=m(Pe,"TD",{});var dt=A(y);p=m(dt,"BUTTON",{"data-svelte-h":!0}),oe(p)!=="svelte-8eygoe"&&(p.textContent=v),dt.forEach(d),I=P(Pe),D=m(Pe,"TD",{});var ft=A(D);b=m(ft,"BUTTON",{"data-svelte-h":!0}),oe(b)!=="svelte-1lp5xnk"&&(b.textContent=C),ft.forEach(d),Pe.forEach(d),L=P(Ee),_=m(Ee,"TR",{});var Be=A(_);Z=m(Be,"TD",{});var mt=A(Z);j=m(mt,"BUTTON",{"data-svelte-h":!0}),oe(j)!=="svelte-amyars"&&(j.textContent=E),mt.forEach(d),Y=P(Be),x=m(Be,"TD",{}),A(x).forEach(d),k=P(Be),w=m(Be,"TD",{});var ht=A(w);B=m(ht,"BUTTON",{"data-svelte-h":!0}),oe(B)!=="svelte-2zfta0"&&(B.textContent=S),ht.forEach(d),le=P(Be),se=m(Be,"TD",{});var pt=A(se);J=m(pt,"BUTTON",{"data-svelte-h":!0}),oe(J)!=="svelte-1kis6k4"&&(J.textContent=ue),pt.forEach(d),Be.forEach(d),z=P(Ee),Q=m(Ee,"TR",{});var Ue=A(Q);O=m(Ue,"TD",{});var gt=A(O);K=m(gt,"BUTTON",{"data-svelte-h":!0}),oe(K)!=="svelte-57p0uk"&&(K.textContent=ee),gt.forEach(d),ne=P(Ue),N=m(Ue,"TD",{});var yt=A(N);X=m(yt,"BUTTON",{"data-svelte-h":!0}),oe(X)!=="svelte-1nly394"&&(X.textContent=Ie),yt.forEach(d),He=P(Ue),Re=m(Ue,"TD",{});var vt=A(Re);Ae=m(vt,"BUTTON",{"data-svelte-h":!0}),oe(Ae)!=="svelte-7ds02w"&&(Ae.textContent=ln),vt.forEach(d),nn=P(Ue),Oe=m(Ue,"TD",{});var _t=A(Oe);De=m(_t,"BUTTON",{"data-svelte-h":!0}),oe(De)!=="svelte-90j6ve"&&(De.textContent=ot),_t.forEach(d),Ue.forEach(d),Un=P(Ee),ye=m(Ee,"TR",{});var Me=A(ye);cn=m(Me,"TD",{});var kt=A(cn);Fe=m(kt,"BUTTON",{"data-svelte-h":!0}),oe(Fe)!=="svelte-fxtyz6"&&(Fe.textContent=rt),kt.forEach(d),Gn=P(Me),un=m(Me,"TD",{});var At=A(un);We=m(At,"BUTTON",{"data-svelte-h":!0}),oe(We)!=="svelte-1m2jkw7"&&(We.textContent=st),At.forEach(d),$n=P(Me),dn=m(Me,"TD",{});var Et=A(dn);Ye=m(Et,"BUTTON",{"data-svelte-h":!0}),oe(Ye)!=="svelte-5alhx0"&&(Ye.textContent=it),Et.forEach(d),Kn=P(Me),fn=m(Me,"TD",{});var bt=A(fn);Ve=m(bt,"BUTTON",{"data-svelte-h":!0}),oe(Ve)!=="svelte-1de77je"&&(Ve.textContent=at),bt.forEach(d),Fn=P(Me),me&&me.l(Me),Me.forEach(d),Ee.forEach(d)},m(Le,Ee){R(Le,n,Ee),u(n,t),u(t,o),u(o,r),u(t,i),u(t,a),u(a,l),u(t,g),u(t,y),u(y,p),u(t,I),u(t,D),u(D,b),u(n,L),u(n,_),u(_,Z),u(Z,j),u(_,Y),u(_,x),u(_,k),u(_,w),u(w,B),u(_,le),u(_,se),u(se,J),u(n,z),u(n,Q),u(Q,O),u(O,K),u(Q,ne),u(Q,N),u(N,X),u(Q,He),u(Q,Re),u(Re,Ae),u(Q,nn),u(Q,Oe),u(Oe,De),u(n,Un),u(n,ye),u(ye,cn),u(cn,Fe),u(ye,Gn),u(ye,un),u(un,We),u(ye,$n),u(ye,dn),u(dn,Ye),u(ye,Kn),u(ye,fn),u(fn,Ve),u(ye,Fn),me&&me.m(ye,null),Wn||(lt=[te(r,"click",e[12]),te(l,"click",e[13]),te(p,"click",e[14]),te(b,"click",e[15]),te(j,"click",e[16]),te(B,"click",e[17]),te(J,"click",e[18]),te(K,"click",e[19]),te(X,"click",e[20]),te(Ae,"click",e[21]),te(De,"click",e[22]),te(Fe,"click",e[23]),te(We,"click",e[24]),te(Ye,"click",e[25]),te(Ve,"click",e[26])],Wn=!0)},p(Le,Ee){Le[1]?me?me.p(Le,Ee):(me=zt(Le),me.c(),me.m(ye,null)):me&&(me.d(1),me=null)},d(Le){Le&&d(n),me&&me.d(),Wn=!1,Jn(lt)}}}function js(e){let n,t,o,r,s="Next",i,a,l,c="End action",g,y,p,v,I="Save",D,b,C,L="Load",_,Z,j,E,Y="Debug",x,k;return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=H(),a=f("td"),l=f("button"),l.textContent=c,g=H(),y=f("tr"),p=f("td"),v=f("button"),v.textContent=I,D=H(),b=f("td"),C=f("button"),C.textContent=L,_=H(),Z=f("tr"),j=f("td"),E=f("button"),E.textContent=Y},l(w){n=m(w,"TABLE",{});var B=A(n);t=m(B,"TR",{});var S=A(t);o=m(S,"TD",{});var le=A(o);r=m(le,"BUTTON",{"data-svelte-h":!0}),oe(r)!=="svelte-1axp1ke"&&(r.textContent=s),le.forEach(d),i=P(S),a=m(S,"TD",{});var se=A(a);l=m(se,"BUTTON",{"data-svelte-h":!0}),oe(l)!=="svelte-1de77je"&&(l.textContent=c),se.forEach(d),S.forEach(d),g=P(B),y=m(B,"TR",{});var J=A(y);p=m(J,"TD",{});var ue=A(p);v=m(ue,"BUTTON",{"data-svelte-h":!0}),oe(v)!=="svelte-fxtyz6"&&(v.textContent=I),ue.forEach(d),D=P(J),b=m(J,"TD",{});var z=A(b);C=m(z,"BUTTON",{"data-svelte-h":!0}),oe(C)!=="svelte-1m2jkw7"&&(C.textContent=L),z.forEach(d),J.forEach(d),_=P(B),Z=m(B,"TR",{});var Q=A(Z);j=m(Q,"TD",{});var O=A(j);E=m(O,"BUTTON",{"data-svelte-h":!0}),oe(E)!=="svelte-5alhx0"&&(E.textContent=Y),O.forEach(d),Q.forEach(d),B.forEach(d)},m(w,B){R(w,n,B),u(n,t),u(t,o),u(o,r),u(t,i),u(t,a),u(a,l),u(n,g),u(n,y),u(y,p),u(p,v),u(y,D),u(y,b),u(b,C),u(n,_),u(n,Z),u(Z,j),u(j,E),x||(k=[te(r,"click",e[7]),te(l,"click",e[8]),te(v,"click",e[9]),te(C,"click",e[10]),te(E,"click",e[11])],x=!0)},p:pe,d(w){w&&d(n),x=!1,Jn(k)}}}function zt(e){let n,t,o="To Testing Grounds",r,s;return{c(){n=f("td"),t=f("button"),t.textContent=o},l(i){n=m(i,"TD",{});var a=A(n);t=m(a,"BUTTON",{"data-svelte-h":!0}),oe(t)!=="svelte-1rubhw6"&&(t.textContent=o),a.forEach(d)},m(i,a){R(i,n,a),u(n,t),r||(s=te(t,"click",e[27]),r=!0)},p:pe,d(i){i&&d(n),r=!1,s()}}}function Xs(e){let n,t,o,r,s,i,a,l,c,g,y,p,v,I,D,b;o=new Gs({props:{state:e[0]}});function C(k){e[5](k)}function L(k){e[6](k)}let _={};e[0]!==void 0&&(_.state=e[0]),e[1]!==void 0&&(_.debugMode=e[1]),s=new vs({props:_}),hn.push(()=>gn(s,"state",C)),hn.push(()=>gn(s,"debugMode",L));function Z(k,w){return k[2]<600?js:qs}let j=Z(e),E=j(e);function Y(k){e[28](k)}let x={};return e[0]!==void 0&&(x.state=e[0]),p=new Ws({props:x}),hn.push(()=>gn(p,"state",Y)),{c(){n=f("div"),t=f("div"),je(o.$$.fragment),r=H(),je(s.$$.fragment),l=H(),c=f("div"),g=f("div"),E.c(),y=H(),je(p.$$.fragment),this.h()},l(k){n=m(k,"DIV",{class:!0});var w=A(n);t=m(w,"DIV",{class:!0});var B=A(t);Xe(o.$$.fragment,B),B.forEach(d),r=P(w),Xe(s.$$.fragment,w),w.forEach(d),l=P(k),c=m(k,"DIV",{class:!0,id:!0});var S=A(c);g=m(S,"DIV",{class:!0});var le=A(g);E.l(le),le.forEach(d),y=P(S),Xe(p.$$.fragment,S),S.forEach(d),this.h()},h(){M(t,"class","characterSide svelte-8a7at9"),M(n,"class","container svelte-8a7at9"),M(g,"class","commands svelte-8a7at9"),M(c,"class","container svelte-8a7at9"),M(c,"id","footer")},m(k,w){R(k,n,w),u(n,t),Je(o,t,null),u(n,r),Je(s,n,null),R(k,l,w),R(k,c,w),u(c,g),E.m(g,null),u(c,y),Je(p,c,null),I=!0,D||(b=te(Vs,"keydown",wo(e[4])),D=!0)},p(k,[w]){const B={};w&1&&(B.state=k[0]),o.$set(B);const S={};!i&&w&1&&(i=!0,S.state=k[0],pn(()=>i=!1)),!a&&w&2&&(a=!0,S.debugMode=k[1],pn(()=>a=!1)),s.$set(S),j===(j=Z(k))&&E?E.p(k,w):(E.d(1),E=j(k),E&&(E.c(),E.m(g,null)));const le={};!v&&w&1&&(v=!0,le.state=k[0],pn(()=>v=!1)),p.$set(le)},i(k){I||(ae(o.$$.fragment,k),ae(s.$$.fragment,k),ae(p.$$.fragment,k),I=!0)},o(k){ce(o.$$.fragment,k),ce(s.$$.fragment,k),ce(p.$$.fragment,k),I=!1},d(k){k&&(d(n),d(l),d(c)),Qe(o),Qe(s),E.d(),Qe(p),D=!1,b()}}}function Js(e,n,t){let o=xr(),r=o.settings.debug,s;_n(()=>{setInterval(()=>Ur(o),1e3)}),s=window.innerWidth;const i=()=>{t(1,r=!r),t(0,o.settings.debug=r,o),t(0,o.reRender=!0,o)};function a(ue){switch(ue.key){case"6":case"d":he("R",o);break;case"9":case"e":he("UR",o);break;case"8":case"w":he("U",o);break;case"7":case"q":he("UL",o);break;case"4":case"a":he("L",o);break;case"1":case"z":he("DL",o);break;case"2":case"x":he("D",o);break;case"3":case"c":he("DR",o);break;case"0":case" ":t(0,o=Mn(o));break;case"-":case"r":qn(o);break;case"+":case"f":jn(o);break}}function l(ue){o=ue,t(0,o)}function c(ue){r=ue,t(1,r)}const g=()=>Mn(o),y=()=>It(o),p=()=>Nt(o),v=()=>t(0,o=Ht()),I=()=>i(),D=()=>he("UL",o),b=()=>he("U",o),C=()=>he("UR",o),L=()=>t(0,o=Mn(o)),_=()=>he("L",o),Z=()=>he("R",o),j=()=>jn(o),E=()=>he("DL",o),Y=()=>he("D",o),x=()=>he("DR",o),k=()=>qn(o),w=()=>Nt(o),B=()=>t(0,o=Ht()),S=()=>i(),le=()=>It(o),se=()=>{t(0,o.dungeon=Ys,o),t(0,o.reRender=!0,o)};function J(ue){o=ue,t(0,o)}return[o,r,s,i,a,l,c,g,y,p,v,I,D,b,C,L,_,Z,j,E,Y,x,k,w,B,S,le,se,J]}class Ss extends Ze{constructor(n){super(),Se(this,n,Js,Xs,Ce,{})}}export{Ss as component};
