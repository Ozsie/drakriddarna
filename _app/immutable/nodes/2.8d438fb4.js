import{s as Pe,n as re,o as Ve,b as Xt,f as Vt,r as In,i as F}from"../chunks/scheduler.ba2ce6c0.js";import{S as ze,i as Ze,g as m,h as p,j as y,f as Q,k as M,a as te,x as u,y as S,e as Fe,z as hn,m as zt,n as Zt,o as En,A as $t,r as dt,s as w,u as ft,c as P,B as Y,v as ut,C as vn,d as gt,t as mt,w as pt}from"../chunks/index.92acf144.js";function jt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var L=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(L||{}),G=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(G||{}),H=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(H||{}),j=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(j||{}),ee=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.DOOR="Door",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(ee||{}),B=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(B||{});const Jt=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1}],en=[{name:"Orch Sword/Bow",range:99,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4}],tn=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4}],Qn="0",Cn="@",xe=" ",It="#",yn=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),K=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),nn=(e,t,n)=>({...K(e,t,n),hidden:!0}),J=(e,t,n,o)=>{const i=Object.values(L).indexOf(t),r=Object.keys(L)[i];let A=H.LORD,I=2,f=2,h=4,C=4,k=4,_=en[0],U=tn[0];switch(e){case G.ORCH:{A=H.APPRENTICE,f=0,h=2,C=2,k=1;break}case G.TROLL:{A=H.KNIGHT,f=1,h=3,C=3,k=2,_=en[1],U=tn[1];break}}return e===G.YELLOW_DARK_LORD&&(I=3),{type:e,level:A,colour:t,actions:I,defense:f,health:h,maxHealth:C,experience:k,name:e+" ("+r+")",movement:3,position:{x:n,y:o},weapon:_,armour:U,incapacitated:!1}},kn={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:j.KILL_ALL,fulfilled:!1},{type:j.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[K(B.RIGHT,2,4),K(B.RIGHT,5,4),K(B.RIGHT,9,5),K(B.RIGHT,12,5),K(B.RIGHT,9,8),K(B.RIGHT,12,8),K(B.RIGHT,11,2),nn(B.UP,9,3),nn(B.RIGHT,15,1)],monsters:[J(G.ORCH,L.Blue,9,7),J(G.ORCH,L.Red,12,8),J(G.TROLL,L.Red,15,1),J(G.TROLL,L.Yellow,13,6)],secrets:[{type:ee.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:ee.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:ee.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item",item:{name:"Healing Herbs"}},{type:ee.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},Bn={name:"Troll cave",beaten:!1,winConditions:[{type:j.KILL_ALL,fulfilled:!1}],nextDungeon:kn,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[K(B.RIGHT,3,9),K(B.RIGHT,6,9),K(B.UP,7,7),K(B.UP,7,4)],monsters:[J(G.ORCH,L.Green,6,9),J(G.ORCH,L.Yellow,8,10),J(G.ORCH,L.Red,7,5),J(G.ORCH,L.Red,9,3),J(G.TROLL,L.Green,6,1)],secrets:[yn(ee.TRAP_DOOR,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},Tn=e=>{const t=e.currentActor,n=$e(t.level,1);let o,i,r,A;n>=1?(o=_n(e,t,n),o||(i=On(e,t,n)),!o&&!i&&(r=wn(e,t,n)),!o&&!i&&!r&&(A=Pn(e,t,n)),!o&&!i&&!r&&!A&&E(e,`${t.name} searched but found nothing`)):E(e,`${t.name} searched but found nothing`)},An=e=>{const t=e.currentActor;if(!t)return;const n=e.dungeon.layout.secrets.filter(o=>o.type===ee.TRAP_DOOR).filter(o=>!o.found).find(o=>Et(o.position,t.position));n&&(et(e,Rn(n),t),E(e,`${t.name} fell into a pit and is incapacitated for one turn.`),t.movement=0,t.actions=0,t.incapacitated=!0,n.found=!0)},Rn=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,colour:L.Red,maxHealth:0,name:"Trap Door",level:H.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1}}),bn=(e,t)=>e.dungeon.layout.doors.find(n=>n.hidden&&_e({x:n.x,y:n.y},t.x,t.y)),Dn=(e,t)=>e.dungeon.layout.doors.find(n=>n.trapped&&n.x===t.x&&n.y===t.y),Ln=(e,t)=>e.dungeon.layout.secrets.find(n=>_e(n.position,t.x,t.y)),Hn=(e,t)=>e.dungeon.layout.secrets.filter(n=>n.type===ee.TRAP_DOOR).find(n=>_e(n.position,t.x,t.y)),On=(e,t,n)=>bn(e,t.position)?(E(e,`${t.name} searched (${n}) and found a hidden door`),!0):!1,wn=(e,t,n)=>{const o=Dn(e,t.position);return o?(E(e,`${t.name} searched (${n}) and found a trap in a door`),o.trapped=!1,!0):!1},Pn=(e,t,n)=>{const o=Ln(e,t.position);return o?(E(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},_n=(e,t,n)=>{const o=Hn(e,t.position);return o?(E(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},on=e=>{E(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Sn=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),E(t,"Game loaded."),t}},Nn=()=>{const e=Mn,t={heroes:e,dungeon:Bn,currentActor:e[0],actionLog:["Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."]};return cn(t),t},Ye=(e,t)=>(Jt[0].amountInDeck--,{name:e,actions:2,movement:3,defense:0,level:H.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Jt[0],incapacitated:!1}),Mn=[Ye("Fearik",L.Yellow),Ye("Helbran",L.Red),Ye("Siedel",L.Green),Ye("Wulf",L.Blue)],cn=e=>{e.heroes.forEach((t,n)=>t.position=e.dungeon.startingPositions[n])},Qe=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},vt=(e,t,n)=>e.dungeon.layout.monsters.some(o=>o.position.x===t&&o.position.y===n&&o.health>0),Qt=(e,t,n)=>N(e).some(o=>o.position.x===t&&o.position.y===n),Ke=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=3)),e.actions==0&&(e.movement=0)},T=(e,t)=>{const n=t.currentActor;if(!n||n.actions===0)return;let o=n.position.x,i=n.position.y;switch(e){case"UL":o=n.position.x-1,i=n.position.y-1;break;case"U":i=n.position.y-1;break;case"UR":o=n.position.x+1,i=n.position.y-1;break;case"L":o=n.position.x-1;break;case"R":o=n.position.x+1;break;case"DL":o=n.position.x-1,i=n.position.y+1;break;case"D":i=n.position.y+1;break;case"DR":o=n.position.x+1,i=n.position.y+1;break}const r=Qt(t,o,i),A=!je(t.dungeon.layout,o,i),I=vt(t,o,i);if(!r&&!A){const f=Ct(t.dungeon,o,i);f?f&&(I?fn(n,t,o,i):dn(n,t,o,i,1)):Yn(t,n,o,i)&&we(n,t,o,i)}else E(t,`${n.name} could not make that move`);Ke(n)},dn=(e,t,n,o,i)=>{e.position.x=n,e.position.y=o,An(t);const r=t.dungeon.layout.notes.find(I=>Et(I.position,e.position));r&&(t.dungeon.layout.doors.some(f=>f.hidden&&Et(r.position,{x:f.x,y:f.y}))||E(t,`${e.name} reads: ${r.message}`)),t.dungeon.layout.monsters.some(I=>_e(e.position,I.position.x,I.position.y))?(E(t,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=i},we=(e,t,n,o)=>{const i=Je(t.dungeon.layout.grid,n,o);i&&t.dungeon.discoveredRooms.push(i),dn(e,t,e.position.x,e.position.y,1),E(t,`${e.name} opened a door`)},fn=(e,t,n,o)=>{if(e.actions===1&&e.movement!==3){E(t,`${e.name} has no actions left to attack`);return}const i=t.dungeon.layout.monsters.find(r=>r.position.x===n&&r.position.y===o);i&&(et(t,e,i),i.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(r=>r!=i),E(t,`${e.name} killed ${i.name}`),t.dungeon.killCount++,e.experience+=i.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},$e=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case H.APPRENTICE:n=n.filter(o=>o===5);break;case H.KNIGHT:case H.HERO:n=n.filter(o=>o>=4);break;case H.LORD:case H.MASTER:n=n.filter(o=>o>=3);break}return n.length},We=e=>{const t=e.currentActor;if(!t)return;if(!Xe(t)){E(e,`${t.name} has no actions left to pick lock`);return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&($e(t.level,1)>=1?(n.locked=!1,E(e,`${t.name} managed to pick the lock`)):E(e,`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=3,t.actions==0&&(t.movement=0))},qe=e=>{const t=e.currentActor;if(t){if(!Xe(t)){E(e,`${t.name} has no actions left to search`);return}Tn(e),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)}},ht=e=>{if(Gn(e),e.currentActor!==void 0){E(e,`${e.currentActor.name} ended their turn`);let n=N(e).indexOf(e.currentActor)+1;n===N(e).length&&(Fn(e),n=0),N(e)[n].incapacitated&&(E(e,`${N(e)[n].name} is no longer incapacitated.`),N(e)[n].incapacitated=!1,n++),e.currentActor.actions=2,e.currentActor.movement=3,e.currentActor=N(e)[n],E(e,`${e.currentActor.name} started their turn`)}},Gn=e=>{var t;e.dungeon.winConditions.forEach(n=>{var o;switch(n.type){case j.KILL_ALL:{const i=e.dungeon.layout.monsters.map(r=>r.health).reduce((r,A)=>r+A,0);n.fulfilled=i<=0;break}case j.REACH_CELL:{n.fulfilled=N(e).some(i=>{var r;return i.position.x===((r=n.targetCell)==null?void 0:r.x)&&i.position.y===n.targetCell.y});break}case j.KILL_ALL_OF_TYPE:{n.fulfilled=e.dungeon.layout.monsters.filter(i=>i.type===n.targetMonsterType).some(i=>i.health>0);break}case j.OPEN_DOOR:{n.fulfilled=((o=e.dungeon.layout.doors.find(i=>{var r,A;return i.x===((r=n.targetCell)==null?void 0:r.x)&&i.y===((A=n.targetCell)==null?void 0:A.y)}))==null?void 0:o.open)??!1;break}case j.KILL_AT_LEAST:{n.fulfilled=(n.killMinCount?n.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(n=>n.fulfilled).reduce((n,o)=>n&&o,!0),e.dungeon.beaten&&(E(e,"All win conditions have been fulfilled"),E(e,`You have cleared ${e.dungeon.name}`),E(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},un=(e,t,n)=>{const o=$e(H.APPRENTICE,e.trapAttacks),i=Math.max(o-t.defense,0);E(n,`Door was trapped. ${t.name} took ${gn(i,o,t)}`),et(n,Un(e),t)},Un=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,colour:L.Red,maxHealth:0,name:"Door",level:H.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1}}),Yn=(e,t,n,o)=>{const i=e.dungeon.layout.doors.find(r=>r.x===t.position.x&&r.y===t.position.y);if(i&&!i.locked){const r=xn(t.position.x,t.position.y,n,o);if(i.side===r)return i.open=!0,i.trapped&&un(i,t,e),!0}return i&&i.locked&&E(e,"Door is locked"),!1},xn=(e,t,n,o)=>{if(e===n){if(t>o)return B.UP;if(t<o)return B.DOWN}if(t===o){if(e>n)return B.LEFT;if(e<n)return B.RIGHT}},je=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const i=Je(e.grid,t,n);(i===Qn||i===Cn||i===xe||i===It)&&(o=!1)}return o},Ct=(e,t,n)=>{const o=Je(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},Je=(e,t,n)=>{let o;return e.forEach((i,r)=>{Qe(i).forEach((A,I)=>{r===n&&I===t&&(o=A)})}),o},_e=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,Fn=e=>{const t=e.dungeon.layout.monsters.filter(n=>{const o=Je(e.dungeon.layout.grid,n.position.x,n.position.y);return o&&e.dungeon.discoveredRooms.includes(o)&&n.health>0});t.length===0&&E(e,"No monsters can act"),t.forEach(n=>{const o=n.actions;for(E(e,`${n.name} acted `);n.actions>0;){const i=N(e).filter(r=>_e(n.position,r.position.x,r.position.y));if(i.length>0){const r=Math.floor(Math.random()*i.length);qn(e,n,i[r])}else{for(;n.movement>0;)Kn(e,n);n.actions--,n.movement=3}}n.actions=o,n.movement=3})},sn=(e,t)=>Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2)),Kn=(e,t)=>{const n=N(e).map(o=>({hero:o,dist:sn(o.position,t.position)})).sort((o,i)=>o.dist-i.dist)[0];if(n.dist>1){const o=Wn(e,t.position);if(o.length>0){const i=o.map(r=>({pos:r,dist:sn(r,n.hero.position)})).sort((r,A)=>r.dist-A.dist)[0].pos;t.position=i,E(e,`${t.name} moved towards ${n.hero.name} (${i.x},${i.y})`)}else E(e,`${t.name} could not move`)}t.movement--};let Wn=(e,t)=>{const n=t.x,o=t.y,i=[];for(let r=n-1;r<=n+1;r++)for(let A=o-1;A<=o+1;A++)r===n&&A===o||je(e.dungeon.layout,r,A)&&Ct(e.dungeon,r,A)&&i.push({x:r,y:A});return i.filter(r=>!N(e).find(A=>A.position.x===r.x&&A.position.y===r.y)).filter(r=>!e.dungeon.layout.monsters.find(I=>I.position.x===r.x&&I.position.y===r.y))};const gn=(e,t,n)=>{var i;const o=((i=n.armour)==null?void 0:i.defense)??n.defense;return`${e} damage (${t}-${o}=${e})`},qn=(e,t,n)=>{if(t.actions===1&&t.movement!==3){E(e,`${n.name} has no actions left to attack`);return}n&&(et(e,t,n),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--)},Xe=e=>e.movement<3?e.actions>1:e.actions>0,Et=(e,t)=>e.x===t.x&&e.y===t.y,E=(e,t)=>{e.actionLog=[t,...e.actionLog]},N=e=>e.heroes.filter(t=>t.health>0),Xn=e=>e.heroes.filter(t=>t.health<=0),et=(e,t,n)=>{var A;const o=((A=n.armour)==null?void 0:A.defense)??n.defense,i=$e(t.level,t.weapon.dice),r=Math.max(i-o,0);n.health-=r,E(e,`${t.name} attacked ${n.name} with ${t.weapon.name} for ${gn(r,i,n)}`),n.health<=0&&(E(e,`${t.name} killed ${n.name}`),n.health=0,n.level=H.APPRENTICE)},Vn=e=>{N(e).forEach(t=>{const n=t.level;t.experience>=28?t.level=H.MASTER:t.experience>=18?t.level=H.LORD:t.experience>=10?t.level=H.HERO:t.experience>=4&&(t.level=H.KNIGHT),n!==t.level&&E(e,`${t.name} leveled up to ${t.level}`)})},zn=e=>{N(e).forEach(t=>t.experience+=4)},Zn=e=>{Xn(e).forEach(t=>{t.experience=0,t.health=t.maxHealth,t.actions=2})},$n=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],zn(e),Vn(e),Zn(e),cn(e))},jn="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",Jn="data:image/png;base64,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",eo=(e,t)=>{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y),i=Math.min(n,o),r=Math.max(n,o),A=i,I=r-i;let f=Math.sqrt(2);return I===0&&(f=1),Math.floor(f*A+I)},to=(e,t,n)=>{const o=e.currentActor,i=e.dungeon.layout.doors.find(r=>r.x===o.position.x&&r.y===o.position.y);if(i){if(!i.open&&!i.hidden&&!i.locked){switch(i.open=!0,i.trapped&&un(i,o,e),i.side){case B.RIGHT:we(o,e,t+1,n);break;case B.LEFT:we(o,e,t-1,n);break;case B.DOWN:we(o,e,t,n+1);break;case B.UP:we(o,e,t,n-1);break}Ke(o)}else if(i.locked&&!i.hidden){if(!Xe(o)){E(e,`${o.name} has no actions left`);return}E(e,"Door is locked"),We(e),Ke(o)}}else{if(!Xe(o)){E(e,`${o.name} has no actions left`);return}qe(e)}},no=(e,t,n)=>{const o=e.currentActor;if(o.actions===0){E(e,`${o.name} has no actions left`);return}const i=je(e.dungeon.layout,t,n),r=eo(o.position,{x:t,y:n});if(console.log("distance: "+r),i){const A=Qt(e,t,n),I=vt(e,t,n);!A&&!I&&r<=o.movement?(o.position={x:t,y:n},o.movement-=r,An(e)):I&&(r<=o.weapon.range?fn(o,e,t,n):E(e,"Monster is out of range"))}Ke(o)},oo=(e,t,n)=>{const o=n.currentActor,i=document.getElementById("gameBoard");if(!i)return;const r=i.getBoundingClientRect(),A=Math.min(Math.floor((e.clientX-r.left)/t),n.dungeon.layout.grid[0].length-1),I=Math.min(Math.floor((e.clientY-r.top)/t),n.dungeon.layout.grid.length-1),f=n.dungeon.layout.grid[I][A];A===o.position.x&&I===o.position.y?to(n,A,I):n.dungeon.discoveredRooms.includes(f)&&no(n,A,I)},io=(e,t,n,o)=>{o.dungeon.layout.secrets.filter(i=>i.found).forEach(i=>{switch(i.type){case ee.TRAP_DOOR:so(e,t,n,i);break;default:ao(e,t,n,i);break}})},so=(e,t,n,o)=>{const i=o.position.x,r=o.position.y;e.drawImage(t,3*48,0,48,48,i*n,r*n,n,n)},ao=(e,t,n,o)=>{const i=o.position.x,r=o.position.y;e.drawImage(t,4*48,0,48,48,i*n,r*n,n,n)};function ro(e){let t,n,o,i;return{c(){t=m("div"),n=m("canvas"),this.h()},l(r){t=p(r,"DIV",{style:!0,class:!0});var A=y(t);n=p(A,"CANVAS",{width:!0,height:!0,id:!0}),y(n).forEach(Q),A.forEach(Q),this.h()},h(){M(n,"width",s*40),M(n,"height",s*30),M(n,"id","gameBoard"),M(t,"style",e[1]()),M(t,"class","dungeon svelte-a4uhtl")},m(r,A){te(r,t,A),u(t,n),o||(i=S(n,"click",e[0]),o=!0)},p:re,i:re,o:re,d(r){r&&Q(t),o=!1,i()}}}const s=48;function lo(e,t,n){let{state:o}=t,{debugMode:i=!0}=t,r,A;A=window.innerHeight,r=document.getElementById("footer").offsetHeight,Ve(()=>{const a=new Image;a.src=jn;const l=new Image;l.src=Jn,f(a,l),setInterval(()=>f(a,l),10)});const I=(a,l,c)=>{const d=l.position.x,g=l.position.y;a.drawImage(c,4*16,0,16,16,d*s,g*s,s,s),le(a,l,d,g),U(a,l,d,g),ve(a,l,d,g)},f=(a,l)=>{if(!o||!document)return;const c=document.getElementById("gameBoard"),d=c.getContext("2d");d.clearRect(0,0,c.width,c.height),d.fillStyle="black",d.fillRect(0,0,c.width,c.height),o.dungeon.layout.grid.forEach((R,v)=>{Qe(R).forEach((b,O)=>C(d,b,O,v,a))}),io(d,a,s,o),o.dungeon.layout.grid.forEach((R,v)=>{Qe(R).forEach((b,O)=>k(d,b,O,v))}),o.dungeon.layout.grid.forEach((R,v)=>{Qe(R).forEach((b,O)=>_(d,b,O,v))}),o.dungeon.layout.grid.forEach((R,v)=>{Qe(R).forEach((b,O)=>Ce(d,b,O,v,l))}),N(o).forEach(R=>{I(d,R,l)}),Ne(d,o.currentActor),X(d,o.currentActor)},h=(a,l,c)=>{a.beginPath(),a.strokeStyle="black",a.fillStyle="black",a.fillRect(l*s,c*s,s,s),a.stroke()},C=(a,l,c,d,g)=>{z(l)||!o.dungeon.discoveredRooms.includes(l)&&l!==xe?o.dungeon.discoveredRooms.some(R=>ye(c,d,R))?a.drawImage(g,48,0,48,48,c*s,d*s,s,s):h(a,c,d):V(l)?h(a,c,d):a.drawImage(g,0,0,48,48,c*s,d*s,s,s)},k=(a,l,c,d)=>{l===xe||l===It||(a.beginPath(),a.strokeStyle="black",a.rect(c*s,d*s,s,s),i&&(a.font="7px Arial",a.fillText(c+","+d,c*s+3,d*s+(s-3))),a.stroke())},_=(a,l,c,d)=>{const g=Me(c,d);if(g&&!g.hidden&&!g.open&&!V(l))switch(a.fillStyle="brown",g.side){case B.RIGHT:{a.fillRect(c*s+(s-2),d*s,4,s),g.locked&&i&&(a.fillStyle="grey",a.fillRect(c*s+(s-4),d*s+(s/2-4),8,8)),g.trapped&&i&&(a.fillStyle="red",a.fillRect(c*s+(s-4),d*s+(s/2-4),4,4));break}case B.LEFT:{a.fillRect(c*s-2,d*s,4,s),g.locked&&i&&(a.fillStyle="grey",a.fillRect(c*s-4,d*s+(s/2-4),8,8)),g.trapped&&i&&(a.fillStyle="red",a.fillRect(c*s-4,d*s+(s/2-4),4,4));break}case B.UP:{a.fillRect(c*s,d*s-2,s,4),g.locked&&i&&(a.fillStyle="grey",a.fillRect(c*s+(s/2-4),d*s-4,8,8)),g.trapped&&i&&(a.fillStyle="red",a.fillRect(c*s+(s/2-4),d*s-4,4,4));break}case B.DOWN:{a.fillRect(c*s,d*s+(s-2),s,4),g.locked&&i&&(a.fillStyle="grey",a.fillRect(c*s+(s/2-4),d*s+(s-4),8,8)),g.trapped&&i&&(a.fillStyle="red",a.fillRect(c*s+(s/2-4),d*s+(s-4),4,4));break}}},U=(a,l,c,d)=>{a.beginPath(),a.strokeStyle=l.colour,a.fillStyle=l.colour,a.fillRect(c*s+4,d*s+(s-6),s-8,4),a.stroke()},Se=(a,l,c,d)=>{i&&c.forEach(g=>{const R=l.position.x,v=l.position.y,b=g.position.x,O=g.position.y;a.strokeStyle=l.colour,a.beginPath(),a.moveTo(R*s+s/2,v*s+s/2),a.lineTo(b*s+s/2,O*s+s/2),a.stroke()})},ve=(a,l,c,d)=>{a.beginPath(),a.strokeStyle="black",a.fillStyle="red",a.fillRect(c*s+4,d*s,s-8,4),a.fillStyle="green",a.fillRect(c*s+4,d*s,(s-8)*(l.health/l.maxHealth),4),a.rect(c*s+4,d*s,s-8,4),a.stroke()},le=(a,l,c,d)=>{var g=a.fillStyle,R=a.strokeStyle;a.strokeStyle="#080808",a.fillStyle="darkred";for(let v=0;v<l.actions;v++)a.fillRect(c*s+4+6*v,d*s+s-12,5,5),a.rect(c*s+4+6*v,d*s+s-12,5,5),a.stroke();a.fillStyle="blue";for(let v=0;v<l.movement;v++)a.fillRect(c*s+s-22+6*v,d*s+s-12,5,5),a.rect(c*s+s-22+6*v,d*s+s-12,5,5),a.stroke();a.fillStyle=g,a.strokeStyle=R},X=(a,l)=>{l===o.currentActor&&(a.beginPath(),a.strokeStyle="lightblue",a.lineWidth=2,a.moveTo(l.position.x*s,l.position.y*s),a.lineTo(l.position.x*s+s/3,l.position.y*s),a.moveTo(l.position.x*s,l.position.y*s),a.lineTo(l.position.x*s,l.position.y*s+s/3),a.moveTo(l.position.x*s+s,l.position.y*s),a.lineTo(l.position.x*s+s/3*2,l.position.y*s),a.moveTo(l.position.x*s+s,l.position.y*s),a.lineTo(l.position.x*s+s,l.position.y*s+s/3),a.moveTo(l.position.x*s,l.position.y*s+s),a.lineTo(l.position.x*s,l.position.y*s+s/3*2),a.moveTo(l.position.x*s,l.position.y*s+s),a.lineTo(l.position.x*s+s/3,l.position.y*s+s),a.moveTo(l.position.x*s+s,l.position.y*s+s),a.lineTo(l.position.x*s+s,l.position.y*s+s/3*2),a.moveTo(l.position.x*s+s,l.position.y*s+s),a.lineTo(l.position.x*s+s/3*2,l.position.y*s+s),a.stroke(),a.lineWidth=1)},Ne=(a,l)=>{if(l===o.currentActor&&i){for(let c=l.position.x-l.movement;c<=l.position.x+l.movement;c++)for(let d=l.position.y-l.movement;d<=l.position.y+l.movement;d++)if(Ct(o.dungeon,c,d)){const R=vt(o,c,d),v=Qt(o,c,d),b=je(o.dungeon.layout,c,d);!v&&!R&&b&&(a.fillStyle="rgba(50, 50, 255, 0.08)",a.fillRect(c*s,d*s,s,s),a.stroke())}}},Ce=(a,l,c,d,g)=>{if(a.beginPath(),!o.heroes.find(v=>v.position.x===c&&v.position.y===d)){const v=o.dungeon.layout.monsters.find(b=>b.position.x===c&&b.position.y===d);if(v&&v.health>0&&!V(l)){switch(v.type){case G.ORCH:a.drawImage(g,s,16,16,16,c*s,d*s,s,s);break;case G.TROLL:a.drawImage(g,s,16,16,16,c*s,d*s,s,s);break;default:a.drawImage(g,16,16,16,16,c*s,d*s,s,s);break}U(a,v,c,d),ve(a,v,c,d),Se(a,v,o.heroes)}}},V=a=>a===xe||!o.dungeon.discoveredRooms.includes(a),z=a=>a===It,Me=(a,l)=>o.dungeon.layout.doors.find(c=>c.x===a&&c.y===l),ye=(a,l,c)=>{if(!o)return;const d=Math.max(a-1,0),g=Math.max(l-1,0),R=Math.min(a+1,o.dungeon.layout.grid.length),v=Math.min(l+1,o.dungeon.layout.grid[0].length);for(let b=d;b<=R;b++)for(let O=g;O<=v;O++){const ce=o.dungeon.layout.grid[O];if(Qe(ce)[b]===c)return!0}return!1},Ae=a=>{oo(a,s,o)},Z=()=>`max-height: ${A-r-20}px; max-width: ${s*40}`;return e.$$set=a=>{"state"in a&&n(2,o=a.state),"debugMode"in a&&n(3,i=a.debugMode)},[Ae,Z,o,i]}class Ao extends ze{constructor(t){super(),Ze(this,t,lo,ro,Pe,{state:2,debugMode:3})}}function co(e){let t;return{c(){t=m("canvas"),this.h()},l(n){t=p(n,"CANVAS",{id:!0,height:!0,width:!0}),y(t).forEach(Q),this.h()},h(){M(t,"id","characterBoard"),M(t,"height","720"),M(t,"width","260")},m(n,o){te(n,t,o)},p:re,i:re,o:re,d(n){n&&Q(t)}}}const q=180;function fo(e,t,n){let{state:o}=t;Ve(()=>{i(),setInterval(i,100)});const i=()=>{if(!o||!document)return;const f=document.getElementById("characterBoard"),h=f.getContext("2d");h.clearRect(0,0,f.width,f.height),h.stroke(),N(o).forEach((C,k)=>{r(h,f,C,k),A(h,C,k),I(h,C,k)})},r=(f,h,C,k)=>{f.fillStyle=C.colour,f.fillRect(12,k*q+12,h.width,q-12),f.stroke(),f.fillStyle="black"},A=(f,h,C)=>{const _=(h===o.currentActor?"> "+h.name:h.name)+" - "+h.level+" ("+h.experience+")";f.strokeStyle="black",f.font="18px Arial",f.fillText(_,16,C*q+30),f.fillText("HP: "+h.health,16,C*q+50),f.fillText("Actions: "+h.actions,16,C*q+70),f.fillText("Moves: "+h.movement,16,C*q+90),f.stroke()},I=(f,h,C)=>{f.fillText("Equipment",16,C*q+110),f.font="12px Arial",f.fillText("🗡️ "+h.weapon.name+" ("+h.weapon.dice+")",16,C*q+125);let k="None (0)",_="None (0)";h.armour&&(k=h.armour.name+" ("+h.armour.defense+")"),h.shield&&(_=h.shield.name+" ("+h.armour.dice+")"),f.fillText("🧱 "+k,16,C*q+142),f.fillText("🛡️ "+_,16,C*q+159)};return e.$$set=f=>{"state"in f&&n(0,o=f.state)},[o]}class uo extends ze{constructor(t){super(),Ze(this,t,fo,co,Pe,{state:0})}}function an(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function go(e){let t,n,o=e[2]+"",i;return{c(){t=m("p"),n=zt(">"),i=zt(o),this.h()},l(r){t=p(r,"P",{class:!0});var A=y(t);n=Zt(A,">"),i=Zt(A,o),A.forEach(Q),this.h()},h(){M(t,"class","svelte-1xp6uq")},m(r,A){te(r,t,A),u(t,n),u(t,i)},p(r,A){A&1&&o!==(o=r[2]+"")&&En(i,o)},d(r){r&&Q(t)}}}function rn(e){let t,n=e[4]<25&&go(e);return{c(){n&&n.c(),t=Fe()},l(o){n&&n.l(o),t=Fe()},m(o,i){n&&n.m(o,i),te(o,t,i)},p(o,i){o[4]<25&&n.p(o,i)},d(o){o&&Q(t),n&&n.d(o)}}}function ln(e){let t,n=jt(e[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=rn(an(e,n,i));return{c(){for(let i=0;i<o.length;i+=1)o[i].c();t=Fe()},l(i){for(let r=0;r<o.length;r+=1)o[r].l(i);t=Fe()},m(i,r){for(let A=0;A<o.length;A+=1)o[A]&&o[A].m(i,r);te(i,t,r)},p(i,r){if(r&1){n=jt(i[0]);let A;for(A=0;A<n.length;A+=1){const I=an(i,n,A);o[A]?o[A].p(I,r):(o[A]=rn(I),o[A].c(),o[A].m(t.parentNode,t))}for(;A<o.length;A+=1)o[A].d(1);o.length=n.length}},d(i){i&&Q(t),hn(o,i)}}}function mo(e){let t,n=e[0],o=ln(e);return{c(){t=m("div"),o.c(),this.h()},l(i){t=p(i,"DIV",{class:!0});var r=y(t);o.l(r),r.forEach(Q),this.h()},h(){M(t,"class","log svelte-1xp6uq")},m(i,r){te(i,t,r),o.m(t,null)},p(i,[r]){r&1&&Pe(n,n=i[0])?(o.d(1),o=ln(i),o.c(),o.m(t,null)):o.p(i,r)},i:re,o:re,d(i){i&&Q(t),o.d(i)}}}function po(e,t,n){let o=[],{state:i}=t;return Ve(()=>{setInterval(()=>{n(0,o=i.actionLog)},1e3)}),e.$$set=r=>{"state"in r&&n(1,i=r.state)},[o,i]}class Io extends ze{constructor(t){super(),Ze(this,t,po,mo,Pe,{state:1})}}function ho(e){let t,n,o,i,r,A,I,f,h,C,k,_,U,Se="UL",ve,le,X,Ne="U",Ce,V,z,Me="UR",ye,Ae,Z,a="Next",l,c,d,g,R="L",v,b,O,ce,ne,yt="R",tt,ke,de,kt="Search",nt,W,Be,fe,Bt="DL",ot,Te,ue,Tt="D",it,Re,ge,Rt="DR",st,be,me,bt="Pick lock",at,pe,De,Ie,Dt="Save",rt,Le,he,Lt="Load",lt,$,At,Ge,ct,Ht;o=new uo({props:{state:e[0]}});function mn(D){e[2](D)}let Ot={};e[0]!==void 0&&(Ot.state=e[0]),r=new Ao({props:Ot}),Xt.push(()=>$t(r,"state",mn));function pn(D){e[4](D)}let wt={};return e[0]!==void 0&&(wt.state=e[0]),$=new Io({props:wt}),Xt.push(()=>$t($,"state",pn)),{c(){t=m("div"),n=m("div"),dt(o.$$.fragment),i=w(),dt(r.$$.fragment),I=w(),f=m("div"),h=m("div"),C=m("table"),k=m("tr"),_=m("td"),U=m("button"),U.textContent=Se,ve=w(),le=m("td"),X=m("button"),X.textContent=Ne,Ce=w(),V=m("td"),z=m("button"),z.textContent=Me,ye=w(),Ae=m("td"),Z=m("button"),Z.textContent=a,l=w(),c=m("tr"),d=m("td"),g=m("button"),g.textContent=R,v=w(),b=m("td"),O=w(),ce=m("td"),ne=m("button"),ne.textContent=yt,tt=w(),ke=m("td"),de=m("button"),de.textContent=kt,nt=w(),W=m("tr"),Be=m("td"),fe=m("button"),fe.textContent=Bt,ot=w(),Te=m("td"),ue=m("button"),ue.textContent=Tt,it=w(),Re=m("td"),ge=m("button"),ge.textContent=Rt,st=w(),be=m("td"),me=m("button"),me.textContent=bt,at=w(),pe=m("tr"),De=m("td"),Ie=m("button"),Ie.textContent=Dt,rt=w(),Le=m("td"),he=m("button"),he.textContent=Lt,lt=w(),dt($.$$.fragment),this.h()},l(D){t=p(D,"DIV",{class:!0});var x=y(t);n=p(x,"DIV",{class:!0});var He=y(n);ft(o.$$.fragment,He),He.forEach(Q),i=P(x),ft(r.$$.fragment,x),x.forEach(Q),I=P(D),f=p(D,"DIV",{class:!0,id:!0});var Ee=y(f);h=p(Ee,"DIV",{class:!0});var Oe=y(h);C=p(Oe,"TABLE",{});var oe=y(C);k=p(oe,"TR",{});var ie=y(k);_=p(ie,"TD",{});var Pt=y(_);U=p(Pt,"BUTTON",{"data-svelte-h":!0}),Y(U)!=="svelte-fw3uxo"&&(U.textContent=Se),Pt.forEach(Q),ve=P(ie),le=p(ie,"TD",{});var _t=y(le);X=p(_t,"BUTTON",{"data-svelte-h":!0}),Y(X)!=="svelte-1jeoia6"&&(X.textContent=Ne),_t.forEach(Q),Ce=P(ie),V=p(ie,"TD",{});var St=y(V);z=p(St,"BUTTON",{"data-svelte-h":!0}),Y(z)!=="svelte-1p8c8vc"&&(z.textContent=Me),St.forEach(Q),ye=P(ie),Ae=p(ie,"TD",{});var Nt=y(Ae);Z=p(Nt,"BUTTON",{"data-svelte-h":!0}),Y(Z)!=="svelte-1rtxc14"&&(Z.textContent=a),Nt.forEach(Q),ie.forEach(Q),l=P(oe),c=p(oe,"TR",{});var se=y(c);d=p(se,"TD",{});var Mt=y(d);g=p(Mt,"BUTTON",{"data-svelte-h":!0}),Y(g)!=="svelte-10dnpu6"&&(g.textContent=R),Mt.forEach(Q),v=P(se),b=p(se,"TD",{}),y(b).forEach(Q),O=P(se),ce=p(se,"TD",{});var Gt=y(ce);ne=p(Gt,"BUTTON",{"data-svelte-h":!0}),Y(ne)!=="svelte-12287ni"&&(ne.textContent=yt),Gt.forEach(Q),tt=P(se),ke=p(se,"TD",{});var Ut=y(ke);de=p(Ut,"BUTTON",{"data-svelte-h":!0}),Y(de)!=="svelte-cps1bu"&&(de.textContent=kt),Ut.forEach(Q),se.forEach(Q),nt=P(oe),W=p(oe,"TR",{});var ae=y(W);Be=p(ae,"TD",{});var Yt=y(Be);fe=p(Yt,"BUTTON",{"data-svelte-h":!0}),Y(fe)!=="svelte-1ji074i"&&(fe.textContent=Bt),Yt.forEach(Q),ot=P(ae),Te=p(ae,"TD",{});var xt=y(Te);ue=p(xt,"BUTTON",{"data-svelte-h":!0}),Y(ue)!=="svelte-li5tq6"&&(ue.textContent=Tt),xt.forEach(Q),it=P(ae),Re=p(ae,"TD",{});var Ft=y(Re);ge=p(Ft,"BUTTON",{"data-svelte-h":!0}),Y(ge)!=="svelte-3esmwe"&&(ge.textContent=Rt),Ft.forEach(Q),st=P(ae),be=p(ae,"TD",{});var Kt=y(be);me=p(Kt,"BUTTON",{"data-svelte-h":!0}),Y(me)!=="svelte-sacog4"&&(me.textContent=bt),Kt.forEach(Q),ae.forEach(Q),at=P(oe),pe=p(oe,"TR",{});var Ue=y(pe);De=p(Ue,"TD",{});var Wt=y(De);Ie=p(Wt,"BUTTON",{"data-svelte-h":!0}),Y(Ie)!=="svelte-1vr5zyk"&&(Ie.textContent=Dt),Wt.forEach(Q),rt=P(Ue),Le=p(Ue,"TD",{});var qt=y(Le);he=p(qt,"BUTTON",{"data-svelte-h":!0}),Y(he)!=="svelte-1m2jkw7"&&(he.textContent=Lt),qt.forEach(Q),Ue.forEach(Q),oe.forEach(Q),Oe.forEach(Q),lt=P(Ee),ft($.$$.fragment,Ee),Ee.forEach(Q),this.h()},h(){M(n,"class","characterSide svelte-13uybsp"),M(t,"class","container svelte-13uybsp"),M(h,"class","commands svelte-13uybsp"),M(f,"class","container svelte-13uybsp"),M(f,"id","footer")},m(D,x){te(D,t,x),u(t,n),ut(o,n,null),u(t,i),ut(r,t,null),te(D,I,x),te(D,f,x),u(f,h),u(h,C),u(C,k),u(k,_),u(_,U),u(k,ve),u(k,le),u(le,X),u(k,Ce),u(k,V),u(V,z),u(k,ye),u(k,Ae),u(Ae,Z),u(C,l),u(C,c),u(c,d),u(d,g),u(c,v),u(c,b),u(c,O),u(c,ce),u(ce,ne),u(c,tt),u(c,ke),u(ke,de),u(C,nt),u(C,W),u(W,Be),u(Be,fe),u(W,ot),u(W,Te),u(Te,ue),u(W,it),u(W,Re),u(Re,ge),u(W,st),u(W,be),u(be,me),u(C,at),u(C,pe),u(pe,De),u(De,Ie),u(pe,rt),u(pe,Le),u(Le,he),u(f,lt),ut($,f,null),Ge=!0,ct||(Ht=[S(window,"keydown",vn(e[1])),S(U,"click",function(){F(T("UL",e[0]))&&T("UL",e[0]).apply(this,arguments)}),S(X,"click",function(){F(T("U",e[0]))&&T("U",e[0]).apply(this,arguments)}),S(z,"click",function(){F(T("UR",e[0]))&&T("UR",e[0]).apply(this,arguments)}),S(Z,"click",function(){F(ht(e[0]))&&ht(e[0]).apply(this,arguments)}),S(g,"click",function(){F(T("L",e[0]))&&T("L",e[0]).apply(this,arguments)}),S(ne,"click",function(){F(T("R",e[0]))&&T("R",e[0]).apply(this,arguments)}),S(de,"click",function(){F(qe(e[0]))&&qe(e[0]).apply(this,arguments)}),S(fe,"click",function(){F(T("DL",e[0]))&&T("DL",e[0]).apply(this,arguments)}),S(ue,"click",function(){F(T("D",e[0]))&&T("D",e[0]).apply(this,arguments)}),S(ge,"click",function(){F(T("DR",e[0]))&&T("DR",e[0]).apply(this,arguments)}),S(me,"click",function(){F(We(e[0]))&&We(e[0]).apply(this,arguments)}),S(Ie,"click",function(){F(on(e[0]))&&on(e[0]).apply(this,arguments)}),S(he,"click",e[3])],ct=!0)},p(D,[x]){e=D;const He={};x&1&&(He.state=e[0]),o.$set(He);const Ee={};!A&&x&1&&(A=!0,Ee.state=e[0],Vt(()=>A=!1)),r.$set(Ee);const Oe={};!At&&x&1&&(At=!0,Oe.state=e[0],Vt(()=>At=!1)),$.$set(Oe)},i(D){Ge||(gt(o.$$.fragment,D),gt(r.$$.fragment,D),gt($.$$.fragment,D),Ge=!0)},o(D){mt(o.$$.fragment,D),mt(r.$$.fragment,D),mt($.$$.fragment,D),Ge=!1},d(D){D&&(Q(t),Q(I),Q(f)),pt(o),pt(r),pt($),ct=!1,In(Ht)}}}function Eo(e,t,n){let o=Nn();Ve(()=>{setInterval(()=>$n(o),1e3)});function i(f){switch(f.key){case"6":case"d":T("R",o);break;case"9":case"e":T("UR",o);break;case"8":case"w":T("U",o);break;case"7":case"q":T("UL",o);break;case"4":case"a":T("L",o);break;case"1":case"z":T("DL",o);break;case"2":case"x":T("D",o);break;case"3":case"c":T("DR",o);break;case"0":case" ":ht(o);break;case"-":case"r":We(o);break;case"+":case"f":qe(o);break}}function r(f){o=f,n(0,o)}const A=()=>n(0,o=Sn());function I(f){o=f,n(0,o)}return[o,i,r,A,I]}class Co extends ze{constructor(t){super(),Ze(this,t,Eo,ho,Pe,{})}}export{Co as component};
