import{s as Se,n as ve,o as Dn,b as Mn,f as Nn,r as Yt}from"../chunks/scheduler.bc760b9c.js";import{S as mn,i as pn,g as u,h as A,j as m,f as d,k as B,a as T,x as c,y as P,m as v,s as Q,n as I,c as _,z as $,l as It,o as te,e as Ie,d as ae,p as Kn,b as Vn,t as Ae,A as Rt,r as dn,u as un,v as An,w as fn,B as Un,C as Ft}from"../chunks/index.54d4ae92.js";function kn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var w=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(w||{}),X=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(X||{}),N=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(N||{}),Re=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(Re||{}),he=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(he||{}),D=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(D||{}),H=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e))(H||{});const $n=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Gn=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Kt=[{name:"Chain mail",type:H.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],Et=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0}],Vt="0",Ht="@",qn=" ",Tn="#",qt=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),re=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),yt=(e,t,n)=>({...re(e,t,n),hidden:!0}),He=(e,t,n,o)=>{const s=Object.values(w).indexOf(t),r=Object.keys(w)[s];let a=N.LORD,i=2,l=2,f=4,y=4,p=4,E=Gn[0],R,b=Et[0];switch(e){case X.ORCH:{a=N.APPRENTICE,l=0,f=2,y=2,p=1,R=Gn[1];break}case X.TROLL:{a=N.KNIGHT,l=1,f=3,y=3,p=2,E=Gn[2],b=Et[1];break}}return e===X.YELLOW_DARK_LORD&&(i=3),{type:e,level:a,colour:t,actions:i,defense:l,health:f,maxHealth:y,experience:p,name:e+" ("+r+")",movement:3,maxMovement:3,position:{x:n,y:o},weapon:E,armour:b,incapacitated:!1,inventory:[],rangedWeapon:R}},Ot={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:Re.KILL_ALL,fulfilled:!1},{type:Re.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[re(D.RIGHT,2,4),re(D.RIGHT,5,4),re(D.RIGHT,9,5),re(D.RIGHT,12,5),re(D.RIGHT,9,8),re(D.RIGHT,12,8),re(D.RIGHT,11,2),yt(D.UP,9,3),yt(D.RIGHT,15,1)],monsters:[He(X.ORCH,w.Blue,9,7),He(X.ORCH,w.Red,12,8),He(X.TROLL,w.Red,15,1),He(X.TROLL,w.Yellow,13,6)],secrets:[{type:he.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:he.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:he.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item"},{type:he.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},Xt={name:"Troll cave",beaten:!1,winConditions:[{type:Re.KILL_ALL,fulfilled:!1}],nextDungeon:Ot,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[re(D.RIGHT,3,9),re(D.RIGHT,6,9),re(D.UP,7,7),re(D.UP,7,4)],monsters:[He(X.ORCH,w.Green,6,9),He(X.ORCH,w.Yellow,8,10),He(X.ORCH,w.Red,7,5),He(X.ORCH,w.Red,9,3),He(X.TROLL,w.Green,6,1)],secrets:[qt(he.NOTE,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},Zt=[{name:"Large shield",type:H.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:H.SHIELD,amountInDeck:2,dice:1,value:1}],jt=e=>{const t=e.currentActor,n=_n(t.level,1);let o,s,r,a;n>=1?(o=io(e,t,n),o||(s=to(e,t,n)),!o&&!s&&(r=oo(e,t,n)),!o&&!s&&!r&&(a=so(e,t,n)),!o&&!s&&!r&&!a&&g(e,`${t.name} searched but found nothing`)):g(e,`${t.name} searched but found nothing`)},xt=e=>{const t=e.currentActor;if(!t)return!1;const n=e.dungeon.layout.secrets.filter(o=>o.type===he.TRAP_DOOR).filter(o=>!o.found).find(o=>bn(o.position,t.position));return n?(In(e,Jt(n),t,!1),g(e,`${t.name} fell into a pit and is incapacitated for one turn.`),t.movement=0,t.actions=0,t.incapacitated=!0,n.found=!0,!0):!1},Jt=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:w.Red,maxHealth:0,name:"Trap Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),St=(e,t)=>e.dungeon.layout.doors.filter(n=>n.hidden).find(n=>vn({x:n.x,y:n.y},t.x,t.y)),zt=(e,t)=>e.dungeon.layout.doors.filter(n=>n.trapped).find(n=>n.x===t.x&&n.y===t.y),eo=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).find(n=>vn(n.position,t.x,t.y)),no=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).filter(n=>n.type===he.TRAP_DOOR).find(n=>vn(n.position,t.x,t.y)),to=(e,t,n)=>St(e,t.position)?(g(e,`${t.name} searched (${n}) and found a hidden door`),!0):!1,oo=(e,t,n)=>{const o=zt(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found a trap in a door`),o.trapped=!1,!0):!1},so=(e,t,n)=>{const o=eo(e,t.position);if(o){switch(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,o.type){case he.EQUIPMENT:{let s=o.item??ro(e);switch(ao(e,s),g(e,`${t.name} equipped (${s.name})`),s.type){case H.ARMOUR:t.armour&&t.inventory.push(t.armour),t.armour=s;break;case H.SHIELD:t.shield&&t.inventory.push(t.shield),t.shield=s;break;case H.WEAPON:t.weapon&&t.inventory.push(t.weapon),t.weapon=s;break}}}return!0}return!1},ro=e=>{const t=e.itemDeck.length,n=Math.floor(Math.random()*t);return e.itemDeck[n]},ao=(e,t)=>{const n=e.itemDeck.findIndex(o=>o.type===t.type&&o.name===t.name);e.itemDeck.splice(n,1)},io=(e,t,n)=>{const o=no(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},yn=(e,t)=>($n[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:N.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:$n[0],incapacitated:!1,inventory:[]}),G=(e,t)=>{const n=t.currentActor;if(!n||n.actions===0)return;const o={x:n.position.x,y:n.position.y};switch(e){case"UL":o.x=n.position.x-1,o.y=n.position.y-1;break;case"U":o.y=n.position.y-1;break;case"UR":o.x=n.position.x+1,o.y=n.position.y-1;break;case"L":o.x=n.position.x-1;break;case"R":o.x=n.position.x+1;break;case"DL":o.x=n.position.x-1,o.y=n.position.y+1;break;case"D":o.y=n.position.y+1;break;case"DR":o.x=n.position.x+1,o.y=n.position.y+1;break}const s=Zn(t,o.x,o.y),r=!Rn(t.dungeon.layout,o.x,o.y),a=Xn(t,o.x,o.y);if(!s&&!r){const i=Jn(t.dungeon,o.x,o.y);i?i&&(a?Lt(n,t,o):Pt(n,t,o.x,o.y,1)):fo(t,n,o.x,o.y)&&cn(n,t,o.x,o.y)}else g(t,`${n.name} could not make that move`);xt(t)||Qn(n)},Wn=e=>{const t=e.currentActor;if(!t)return;if(!Cn(t)){g(e,`${t.name} has no actions left to pick lock`);return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(_n(t.level,1)>=1?(n.locked=!1,g(e,`${t.name} managed to pick the lock`)):g(e,`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=Oe(t),t.actions==0&&(t.movement=0))},wt=e=>{e.heroes.forEach((t,n)=>{t.position=e.dungeon.startingPositions[n],t.movement=Oe(t),t.actions=2,t.health=t.maxHealth})},M=e=>e.heroes.filter(t=>t.health>0),lo=e=>{const t=e.currentActor;t&&(t.actions--,t.movement=Oe(t),t.actions===0&&Fn(e))},Cn=e=>e.movement<Oe(e)?e.actions>1:e.actions>0,cn=(e,t,n,o)=>{const s=hn(t.dungeon.layout.grid,n,o);s&&t.dungeon.discoveredRooms.push(s),Pt(e,t,e.position.x,e.position.y,1),g(t,`${e.name} opened a door`)},Lt=(e,t,n)=>{if(e.actions===1&&e.movement!==3){g(t,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&ho(t,e)){g(t,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const o=po(t,n);o&&(In(t,e,o,!1),o.health<=0&&mo(t,o,e),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},Yn=e=>{const t=e.currentActor;if(t){if(!Cn(t)){g(e,`${t.name} has no actions left to search`);return}jt(e),t.actions>1&&t.movement<Oe(t)?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)}},Xn=(e,t,n)=>e.dungeon.layout.monsters.some(o=>o.position.x===t&&o.position.y===n&&o.health>0),Zn=(e,t,n)=>M(e).some(o=>o.position.x===t&&o.position.y===n),Qn=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=Oe(e))),e.actions==0&&(e.movement=0)},co=e=>{M(e).forEach(t=>{const n=t.level;t.experience>=28?t.level=N.MASTER:t.experience>=18?t.level=N.LORD:t.experience>=10?t.level=N.HERO:t.experience>=4&&(t.level=N.KNIGHT),n!==t.level&&g(e,`${t.name} leveled up to ${t.level}`)})},uo=e=>{M(e).forEach(t=>t.experience+=4)},Ao=e=>{vo(e).forEach(t=>{t.experience=0,t.health=t.maxHealth,t.movement=t.maxMovement,t.actions=2})},Pt=(e,t,n,o,s)=>{e.position.x=n,e.position.y=o;const r=t.dungeon.layout.notes.find(i=>bn(i.position,e.position));r&&(t.dungeon.layout.doors.some(l=>l.hidden&&bn(r.position,{x:l.x,y:l.y}))||g(t,`${e.name} reads: ${r.message}`)),t.dungeon.layout.monsters.some(i=>vn(e.position,i.position.x,i.position.y))?(g(t,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=s},fo=(e,t,n,o)=>{const s=e.dungeon.layout.doors.find(r=>r.x===t.position.x&&r.y===t.position.y);if(s&&!s.locked){const r=go(t.position.x,t.position.y,n,o);if(s.side===r)return s.open=!0,s.trapped&&In(e,Mt(s),t,!1),!0}return s&&s.locked&&g(e,"Door is locked"),!1},go=(e,t,n,o)=>{if(e===n){if(t>o)return D.UP;if(t<o)return D.DOWN}if(t===o){if(e>n)return D.LEFT;if(e<n)return D.RIGHT}},mo=(e,t,n)=>{e.dungeon.layout.monsters=e.dungeon.layout.monsters.filter(o=>o!=t),g(e,`${n.name} killed ${t.name}`),e.dungeon.killCount++,n.experience+=t.experience},po=(e,t)=>e.dungeon.layout.monsters.find(n=>bn(n.position,t)),ho=(e,t)=>Nt(e,t).filter(n=>n!==t).length>0,vo=e=>e.heroes.filter(t=>t.health<=0),Io=()=>{const e=[];return $n.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Kt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Zt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),e},ln={name:"Treasure of the Ice Dragon",dungeons:[Xt,Ot],itemDeck:Io(),heroes:[yn("Fearik",w.Yellow),yn("Helbran",w.Red),yn("Siedel",w.Green),yn("Wulf",w.Blue)]},Eo=e=>{const t=_o(e);t.length===0&&g(e,"No monsters can act"),t.forEach(n=>{e.currentActor=n;const o=n.actions;for(g(e,`${n.name} acted `);n.actions>0;){const s=Nt(e,n),r=Qo(e,n);switch(yo(e,n,s,r)){case"MELEE_ATTACK":{const i=Co(s);kt(e,n,i,!1);break}case"RANGED_ATTACK":{const i=ko(r,n);kt(e,n,i,!0);break}case"MOVE":{Bo(e,n);break}}n.movement=Oe(n)}n.actions=o,n.movement=Oe(n)})},yo=(e,t,n,o)=>n.length>0?"MELEE_ATTACK":t.rangedWeapon&&o.length>0&&t.rangedWeapon?Math.random()<.1?(g(e,`${t.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":"MOVE",ko=(e,t)=>e.filter(n=>!n.shield).sort(n=>gn(t.position,n.position)).sort((n,o)=>o.health-n.health||gn(t.position,n.position)-gn(t.position,o.position))[0],Co=e=>e.sort((t,n)=>n.health-t.health)[0],Qo=(e,t)=>M(e).filter(n=>{const o={x:t.position.x*48-24,y:t.position.y*48-24},s={x:n.position.x*48-24,y:n.position.y*48-24};return Sn(o,t.position,s,n.position,e,[])}),_o=e=>e.dungeon.layout.monsters.filter(t=>{const n=hn(e.dungeon.layout.grid,t.position.x,t.position.y);return n&&e.dungeon.discoveredRooms.includes(n)&&t.health>0}),kt=(e,t,n,o)=>{In(e,t,n,o),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--},bo=(e,t)=>M(e).map(n=>({hero:n,dist:gn(n.position,t.position)})).sort((n,o)=>n.dist-o.dist)[0],Bo=(e,t)=>{const n=bo(e,t);for(;t.movement>0;){if(n.dist>1){const o=Do(e,t.position);if(o.length>0){const s=o.map(r=>({pos:r,dist:gn(r,n.hero.position)})).sort((r,a)=>r.dist-a.dist)[0].pos;t.position=s,g(e,`${t.name} moved towards ${n.hero.name} (${s.x},${s.y})`)}else g(e,`${t.name} could not move`)}t.movement--}t.actions--},Do=(e,t)=>{const n=t.x,o=t.y,s=[];for(let r=n-1;r<=n+1;r++)for(let a=o-1;a<=o+1;a++)r===n&&a===o||Rn(e.dungeon.layout,r,a)&&Jn(e.dungeon,r,a)&&s.push({x:r,y:a});return s.filter(r=>!M(e).find(a=>a.position.x===r.x&&a.position.y===r.y)).filter(r=>!e.dungeon.layout.monsters.some(a=>a.position.x===r.x&&a.position.y===r.y))},To=e=>{g(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Ro=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),g(t,"Game loaded."),t}},Ho=()=>{const e={heroes:ln.heroes,dungeon:ln.dungeons[0],currentActor:ln.heroes[0],actionLog:[`Playing '${ln.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:Oo(ln.itemDeck),settings:{cellSize:48,debug:!1}};return wt(e),e},Oo=e=>{let t=e.length,n;for(;t>0;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e},jn=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},_n=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case N.APPRENTICE:n=n.filter(o=>o===5);break;case N.KNIGHT:case N.HERO:n=n.filter(o=>o>=4);break;case N.LORD:case N.MASTER:n=n.filter(o=>o>=3);break}return n.length},Oe=e=>{var t;return e.maxMovement-(((t=e.armour)==null?void 0:t.movementReduction)??0)},Fn=e=>{if(xo(e),e.currentActor!==void 0){g(e,`${e.currentActor.name} ended their turn`);let n=M(e).indexOf(e.currentActor)+1;n===M(e).length&&(Eo(e),n=0),M(e)[n].incapacitated&&(g(e,`${M(e)[n].name} is no longer incapacitated.`),M(e)[n].incapacitated=!1,n++),e.currentActor.actions=2,e.currentActor.movement=Oe(e.currentActor),e.currentActor=M(e)[n],g(e,`${e.currentActor.name} started their turn`)}},xo=e=>{var t;e.dungeon.winConditions.forEach(n=>{var o;switch(n.type){case Re.KILL_ALL:{const s=e.dungeon.layout.monsters.map(r=>r.health).reduce((r,a)=>r+a,0);n.fulfilled=s<=0;break}case Re.REACH_CELL:{n.fulfilled=M(e).some(s=>{var r;return s.position.x===((r=n.targetCell)==null?void 0:r.x)&&s.position.y===n.targetCell.y});break}case Re.KILL_ALL_OF_TYPE:{n.fulfilled=e.dungeon.layout.monsters.filter(s=>s.type===n.targetMonsterType).some(s=>s.health>0);break}case Re.OPEN_DOOR:{n.fulfilled=((o=e.dungeon.layout.doors.find(s=>{var r,a;return s.x===((r=n.targetCell)==null?void 0:r.x)&&s.y===((a=n.targetCell)==null?void 0:a.y)}))==null?void 0:o.open)??!1;break}case Re.KILL_AT_LEAST:{n.fulfilled=(n.killMinCount?n.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(n=>n.fulfilled).reduce((n,o)=>n&&o,!0),e.dungeon.beaten&&(g(e,"All win conditions have been fulfilled"),g(e,`You have cleared ${e.dungeon.name}`),g(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},Mt=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:w.Red,maxHealth:0,name:"Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Rn=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const s=hn(e.grid,t,n);(s===Vt||s===Ht||s===qn||s===Tn)&&(o=!1)}return o},Jn=(e,t,n)=>{const o=hn(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},hn=(e,t,n)=>{let o;return e.forEach((s,r)=>{jn(s).forEach((a,i)=>{r===n&&i===t&&(o=a)})}),o},vn=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,wo=(e,t,n,o)=>{var r;const s=((r=o.armour)==null?void 0:r.defense)??o.defense;return`${e} damage (${t}-(${s}+${n})=${e})`},bn=(e,t)=>e.x===t.x&&e.y===t.y,g=(e,t)=>{e.actionLog=[t,...e.actionLog]},In=(e,t,n,o)=>{var f,y;let s=t.weapon;o&&t.rangedWeapon&&(s=t.rangedWeapon);let r=0,a=0;s.ignoresArmour?n.armour&&g(e,`${n.name}'s armour was useless against ${s.name} `):r=((f=n.armour)==null?void 0:f.defense)??n.defense,s.ignoresShield?n.shield&&g(e,`${n.name}'s shield was useless against ${s.name} `):a=_n(n.level,((y=n.shield)==null?void 0:y.dice)??0);const i=_n(t.level,s.dice),l=Math.max(i-(r+a),0);n.health-=l,g(e,`${t.name} attacked ${n.name} with ${s.name} for ${wo(l,i,a,n)}`),n.health<=0&&(g(e,`${t.name} killed ${n.name}`),n.health=0,n.level=N.APPRENTICE)},Lo=(e,t)=>{const n=document.getElementById("gameBoardContainer"),o=document.getElementById("gameBoard");if(n&&o){const s=e.x*t,r=e.y*t,a=o.offsetWidth,i=o.offsetHeight;n.scrollLeft=Math.round(s/a),n.scrollTop=Math.round(r/i),console.log(`scrolling to ${n.scrollLeft} x ${n.scrollTop}`)}},Po=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],uo(e),co(e),Ao(e),wt(e),Lo({x:e.dungeon.startingPositions[0].x,y:e.dungeon.startingPositions[0].y},e.settings.cellSize))},gn=(e,t)=>Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2)),Sn=(e,t,n,o,s,r)=>{const a=Mo(e,n),i={x:Math.round((a.x+24)/48),y:Math.round((a.y+24)/48)},l=hn(s.dungeon.layout.grid,i.x,i.y);return i.x===o.x&&i.y===o.y?(r.push(i),!0):l===Tn||l===Ht?!1:(i.x===t.x&&i.y===t.y||r.some(f=>f.x===i.x&&f.y===i.y)||r.push(i),Sn(a,t,n,o,s,r))},Mo=(e,t)=>{const n=e.x,o=e.y,s=t.x-n,r=t.y-o,a=s/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2),i=r/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2);let l=Math.round(a+n),f=Math.round(i+o);return{x:l,y:f}},Nt=(e,t)=>M(e).filter(n=>vn(t.position,n.position.x,n.position.y)),No="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",Uo="data:image/png;base64,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",Go=(e,t)=>{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y),s=Math.min(n,o),r=Math.max(n,o),a=s,i=r-s;let l=Math.sqrt(2);return i===0&&(l=1),Math.floor(l*a+i)},$o=(e,t)=>{const n=e.currentActor,o=e.dungeon.layout.doors.find(s=>s.x===n.position.x&&s.y===n.position.y);if(o){if(!o.open&&!o.hidden&&!o.locked&&n.movement>0){switch(o.open=!0,o.trapped&&In(e,Mt(o),n,!1),o.side){case D.RIGHT:cn(n,e,t.x+1,t.y);break;case D.LEFT:cn(n,e,t.x-1,t.y);break;case D.DOWN:cn(n,e,t.x,t.y+1);break;case D.UP:cn(n,e,t.x,t.y-1);break}Qn(n)}else if(o.locked&&!o.hidden){if(!Cn(n)){g(e,`${n.name} has no actions left`);return}g(e,"Door is locked"),Wn(e),Qn(n)}}else{if(!Cn(n)){g(e,`${n.name} has no actions left`);return}Yn(e)}},Wo=(e,t)=>{const n=e.currentActor;if(n.actions===0){g(e,`${n.name} has no actions left`);return}const o=Rn(e.dungeon.layout,t.x,t.y),s=Go(n.position,t);if(console.log("distance: "+s),o){const r=Zn(e,t.x,t.y),a=Xn(e,t.x,t.y);if(!r&&!a&&s<=n.movement){if(n.position=t,n.movement-=s,xt(e))return}else a&&(s<=n.weapon.range?Lt(n,e,t):g(e,"Monster is out of range"))}Qn(n)},Yo=(e,t,n)=>{const o=document.getElementById("gameBoard");if(!o)return;const s=o.getBoundingClientRect(),r=Math.min(Math.floor((e.clientX-s.left)/t),n.dungeon.layout.grid[0].length-1),a=Math.min(Math.floor((e.clientY-s.top)/t),n.dungeon.layout.grid.length-1),i=n.dungeon.layout.grid[a][r],l=n.currentActor;r===l.position.x&&a===l.position.y?$o(n,{x:r,y:a}):n.dungeon.discoveredRooms.includes(i)&&Wo(n,{x:r,y:a})},Fo=(e,t,n,o,s)=>{M(o).forEach(a=>{Ko(e,a,t,n)}),Zo(e,o,n),jo(e,o,n)},Ko=(e,t,n,o)=>{const s=t.position.x,r=t.position.y;e.drawImage(n,4*16,0,16,16,s*o,r*o,o,o),Vo(e,t,s,r,o),Xo(e,t,s,r,o),qo(e,t,s,r,o)},Vo=(e,t,n,o,s)=>{const r=e.fillStyle,a=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let i=0;i<t.actions;i++)e.fillRect(n*s+4+6*i,o*s+s-12,5,5),e.rect(n*s+4+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle="blue";for(let i=0;i<t.movement;i++)e.fillRect(n*s+s-22+6*i,o*s+s-12,5,5),e.rect(n*s+s-22+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle=r,e.strokeStyle=a},qo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n*s+4,o*s,s-8,4),e.fillStyle="green",e.fillRect(n*s+4,o*s,(s-8)*(t.health/t.maxHealth),4),e.rect(n*s+4,o*s,s-8,4),e.stroke()},Xo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(n*s+4,o*s+(s-6),s-8,4),e.stroke()},Zo=(e,t,n)=>{const o=t.currentActor;if(o){for(let s=o.position.x-o.movement;s<=o.position.x+o.movement;s++)for(let r=o.position.y-o.movement;r<=o.position.y+o.movement;r++)if(Jn(t.dungeon,s,r)){const i=Xn(t,s,r),l=Zn(t,s,r),f=Rn(t.dungeon.layout,s,r);!l&&!i&&f&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(s*n,r*n,n,n),e.stroke())}}},jo=(e,t,n)=>{const o=t.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n+n/3,o.position.y*n),e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n,o.position.y*n+n/3),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3,o.position.y*n+n),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n+n),e.stroke(),e.lineWidth=1)},Jo=(e,t,n,o,s)=>{o.dungeon.layout.monsters.forEach(r=>{So(e,t,o,r,n,s)})},So=(e,t,n,o,s,r)=>{const a=n.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&rs(a,n)){switch(o.type){case X.ORCH:zo(e,t,s,o);break;case X.TROLL:es(e,t,s,o);break;default:ns(e,t,s,o);break}ts(e,o,s),os(e,o,s),ss(e,o,n.heroes,n,s,r)}},zo=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},es=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},ns=(e,t,n,o)=>{e.drawImage(t,16,16,16,16,o.position.x*n,o.position.y*n,n,n)},ts=(e,t,n)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(t.position.x*n+4,t.position.y*n+(n-6),n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},os=(e,t,n)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t.position.x*n+4,t.position.y*n,n-8,4),e.fillStyle="green",e.fillRect(t.position.x*n+4,t.position.y*n,(n-8)*(t.health/t.maxHealth),4),e.rect(t.position.x*n+4,t.position.y*n,n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ss=(e,t,n,o,s,r)=>{r&&n.forEach(a=>{const i=[],l={x:t.position.x*48-24,y:t.position.y*48-24},f={x:a.position.x*48-24,y:a.position.y*48-24};if(Sn(l,t.position,f,a.position,o,i)){const p=t.position.x,E=t.position.y,R=a.position.x,b=a.position.y;e.beginPath(),e.strokeStyle=t.colour,e.lineWidth=2,e.moveTo(p*s+s/2,E*s+s/2),e.lineTo(R*s+s/2,b*s+s/2),e.stroke(),e.lineWidth=1}})},rs=(e,t)=>t.dungeon.discoveredRooms.includes(e),as=(e,t,n,o,s)=>{o.dungeon.layout.doors.forEach(r=>{fs(e,t,n,o,r,s)})},is=(e,t,n,o,s)=>{o.dungeon.layout.grid.forEach((r,a)=>{jn(r).forEach((i,l)=>{cs(e,t,o,i,l,a,n),As(e,i,o,l,a,n,s)})})},ls=(e,t,n,o)=>{o.dungeon.layout.secrets.filter(s=>s.found).forEach(s=>{switch(s.type){case he.TRAP_DOOR:ds(e,t,n,s);break;default:us(e,t,n,s);break}})},cs=(e,t,n,o,s,r,a)=>{gs(o)||!n.dungeon.discoveredRooms.includes(o)&&o!==qn?n.dungeon.discoveredRooms.some(i=>ms(s,r,i,n))?e.drawImage(t,48,0,48,48,s*a,r*a,a,a):Ct(e,s,r,a):Bn(o,n)?Ct(e,s,r,a):e.drawImage(t,0,0,48,48,s*a,r*a,a,a)},Ct=(e,t,n,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(t*o,n*o,o,o),e.stroke()},ds=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,3*48,0,48,48,s*n,r*n,n,n)},us=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,4*48,0,48,48,s*n,r*n,n,n)},As=(e,t,n,o,s,r,a)=>{!a&&(Bn(t,n)||t===Tn)||(e.beginPath(),e.strokeStyle="black",e.rect(o*r,s*r,r,r),a&&(e.font="7px Arial",e.fillText(o+","+s,o*r+3,s*r+(r-3))),e.stroke())},fs=(e,t,n,o,s,r)=>{const a=o.dungeon.layout.grid[s.y][s.x];if(s&&!s.hidden&&!s.open&&!Bn(a,o))switch(e.fillStyle="brown",s.side){case D.RIGHT:{e.fillRect(s.x*n+(n-2),s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n-4),s.y*n+(n/2-4),8,8));break}case D.LEFT:{e.fillRect(s.x*n-2,s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n-4,s.y*n+(n/2-4),8,8));break}case D.UP:{e.fillRect(s.x*n,s.y*n-2,n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n-4,8,8));break}case D.DOWN:{e.fillRect(s.x*n,s.y*n+(n-2),n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n+(n-4),8,8));break}}r&&!Bn(a,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${s.hidden?"H":"-"}/${s.trapped?"T"+s.trapAttacks:"-"}/${s.locked?"L":"-"}]`,s.x*n,s.y*n+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(s.x*n,s.y*n,n,n))},gs=e=>e===Tn,Bn=(e,t)=>e===qn||!t.dungeon.discoveredRooms.includes(e),ms=(e,t,n,o)=>{if(!o)return;const s=Math.max(e-1,0),r=Math.max(t-1,0),a=Math.min(e+1,o.dungeon.layout.grid.length),i=Math.min(t+1,o.dungeon.layout.grid[0].length);for(let l=s;l<=a;l++)for(let f=r;f<=i;f++){const y=o.dungeon.layout.grid[f];if(jn(y)[l]===n)return!0}return!1};function ps(e){let t,n,o,s;return{c(){t=u("div"),n=u("canvas"),this.h()},l(r){t=A(r,"DIV",{style:!0,class:!0,id:!0});var a=m(t);n=A(a,"CANVAS",{width:!0,height:!0,id:!0}),m(n).forEach(d),a.forEach(d),this.h()},h(){B(n,"width",e[0]*40),B(n,"height",e[0]*30),B(n,"id","gameBoard"),B(t,"style",e[2]()),B(t,"class","dungeon svelte-a4uhtl"),B(t,"id","gameBoardContainer")},m(r,a){T(r,t,a),c(t,n),o||(s=P(n,"click",e[1]),o=!0)},p:ve,i:ve,o:ve,d(r){r&&d(t),o=!1,s()}}}function hs(e,t,n){let{state:o}=t,{debugMode:s}=t,r,a;const i=(o==null?void 0:o.settings.cellSize)??48;a=window.innerHeight,r=document.getElementById("footer").offsetHeight,Dn(()=>{const p=new Image;p.src=No;const E=new Image;E.src=Uo,setInterval(()=>l(p,E),10)});const l=(p,E)=>{if(!o||!document)return;const R=document.getElementById("gameBoard"),b=R.getContext("2d");b.clearRect(0,0,R.width,R.height),b.fillStyle="black",b.fillRect(0,0,R.width,R.height),is(b,p,i,o,s),ls(b,p,i,o),as(b,p,i,o,s),Jo(b,E,i,o,s),Fo(b,E,i,o)},f=p=>{Yo(p,i,o)},y=()=>`max-height: ${a-r-20}px; max-width: ${i*40}`;return e.$$set=p=>{"state"in p&&n(3,o=p.state),"debugMode"in p&&n(4,s=p.debugMode)},[i,f,y,o,s]}class vs extends mn{constructor(t){super(),pn(this,t,hs,ps,Se,{state:3,debugMode:4})}}function Is(e){let t;return{c(){t=v("None (0)")},l(n){t=I(n,"None (0)")},m(n,o){T(n,t,o)},p:ve,d(n){n&&d(t)}}}function Es(e){let t=e[0].armour.name+"",n,o,s=e[0].armour.defense+"",r,a;return{c(){n=v(t),o=v(" ("),r=v(s),a=v(")")},l(i){n=I(i,t),o=I(i," ("),r=I(i,s),a=I(i,")")},m(i,l){T(i,n,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&t!==(t=i[0].armour.name+"")&&te(n,t),l&1&&s!==(s=i[0].armour.defense+"")&&te(r,s)},d(i){i&&(d(n),d(o),d(r),d(a))}}}function ys(e){let t;return{c(){t=v("None (0)")},l(n){t=I(n,"None (0)")},m(n,o){T(n,t,o)},p:ve,d(n){n&&d(t)}}}function ks(e){let t=e[0].shield.name+"",n,o,s=e[0].shield.dice+"",r,a;return{c(){n=v(t),o=v(" ("),r=v(s),a=v(")")},l(i){n=I(i,t),o=I(i," ("),r=I(i,s),a=I(i,")")},m(i,l){T(i,n,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&t!==(t=i[0].shield.name+"")&&te(n,t),l&1&&s!==(s=i[0].shield.dice+"")&&te(r,s)},d(i){i&&(d(n),d(o),d(r),d(a))}}}function Cs(e){let t,n,o,s=e[0].name+"",r,a,i,l,f=e[0].level+"",y,p,E=e[0].experience+"",R,b,xe,S,ie,W=e[0].health+"",Ee,ye,Y,z,fe=e[0].actions+"",ge,L,F,ze,ke=e[0].movement+"",U,Ce,K,tn="Equipment:",We,V,Z,Qe,ee=e[0].weapon.name+"",Ye,Fe,le=e[0].weapon.dice+"",oe,en,Ke,O,_e,ce,de,Ve;function we(k,h){return k[0].armour?Es:Is}let se=we(e),j=se(e);function nn(k,h){return k[0].shield?ks:ys}let me=nn(e),x=me(e);return{c(){t=u("div"),n=u("div"),o=u("b"),r=v(s),a=v(" -"),i=Q(),l=u("b"),y=v(f),p=v(" ("),R=v(E),b=v(")"),xe=Q(),S=u("span"),ie=v("HP: "),Ee=v(W),ye=Q(),Y=u("span"),z=v("Actions: "),ge=v(fe),L=Q(),F=u("span"),ze=v("Moves: "),U=v(ke),Ce=Q(),K=u("span"),K.textContent=tn,We=Q(),V=u("div"),Z=u("span"),Qe=v("🗡️ "),Ye=v(ee),Fe=v(" ("),oe=v(le),en=v(")"),Ke=Q(),O=u("span"),_e=v(`🧱
      `),j.c(),ce=Q(),de=u("span"),Ve=v(`🛡️
      `),x.c(),this.h()},l(k){t=A(k,"DIV",{class:!0,style:!0});var h=m(t);n=A(h,"DIV",{class:!0});var pe=m(n);o=A(pe,"B",{class:!0});var ue=m(o);r=I(ue,s),a=I(ue," -"),ue.forEach(d),i=_(pe),l=A(pe,"B",{class:!0});var Le=m(l);y=I(Le,f),p=I(Le," ("),R=I(Le,E),b=I(Le,")"),Le.forEach(d),pe.forEach(d),xe=_(h),S=A(h,"SPAN",{class:!0});var qe=m(S);ie=I(qe,"HP: "),Ee=I(qe,W),qe.forEach(d),ye=_(h),Y=A(h,"SPAN",{class:!0});var q=m(Y);z=I(q,"Actions: "),ge=I(q,fe),q.forEach(d),L=_(h),F=A(h,"SPAN",{class:!0});var be=m(F);ze=I(be,"Moves: "),U=I(be,ke),be.forEach(d),Ce=_(h),K=A(h,"SPAN",{class:!0,"data-svelte-h":!0}),$(K)!=="svelte-1ue18fw"&&(K.textContent=tn),We=_(h),V=A(h,"DIV",{class:!0});var J=m(V);Z=A(J,"SPAN",{class:!0});var Be=m(Z);Qe=I(Be,"🗡️ "),Ye=I(Be,ee),Fe=I(Be," ("),oe=I(Be,le),en=I(Be,")"),Be.forEach(d),Ke=_(J),O=A(J,"SPAN",{class:!0});var Xe=m(O);_e=I(Xe,`🧱
      `),j.l(Xe),Xe.forEach(d),ce=_(J),de=A(J,"SPAN",{class:!0});var De=m(de);Ve=I(De,`🛡️
      `),x.l(De),De.forEach(d),J.forEach(d),h.forEach(d),this.h()},h(){B(o,"class","svelte-pgtred"),B(l,"class","svelte-pgtred"),B(n,"class","hero-title svelte-pgtred"),B(S,"class","svelte-pgtred"),B(Y,"class","svelte-pgtred"),B(F,"class","svelte-pgtred"),B(K,"class","svelte-pgtred"),B(Z,"class","svelte-pgtred"),B(O,"class","svelte-pgtred"),B(de,"class","svelte-pgtred"),B(V,"class","equipment"),B(t,"class","hero-card svelte-pgtred"),It(t,"background-color",e[0].colour)},m(k,h){T(k,t,h),c(t,n),c(n,o),c(o,r),c(o,a),c(n,i),c(n,l),c(l,y),c(l,p),c(l,R),c(l,b),c(t,xe),c(t,S),c(S,ie),c(S,Ee),c(t,ye),c(t,Y),c(Y,z),c(Y,ge),c(t,L),c(t,F),c(F,ze),c(F,U),c(t,Ce),c(t,K),c(t,We),c(t,V),c(V,Z),c(Z,Qe),c(Z,Ye),c(Z,Fe),c(Z,oe),c(Z,en),c(V,Ke),c(V,O),c(O,_e),j.m(O,null),c(V,ce),c(V,de),c(de,Ve),x.m(de,null)},p(k,[h]){h&1&&s!==(s=k[0].name+"")&&te(r,s),h&1&&f!==(f=k[0].level+"")&&te(y,f),h&1&&E!==(E=k[0].experience+"")&&te(R,E),h&1&&W!==(W=k[0].health+"")&&te(Ee,W),h&1&&fe!==(fe=k[0].actions+"")&&te(ge,fe),h&1&&ke!==(ke=k[0].movement+"")&&te(U,ke),h&1&&ee!==(ee=k[0].weapon.name+"")&&te(Ye,ee),h&1&&le!==(le=k[0].weapon.dice+"")&&te(oe,le),se===(se=we(k))&&j?j.p(k,h):(j.d(1),j=se(k),j&&(j.c(),j.m(O,null))),me===(me=nn(k))&&x?x.p(k,h):(x.d(1),x=me(k),x&&(x.c(),x.m(de,null))),h&1&&It(t,"background-color",k[0].colour)},i:ve,o:ve,d(k){k&&d(t),j.d(),x.d()}}}function Qs(e,t,n){let{hero:o}=t;return e.$$set=s=>{"hero"in s&&n(0,o=s.hero)},[o]}class Ut extends mn{constructor(t){super(),pn(this,t,Qs,Cs,Se,{hero:0})}}function Qt(e,t,n){const o=e.slice();return o[3]=t[n],o[5]=n,o}function _s(e){let t,n,o,s;return n=new Ut({props:{hero:e[3]}}),{c(){t=u("div"),dn(n.$$.fragment),o=Q(),this.h()},l(r){t=A(r,"DIV",{class:!0});var a=m(t);un(n.$$.fragment,a),o=_(a),a.forEach(d),this.h()},h(){B(t,"class","not-current-actor svelte-izfxty")},m(r,a){T(r,t,a),An(n,t,null),c(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&d(t),fn(n)}}}function bs(e){let t,n,o,s;return n=new Ut({props:{hero:e[3]}}),{c(){t=u("div"),dn(n.$$.fragment),o=Q(),this.h()},l(r){t=A(r,"DIV",{class:!0});var a=m(t);un(n.$$.fragment,a),o=_(a),a.forEach(d),this.h()},h(){B(t,"class","is-current-actor svelte-izfxty")},m(r,a){T(r,t,a),An(n,t,null),c(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&d(t),fn(n)}}}function _t(e){let t,n,o,s;const r=[bs,_s],a=[];function i(l,f){return l[3]===l[0].currentActor?0:1}return t=i(e),n=a[t]=r[t](e),{c(){n.c(),o=Ie()},l(l){n.l(l),o=Ie()},m(l,f){a[t].m(l,f),T(l,o,f),s=!0},p(l,f){let y=t;t=i(l),t===y?a[t].p(l,f):(Kn(),Ae(a[y],1,1,()=>{a[y]=null}),Vn(),n=a[t],n?n.p(l,f):(n=a[t]=r[t](l),n.c()),ae(n,1),n.m(o.parentNode,o))},i(l){s||(ae(n),s=!0)},o(l){Ae(n),s=!1},d(l){l&&d(o),a[t].d(l)}}}function bt(e){let t=e[1],n,o,s=_t(e);return{c(){s.c(),n=Ie()},l(r){s.l(r),n=Ie()},m(r,a){s.m(r,a),T(r,n,a),o=!0},p(r,a){a&2&&Se(t,t=r[1])?(Kn(),Ae(s,1,1,ve),Vn(),s=_t(r),s.c(),ae(s,1),s.m(n.parentNode,n)):s.p(r,a)},i(r){o||(ae(s),o=!0)},o(r){Ae(s),o=!1},d(r){r&&d(n),s.d(r)}}}function Bs(e){let t,n,o=kn(M(e[0])),s=[];for(let a=0;a<o.length;a+=1)s[a]=bt(Qt(e,o,a));const r=a=>Ae(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();t=Ie()},l(a){for(let i=0;i<s.length;i+=1)s[i].l(a);t=Ie()},m(a,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,i);T(a,t,i),n=!0},p(a,[i]){if(i&3){o=kn(M(a[0]));let l;for(l=0;l<o.length;l+=1){const f=Qt(a,o,l);s[l]?(s[l].p(f,i),ae(s[l],1)):(s[l]=bt(f),s[l].c(),ae(s[l],1),s[l].m(t.parentNode,t))}for(Kn(),l=o.length;l<s.length;l+=1)r(l);Vn()}},i(a){if(!n){for(let i=0;i<o.length;i+=1)ae(s[i]);n=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Ae(s[i]);n=!1},d(a){a&&d(t),Rt(s,a)}}}function Ds(e,t,n){let{state:o}=t,s=!1;Dn(()=>{r(),setInterval(r,100)});const r=()=>{n(1,s=!s)};return e.$$set=a=>{"state"in a&&n(0,o=a.state)},[o,s]}class Ts extends mn{constructor(t){super(),pn(this,t,Ds,Bs,Se,{state:0})}}function Bt(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function Rs(e){let t,n,o=e[2]+"",s;return{c(){t=u("p"),n=v(">"),s=v(o),this.h()},l(r){t=A(r,"P",{class:!0});var a=m(t);n=I(a,">"),s=I(a,o),a.forEach(d),this.h()},h(){B(t,"class","svelte-1xp6uq")},m(r,a){T(r,t,a),c(t,n),c(t,s)},p(r,a){a&1&&o!==(o=r[2]+"")&&te(s,o)},d(r){r&&d(t)}}}function Dt(e){let t,n=e[4]<25&&Rs(e);return{c(){n&&n.c(),t=Ie()},l(o){n&&n.l(o),t=Ie()},m(o,s){n&&n.m(o,s),T(o,t,s)},p(o,s){o[4]<25&&n.p(o,s)},d(o){o&&d(t),n&&n.d(o)}}}function Tt(e){let t,n=kn(e[0]),o=[];for(let s=0;s<n.length;s+=1)o[s]=Dt(Bt(e,n,s));return{c(){for(let s=0;s<o.length;s+=1)o[s].c();t=Ie()},l(s){for(let r=0;r<o.length;r+=1)o[r].l(s);t=Ie()},m(s,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(s,r);T(s,t,r)},p(s,r){if(r&1){n=kn(s[0]);let a;for(a=0;a<n.length;a+=1){const i=Bt(s,n,a);o[a]?o[a].p(i,r):(o[a]=Dt(i),o[a].c(),o[a].m(t.parentNode,t))}for(;a<o.length;a+=1)o[a].d(1);o.length=n.length}},d(s){s&&d(t),Rt(o,s)}}}function Hs(e){let t,n=e[0],o=Tt(e);return{c(){t=u("div"),o.c(),this.h()},l(s){t=A(s,"DIV",{class:!0});var r=m(t);o.l(r),r.forEach(d),this.h()},h(){B(t,"class","log svelte-1xp6uq")},m(s,r){T(s,t,r),o.m(t,null)},p(s,[r]){r&1&&Se(n,n=s[0])?(o.d(1),o=Tt(s),o.c(),o.m(t,null)):o.p(s,r)},i:ve,o:ve,d(s){s&&d(t),o.d(s)}}}function Os(e,t,n){let o=[],{state:s}=t;return Dn(()=>{setInterval(()=>{n(0,o=s.actionLog)},500)}),e.$$set=r=>{"state"in r&&n(1,s=r.state)},[o,s]}class xs extends mn{constructor(t){super(),pn(this,t,Os,Hs,Se,{state:1})}}function ws(e){let t,n,o,s,r,a,i,l,f,y,p,E,R,b,xe="UL",S,ie,W,Ee="U",ye,Y,z,fe="UR",ge,L,F,ze="Next",ke,U,Ce,K,tn="L",We,V,Z,Qe,ee,Ye="R",Fe,le,oe,en="Search",Ke,O,_e,ce,de="DL",Ve,we,se,j="D",nn,me,x,k="DR",h,pe,ue,Le="Pick lock",qe,q,be,J,Be="Save",Xe,De,Ze,zn="Load",Hn,on,je,et="Debug",On,sn,Je,nt="End action",xn,Te,wn,En,Ln,tt;o=new Ts({props:{state:e[0]}});function Gt(C){e[4](C)}function $t(C){e[5](C)}let Pn={};e[0]!==void 0&&(Pn.state=e[0]),e[1]!==void 0&&(Pn.debugMode=e[1]),r=new vs({props:Pn}),Mn.push(()=>Un(r,"state",Gt)),Mn.push(()=>Un(r,"debugMode",$t));function Wt(C){e[21](C)}let ot={};return e[0]!==void 0&&(ot.state=e[0]),Te=new xs({props:ot}),Mn.push(()=>Un(Te,"state",Wt)),{c(){t=u("div"),n=u("div"),dn(o.$$.fragment),s=Q(),dn(r.$$.fragment),l=Q(),f=u("div"),y=u("div"),p=u("table"),E=u("tr"),R=u("td"),b=u("button"),b.textContent=xe,S=Q(),ie=u("td"),W=u("button"),W.textContent=Ee,ye=Q(),Y=u("td"),z=u("button"),z.textContent=fe,ge=Q(),L=u("td"),F=u("button"),F.textContent=ze,ke=Q(),U=u("tr"),Ce=u("td"),K=u("button"),K.textContent=tn,We=Q(),V=u("td"),Z=Q(),Qe=u("td"),ee=u("button"),ee.textContent=Ye,Fe=Q(),le=u("td"),oe=u("button"),oe.textContent=en,Ke=Q(),O=u("tr"),_e=u("td"),ce=u("button"),ce.textContent=de,Ve=Q(),we=u("td"),se=u("button"),se.textContent=j,nn=Q(),me=u("td"),x=u("button"),x.textContent=k,h=Q(),pe=u("td"),ue=u("button"),ue.textContent=Le,qe=Q(),q=u("tr"),be=u("td"),J=u("button"),J.textContent=Be,Xe=Q(),De=u("td"),Ze=u("button"),Ze.textContent=zn,Hn=Q(),on=u("td"),je=u("button"),je.textContent=et,On=Q(),sn=u("td"),Je=u("button"),Je.textContent=nt,xn=Q(),dn(Te.$$.fragment),this.h()},l(C){t=A(C,"DIV",{class:!0});var ne=m(t);n=A(ne,"DIV",{class:!0});var rn=m(n);un(o.$$.fragment,rn),rn.forEach(d),s=_(ne),un(r.$$.fragment,ne),ne.forEach(d),l=_(C),f=A(C,"DIV",{class:!0,id:!0});var Pe=m(f);y=A(Pe,"DIV",{class:!0});var an=m(y);p=A(an,"TABLE",{});var Me=m(p);E=A(Me,"TR",{});var Ne=m(E);R=A(Ne,"TD",{});var st=m(R);b=A(st,"BUTTON",{"data-svelte-h":!0}),$(b)!=="svelte-1vu0fc2"&&(b.textContent=xe),st.forEach(d),S=_(Ne),ie=A(Ne,"TD",{});var rt=m(ie);W=A(rt,"BUTTON",{"data-svelte-h":!0}),$(W)!=="svelte-m1j18o"&&(W.textContent=Ee),rt.forEach(d),ye=_(Ne),Y=A(Ne,"TD",{});var at=m(Y);z=A(at,"BUTTON",{"data-svelte-h":!0}),$(z)!=="svelte-8eygoe"&&(z.textContent=fe),at.forEach(d),ge=_(Ne),L=A(Ne,"TD",{});var it=m(L);F=A(it,"BUTTON",{"data-svelte-h":!0}),$(F)!=="svelte-1axp1ke"&&(F.textContent=ze),it.forEach(d),Ne.forEach(d),ke=_(Me),U=A(Me,"TR",{});var Ue=m(U);Ce=A(Ue,"TD",{});var lt=m(Ce);K=A(lt,"BUTTON",{"data-svelte-h":!0}),$(K)!=="svelte-amyars"&&(K.textContent=tn),lt.forEach(d),We=_(Ue),V=A(Ue,"TD",{}),m(V).forEach(d),Z=_(Ue),Qe=A(Ue,"TD",{});var ct=m(Qe);ee=A(ct,"BUTTON",{"data-svelte-h":!0}),$(ee)!=="svelte-2zfta0"&&(ee.textContent=Ye),ct.forEach(d),Fe=_(Ue),le=A(Ue,"TD",{});var dt=m(le);oe=A(dt,"BUTTON",{"data-svelte-h":!0}),$(oe)!=="svelte-1kis6k4"&&(oe.textContent=en),dt.forEach(d),Ue.forEach(d),Ke=_(Me),O=A(Me,"TR",{});var Ge=m(O);_e=A(Ge,"TD",{});var ut=m(_e);ce=A(ut,"BUTTON",{"data-svelte-h":!0}),$(ce)!=="svelte-57p0uk"&&(ce.textContent=de),ut.forEach(d),Ve=_(Ge),we=A(Ge,"TD",{});var At=m(we);se=A(At,"BUTTON",{"data-svelte-h":!0}),$(se)!=="svelte-1nly394"&&(se.textContent=j),At.forEach(d),nn=_(Ge),me=A(Ge,"TD",{});var ft=m(me);x=A(ft,"BUTTON",{"data-svelte-h":!0}),$(x)!=="svelte-7ds02w"&&(x.textContent=k),ft.forEach(d),h=_(Ge),pe=A(Ge,"TD",{});var gt=m(pe);ue=A(gt,"BUTTON",{"data-svelte-h":!0}),$(ue)!=="svelte-90j6ve"&&(ue.textContent=Le),gt.forEach(d),Ge.forEach(d),qe=_(Me),q=A(Me,"TR",{});var $e=m(q);be=A($e,"TD",{});var mt=m(be);J=A(mt,"BUTTON",{"data-svelte-h":!0}),$(J)!=="svelte-fxtyz6"&&(J.textContent=Be),mt.forEach(d),Xe=_($e),De=A($e,"TD",{});var pt=m(De);Ze=A(pt,"BUTTON",{"data-svelte-h":!0}),$(Ze)!=="svelte-1m2jkw7"&&(Ze.textContent=zn),pt.forEach(d),Hn=_($e),on=A($e,"TD",{});var ht=m(on);je=A(ht,"BUTTON",{"data-svelte-h":!0}),$(je)!=="svelte-5alhx0"&&(je.textContent=et),ht.forEach(d),On=_($e),sn=A($e,"TD",{});var vt=m(sn);Je=A(vt,"BUTTON",{"data-svelte-h":!0}),$(Je)!=="svelte-1de77je"&&(Je.textContent=nt),vt.forEach(d),$e.forEach(d),Me.forEach(d),an.forEach(d),xn=_(Pe),un(Te.$$.fragment,Pe),Pe.forEach(d),this.h()},h(){B(n,"class","characterSide svelte-aelzqd"),B(t,"class","container svelte-aelzqd"),B(y,"class","commands svelte-aelzqd"),B(f,"class","container svelte-aelzqd"),B(f,"id","footer")},m(C,ne){T(C,t,ne),c(t,n),An(o,n,null),c(t,s),An(r,t,null),T(C,l,ne),T(C,f,ne),c(f,y),c(y,p),c(p,E),c(E,R),c(R,b),c(E,S),c(E,ie),c(ie,W),c(E,ye),c(E,Y),c(Y,z),c(E,ge),c(E,L),c(L,F),c(p,ke),c(p,U),c(U,Ce),c(Ce,K),c(U,We),c(U,V),c(U,Z),c(U,Qe),c(Qe,ee),c(U,Fe),c(U,le),c(le,oe),c(p,Ke),c(p,O),c(O,_e),c(_e,ce),c(O,Ve),c(O,we),c(we,se),c(O,nn),c(O,me),c(me,x),c(O,h),c(O,pe),c(pe,ue),c(p,qe),c(p,q),c(q,be),c(be,J),c(q,Xe),c(q,De),c(De,Ze),c(q,Hn),c(q,on),c(on,je),c(q,On),c(q,sn),c(sn,Je),c(f,xn),An(Te,f,null),En=!0,Ln||(tt=[P(window,"keydown",Ft(e[3])),P(b,"click",e[6]),P(W,"click",e[7]),P(z,"click",e[8]),P(F,"click",e[9]),P(K,"click",e[10]),P(ee,"click",e[11]),P(oe,"click",e[12]),P(ce,"click",e[13]),P(se,"click",e[14]),P(x,"click",e[15]),P(ue,"click",e[16]),P(J,"click",e[17]),P(Ze,"click",e[18]),P(je,"click",e[19]),P(Je,"click",e[20])],Ln=!0)},p(C,[ne]){const rn={};ne&1&&(rn.state=C[0]),o.$set(rn);const Pe={};!a&&ne&1&&(a=!0,Pe.state=C[0],Nn(()=>a=!1)),!i&&ne&2&&(i=!0,Pe.debugMode=C[1],Nn(()=>i=!1)),r.$set(Pe);const an={};!wn&&ne&1&&(wn=!0,an.state=C[0],Nn(()=>wn=!1)),Te.$set(an)},i(C){En||(ae(o.$$.fragment,C),ae(r.$$.fragment,C),ae(Te.$$.fragment,C),En=!0)},o(C){Ae(o.$$.fragment,C),Ae(r.$$.fragment,C),Ae(Te.$$.fragment,C),En=!1},d(C){C&&(d(t),d(l),d(f)),fn(o),fn(r),fn(Te),Ln=!1,Yt(tt)}}}function Ls(e,t,n){let o=Ho(),s=o.settings.debug;Dn(()=>{setInterval(()=>Po(o),1e3)});const r=()=>{n(1,s=!s),n(0,o.settings.debug=s,o)};function a(L){switch(L.key){case"6":case"d":G("R",o);break;case"9":case"e":G("UR",o);break;case"8":case"w":G("U",o);break;case"7":case"q":G("UL",o);break;case"4":case"a":G("L",o);break;case"1":case"z":G("DL",o);break;case"2":case"x":G("D",o);break;case"3":case"c":G("DR",o);break;case"0":case" ":Fn(o);break;case"-":case"r":Wn(o);break;case"+":case"f":Yn(o);break}}function i(L){o=L,n(0,o)}function l(L){s=L,n(1,s)}const f=()=>G("UL",o),y=()=>G("U",o),p=()=>G("UR",o),E=()=>Fn(o),R=()=>G("L",o),b=()=>G("R",o),xe=()=>Yn(o),S=()=>G("DL",o),ie=()=>G("D",o),W=()=>G("DR",o),Ee=()=>Wn(o),ye=()=>To(o),Y=()=>n(0,o=Ro()),z=()=>r(),fe=()=>lo(o);function ge(L){o=L,n(0,o)}return[o,s,r,a,i,l,f,y,p,E,R,b,xe,S,ie,W,Ee,ye,Y,z,fe,ge]}class Ns extends mn{constructor(t){super(),pn(this,t,Ls,ws,Se,{})}}export{Ns as component};
