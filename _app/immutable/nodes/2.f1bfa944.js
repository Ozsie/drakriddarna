import{s as Pe,n as ge,o as Ve,b as tn,f as nn,r as on,i as N}from"../chunks/scheduler.ba2ce6c0.js";import{S as Ze,i as je,g as B,h as m,j as k,f as E,k as Y,a as me,y as sn,r as bt,s as D,u as Ht,c as b,z as S,x as f,v as Ot,A as M,d as wt,t as St,w as _t}from"../chunks/index.8040907f.js";var O=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(O||{}),w=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(w||{}),K=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(K||{}),X=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(X||{}),Be=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.DOOR="Door",e.NOTE="Note",e))(Be||{}),Q=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(Q||{});const Mt=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1}],Pt=[{name:"Orch Sword/Bow",range:99,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4}],Nt=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4}],an="0",An="@",Me=" ",$e="#",ln=(e,t,o,n)=>({type:e,name:t,position:{x:o,y:n},found:!1}),U=(e,t,o)=>({side:e,x:t,y:o,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),Ut=(e,t,o)=>({...U(e,t,o),hidden:!0}),z=(e,t,o,n)=>{const a=Object.values(O).indexOf(t),l=Object.keys(O)[a];let g=K.LORD,C=2,d=2,u=4,h=4,I=4,L=Pt[0],x=Nt[0];switch(e){case w.ORCH:{g=K.APPRENTICE,d=0,u=2,h=2,I=1;break}case w.TROLL:{g=K.KNIGHT,d=1,u=3,h=3,I=2,L=Pt[1],x=Nt[1];break}}return e===w.YELLOW_DARK_LORD&&(C=3),{type:e,level:g,colour:t,actions:C,defense:d,health:u,maxHealth:h,experience:I,name:e+" ("+l+")",movement:3,position:{x:o,y:n},weapon:L,armour:x}},rn={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:X.KILL_ALL,fulfilled:!1},{type:X.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[U(Q.RIGHT,2,4),U(Q.RIGHT,5,4),U(Q.RIGHT,9,5),U(Q.RIGHT,12,5),U(Q.RIGHT,9,8),U(Q.RIGHT,12,8),U(Q.RIGHT,11,2),Ut(Q.UP,9,3),Ut(Q.RIGHT,15,1)],monsters:[z(w.ORCH,O.Blue,9,7),z(w.ORCH,O.Red,12,8),z(w.TROLL,O.Red,15,1),z(w.TROLL,O.Yellow,13,6)],secrets:[{type:Be.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:Be.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:Be.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item",item:{name:"Healing Herbs"}},{type:Be.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},Yt={name:"Troll cave",beaten:!1,winConditions:[{type:X.KILL_ALL,fulfilled:!1}],nextDungeon:rn,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[U(Q.RIGHT,3,9),U(Q.RIGHT,6,9),U(Q.UP,7,7),U(Q.UP,7,4)],monsters:[z(w.ORCH,O.Green,6,9),z(w.ORCH,O.Yellow,8,10),z(w.ORCH,O.Red,7,5),z(w.ORCH,O.Red,9,3),z(w.TROLL,O.Green,6,1)],secrets:[ln(Be.NOTE,"Welcome to Drakriddarna",2,9)],notes:[]},killCount:0},Gt=e=>{e.actionLog.push("Game saved."),localStorage.setItem("state",JSON.stringify(e))},cn=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(o=>{var n;return o.name===((n=t.currentActor)==null?void 0:n.name)}),t.actionLog.push("Game loaded."),t}},dn=()=>{const e=Xt;return zt(e,Yt),{heroes:e,dungeon:Yt,currentActor:e[0],actionLog:["Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."]}},_e=(e,t)=>(Mt[0].amountInDeck--,{name:e,actions:2,movement:3,defense:0,level:K.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Mt[0]}),Xt=[_e("Fearik",O.Yellow),_e("Helbran",O.Red),_e("Siedel",O.Green),_e("Wulf",O.Blue)],zt=(e,t)=>{e.forEach((o,n)=>o.position=t.startingPositions[n])},fe=e=>{let t=[];for(let o=0;o<e.length;o++)t.push(e[o]);return t},$t=(e,t,o)=>e.dungeon.layout.monsters.some(n=>n.position.x===t&&n.position.y===o&&n.health>0),Vt=(e,t,o)=>e.heroes.some(n=>n.position.x===t&&n.position.y===o),H=(e,t)=>{const o=t.currentActor;if(!o||o.actions===0)return;let n=o.position.x,a=o.position.y;switch(e){case"UL":n=o.position.x-1,a=o.position.y-1;break;case"U":a=o.position.y-1;break;case"UR":n=o.position.x+1,a=o.position.y-1;break;case"L":n=o.position.x-1;break;case"R":n=o.position.x+1;break;case"DL":n=o.position.x-1,a=o.position.y+1;break;case"D":a=o.position.y+1;break;case"DR":n=o.position.x+1,a=o.position.y+1;break}const l=Vt(t,n,a),g=!et(t.dungeon.layout,n,a),C=$t(t,n,a);if(!l&&!g){const d=tt(t.dungeon,n,a);d?d&&(C?un(o,t,n,a):Zt(o,t,n,a,1)):Bn(t,o,n,a)&&gn(o,t,n,a)}else t.actionLog.push(`${o.name} could not make that move`);o.movement===0&&(o.actions--,o.actions!==0&&(o.movement=3))},Zt=(e,t,o,n,a)=>{e.position.x=o,e.position.y=n;const l=t.dungeon.layout.notes.find(C=>qt(C.position,e.position));l&&(t.dungeon.layout.doors.some(d=>d.hidden&&qt(l.position,{x:d.x,y:d.y}))||t.actionLog.push(`${e.name} reads: ${l.message}`)),t.dungeon.layout.monsters.some(C=>nt(e.position,C.position.x,C.position.y))?(t.actionLog.push(`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=a},gn=(e,t,o,n)=>{const a=Ne(t.dungeon.layout.grid,o,n);a&&t.dungeon.discoveredRooms.push(a),Zt(e,t,e.position.x,e.position.y,1),t.actionLog.push(`${e.name} opened a door`)},un=(e,t,o,n)=>{var l;if(e.actions===1&&e.movement!==3){t.actionLog.push(`${e.name} has no actions left to attack`);return}const a=t.dungeon.layout.monsters.find(g=>g.position.x===o&&g.position.y===n);if(a){const g=((l=a.armour)==null?void 0:l.defense)??a.defense,C=be(e.level,e.weapon.dice),d=Math.max(C-g,0);t.actionLog.push(`${e.name} attacked ${a.name} with ${e.weapon.name} for ${ot(d,C,a)}`),a.health-=d,a.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(u=>u!=a),t.actionLog.push(`${e.name} killed ${a.name}`),t.dungeon.killCount++,e.experience+=a.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--}},be=(e,t)=>{let o=[];for(let n=0;n<t;n++)o.push(Math.floor(Math.random()*6)+1);switch(e){case K.APPRENTICE:o=o.filter(n=>n===5);break;case K.KNIGHT:case K.HERO:o=o.filter(n=>n>=4);break;case K.LORD:case K.MASTER:o=o.filter(n=>n>=3);break}return o.length},Kt=e=>{const t=e.currentActor;if(!t)return;if(!jt(t)){e.actionLog.push(`${t.name} has no actions left to pick lock`);return}const o=e.dungeon.layout.doors.find(n=>n.x===t.position.x&&n.y===t.position.y);o&&o.locked&&(be(t.level,1)>=1?(o.locked=!1,e.actionLog.push(`${t.name} managed to pick the lock`)):e.actionLog.push(`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=3)},xt=e=>{const t=e.currentActor;if(!t)return;if(!jt(t)){e.actionLog.push(`${t.name} has no actions left to search`);return}const o=be(t.level,1);if(o>=1){const n=e.dungeon.layout.doors.find(g=>g.hidden&&g.x===t.position.x&&g.y===t.position.y);n&&(e.actionLog.push(`${t.name} searched (${o}) and found a hidden door`),n.hidden=!1);const a=e.dungeon.layout.doors.find(g=>g.trapped&&g.x===t.position.x&&t.position.y);a&&!n&&(e.actionLog.push(`${t.name} searched (${o}) and found a trap in a door`),a.trapped=!1);const l=e.dungeon.layout.secrets.find(g=>nt(g.position,t.position.x,t.position.y));l&&!a&&!n&&e.actionLog.push(`${t.name} searched (${o}) and found ${l.name}`),!n&&!a&&!l&&e.actionLog.push(`${t.name} searched (${o}) but found nothing`)}else e.actionLog.push(`${t.name} searched (${o}) but found nothing`);t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=3},Ft=e=>{if(fn(e),e.currentActor!==void 0){e.actionLog.push(`${e.currentActor.name} ended their turn`);let o=e.heroes.indexOf(e.currentActor)+1;o===e.heroes.length&&(pn(e),o=0),e.currentActor.actions=2,e.currentActor.movement=3,e.currentActor=e.heroes[o],e.actionLog.push(`${e.currentActor.name} started their turn`)}},fn=e=>{e.dungeon.winConditions.forEach(t=>{var o;switch(t.type){case X.KILL_ALL:{const n=e.dungeon.layout.monsters.map(a=>a.health).reduce((a,l)=>a+l,0);t.fulfilled=n<=0;break}case X.REACH_CELL:{t.fulfilled=e.heroes.some(n=>{var a;return n.position.x===((a=t.targetCell)==null?void 0:a.x)&&n.position.y===t.targetCell.y});break}case X.KILL_ALL_OF_TYPE:{t.fulfilled=e.dungeon.layout.monsters.filter(n=>n.type===t.targetMonsterType).some(n=>n.health>0);break}case X.OPEN_DOOR:{t.fulfilled=((o=e.dungeon.layout.doors.find(n=>{var a,l;return n.x===((a=t.targetCell)==null?void 0:a.x)&&n.y===((l=t.targetCell)==null?void 0:l.y)}))==null?void 0:o.open)??!1;break}case X.KILL_AT_LEAST:{t.fulfilled=(t.killMinCount?t.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,o)=>t&&o,!0),e.dungeon.beaten&&(e.actionLog.push("All win conditions have been fulfilled"),e.actionLog.push(`You have cleared ${e.dungeon.name}`))},Bn=(e,t,o,n)=>{const a=e.dungeon.layout.doors.find(l=>l.x===t.position.x&&l.y===t.position.y);if(a&&!a.locked){const l=mn(t.position.x,t.position.y,o,n);if(a.side===l){if(a.open=!0,a.trapped){const g=be(K.APPRENTICE,a.trapAttacks),C=Math.max(g-t.defense,0);e.actionLog.push(`Door was trapped. ${t.name} took ${ot(C,g,t)}`),t.health-=C}return!0}}return a&&a.locked&&e.actionLog.push("Door is locked"),!1},mn=(e,t,o,n)=>{if(e===o){if(t>n)return Q.UP;if(t<n)return Q.DOWN}if(t===n){if(e>o)return Q.LEFT;if(e<o)return Q.RIGHT}},et=(e,t,o)=>{let n=!0;if(t<0||t>=e.grid[0].length||o<0||o>=e.grid.length)n=!1;else{const a=Ne(e.grid,t,o);(a===an||a===An||a===Me||a===$e)&&(n=!1)}return n},tt=(e,t,o)=>{const n=Ne(e.layout.grid,t,o);return n?e.discoveredRooms.includes(n):!1},Ne=(e,t,o)=>{let n;return e.forEach((a,l)=>{fe(a).forEach((g,C)=>{l===o&&C===t&&(n=g)})}),n},nt=(e,t,o)=>e.x===t&&e.y===o||e.x===t-1&&e.y===o||e.x===t-1&&e.y===o-1||e.x===t&&e.y===o-1||e.x===t+1&&e.y===o-1||e.x===t+1&&e.y===o||e.x===t+1&&e.y===o+1||e.x===t&&e.y===o+1||e.x===t-1&&e.y===o+1,pn=e=>{const t=e.dungeon.layout.monsters.filter(o=>{const n=Ne(e.dungeon.layout.grid,o.position.x,o.position.y);return n&&e.dungeon.discoveredRooms.includes(n)&&o.health>0});t.length===0&&e.actionLog.push("No monsters can act"),t.forEach(o=>{const n=o.actions;for(;o.actions>0;){e.actionLog.push(`${o.name} acted `);const a=e.heroes.filter(l=>nt(o.position,l.position.x,l.position.y));if(a.length>0){const l=Math.floor(Math.random()*a.length);Cn(e,o,a[l])}else hn(e,o)}o.actions=n})};function Wt(e,t){return Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2))}const hn=(e,t)=>{const o=e.heroes.map(a=>({hero:a,dist:Wt(a.position,t.position)})).sort((a,l)=>a.dist-l.dist)[0],n=En(e,t.position);if(n.length>0){const a=n.map(l=>({pos:l,dist:Wt(l,o.hero.position)})).sort((l,g)=>l.dist-g.dist)[0].pos;t.position=a,e.actionLog.push(`${t.name} moved towards ${o.hero.name} (${a.x},${a.y})`)}else e.actionLog.push(`${t.name} could not move`);t.actions--};let En=(e,t)=>{const o=t.x,n=t.y,a=[];for(let l=o-1;l<=o+1;l++)for(let g=n-1;g<=n+1;g++)l===o&&g===n||et(e.dungeon.layout,l,g)&&tt(e.dungeon,l,g)&&a.push({x:l,y:g});return a.filter(l=>!e.heroes.find(g=>g.position.x===l.x&&g.position.y===l.y)).filter(l=>!e.dungeon.layout.monsters.find(C=>C.position.x===l.x&&C.position.y===l.y))};const ot=(e,t,o)=>{var a;const n=((a=o.armour)==null?void 0:a.defense)??o.defense;return`${e} damage (${t}-${n}=${e})`},Cn=(e,t,o)=>{if(t.actions===1&&t.movement!==3){e.actionLog.push(`${o.name} has no actions left to attack`);return}if(o){const n=be(t.level,t.weapon.dice),a=Math.max(n-o.defense,0);e.actionLog.push(`${t.name} attacked ${o.name} with ${t.weapon.name} for ${ot(a,n,o)}`),o.health-=a,o.health<=0&&(e.actionLog.push(`${t.name} killed ${o.name}`),e.heroes=e.heroes.filter(l=>l!==o)),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--}},jt=e=>e.movement<3?e.actions>1:e.actions>0,qt=(e,t)=>e.x===t.x&&e.y===t.y,In="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABAKADAAQAAAABAAABAAAAAABn6hpJAAAGiklEQVR4Ae3dS47iMBAA0DDiDogT9g6JY7ELJ2IJnKKnMxpLSQRRHJzxRPWyCQZ/n1ulFiqT3eVy+W5mXs/nszkcDjNrN01u/dkd/63Y9Z973e/35ng85jb7qP7UmKfTafdR5xoT+EBg37V9PB6zurher83X19dq9WdNolepm0/udbvdmvP53LRtm9t0cf0aYy6erIahBH6FWq3FEiAwEBAABhwKBGIJCACx9ttqCQwEBIABhwKBWAICQKz9tloCAwEBYMChQCCWgAAQa7+tlsBAQAAYcCgQiCUgAMTab6slMBD4kwk4eKdwoUvXXZKxN3caXZZd7tWl5i5plztOv36NMfvje03glcDqAaA7O9ClD69xvTsLMJV7n+bRpQOXvJaO+XMWoOQ09EUgS2D1ANDNZu5Zg6yZ/1R+959Fjdz7GmPmeqlPYCzgO4CxiDKBQAICQKDNtlQCYwEBYCyiTCCQgAAQaLMtlcBYQAAYiygTCCQgAATabEslMBYQAMYiygQCCQgAgTbbUgmMBQSAsYgygUAC+9xc/bXr59q/y+mvkXtfY8xcL/UJ9AV2Oc8F6Dec87oLFms+R+DdWYCpuc3J2Z9qv+SzqTE9F2CJqDalBLKeC5A76NrPEXh3FmBqnjVy9muMOWXgMwJJwHcAScKdQEABASDgplsygSQgACQJdwIBBQSAgJtuyQSSgACQJNwJBBQQAAJuuiUTSAICQJJwJxBQQAAIuOmWTCAJCABJwp1AQIHsswD/m9G7swBT86yRs19jzCkDnxHoBPY1fre/JP3S3/df2q4/96kc/3699PrVmJ4LkHTcawj8k7MAay+sbdu1h3jZvxz/lyze3JCA7wA2tFmmSqC0gABQWlR/BDYkIABsaLNMlUBpAQGgtKj+CGxIQADY0GaZKoHSAgJAaVH9EdiQgACwoc0yVQKlBQSA0qL6I7AhAQFgQ5tlqgRKC6x+FmDt5wjUzrGvPX7pPwj9ESBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoJTAbwUM8lhPvL+bAAAAAElFTkSuQmCC",vn="data:image/png;base64,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";function yn(e){let t;return{c(){t=B("canvas"),this.h()},l(o){t=m(o,"CANVAS",{width:!0,height:!0,id:!0}),k(t).forEach(E),this.h()},h(){Y(t,"width","860"),Y(t,"height","750"),Y(t,"id","gameBoard")},m(o,n){me(o,t,n)},p:ge,i:ge,o:ge,d(o){o&&E(t)}}}const i=48;function kn(e,t,o){let{state:n}=t,{debugMode:a=!0}=t;Ve(()=>{const s=new Image;s.src=In;const A=new Image;A.src=vn,l(s,A),setInterval(()=>l(s,A),10)});const l=(s,A)=>{if(!n||!document)return;const c=document.getElementById("gameBoard"),r=c.getContext("2d");r.clearRect(0,0,c.width,c.height),n.dungeon.layout.grid.forEach((p,T)=>{fe(p).forEach((v,y)=>g(r,v,y,T,s))}),n.dungeon.layout.grid.forEach((p,T)=>{fe(p).forEach((v,y)=>C(r,v,y,T))}),n.dungeon.layout.grid.forEach((p,T)=>{fe(p).forEach((v,y)=>d(r,v,y,T))}),n.dungeon.layout.grid.forEach((p,T)=>{fe(p).forEach((v,y)=>W(r,v,y,T,A))}),x(r,n.currentActor),L(r,n.currentActor)},g=(s,A,c,r,p)=>{pe(A)||!n.dungeon.discoveredRooms.includes(A)&&A!==Me?n.dungeon.discoveredRooms.some(T=>q(c,r,T))&&s.drawImage(p,48,0,48,48,c*i,r*i,i,i):ue(A)?(s.beginPath(),s.strokeStyle="black",s.fillStyle="black",s.fillRect(c*i,r*i,i,i),s.stroke()):s.drawImage(p,0,0,48,48,c*i,r*i,i,i)},C=(s,A,c,r)=>{A===Me||A===$e||(s.beginPath(),s.strokeStyle="black",s.rect(c*i,r*i,i,i),a&&(s.font="7px Arial",s.fillText(c+","+r,c*i+3,r*i+(i-3))),s.stroke())},d=(s,A,c,r)=>{const p=te(c,r);if(p&&!p.hidden&&!p.open&&!ue(A))switch(s.fillStyle="brown",p.side){case Q.RIGHT:{s.fillRect(c*i+(i-2),r*i,4,i),p.locked&&a&&(s.fillStyle="grey",s.fillRect(c*i+(i-4),r*i+(i/2-4),8,8)),p.trapped&&a&&(s.fillStyle="red",s.fillRect(c*i+(i-4),r*i+(i/2-4),4,4));break}case Q.LEFT:{s.fillRect(c*i-2,r*i,4,i),p.locked&&a&&(s.fillStyle="grey",s.fillRect(c*i-4,r*i+(i/2-4),8,8)),p.trapped&&a&&(s.fillStyle="red",s.fillRect(c*i-4,r*i+(i/2-4),4,4));break}case Q.UP:{s.fillRect(c*i,r*i-2,i,4),p.locked&&a&&(s.fillStyle="grey",s.fillRect(c*i+(i/2-4),r*i-4,8,8)),p.trapped&&a&&(s.fillStyle="red",s.fillRect(c*i+(i/2-4),r*i-4,4,4));break}case Q.DOWN:{s.fillRect(c*i,r*i+(i-2),i,4),p.locked&&a&&(s.fillStyle="grey",s.fillRect(c*i+(i/2-4),r*i+(i-4),8,8)),p.trapped&&a&&(s.fillStyle="red",s.fillRect(c*i+(i/2-4),r*i+(i-4),4,4));break}}},u=(s,A,c,r)=>{s.beginPath(),s.strokeStyle=A.colour,s.fillStyle=A.colour,s.fillRect(c*i+4,r*i+(i-6),i-8,4),s.stroke()},h=(s,A,c,r)=>{a&&c.forEach(p=>{const T=A.position.x,v=A.position.y,y=p.position.x,$=p.position.y;s.strokeStyle=A.colour,s.beginPath(),s.moveTo(T*i+i/2,v*i+i/2),s.lineTo(y*i+i/2,$*i+i/2),s.stroke()})},I=(s,A,c,r)=>{s.beginPath(),s.strokeStyle="black",s.fillStyle="red",s.fillRect(c*i+4,r*i,i-8,4),s.fillStyle="green",s.fillRect(c*i+4,r*i,(i-8)*(A.health/A.maxHealth),4),s.rect(c*i+4,r*i,i-8,4),s.stroke()},L=(s,A)=>{A===n.currentActor&&(s.beginPath(),s.strokeStyle="lightblue",s.lineWidth=2,s.moveTo(A.position.x*i,A.position.y*i),s.lineTo(A.position.x*i+i/3,A.position.y*i),s.moveTo(A.position.x*i,A.position.y*i),s.lineTo(A.position.x*i,A.position.y*i+i/3),s.moveTo(A.position.x*i+i,A.position.y*i),s.lineTo(A.position.x*i+i/3*2,A.position.y*i),s.moveTo(A.position.x*i+i,A.position.y*i),s.lineTo(A.position.x*i+i,A.position.y*i+i/3),s.moveTo(A.position.x*i,A.position.y*i+i),s.lineTo(A.position.x*i,A.position.y*i+i/3*2),s.moveTo(A.position.x*i,A.position.y*i+i),s.lineTo(A.position.x*i+i/3,A.position.y*i+i),s.moveTo(A.position.x*i+i,A.position.y*i+i),s.lineTo(A.position.x*i+i,A.position.y*i+i/3*2),s.moveTo(A.position.x*i+i,A.position.y*i+i),s.lineTo(A.position.x*i+i/3*2,A.position.y*i+i),s.stroke(),s.lineWidth=1)},x=(s,A)=>{if(A===n.currentActor&&a){for(let c=A.position.x-A.movement;c<=A.position.x+A.movement;c++)for(let r=A.position.y-A.movement;r<=A.position.y+A.movement;r++)if(tt(n.dungeon,c,r)){const T=$t(n,c,r),v=Vt(n,c,r),y=et(n.dungeon.layout,c,r);!v&&!T&&y&&(s.fillStyle="rgba(50, 50, 255, 0.08)",s.fillRect(c*i,r*i,i,i),s.stroke())}}},W=(s,A,c,r,p)=>{s.beginPath();const T=n.heroes.find(v=>v.position.x===c&&v.position.y===r);if(T)s.drawImage(p,4*16,0,16,16,c*i,r*i,i,i),u(s,T,c,r),I(s,T,c,r);else{const v=n.dungeon.layout.monsters.find(y=>y.position.x===c&&y.position.y===r);if(v&&v.health>0&&!ue(A)){switch(v.type){case w.ORCH:s.drawImage(p,i,16,16,16,c*i,r*i,i,i);break;case w.TROLL:s.drawImage(p,i,16,16,16,c*i,r*i,i,i);break;default:s.drawImage(p,16,16,16,16,c*i,r*i,i,i);break}u(s,v,c,r),I(s,v,c,r),h(s,v,n.heroes)}}},ue=s=>s===Me||!n.dungeon.discoveredRooms.includes(s),pe=s=>s===$e,te=(s,A)=>n.dungeon.layout.doors.find(c=>c.x===s&&c.y===A),q=(s,A,c)=>{if(!n)return;const r=Math.max(s-1,0),p=Math.max(A-1,0),T=Math.min(s+1,n.dungeon.layout.grid.length),v=Math.min(A+1,n.dungeon.layout.grid[0].length);for(let y=r;y<=T;y++)for(let $=p;$<=v;$++){const he=n.dungeon.layout.grid[$];if(fe(he)[y]===c)return!0}return!1};return e.$$set=s=>{"state"in s&&o(0,n=s.state),"debugMode"in s&&o(1,a=s.debugMode)},[n,a]}class Tn extends Ze{constructor(t){super(),je(this,t,kn,yn,Pe,{state:0,debugMode:1})}}function Qn(e){let t;return{c(){t=B("canvas"),this.h()},l(o){t=m(o,"CANVAS",{id:!0,height:!0,width:!0}),k(t).forEach(E),this.h()},h(){Y(t,"id","characterBoard"),Y(t,"height","750"),Y(t,"width","260")},m(o,n){me(o,t,n)},p:ge,i:ge,o:ge,d(o){o&&E(t)}}}const F=180;function Ln(e,t,o){let{state:n}=t;Ve(()=>{a(),setInterval(a,100)});const a=()=>{if(!n||!document)return;const d=document.getElementById("characterBoard"),u=d.getContext("2d");u.clearRect(0,0,d.width,d.height),u.stroke(),n.heroes.forEach((h,I)=>{l(u,d,h,I),g(u,h,I),C(u,h,I)})},l=(d,u,h,I)=>{d.fillStyle=h.colour,d.fillRect(12,I*F+12,u.width,F-12),d.stroke(),d.fillStyle="black"},g=(d,u,h)=>{const L=(u===n.currentActor?"> "+u.name:u.name)+" - "+u.level+" ("+u.experience+")";d.strokeStyle="black",d.font="18px Arial",d.fillText(L,16,h*F+30),d.fillText("HP: "+u.health,16,h*F+50),d.fillText("Actions: "+u.actions,16,h*F+70),d.fillText("Moves: "+u.movement,16,h*F+90),d.stroke()},C=(d,u,h)=>{d.fillText("Equipment",16,h*F+110),d.font="12px Arial",d.fillText("🗡️ "+u.weapon.name+" ("+u.weapon.dice+")",16,h*F+125);let I="None (0)",L="None (0)";u.armour&&(I=u.armour.name+" ("+u.armour.defense+")"),u.shield&&(L=u.shield.name+" ("+u.armour.dice+")"),d.fillText("🧱 "+I,16,h*F+142),d.fillText("🛡️ "+L,16,h*F+159)};return e.$$set=d=>{"state"in d&&o(0,n=d.state)},[n]}class Rn extends Ze{constructor(t){super(),je(this,t,Ln,Qn,Pe,{state:0})}}function Jt(e){let t,o='<canvas width="860" height="100" id="logs"></canvas>';return{c(){t=B("div"),t.innerHTML=o,this.h()},l(n){t=m(n,"DIV",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-xcon9n"&&(t.innerHTML=o),this.h()},h(){Y(t,"class","log svelte-60nygp")},m(n,a){me(n,t,a)},p:ge,d(n){n&&E(t)}}}function Dn(e){let t,o,n,a,l,g,C,d,u,h,I,L,x,W,ue="UL",pe,te,q,s="U",A,c,r,p="UR",T,v,y,$="Next",he,P,Ee,ne,it="L",Ue,He,Ye,Ce,oe,st="R",Ge,Ie,ie,at="Search",Ke,G,ve,se,At="DL",xe,ye,ae,lt="D",Fe,ke,Ae,rt="DR",We,Te,le,ct="Pick lock",qe,re,Qe,ce,dt="Save",Je,Le,de,gt="Load",Xe,ut=e[0].actionLog,Oe,ze,ft;n=new Rn({props:{state:e[0]}});function en(R){e[1](R)}let Bt={};e[0]!==void 0&&(Bt.state=e[0]),g=new Tn({props:Bt}),tn.push(()=>sn(g,"state",en));let J=Jt();return{c(){t=B("div"),o=B("div"),bt(n.$$.fragment),a=D(),l=B("div"),bt(g.$$.fragment),d=D(),u=B("div"),h=B("div"),I=B("table"),L=B("tr"),x=B("td"),W=B("button"),W.textContent=ue,pe=D(),te=B("td"),q=B("button"),q.textContent=s,A=D(),c=B("td"),r=B("button"),r.textContent=p,T=D(),v=B("td"),y=B("button"),y.textContent=$,he=D(),P=B("tr"),Ee=B("td"),ne=B("button"),ne.textContent=it,Ue=D(),He=B("td"),Ye=D(),Ce=B("td"),oe=B("button"),oe.textContent=st,Ge=D(),Ie=B("td"),ie=B("button"),ie.textContent=at,Ke=D(),G=B("tr"),ve=B("td"),se=B("button"),se.textContent=At,xe=D(),ye=B("td"),ae=B("button"),ae.textContent=lt,Fe=D(),ke=B("td"),Ae=B("button"),Ae.textContent=rt,We=D(),Te=B("td"),le=B("button"),le.textContent=ct,qe=D(),re=B("tr"),Qe=B("td"),ce=B("button"),ce.textContent=dt,Je=D(),Le=B("td"),de=B("button"),de.textContent=gt,Xe=D(),J.c(),this.h()},l(R){t=m(R,"DIV",{class:!0});var _=k(t);o=m(_,"DIV",{class:!0});var Re=k(o);Ht(n.$$.fragment,Re),Re.forEach(E),a=b(_),l=m(_,"DIV",{class:!0});var De=k(l);Ht(g.$$.fragment,De),De.forEach(E),_.forEach(E),d=b(R),u=m(R,"DIV",{class:!0});var we=k(u);h=m(we,"DIV",{class:!0});var mt=k(h);I=m(mt,"TABLE",{});var V=k(I);L=m(V,"TR",{});var Z=k(L);x=m(Z,"TD",{});var pt=k(x);W=m(pt,"BUTTON",{"data-svelte-h":!0}),S(W)!=="svelte-fw3uxo"&&(W.textContent=ue),pt.forEach(E),pe=b(Z),te=m(Z,"TD",{});var ht=k(te);q=m(ht,"BUTTON",{"data-svelte-h":!0}),S(q)!=="svelte-1jeoia6"&&(q.textContent=s),ht.forEach(E),A=b(Z),c=m(Z,"TD",{});var Et=k(c);r=m(Et,"BUTTON",{"data-svelte-h":!0}),S(r)!=="svelte-1p8c8vc"&&(r.textContent=p),Et.forEach(E),T=b(Z),v=m(Z,"TD",{});var Ct=k(v);y=m(Ct,"BUTTON",{"data-svelte-h":!0}),S(y)!=="svelte-1rtxc14"&&(y.textContent=$),Ct.forEach(E),Z.forEach(E),he=b(V),P=m(V,"TR",{});var j=k(P);Ee=m(j,"TD",{});var It=k(Ee);ne=m(It,"BUTTON",{"data-svelte-h":!0}),S(ne)!=="svelte-10dnpu6"&&(ne.textContent=it),It.forEach(E),Ue=b(j),He=m(j,"TD",{}),k(He).forEach(E),Ye=b(j),Ce=m(j,"TD",{});var vt=k(Ce);oe=m(vt,"BUTTON",{"data-svelte-h":!0}),S(oe)!=="svelte-12287ni"&&(oe.textContent=st),vt.forEach(E),Ge=b(j),Ie=m(j,"TD",{});var yt=k(Ie);ie=m(yt,"BUTTON",{"data-svelte-h":!0}),S(ie)!=="svelte-cps1bu"&&(ie.textContent=at),yt.forEach(E),j.forEach(E),Ke=b(V),G=m(V,"TR",{});var ee=k(G);ve=m(ee,"TD",{});var kt=k(ve);se=m(kt,"BUTTON",{"data-svelte-h":!0}),S(se)!=="svelte-1ji074i"&&(se.textContent=At),kt.forEach(E),xe=b(ee),ye=m(ee,"TD",{});var Tt=k(ye);ae=m(Tt,"BUTTON",{"data-svelte-h":!0}),S(ae)!=="svelte-li5tq6"&&(ae.textContent=lt),Tt.forEach(E),Fe=b(ee),ke=m(ee,"TD",{});var Qt=k(ke);Ae=m(Qt,"BUTTON",{"data-svelte-h":!0}),S(Ae)!=="svelte-3esmwe"&&(Ae.textContent=rt),Qt.forEach(E),We=b(ee),Te=m(ee,"TD",{});var Lt=k(Te);le=m(Lt,"BUTTON",{"data-svelte-h":!0}),S(le)!=="svelte-sacog4"&&(le.textContent=ct),Lt.forEach(E),ee.forEach(E),qe=b(V),re=m(V,"TR",{});var Se=k(re);Qe=m(Se,"TD",{});var Rt=k(Qe);ce=m(Rt,"BUTTON",{"data-svelte-h":!0}),S(ce)!=="svelte-1vr5zyk"&&(ce.textContent=dt),Rt.forEach(E),Je=b(Se),Le=m(Se,"TD",{});var Dt=k(Le);de=m(Dt,"BUTTON",{"data-svelte-h":!0}),S(de)!=="svelte-1m2jkw7"&&(de.textContent=gt),Dt.forEach(E),Se.forEach(E),V.forEach(E),mt.forEach(E),Xe=b(we),J.l(we),we.forEach(E),this.h()},h(){Y(o,"class","characterSide svelte-60nygp"),Y(l,"class","boardSide svelte-60nygp"),Y(t,"class","container svelte-60nygp"),Y(h,"class","commands svelte-60nygp"),Y(u,"class","container svelte-60nygp")},m(R,_){me(R,t,_),f(t,o),Ot(n,o,null),f(t,a),f(t,l),Ot(g,l,null),me(R,d,_),me(R,u,_),f(u,h),f(h,I),f(I,L),f(L,x),f(x,W),f(L,pe),f(L,te),f(te,q),f(L,A),f(L,c),f(c,r),f(L,T),f(L,v),f(v,y),f(I,he),f(I,P),f(P,Ee),f(Ee,ne),f(P,Ue),f(P,He),f(P,Ye),f(P,Ce),f(Ce,oe),f(P,Ge),f(P,Ie),f(Ie,ie),f(I,Ke),f(I,G),f(G,ve),f(ve,se),f(G,xe),f(G,ye),f(ye,ae),f(G,Fe),f(G,ke),f(ke,Ae),f(G,We),f(G,Te),f(Te,le),f(I,qe),f(I,re),f(re,Qe),f(Qe,ce),f(re,Je),f(re,Le),f(Le,de),f(u,Xe),J.m(u,null),Oe=!0,ze||(ft=[M(W,"click",function(){N(H("UL",e[0]))&&H("UL",e[0]).apply(this,arguments)}),M(q,"click",function(){N(H("U",e[0]))&&H("U",e[0]).apply(this,arguments)}),M(r,"click",function(){N(H("UR",e[0]))&&H("UR",e[0]).apply(this,arguments)}),M(y,"click",function(){N(Ft(e[0]))&&Ft(e[0]).apply(this,arguments)}),M(ne,"click",function(){N(H("L",e[0]))&&H("L",e[0]).apply(this,arguments)}),M(oe,"click",function(){N(H("R",e[0]))&&H("R",e[0]).apply(this,arguments)}),M(ie,"click",function(){N(xt(e[0]))&&xt(e[0]).apply(this,arguments)}),M(se,"click",function(){N(H("DL",e[0]))&&H("DL",e[0]).apply(this,arguments)}),M(ae,"click",function(){N(H("D",e[0]))&&H("D",e[0]).apply(this,arguments)}),M(Ae,"click",function(){N(H("DR",e[0]))&&H("DR",e[0]).apply(this,arguments)}),M(le,"click",function(){N(Kt(e[0]))&&Kt(e[0]).apply(this,arguments)}),M(ce,"click",function(){N(Gt(e[0]))&&Gt(e[0]).apply(this,arguments)}),M(de,"click",e[2])],ze=!0)},p(R,[_]){e=R;const Re={};_&1&&(Re.state=e[0]),n.$set(Re);const De={};!C&&_&1&&(C=!0,De.state=e[0],nn(()=>C=!1)),g.$set(De),_&1&&Pe(ut,ut=e[0].actionLog)?(J.d(1),J=Jt(),J.c(),J.m(u,null)):J.p(e,_)},i(R){Oe||(wt(n.$$.fragment,R),wt(g.$$.fragment,R),Oe=!0)},o(R){St(n.$$.fragment,R),St(g.$$.fragment,R),Oe=!1},d(R){R&&(E(t),E(d),E(u)),_t(n),_t(g),J.d(R),ze=!1,on(ft)}}}function bn(e,t,o){let n=dn();Ve(()=>{l(),setInterval(l,500),setInterval(a,1e3)});const a=()=>{if(n.dungeon.beaten&&n.dungeon.nextDungeon){o(0,n.dungeon=n.dungeon.nextDungeon,n);const d=Xt.filter(u=>!n.heroes.find(h=>u.name===h.name));n.heroes.push(...d),zt(n.heroes,n.dungeon),o(0,n.actionLog=[],n),n.actionLog.push("You have reached "+n.dungeon.name)}},l=()=>{if(!n||!document)return;const d=document.getElementById("logs"),u=d.getContext("2d");u.clearRect(0,0,d.width,d.height),n.actionLog.slice(-10).reverse().forEach((h,I)=>{u.font="12px Arial",u.fillStyle="black",u.fillText("> "+h,2,(I+1)*12+2),u.stroke()})};function g(d){n=d,o(0,n)}return[n,g,()=>o(0,n=cn())]}class wn extends Ze{constructor(t){super(),je(this,t,bn,Dn,Pe,{})}}export{wn as component};
