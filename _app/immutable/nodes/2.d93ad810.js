import{s as ze,n as pe,o as Ht,b as Gt,f as $t,r as Vn,i as z}from"../chunks/scheduler.ba2ce6c0.js";import{S as ht,i as vt,g as c,h as A,j as m,f as d,k as b,a as T,x as u,y as M,m as I,s as Q,n as E,c as C,z as G,l as yn,o as ee,e as me,d as se,p as Vt,b as qt,t as ce,A as Ln,r as At,u as ft,v as gt,w as pt,B as Wt,C as qn}from"../chunks/index.6f434070.js";function Qt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var P=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(P||{}),K=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(K||{}),N=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(N||{}),De=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(De||{}),ge=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(ge||{}),_=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(_||{}),H=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e))(H||{});const Ft=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Yt=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Xn=[{name:"Chain mail",type:H.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],kn=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0}],jn="0",Pn="@",Xt=" ",Ot="#",Zn=(e,n,t,o)=>({type:e,name:n,position:{x:t,y:o},found:!1}),oe=(e,n,t)=>({side:e,x:n,y:t,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),Qn=(e,n,t)=>({...oe(e,n,t),hidden:!0}),Re=(e,n,t,o)=>{const s=Object.values(P).indexOf(n),r=Object.keys(P)[s];let a=N.LORD,i=2,l=2,f=4,p=4,h=4,y=Yt[0],D,x=kn[0];switch(e){case K.ORCH:{a=N.APPRENTICE,l=0,f=2,p=2,h=1,D=Yt[1];break}case K.TROLL:{a=N.KNIGHT,l=1,f=3,p=3,h=2,y=Yt[2],x=kn[1];break}}return e===K.YELLOW_DARK_LORD&&(i=3),{type:e,level:a,colour:n,actions:i,defense:l,health:f,maxHealth:p,experience:h,name:e+" ("+r+")",movement:3,maxMovement:3,position:{x:t,y:o},weapon:y,armour:x,incapacitated:!1,inventory:[],rangedWeapon:D}},Jn=e=>{const n=e.currentActor,t=bt(n.level,1);let o,s,r,a;t>=1?(o=lo(e,n,t),o||(s=oo(e,n,t)),!o&&!s&&(r=so(e,n,t)),!o&&!s&&!r&&(a=ro(e,n,t)),!o&&!s&&!r&&!a&&g(e,`${n.name} searched but found nothing`)):g(e,`${n.name} searched but found nothing`)},Mn=e=>{const n=e.currentActor;if(!n)return!1;const t=e.dungeon.layout.secrets.filter(o=>o.type===ge.TRAP_DOOR).filter(o=>!o.found).find(o=>Kt(o.position,n.position));return t?(Et(e,Sn(t),n),g(e,`${n.name} fell into a pit and is incapacitated for one turn.`),n.movement=0,n.actions=0,n.incapacitated=!0,t.found=!0,!0):!1},Sn=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:P.Red,maxHealth:0,name:"Trap Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),zn=(e,n)=>e.dungeon.layout.doors.filter(t=>t.hidden).find(t=>st({x:t.x,y:t.y},n.x,n.y)),eo=(e,n)=>e.dungeon.layout.doors.filter(t=>t.trapped).find(t=>t.x===n.x&&t.y===n.y),to=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).find(t=>st(t.position,n.x,n.y)),no=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).filter(t=>t.type===ge.TRAP_DOOR).find(t=>st(t.position,n.x,n.y)),oo=(e,n,t)=>zn(e,n.position)?(g(e,`${n.name} searched (${t}) and found a hidden door`),!0):!1,so=(e,n,t)=>{const o=eo(e,n.position);return o?(g(e,`${n.name} searched (${t}) and found a trap in a door`),o.trapped=!1,!0):!1},ro=(e,n,t)=>{const o=to(e,n.position);if(o){switch(g(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,o.type){case ge.EQUIPMENT:{let s=o.item??ao(e);switch(io(e,s),g(e,`${n.name} equipped (${s.name})`),s.type){case H.ARMOUR:n.armour&&n.inventory.push(n.armour),n.armour=s;break;case H.SHIELD:n.shield&&n.inventory.push(n.shield),n.shield=s;break;case H.WEAPON:n.weapon&&n.inventory.push(n.weapon),n.weapon=s;break}}}return!0}return!1},ao=e=>{const n=e.itemDeck.length,t=Math.floor(Math.random()*n);return e.itemDeck[t]},io=(e,n)=>{const t=e.itemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.itemDeck.splice(t,1)},lo=(e,n,t)=>{const o=no(e,n.position);return o?(g(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,!0):!1},Nn={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:De.KILL_ALL,fulfilled:!1},{type:De.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[oe(_.RIGHT,2,4),oe(_.RIGHT,5,4),oe(_.RIGHT,9,5),oe(_.RIGHT,12,5),oe(_.RIGHT,9,8),oe(_.RIGHT,12,8),oe(_.RIGHT,11,2),Qn(_.UP,9,3),Qn(_.RIGHT,15,1)],monsters:[Re(K.ORCH,P.Blue,9,7),Re(K.ORCH,P.Red,12,8),Re(K.TROLL,P.Red,15,1),Re(K.TROLL,P.Yellow,13,6)],secrets:[{type:ge.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:ge.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:ge.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item"},{type:ge.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},uo={name:"Troll cave",beaten:!1,winConditions:[{type:De.KILL_ALL,fulfilled:!1}],nextDungeon:Nn,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[oe(_.RIGHT,3,9),oe(_.RIGHT,6,9),oe(_.UP,7,7),oe(_.UP,7,4)],monsters:[Re(K.ORCH,P.Green,6,9),Re(K.ORCH,P.Yellow,8,10),Re(K.ORCH,P.Red,7,5),Re(K.ORCH,P.Red,9,3),Re(K.TROLL,P.Green,6,1)],secrets:[Zn(ge.NOTE,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},co=[{name:"Large shield",type:H.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:H.SHIELD,amountInDeck:2,dice:1,value:1}],kt=(e,n)=>(Ft[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:N.APPRENTICE,health:7,maxHealth:7,colour:n,experience:0,position:{x:-1,y:-1},weapon:Ft[0],incapacitated:!1,inventory:[]}),Ao=()=>{const e=[];return Ft.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),Xn.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),co.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},dt={name:"Treasure of the Ice Dragon",dungeons:[uo,Nn],itemDeck:Ao(),heroes:[kt("Fearik",P.Yellow),kt("Helbran",P.Red),kt("Siedel",P.Green),kt("Wulf",P.Blue)]},fo=e=>{const n=Io(e);n.length===0&&g(e,"No monsters can act"),n.forEach(t=>{e.currentActor=t;const o=t.actions;for(g(e,`${t.name} acted `);t.actions>0;){const s=ho(e,t),r=vo(e,t);switch(go(e,t,s,r)){case"MELEE_ATTACK":{const i=mo(s);Cn(e,t,i,!1);break}case"RANGED_ATTACK":{const i=po(r,t);Cn(e,t,i,!0);break}case"MOVE":{yo(e,t);break}}t.movement=Te(t)}t.actions=o,t.movement=Te(t)})},go=(e,n,t,o)=>t.length>0?"MELEE_ATTACK":n.rangedWeapon&&o.length>0&&n.rangedWeapon?Math.random()<.1?(g(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":"MOVE",po=(e,n)=>e.filter(t=>!t.shield).sort(t=>mt(n.position,t.position)).sort((t,o)=>o.health-t.health||mt(n.position,t.position)-mt(n.position,o.position))[0],mo=e=>e.sort((n,t)=>t.health-n.health)[0],ho=(e,n)=>L(e).filter(t=>st(n.position,t.position.x,t.position.y)),vo=(e,n)=>L(e).filter(t=>{const o={x:n.position.x*48-24,y:n.position.y*48-24},s={x:t.position.x*48-24,y:t.position.y*48-24};return zt(o,n.position,s,t.position,e,[])}),Io=e=>e.dungeon.layout.monsters.filter(n=>{const t=It(e.dungeon.layout.grid,n.position.x,n.position.y);return t&&e.dungeon.discoveredRooms.includes(t)&&n.health>0}),Cn=(e,n,t,o)=>{Et(e,n,t,o),(n==null?void 0:n.actions)>1&&(n==null?void 0:n.movement)<3?n.actions-=2:n.actions--},Eo=(e,n)=>L(e).map(t=>({hero:t,dist:mt(t.position,n.position)})).sort((t,o)=>t.dist-o.dist)[0],yo=(e,n)=>{const t=Eo(e,n);for(;n.movement>0;){if(t.dist>1){const o=ko(e,n.position);if(o.length>0){const s=o.map(r=>({pos:r,dist:mt(r,t.hero.position)})).sort((r,a)=>r.dist-a.dist)[0].pos;n.position=s,g(e,`${n.name} moved towards ${t.hero.name} (${s.x},${s.y})`)}else g(e,`${n.name} could not move`)}n.movement--}n.actions--},ko=(e,n)=>{const t=n.x,o=n.y,s=[];for(let r=t-1;r<=t+1;r++)for(let a=o-1;a<=o+1;a++)r===t&&a===o||wt(e.dungeon.layout,r,a)&&St(e.dungeon,r,a)&&s.push({x:r,y:a});return s.filter(r=>!L(e).find(a=>a.position.x===r.x&&a.position.y===r.y)).filter(r=>!e.dungeon.layout.monsters.some(a=>a.position.x===r.x&&a.position.y===r.y))},bn=e=>{g(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Qo=()=>{const e=localStorage.getItem("state");if(e){const n=JSON.parse(e);return n.currentActor=n.heroes.find(t=>{var o;return t.name===((o=n.currentActor)==null?void 0:o.name)}),g(n,"Game loaded."),n}},Co=()=>{const e={heroes:dt.heroes,dungeon:dt.dungeons[0],currentActor:dt.heroes[0],actionLog:[`Playing '${dt.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:bo(dt.itemDeck)};return xn(e),e},bo=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},xn=e=>{e.heroes.forEach((n,t)=>{n.position=e.dungeon.startingPositions[t],n.movement=Te(n),n.actions=2,n.health=n.maxHealth})},jt=e=>{let n=[];for(let t=0;t<e.length;t++)n.push(e[t]);return n},Zt=(e,n,t)=>e.dungeon.layout.monsters.some(o=>o.position.x===n&&o.position.y===t&&o.health>0),Jt=(e,n,t)=>L(e).some(o=>o.position.x===n&&o.position.y===t),Ct=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=Te(e))),e.actions==0&&(e.movement=0)},R=(e,n)=>{const t=n.currentActor;if(!t||t.actions===0)return;let o=t.position.x,s=t.position.y;switch(e){case"UL":o=t.position.x-1,s=t.position.y-1;break;case"U":s=t.position.y-1;break;case"UR":o=t.position.x+1,s=t.position.y-1;break;case"L":o=t.position.x-1;break;case"R":o=t.position.x+1;break;case"DL":o=t.position.x-1,s=t.position.y+1;break;case"D":s=t.position.y+1;break;case"DR":o=t.position.x+1,s=t.position.y+1;break}const r=Jt(n,o,s),a=!wt(n.dungeon.layout,o,s),i=Zt(n,o,s);if(!r&&!a){const l=St(n.dungeon,o,s);l?l&&(i?Gn(t,n,o,s):Un(t,n,o,s,1)):Bo(n,t,o,s)&&ct(t,n,o,s)}else g(n,`${t.name} could not make that move`);Mn(n)||Ct(t)},Un=(e,n,t,o,s)=>{e.position.x=t,e.position.y=o;const r=n.dungeon.layout.notes.find(i=>Kt(i.position,e.position));r&&(n.dungeon.layout.doors.some(l=>l.hidden&&Kt(r.position,{x:l.x,y:l.y}))||g(n,`${e.name} reads: ${r.message}`)),n.dungeon.layout.monsters.some(i=>st(e.position,i.position.x,i.position.y))?(g(n,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=s},ct=(e,n,t,o)=>{const s=It(n.dungeon.layout.grid,t,o);s&&n.dungeon.discoveredRooms.push(s),Un(e,n,e.position.x,e.position.y,1),g(n,`${e.name} opened a door`)},Gn=(e,n,t,o)=>{if(e.actions===1&&e.movement!==3){g(n,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&L(n).filter(a=>a!==e).filter(a=>st(e.position,a.position.x,a.position.y)).length>0){g(n,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const s=n.dungeon.layout.monsters.find(r=>r.position.x===t&&r.position.y===o);s&&(Et(n,e,s,!1),s.health<=0&&(n.dungeon.layout.monsters=n.dungeon.layout.monsters.filter(r=>r!=s),g(n,`${e.name} killed ${s.name}`),n.dungeon.killCount++,e.experience+=s.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},bt=(e,n)=>{let t=[];for(let o=0;o<n;o++)t.push(Math.floor(Math.random()*6)+1);switch(e){case N.APPRENTICE:t=t.filter(o=>o===5);break;case N.KNIGHT:case N.HERO:t=t.filter(o=>o>=4);break;case N.LORD:case N.MASTER:t=t.filter(o=>o>=3);break}return t.length},_n=e=>{const n=e.currentActor;n&&(n.actions--,n.movement=Te(n),n.actions===0&&Dt(e))},_t=e=>{const n=e.currentActor;if(!n)return;if(!Rt(n)){g(e,`${n.name} has no actions left to pick lock`);return}const t=e.dungeon.layout.doors.find(o=>o.x===n.position.x&&o.y===n.position.y);t&&t.locked&&(bt(n.level,1)>=1?(t.locked=!1,g(e,`${n.name} managed to pick the lock`)):g(e,`${n.name} failed to pick the lock`),n.actions>1&&n.movement<3?n.actions-=2:n.actions--,n.movement=Te(n),n.actions==0&&(n.movement=0))},Te=e=>{var n;return e.maxMovement-(((n=e.armour)==null?void 0:n.movementReduction)??0)},Bt=e=>{const n=e.currentActor;if(n){if(!Rt(n)){g(e,`${n.name} has no actions left to search`);return}Jn(e),n.actions>1&&n.movement<Te(n)?n.actions-=2:n.actions--,n.actions==0&&(n.movement=0)}},Dt=e=>{if(_o(e),e.currentActor!==void 0){g(e,`${e.currentActor.name} ended their turn`);let t=L(e).indexOf(e.currentActor)+1;t===L(e).length&&(fo(e),t=0),L(e)[t].incapacitated&&(g(e,`${L(e)[t].name} is no longer incapacitated.`),L(e)[t].incapacitated=!1,t++),e.currentActor.actions=2,e.currentActor.movement=Te(e.currentActor),e.currentActor=L(e)[t],g(e,`${e.currentActor.name} started their turn`)}},_o=e=>{var n;e.dungeon.winConditions.forEach(t=>{var o;switch(t.type){case De.KILL_ALL:{const s=e.dungeon.layout.monsters.map(r=>r.health).reduce((r,a)=>r+a,0);t.fulfilled=s<=0;break}case De.REACH_CELL:{t.fulfilled=L(e).some(s=>{var r;return s.position.x===((r=t.targetCell)==null?void 0:r.x)&&s.position.y===t.targetCell.y});break}case De.KILL_ALL_OF_TYPE:{t.fulfilled=e.dungeon.layout.monsters.filter(s=>s.type===t.targetMonsterType).some(s=>s.health>0);break}case De.OPEN_DOOR:{t.fulfilled=((o=e.dungeon.layout.doors.find(s=>{var r,a;return s.x===((r=t.targetCell)==null?void 0:r.x)&&s.y===((a=t.targetCell)==null?void 0:a.y)}))==null?void 0:o.open)??!1;break}case De.KILL_AT_LEAST:{t.fulfilled=(t.killMinCount?t.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,o)=>t&&o,!0),e.dungeon.beaten&&(g(e,"All win conditions have been fulfilled"),g(e,`You have cleared ${e.dungeon.name}`),g(e,`Press 'Next' to move on to the next level: ${(n=e.dungeon.nextDungeon)==null?void 0:n.name}`))},$n=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:P.Red,maxHealth:0,name:"Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Bo=(e,n,t,o)=>{const s=e.dungeon.layout.doors.find(r=>r.x===n.position.x&&r.y===n.position.y);if(s&&!s.locked){const r=Do(n.position.x,n.position.y,t,o);if(s.side===r)return s.open=!0,s.trapped&&Et(e,$n(s),n,!1),!0}return s&&s.locked&&g(e,"Door is locked"),!1},Do=(e,n,t,o)=>{if(e===t){if(n>o)return _.UP;if(n<o)return _.DOWN}if(n===o){if(e>t)return _.LEFT;if(e<t)return _.RIGHT}},wt=(e,n,t)=>{let o=!0;if(n<0||n>=e.grid[0].length||t<0||t>=e.grid.length)o=!1;else{const s=It(e.grid,n,t);(s===jn||s===Pn||s===Xt||s===Ot)&&(o=!1)}return o},St=(e,n,t)=>{const o=It(e.layout.grid,n,t);return o?e.discoveredRooms.includes(o):!1},It=(e,n,t)=>{let o;return e.forEach((s,r)=>{jt(s).forEach((a,i)=>{r===t&&i===n&&(o=a)})}),o},st=(e,n,t)=>e.x===n&&e.y===t||e.x===n-1&&e.y===t||e.x===n-1&&e.y===t-1||e.x===n&&e.y===t-1||e.x===n+1&&e.y===t-1||e.x===n+1&&e.y===t||e.x===n+1&&e.y===t+1||e.x===n&&e.y===t+1||e.x===n-1&&e.y===t+1,Ro=(e,n,t,o)=>{var r;const s=((r=o.armour)==null?void 0:r.defense)??o.defense;return`${e} damage (${n}-(${s}+${t})=${e})`},Rt=e=>e.movement<Te(e)?e.actions>1:e.actions>0,Kt=(e,n)=>e.x===n.x&&e.y===n.y,g=(e,n)=>{e.actionLog=[n,...e.actionLog]},L=e=>e.heroes.filter(n=>n.health>0),To=e=>e.heroes.filter(n=>n.health<=0),Et=(e,n,t,o)=>{var f,p;let s=n.weapon;o&&n.rangedWeapon&&(s=n.rangedWeapon);let r=0,a=0;s.ignoresArmour?t.armour&&g(e,`${t.name}'s armour was useless against ${s.name} `):r=((f=t.armour)==null?void 0:f.defense)??t.defense,s.ignoresShield?t.shield&&g(e,`${t.name}'s shield was useless against ${s.name} `):a=bt(t.level,((p=t.shield)==null?void 0:p.dice)??0);const i=bt(n.level,s.dice),l=Math.max(i-(r+a),0);t.health-=l,g(e,`${n.name} attacked ${t.name} with ${s.name} for ${Ro(l,i,a,t)}`),t.health<=0&&(g(e,`${n.name} killed ${t.name}`),t.health=0,t.level=N.APPRENTICE)},Ho=e=>{L(e).forEach(n=>{const t=n.level;n.experience>=28?n.level=N.MASTER:n.experience>=18?n.level=N.LORD:n.experience>=10?n.level=N.HERO:n.experience>=4&&(n.level=N.KNIGHT),t!==n.level&&g(e,`${n.name} leveled up to ${n.level}`)})},Oo=e=>{L(e).forEach(n=>n.experience+=4)},wo=e=>{To(e).forEach(n=>{n.experience=0,n.health=n.maxHealth,n.movement=n.maxMovement,n.actions=2})},Lo=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],Oo(e),Ho(e),wo(e),xn(e))},mt=(e,n)=>Math.sqrt(Math.pow(e.x-(n==null?void 0:n.x),2)+Math.pow(e.y-(n==null?void 0:n.y),2)),zt=(e,n,t,o,s,r)=>{const a=Po(e,t),i={x:Math.round((a.x+24)/48),y:Math.round((a.y+24)/48)},l=It(s.dungeon.layout.grid,i.x,i.y);return i.x===o.x&&i.y===o.y?(r.push(i),!0):l===Ot||l===Pn?!1:(i.x===n.x&&i.y===n.y||r.some(f=>f.x===i.x&&f.y===i.y)||r.push(i),zt(a,n,t,o,s,r))},Po=(e,n)=>{const t=e.x,o=e.y,s=n.x-t,r=n.y-o,a=s/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2),i=r/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2);let l=Math.round(a+t),f=Math.round(i+o);return{x:l,y:f}},Mo="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",No="data:image/png;base64,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",xo=(e,n)=>{const t=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),s=Math.min(t,o),r=Math.max(t,o),a=s,i=r-s;let l=Math.sqrt(2);return i===0&&(l=1),Math.floor(l*a+i)},Uo=(e,n,t)=>{const o=e.currentActor,s=e.dungeon.layout.doors.find(r=>r.x===o.position.x&&r.y===o.position.y);if(s){if(!s.open&&!s.hidden&&!s.locked&&o.movement>0){switch(s.open=!0,s.trapped&&Et(e,$n(s),o),s.side){case _.RIGHT:ct(o,e,n+1,t);break;case _.LEFT:ct(o,e,n-1,t);break;case _.DOWN:ct(o,e,n,t+1);break;case _.UP:ct(o,e,n,t-1);break}Ct(o)}else if(s.locked&&!s.hidden){if(!Rt(o)){g(e,`${o.name} has no actions left`);return}g(e,"Door is locked"),_t(e),Ct(o)}}else{if(!Rt(o)){g(e,`${o.name} has no actions left`);return}Bt(e)}},Go=(e,n,t)=>{const o=e.currentActor;if(o.actions===0){g(e,`${o.name} has no actions left`);return}const s=wt(e.dungeon.layout,n,t),r=xo(o.position,{x:n,y:t});if(console.log("distance: "+r),s){const a=Jt(e,n,t),i=Zt(e,n,t);if(!a&&!i&&r<=o.movement){if(o.position={x:n,y:t},o.movement-=r,Mn(e))return}else i&&(r<=o.weapon.range?Gn(o,e,n,t):g(e,"Monster is out of range"))}Ct(o)},$o=(e,n,t)=>{const o=t.currentActor,s=document.getElementById("gameBoard");if(!s)return;const r=s.getBoundingClientRect(),a=Math.min(Math.floor((e.clientX-r.left)/n),t.dungeon.layout.grid[0].length-1),i=Math.min(Math.floor((e.clientY-r.top)/n),t.dungeon.layout.grid.length-1),l=t.dungeon.layout.grid[i][a];a===o.position.x&&i===o.position.y?Uo(t,a,i):t.dungeon.discoveredRooms.includes(l)&&Go(t,a,i)},Wo=(e,n,t,o,s)=>{L(o).forEach(a=>{Yo(e,a,n,t)}),qo(e,o,t),Xo(e,o,t)},Yo=(e,n,t,o)=>{const s=n.position.x,r=n.position.y;e.drawImage(t,4*16,0,16,16,s*o,r*o,o,o),Fo(e,n,s,r,o),Vo(e,n,s,r,o),Ko(e,n,s,r,o)},Fo=(e,n,t,o,s)=>{const r=e.fillStyle,a=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let i=0;i<n.actions;i++)e.fillRect(t*s+4+6*i,o*s+s-12,5,5),e.rect(t*s+4+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle="blue";for(let i=0;i<n.movement;i++)e.fillRect(t*s+s-22+6*i,o*s+s-12,5,5),e.rect(t*s+s-22+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle=r,e.strokeStyle=a},Ko=(e,n,t,o,s)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t*s+4,o*s,s-8,4),e.fillStyle="green",e.fillRect(t*s+4,o*s,(s-8)*(n.health/n.maxHealth),4),e.rect(t*s+4,o*s,s-8,4),e.stroke()},Vo=(e,n,t,o,s)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(t*s+4,o*s+(s-6),s-8,4),e.stroke()},qo=(e,n,t)=>{const o=n.currentActor;if(o){for(let s=o.position.x-o.movement;s<=o.position.x+o.movement;s++)for(let r=o.position.y-o.movement;r<=o.position.y+o.movement;r++)if(St(n.dungeon,s,r)){const i=Zt(n,s,r),l=Jt(n,s,r),f=wt(n.dungeon.layout,s,r);!l&&!i&&f&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(s*t,r*t,t,t),e.stroke())}}},Xo=(e,n,t)=>{const o=n.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t+t/3,o.position.y*t),e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t,o.position.y*t+t/3),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3,o.position.y*t+t),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t+t),e.stroke(),e.lineWidth=1)},jo=(e,n,t,o,s)=>{o.dungeon.layout.monsters.forEach(r=>{Zo(e,n,o,r,t,s)})},Zo=(e,n,t,o,s,r)=>{const a=t.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&os(a,t)){switch(o.type){case K.ORCH:Jo(e,n,s,o);break;case K.TROLL:So(e,n,s,o);break;default:zo(e,n,s,o);break}es(e,o,s),ts(e,o,s),ns(e,o,t.heroes,t,s,r)}},Jo=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},So=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},zo=(e,n,t,o)=>{e.drawImage(n,16,16,16,16,o.position.x*t,o.position.y*t,t,t)},es=(e,n,t)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(n.position.x*t+4,n.position.y*t+(t-6),t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ts=(e,n,t)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n.position.x*t+4,n.position.y*t,t-8,4),e.fillStyle="green",e.fillRect(n.position.x*t+4,n.position.y*t,(t-8)*(n.health/n.maxHealth),4),e.rect(n.position.x*t+4,n.position.y*t,t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ns=(e,n,t,o,s,r)=>{r&&t.forEach(a=>{const i=[],l={x:n.position.x*48-24,y:n.position.y*48-24},f={x:a.position.x*48-24,y:a.position.y*48-24};if(zt(l,n.position,f,a.position,o,i)){const h=n.position.x,y=n.position.y,D=a.position.x,x=a.position.y;e.beginPath(),e.strokeStyle=n.colour,e.lineWidth=2,e.moveTo(h*s+s/2,y*s+s/2),e.lineTo(D*s+s/2,x*s+s/2),e.stroke(),e.lineWidth=1}})},os=(e,n)=>n.dungeon.discoveredRooms.includes(e),ss=(e,n,t,o,s)=>{o.dungeon.layout.doors.forEach(r=>{cs(e,n,t,o,r,s)})},rs=(e,n,t,o,s)=>{o.dungeon.layout.grid.forEach((r,a)=>{jt(r).forEach((i,l)=>{is(e,n,o,i,l,a,t),ds(e,i,o,l,a,t,s)})})},as=(e,n,t,o)=>{o.dungeon.layout.secrets.filter(s=>s.found).forEach(s=>{switch(s.type){case ge.TRAP_DOOR:ls(e,n,t,s);break;default:us(e,n,t,s);break}})},is=(e,n,t,o,s,r,a)=>{As(o)||!t.dungeon.discoveredRooms.includes(o)&&o!==Xt?t.dungeon.discoveredRooms.some(i=>fs(s,r,i,t))?e.drawImage(n,48,0,48,48,s*a,r*a,a,a):Bn(e,s,r,a):Tt(o,t)?Bn(e,s,r,a):e.drawImage(n,0,0,48,48,s*a,r*a,a,a)},Bn=(e,n,t,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(n*o,t*o,o,o),e.stroke()},ls=(e,n,t,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(n,3*48,0,48,48,s*t,r*t,t,t)},us=(e,n,t,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(n,4*48,0,48,48,s*t,r*t,t,t)},ds=(e,n,t,o,s,r,a)=>{!a&&(Tt(n,t)||n===Ot)||(e.beginPath(),e.strokeStyle="black",e.rect(o*r,s*r,r,r),a&&(e.font="7px Arial",e.fillText(o+","+s,o*r+3,s*r+(r-3))),e.stroke())},cs=(e,n,t,o,s,r)=>{const a=o.dungeon.layout.grid[s.y][s.x];if(s&&!s.hidden&&!s.open&&!Tt(a,o))switch(e.fillStyle="brown",s.side){case _.RIGHT:{e.fillRect(s.x*t+(t-2),s.y*t,4,t),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*t+(t-4),s.y*t+(t/2-4),8,8));break}case _.LEFT:{e.fillRect(s.x*t-2,s.y*t,4,t),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*t-4,s.y*t+(t/2-4),8,8));break}case _.UP:{e.fillRect(s.x*t,s.y*t-2,t,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*t+(t/2-4),s.y*t-4,8,8));break}case _.DOWN:{e.fillRect(s.x*t,s.y*t+(t-2),t,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*t+(t/2-4),s.y*t+(t-4),8,8));break}}r&&!Tt(a,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${s.hidden?"H":"-"}/${s.trapped?"T"+s.trapAttacks:"-"}/${s.locked?"L":"-"}]`,s.x*t,s.y*t+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(s.x*t,s.y*t,t,t))},As=e=>e===Ot,Tt=(e,n)=>e===Xt||!n.dungeon.discoveredRooms.includes(e),fs=(e,n,t,o)=>{if(!o)return;const s=Math.max(e-1,0),r=Math.max(n-1,0),a=Math.min(e+1,o.dungeon.layout.grid.length),i=Math.min(n+1,o.dungeon.layout.grid[0].length);for(let l=s;l<=a;l++)for(let f=r;f<=i;f++){const p=o.dungeon.layout.grid[f];if(jt(p)[l]===t)return!0}return!1};function gs(e){let n,t,o,s;return{c(){n=c("div"),t=c("canvas"),this.h()},l(r){n=A(r,"DIV",{style:!0,class:!0});var a=m(n);t=A(a,"CANVAS",{width:!0,height:!0,id:!0}),m(t).forEach(d),a.forEach(d),this.h()},h(){b(t,"width",Be*40),b(t,"height",Be*30),b(t,"id","gameBoard"),b(n,"style",e[1]()),b(n,"class","dungeon svelte-a4uhtl")},m(r,a){T(r,n,a),u(n,t),o||(s=M(t,"click",e[0]),o=!0)},p:pe,i:pe,o:pe,d(r){r&&d(n),o=!1,s()}}}const Be=48;function ps(e,n,t){let{state:o}=n,{debugMode:s}=n,r,a;a=window.innerHeight,r=document.getElementById("footer").offsetHeight,Ht(()=>{const p=new Image;p.src=Mo;const h=new Image;h.src=No,setInterval(()=>i(p,h),10)});const i=(p,h)=>{if(!o||!document)return;const y=document.getElementById("gameBoard"),D=y.getContext("2d");D.clearRect(0,0,y.width,y.height),D.fillStyle="black",D.fillRect(0,0,y.width,y.height),rs(D,p,Be,o,s),as(D,p,Be,o),ss(D,p,Be,o,s),jo(D,h,Be,o,s),Wo(D,h,Be,o)},l=p=>{$o(p,Be,o)},f=()=>`max-height: ${a-r-20}px; max-width: ${Be*40}`;return e.$$set=p=>{"state"in p&&t(2,o=p.state),"debugMode"in p&&t(3,s=p.debugMode)},[l,f,o,s]}class ms extends ht{constructor(n){super(),vt(this,n,ps,gs,ze,{state:2,debugMode:3})}}function hs(e){let n;return{c(){n=I("None (0)")},l(t){n=E(t,"None (0)")},m(t,o){T(t,n,o)},p:pe,d(t){t&&d(n)}}}function vs(e){let n=e[0].armour.name+"",t,o,s=e[0].armour.defense+"",r,a;return{c(){t=I(n),o=I(" ("),r=I(s),a=I(")")},l(i){t=E(i,n),o=E(i," ("),r=E(i,s),a=E(i,")")},m(i,l){T(i,t,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&n!==(n=i[0].armour.name+"")&&ee(t,n),l&1&&s!==(s=i[0].armour.defense+"")&&ee(r,s)},d(i){i&&(d(t),d(o),d(r),d(a))}}}function Is(e){let n;return{c(){n=I("None (0)")},l(t){n=E(t,"None (0)")},m(t,o){T(t,n,o)},p:pe,d(t){t&&d(n)}}}function Es(e){let n=e[0].shield.name+"",t,o,s=e[0].shield.dice+"",r,a;return{c(){t=I(n),o=I(" ("),r=I(s),a=I(")")},l(i){t=E(i,n),o=E(i," ("),r=E(i,s),a=E(i,")")},m(i,l){T(i,t,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&n!==(n=i[0].shield.name+"")&&ee(t,n),l&1&&s!==(s=i[0].shield.dice+"")&&ee(r,s)},d(i){i&&(d(t),d(o),d(r),d(a))}}}function ys(e){let n,t,o,s=e[0].name+"",r,a,i,l,f=e[0].level+"",p,h,y=e[0].experience+"",D,x,et,re,he,j=e[0].health+"",$e,We,Z,ae,He=e[0].actions+"",Oe,ve,$,tt,Ie=e[0].movement+"",U,Ee,W,rt="Equipment:",Ye,Y,V,ye,J=e[0].weapon.name+"",Fe,Ke,ie=e[0].weapon.dice+"",te,nt,Ve,O,ke,le,ue,qe;function we(k,v){return k[0].armour!=null?vs:hs}let ne=we(e),q=ne(e);function ot(k,v){return k[0].shield!=null?Es:Is}let Ae=ot(e),w=Ae(e);return{c(){n=c("div"),t=c("div"),o=c("b"),r=I(s),a=I(" -"),i=Q(),l=c("b"),p=I(f),h=I(" ("),D=I(y),x=I(")"),et=Q(),re=c("span"),he=I("HP: "),$e=I(j),We=Q(),Z=c("span"),ae=I("Actions: "),Oe=I(He),ve=Q(),$=c("span"),tt=I("Moves: "),U=I(Ie),Ee=Q(),W=c("span"),W.textContent=rt,Ye=Q(),Y=c("div"),V=c("span"),ye=I("🗡️  "),Fe=I(J),Ke=I(" ("),te=I(ie),nt=I(")"),Ve=Q(),O=c("span"),ke=I(`🧱
        `),q.c(),le=Q(),ue=c("span"),qe=I(`🛡️
            `),w.c(),this.h()},l(k){n=A(k,"DIV",{class:!0,style:!0});var v=m(n);t=A(v,"DIV",{class:!0});var fe=m(t);o=A(fe,"B",{class:!0});var de=m(o);r=E(de,s),a=E(de," -"),de.forEach(d),i=C(fe),l=A(fe,"B",{class:!0});var Le=m(l);p=E(Le,f),h=E(Le," ("),D=E(Le,y),x=E(Le,")"),Le.forEach(d),fe.forEach(d),et=C(v),re=A(v,"SPAN",{class:!0});var Xe=m(re);he=E(Xe,"HP: "),$e=E(Xe,j),Xe.forEach(d),We=C(v),Z=A(v,"SPAN",{class:!0});var F=m(Z);ae=E(F,"Actions: "),Oe=E(F,He),F.forEach(d),ve=C(v),$=A(v,"SPAN",{class:!0});var Qe=m($);tt=E(Qe,"Moves: "),U=E(Qe,Ie),Qe.forEach(d),Ee=C(v),W=A(v,"SPAN",{class:!0,"data-svelte-h":!0}),G(W)!=="svelte-1ue18fw"&&(W.textContent=rt),Ye=C(v),Y=A(v,"DIV",{class:!0});var X=m(Y);V=A(X,"SPAN",{class:!0});var Ce=m(V);ye=E(Ce,"🗡️  "),Fe=E(Ce,J),Ke=E(Ce," ("),te=E(Ce,ie),nt=E(Ce,")"),Ce.forEach(d),Ve=C(X),O=A(X,"SPAN",{class:!0});var je=m(O);ke=E(je,`🧱
        `),q.l(je),je.forEach(d),le=C(X),ue=A(X,"SPAN",{class:!0});var be=m(ue);qe=E(be,`🛡️
            `),w.l(be),be.forEach(d),X.forEach(d),v.forEach(d),this.h()},h(){b(o,"class","svelte-1jzprgd"),b(l,"class","svelte-1jzprgd"),b(t,"class","hero-title svelte-1jzprgd"),b(re,"class","svelte-1jzprgd"),b(Z,"class","svelte-1jzprgd"),b($,"class","svelte-1jzprgd"),b(W,"class","svelte-1jzprgd"),b(V,"class","svelte-1jzprgd"),b(O,"class","svelte-1jzprgd"),b(ue,"class","svelte-1jzprgd"),b(Y,"class","equipment"),b(n,"class","hero-card svelte-1jzprgd"),yn(n,"background-color",e[0].colour)},m(k,v){T(k,n,v),u(n,t),u(t,o),u(o,r),u(o,a),u(t,i),u(t,l),u(l,p),u(l,h),u(l,D),u(l,x),u(n,et),u(n,re),u(re,he),u(re,$e),u(n,We),u(n,Z),u(Z,ae),u(Z,Oe),u(n,ve),u(n,$),u($,tt),u($,U),u(n,Ee),u(n,W),u(n,Ye),u(n,Y),u(Y,V),u(V,ye),u(V,Fe),u(V,Ke),u(V,te),u(V,nt),u(Y,Ve),u(Y,O),u(O,ke),q.m(O,null),u(Y,le),u(Y,ue),u(ue,qe),w.m(ue,null)},p(k,[v]){v&1&&s!==(s=k[0].name+"")&&ee(r,s),v&1&&f!==(f=k[0].level+"")&&ee(p,f),v&1&&y!==(y=k[0].experience+"")&&ee(D,y),v&1&&j!==(j=k[0].health+"")&&ee($e,j),v&1&&He!==(He=k[0].actions+"")&&ee(Oe,He),v&1&&Ie!==(Ie=k[0].movement+"")&&ee(U,Ie),v&1&&J!==(J=k[0].weapon.name+"")&&ee(Fe,J),v&1&&ie!==(ie=k[0].weapon.dice+"")&&ee(te,ie),ne===(ne=we(k))&&q?q.p(k,v):(q.d(1),q=ne(k),q&&(q.c(),q.m(O,null))),Ae===(Ae=ot(k))&&w?w.p(k,v):(w.d(1),w=Ae(k),w&&(w.c(),w.m(ue,null))),v&1&&yn(n,"background-color",k[0].colour)},i:pe,o:pe,d(k){k&&d(n),q.d(),w.d()}}}function ks(e,n,t){let{hero:o}=n;return e.$$set=s=>{"hero"in s&&t(0,o=s.hero)},[o]}class Wn extends ht{constructor(n){super(),vt(this,n,ks,ys,ze,{hero:0})}}function Dn(e,n,t){const o=e.slice();return o[3]=n[t],o[5]=t,o}function Qs(e){let n,t,o,s;return t=new Wn({props:{hero:e[3]}}),{c(){n=c("div"),At(t.$$.fragment),o=Q(),this.h()},l(r){n=A(r,"DIV",{class:!0});var a=m(n);ft(t.$$.fragment,a),o=C(a),a.forEach(d),this.h()},h(){b(n,"class","not-current-actor svelte-izfxty")},m(r,a){T(r,n,a),gt(t,n,null),u(n,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),t.$set(i)},i(r){s||(se(t.$$.fragment,r),s=!0)},o(r){ce(t.$$.fragment,r),s=!1},d(r){r&&d(n),pt(t)}}}function Cs(e){let n,t,o,s;return t=new Wn({props:{hero:e[3]}}),{c(){n=c("div"),At(t.$$.fragment),o=Q(),this.h()},l(r){n=A(r,"DIV",{class:!0});var a=m(n);ft(t.$$.fragment,a),o=C(a),a.forEach(d),this.h()},h(){b(n,"class","is-current-actor svelte-izfxty")},m(r,a){T(r,n,a),gt(t,n,null),u(n,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),t.$set(i)},i(r){s||(se(t.$$.fragment,r),s=!0)},o(r){ce(t.$$.fragment,r),s=!1},d(r){r&&d(n),pt(t)}}}function Rn(e){let n,t,o,s;const r=[Cs,Qs],a=[];function i(l,f){return l[3]===l[0].currentActor?0:1}return n=i(e),t=a[n]=r[n](e),{c(){t.c(),o=me()},l(l){t.l(l),o=me()},m(l,f){a[n].m(l,f),T(l,o,f),s=!0},p(l,f){let p=n;n=i(l),n===p?a[n].p(l,f):(Vt(),ce(a[p],1,1,()=>{a[p]=null}),qt(),t=a[n],t?t.p(l,f):(t=a[n]=r[n](l),t.c()),se(t,1),t.m(o.parentNode,o))},i(l){s||(se(t),s=!0)},o(l){ce(t),s=!1},d(l){l&&d(o),a[n].d(l)}}}function Tn(e){let n=e[1],t,o,s=Rn(e);return{c(){s.c(),t=me()},l(r){s.l(r),t=me()},m(r,a){s.m(r,a),T(r,t,a),o=!0},p(r,a){a&2&&ze(n,n=r[1])?(Vt(),ce(s,1,1,pe),qt(),s=Rn(r),s.c(),se(s,1),s.m(t.parentNode,t)):s.p(r,a)},i(r){o||(se(s),o=!0)},o(r){ce(s),o=!1},d(r){r&&d(t),s.d(r)}}}function bs(e){let n,t,o=Qt(L(e[0])),s=[];for(let a=0;a<o.length;a+=1)s[a]=Tn(Dn(e,o,a));const r=a=>ce(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();n=me()},l(a){for(let i=0;i<s.length;i+=1)s[i].l(a);n=me()},m(a,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,i);T(a,n,i),t=!0},p(a,[i]){if(i&3){o=Qt(L(a[0]));let l;for(l=0;l<o.length;l+=1){const f=Dn(a,o,l);s[l]?(s[l].p(f,i),se(s[l],1)):(s[l]=Tn(f),s[l].c(),se(s[l],1),s[l].m(n.parentNode,n))}for(Vt(),l=o.length;l<s.length;l+=1)r(l);qt()}},i(a){if(!t){for(let i=0;i<o.length;i+=1)se(s[i]);t=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ce(s[i]);t=!1},d(a){a&&d(n),Ln(s,a)}}}function _s(e,n,t){let{state:o}=n,s=!1;Ht(()=>{r(),setInterval(r,100)});const r=()=>{t(1,s=!s)};return e.$$set=a=>{"state"in a&&t(0,o=a.state)},[o,s]}class Bs extends ht{constructor(n){super(),vt(this,n,_s,bs,ze,{state:0})}}function Hn(e,n,t){const o=e.slice();return o[2]=n[t],o[4]=t,o}function Ds(e){let n,t,o=e[2]+"",s;return{c(){n=c("p"),t=I(">"),s=I(o),this.h()},l(r){n=A(r,"P",{class:!0});var a=m(n);t=E(a,">"),s=E(a,o),a.forEach(d),this.h()},h(){b(n,"class","svelte-1xp6uq")},m(r,a){T(r,n,a),u(n,t),u(n,s)},p(r,a){a&1&&o!==(o=r[2]+"")&&ee(s,o)},d(r){r&&d(n)}}}function On(e){let n,t=e[4]<25&&Ds(e);return{c(){t&&t.c(),n=me()},l(o){t&&t.l(o),n=me()},m(o,s){t&&t.m(o,s),T(o,n,s)},p(o,s){o[4]<25&&t.p(o,s)},d(o){o&&d(n),t&&t.d(o)}}}function wn(e){let n,t=Qt(e[0]),o=[];for(let s=0;s<t.length;s+=1)o[s]=On(Hn(e,t,s));return{c(){for(let s=0;s<o.length;s+=1)o[s].c();n=me()},l(s){for(let r=0;r<o.length;r+=1)o[r].l(s);n=me()},m(s,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(s,r);T(s,n,r)},p(s,r){if(r&1){t=Qt(s[0]);let a;for(a=0;a<t.length;a+=1){const i=Hn(s,t,a);o[a]?o[a].p(i,r):(o[a]=On(i),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].d(1);o.length=t.length}},d(s){s&&d(n),Ln(o,s)}}}function Rs(e){let n,t=e[0],o=wn(e);return{c(){n=c("div"),o.c(),this.h()},l(s){n=A(s,"DIV",{class:!0});var r=m(n);o.l(r),r.forEach(d),this.h()},h(){b(n,"class","log svelte-1xp6uq")},m(s,r){T(s,n,r),o.m(n,null)},p(s,[r]){r&1&&ze(t,t=s[0])?(o.d(1),o=wn(s),o.c(),o.m(n,null)):o.p(s,r)},i:pe,o:pe,d(s){s&&d(n),o.d(s)}}}function Ts(e,n,t){let o=[],{state:s}=n;return Ht(()=>{setInterval(()=>{t(0,o=s.actionLog)},1e3)}),e.$$set=r=>{"state"in r&&t(1,s=r.state)},[o,s]}class Hs extends ht{constructor(n){super(),vt(this,n,Ts,Rs,ze,{state:1})}}function Os(e){let n,t,o,s,r,a,i,l,f,p,h,y,D,x,et="UL",re,he,j,$e="U",We,Z,ae,He="UR",Oe,ve,$,tt="Next",Ie,U,Ee,W,rt="L",Ye,Y,V,ye,J,Fe="R",Ke,ie,te,nt="Search",Ve,O,ke,le,ue="DL",qe,we,ne,q="D",ot,Ae,w,k="DR",v,fe,de,Le="Pick lock",Xe,F,Qe,X,Ce="Save",je,be,Ze,en="Load",Lt,at,Je,tn="Debug",Pt,it,Se,nn="End action",Mt,_e,Nt,yt,xt,on;o=new Bs({props:{state:e[0]}});function Yn(B){e[3](B)}function Fn(B){e[4](B)}let Ut={};e[0]!==void 0&&(Ut.state=e[0]),e[1]!==void 0&&(Ut.debugMode=e[1]),r=new ms({props:Ut}),Gt.push(()=>Wt(r,"state",Yn)),Gt.push(()=>Wt(r,"debugMode",Fn));function Kn(B){e[7](B)}let sn={};return e[0]!==void 0&&(sn.state=e[0]),_e=new Hs({props:sn}),Gt.push(()=>Wt(_e,"state",Kn)),{c(){n=c("div"),t=c("div"),At(o.$$.fragment),s=Q(),At(r.$$.fragment),l=Q(),f=c("div"),p=c("div"),h=c("table"),y=c("tr"),D=c("td"),x=c("button"),x.textContent=et,re=Q(),he=c("td"),j=c("button"),j.textContent=$e,We=Q(),Z=c("td"),ae=c("button"),ae.textContent=He,Oe=Q(),ve=c("td"),$=c("button"),$.textContent=tt,Ie=Q(),U=c("tr"),Ee=c("td"),W=c("button"),W.textContent=rt,Ye=Q(),Y=c("td"),V=Q(),ye=c("td"),J=c("button"),J.textContent=Fe,Ke=Q(),ie=c("td"),te=c("button"),te.textContent=nt,Ve=Q(),O=c("tr"),ke=c("td"),le=c("button"),le.textContent=ue,qe=Q(),we=c("td"),ne=c("button"),ne.textContent=q,ot=Q(),Ae=c("td"),w=c("button"),w.textContent=k,v=Q(),fe=c("td"),de=c("button"),de.textContent=Le,Xe=Q(),F=c("tr"),Qe=c("td"),X=c("button"),X.textContent=Ce,je=Q(),be=c("td"),Ze=c("button"),Ze.textContent=en,Lt=Q(),at=c("td"),Je=c("button"),Je.textContent=tn,Pt=Q(),it=c("td"),Se=c("button"),Se.textContent=nn,Mt=Q(),At(_e.$$.fragment),this.h()},l(B){n=A(B,"DIV",{class:!0});var S=m(n);t=A(S,"DIV",{class:!0});var lt=m(t);ft(o.$$.fragment,lt),lt.forEach(d),s=C(S),ft(r.$$.fragment,S),S.forEach(d),l=C(B),f=A(B,"DIV",{class:!0,id:!0});var Pe=m(f);p=A(Pe,"DIV",{class:!0});var ut=m(p);h=A(ut,"TABLE",{});var Me=m(h);y=A(Me,"TR",{});var Ne=m(y);D=A(Ne,"TD",{});var rn=m(D);x=A(rn,"BUTTON",{"data-svelte-h":!0}),G(x)!=="svelte-fw3uxo"&&(x.textContent=et),rn.forEach(d),re=C(Ne),he=A(Ne,"TD",{});var an=m(he);j=A(an,"BUTTON",{"data-svelte-h":!0}),G(j)!=="svelte-1jeoia6"&&(j.textContent=$e),an.forEach(d),We=C(Ne),Z=A(Ne,"TD",{});var ln=m(Z);ae=A(ln,"BUTTON",{"data-svelte-h":!0}),G(ae)!=="svelte-1p8c8vc"&&(ae.textContent=He),ln.forEach(d),Oe=C(Ne),ve=A(Ne,"TD",{});var un=m(ve);$=A(un,"BUTTON",{"data-svelte-h":!0}),G($)!=="svelte-1rtxc14"&&($.textContent=tt),un.forEach(d),Ne.forEach(d),Ie=C(Me),U=A(Me,"TR",{});var xe=m(U);Ee=A(xe,"TD",{});var dn=m(Ee);W=A(dn,"BUTTON",{"data-svelte-h":!0}),G(W)!=="svelte-10dnpu6"&&(W.textContent=rt),dn.forEach(d),Ye=C(xe),Y=A(xe,"TD",{}),m(Y).forEach(d),V=C(xe),ye=A(xe,"TD",{});var cn=m(ye);J=A(cn,"BUTTON",{"data-svelte-h":!0}),G(J)!=="svelte-12287ni"&&(J.textContent=Fe),cn.forEach(d),Ke=C(xe),ie=A(xe,"TD",{});var An=m(ie);te=A(An,"BUTTON",{"data-svelte-h":!0}),G(te)!=="svelte-cps1bu"&&(te.textContent=nt),An.forEach(d),xe.forEach(d),Ve=C(Me),O=A(Me,"TR",{});var Ue=m(O);ke=A(Ue,"TD",{});var fn=m(ke);le=A(fn,"BUTTON",{"data-svelte-h":!0}),G(le)!=="svelte-1ji074i"&&(le.textContent=ue),fn.forEach(d),qe=C(Ue),we=A(Ue,"TD",{});var gn=m(we);ne=A(gn,"BUTTON",{"data-svelte-h":!0}),G(ne)!=="svelte-li5tq6"&&(ne.textContent=q),gn.forEach(d),ot=C(Ue),Ae=A(Ue,"TD",{});var pn=m(Ae);w=A(pn,"BUTTON",{"data-svelte-h":!0}),G(w)!=="svelte-3esmwe"&&(w.textContent=k),pn.forEach(d),v=C(Ue),fe=A(Ue,"TD",{});var mn=m(fe);de=A(mn,"BUTTON",{"data-svelte-h":!0}),G(de)!=="svelte-sacog4"&&(de.textContent=Le),mn.forEach(d),Ue.forEach(d),Xe=C(Me),F=A(Me,"TR",{});var Ge=m(F);Qe=A(Ge,"TD",{});var hn=m(Qe);X=A(hn,"BUTTON",{"data-svelte-h":!0}),G(X)!=="svelte-1vr5zyk"&&(X.textContent=Ce),hn.forEach(d),je=C(Ge),be=A(Ge,"TD",{});var vn=m(be);Ze=A(vn,"BUTTON",{"data-svelte-h":!0}),G(Ze)!=="svelte-1m2jkw7"&&(Ze.textContent=en),vn.forEach(d),Lt=C(Ge),at=A(Ge,"TD",{});var In=m(at);Je=A(In,"BUTTON",{"data-svelte-h":!0}),G(Je)!=="svelte-1vbubr3"&&(Je.textContent=tn),In.forEach(d),Pt=C(Ge),it=A(Ge,"TD",{});var En=m(it);Se=A(En,"BUTTON",{"data-svelte-h":!0}),G(Se)!=="svelte-1ied6ec"&&(Se.textContent=nn),En.forEach(d),Ge.forEach(d),Me.forEach(d),ut.forEach(d),Mt=C(Pe),ft(_e.$$.fragment,Pe),Pe.forEach(d),this.h()},h(){b(t,"class","characterSide svelte-aelzqd"),b(n,"class","container svelte-aelzqd"),b(p,"class","commands svelte-aelzqd"),b(f,"class","container svelte-aelzqd"),b(f,"id","footer")},m(B,S){T(B,n,S),u(n,t),gt(o,t,null),u(n,s),gt(r,n,null),T(B,l,S),T(B,f,S),u(f,p),u(p,h),u(h,y),u(y,D),u(D,x),u(y,re),u(y,he),u(he,j),u(y,We),u(y,Z),u(Z,ae),u(y,Oe),u(y,ve),u(ve,$),u(h,Ie),u(h,U),u(U,Ee),u(Ee,W),u(U,Ye),u(U,Y),u(U,V),u(U,ye),u(ye,J),u(U,Ke),u(U,ie),u(ie,te),u(h,Ve),u(h,O),u(O,ke),u(ke,le),u(O,qe),u(O,we),u(we,ne),u(O,ot),u(O,Ae),u(Ae,w),u(O,v),u(O,fe),u(fe,de),u(h,Xe),u(h,F),u(F,Qe),u(Qe,X),u(F,je),u(F,be),u(be,Ze),u(F,Lt),u(F,at),u(at,Je),u(F,Pt),u(F,it),u(it,Se),u(f,Mt),gt(_e,f,null),yt=!0,xt||(on=[M(window,"keydown",qn(e[2])),M(x,"click",function(){z(R("UL",e[0]))&&R("UL",e[0]).apply(this,arguments)}),M(j,"click",function(){z(R("U",e[0]))&&R("U",e[0]).apply(this,arguments)}),M(ae,"click",function(){z(R("UR",e[0]))&&R("UR",e[0]).apply(this,arguments)}),M($,"click",function(){z(Dt(e[0]))&&Dt(e[0]).apply(this,arguments)}),M(W,"click",function(){z(R("L",e[0]))&&R("L",e[0]).apply(this,arguments)}),M(J,"click",function(){z(R("R",e[0]))&&R("R",e[0]).apply(this,arguments)}),M(te,"click",function(){z(Bt(e[0]))&&Bt(e[0]).apply(this,arguments)}),M(le,"click",function(){z(R("DL",e[0]))&&R("DL",e[0]).apply(this,arguments)}),M(ne,"click",function(){z(R("D",e[0]))&&R("D",e[0]).apply(this,arguments)}),M(w,"click",function(){z(R("DR",e[0]))&&R("DR",e[0]).apply(this,arguments)}),M(de,"click",function(){z(_t(e[0]))&&_t(e[0]).apply(this,arguments)}),M(X,"click",function(){z(bn(e[0]))&&bn(e[0]).apply(this,arguments)}),M(Ze,"click",e[5]),M(Je,"click",e[6]),M(Se,"click",function(){z(_n(e[0]))&&_n(e[0]).apply(this,arguments)})],xt=!0)},p(B,[S]){e=B;const lt={};S&1&&(lt.state=e[0]),o.$set(lt);const Pe={};!a&&S&1&&(a=!0,Pe.state=e[0],$t(()=>a=!1)),!i&&S&2&&(i=!0,Pe.debugMode=e[1],$t(()=>i=!1)),r.$set(Pe);const ut={};!Nt&&S&1&&(Nt=!0,ut.state=e[0],$t(()=>Nt=!1)),_e.$set(ut)},i(B){yt||(se(o.$$.fragment,B),se(r.$$.fragment,B),se(_e.$$.fragment,B),yt=!0)},o(B){ce(o.$$.fragment,B),ce(r.$$.fragment,B),ce(_e.$$.fragment,B),yt=!1},d(B){B&&(d(n),d(l),d(f)),pt(o),pt(r),pt(_e),xt=!1,Vn(on)}}}function ws(e,n,t){let o=Co(),s=!1;Ht(()=>{setInterval(()=>Lo(o),1e3)});function r(h){switch(h.key){case"6":case"d":R("R",o);break;case"9":case"e":R("UR",o);break;case"8":case"w":R("U",o);break;case"7":case"q":R("UL",o);break;case"4":case"a":R("L",o);break;case"1":case"z":R("DL",o);break;case"2":case"x":R("D",o);break;case"3":case"c":R("DR",o);break;case"0":case" ":Dt(o);break;case"-":case"r":_t(o);break;case"+":case"f":Bt(o);break}}function a(h){o=h,t(0,o)}function i(h){s=h,t(1,s)}const l=()=>t(0,o=Qo()),f=()=>t(1,s=!s);function p(h){o=h,t(0,o)}return[o,s,r,a,i,l,f,p]}class Ms extends ht{constructor(n){super(),vt(this,n,ws,Os,ze,{})}}export{Ms as component};
