import{s as Te,n as ne,o as Fe,b as Wt,f as Ft,r as Gt,i as w}from"../chunks/scheduler.ba2ce6c0.js";import{S as Ge,i as qe,g as f,h,j as A,f as v,k as S,a as se,y as qt,r as Et,s as R,u as bt,c as D,z as O,x as l,v as yt,A as H,d as Rt,t as Dt,w as Tt}from"../chunks/index.8040907f.js";var P=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(P||{}),U=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(U||{}),ae=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ONE=1]="KILL_ONE",e[e.REACH_CELL=2]="REACH_CELL",e))(ae||{}),Bt=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.DOOR="Door",e.NOTE="Note",e))(Bt||{}),I=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(I||{});const zt="0",Vt="#",Xt=" ",Zt=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),De=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1}),ke=(e,t,n,o)=>{let s=U.LORD,i=2,r=2,c=4,d=4;switch(e){case P.ORCH:{s=U.APPRENTICE,r=0,c=2,d=1;break}case P.TROLL:{s=U.KNIGHT,r=1,c=3,d=2;break}}return e===P.YELLOW_DARK_LORD&&(i=3),{type:e,level:s,colour:t,actions:i,defense:r,health:c,experience:d,name:e.valueOf()+" ("+t+")",movement:3,position:{x:n,y:o}}},jt={name:"Second cave",beaten:!1,winConditions:[{type:ae.REACH_CELL,targetCell:{x:0,y:0},fulfilled:!1}],startingPositions:[{x:0,y:2},{x:0,y:3},{x:0,y:4},{x:1,y:3}],discoveredRooms:["A"],layout:{grid:["AAA","A A","AAA","AAA","AAA"],doors:[],monsters:[],secrets:[]}},Ct={name:"Troll cave",beaten:!1,winConditions:[{type:ae.KILL_ALL,fulfilled:!1}],nextDungeon:jt,startingPositions:[{x:0,y:7},{x:0,y:8},{x:0,y:9},{x:1,y:8}],discoveredRooms:["A"],layout:{grid:["     CCCC","     CCCC","     CCCC","      E  ","      E  ","      E  ","      BB ","AAA   BB ","AAADDDBB ","AAA   BB "],doors:[De(I.RIGHT,2,8),De(I.RIGHT,5,8),De(I.UP,6,6),De(I.UP,6,3)],monsters:[ke(P.ORCH,"green",5,8),ke(P.ORCH,"yellow",7,9),ke(P.ORCH,"red",6,4),ke(P.ORCH,"red",8,2),ke(P.TROLL,"green",5,0)],secrets:[Zt(Bt.NOTE,"Welcome to Drakriddarna",1,8)]}},Ot=e=>{e.actionLog.push("Game saved."),localStorage.setItem("state",JSON.stringify(e))},Jt=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),t.actionLog.push("Game loaded."),t}},Qt=()=>{const e=[F("Fearik","orange"),F("Helbran","red"),F("Siedel","green"),F("Wulf","lightblue")];return Nt(e,Ct),{heroes:e,dungeon:Ct,currentActor:e[0],actionLog:["Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."]}},F=(e,t)=>({name:e,actions:2,movement:3,defense:0,level:U.APPRENTICE,health:7,colour:t,experience:0}),$t=[F("Fearik","orange"),F("Helbran","red"),F("Siedel","green"),F("Wulf","lightblue")],Nt=(e,t)=>{e.forEach((n,o)=>n.position=t.startingPositions[o])},Le=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},en=(e,t,n)=>e.dungeon.layout.monsters.some(o=>{var s;return o.position.x===t&&((s=o.position)==null?void 0:s.y)===n&&o.health>0}),T=(e,t)=>{const n=t.currentActor;if(n.actions===0)return;let o=n.position.x,s=n.position.y;switch(e){case"UL":o=n.position.x-1,s=n.position.y-1;break;case"U":s=n.position.y-1;break;case"UR":o=n.position.x+1,s=n.position.y-1;break;case"L":o=n.position.x-1;break;case"R":o=n.position.x+1;break;case"DL":o=n.position.x-1,s=n.position.y+1;break;case"D":s=n.position.y+1;break;case"DR":o=n.position.x+1,s=n.position.y+1;break}const i=t.heroes.some(d=>d.position.x===o&&d.position.y===s),r=!Ut(t.dungeon.layout,o,s),c=en(t,o,s);if(!i&&!r){const d=xt(t.dungeon,o,s);d?d&&(c?nn(n,t,o,s):Pt(n,o,s,1)):sn(t,n,o,s)&&tn(n,t,o,s)}else t.actionLog.push(n.name+" could not make that move");n.movement===0&&(n.actions--,n.movement=3)},Pt=(e,t,n,o)=>{e.position.x=t,e.position.y=n,e.movement-=o},tn=(e,t,n,o)=>{const s=Oe(t.dungeon.layout.grid,n,o);s&&t.dungeon.discoveredRooms.push(s),Pt(e,e.position.x,e.position.y,1),t.actionLog.push(e.name+" opened a door")},nn=(e,t,n,o)=>{if(e.actions===1&&e.movement!==3){t.actionLog.push(e.name+" has no actions left to attack");return}const s=t.dungeon.layout.monsters.find(i=>{var r;return i.position.x===n&&((r=i.position)==null?void 0:r.y)===o});if(s){const i=Ce(e.level,3),r=Math.max(i-s.defense,0);t.actionLog.push(e.name+" attacked "+s.name+" for "+r+" damage ("+i+"-"+s.defense+"="+r+")"),s.health-=r,s.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(c=>c!=s),t.actionLog.push(e.name+" killed "+s.name),e.experience+=s.experience),(e==null?void 0:e.actions)>1&&(e==null?void 0:e.movement)<3?e.actions-=2:e.actions--}},Ce=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case U.APPRENTICE:n=n.filter(o=>o===6);break;case U.KNIGHT:case U.HERO:n=n.filter(o=>o>=5);break;case U.LORD:case U.MASTER:n=n.filter(o=>o>=4);break}return n.length},_t=e=>{const t=e.currentActor;if(!Kt(t)){e.actionLog.push(t.name+" has no actions left to pick lock");return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(Ce(t.level,1)>=1?(n.locked=!1,e.actionLog.push(t.name+" managed to pick the lock")):e.actionLog.push(t.name+" failed to pick the lock"),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--,t.movement=3)},Ht=e=>{const t=e.currentActor;if(!Kt(t)){e.actionLog.push(t.name+" has no actions left to search");return}const n=Ce(t.level,1);if(n>=1){const o=e.dungeon.layout.secrets.find(s=>Mt(s.position,t.position.x,t.position.y));o?e.actionLog.push(t.name+" searched ("+n+") and found "+o.name):(e.actionLog.push(t.name+" searched ("+n+") but found nothing"),console.log("found no secret"))}else e.actionLog.push(t.name+" searched ("+n+") but found nothing");(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--,t.movement=3},It=e=>{if(on(e),e.currentActor!==void 0){e.actionLog.push(e.currentActor.name+" ended their turn");let n=e.heroes.indexOf(e.currentActor)+1;n===e.heroes.length&&(rn(e),n=0),e.currentActor.actions=2,e.currentActor.movement=3,e.currentActor=e.heroes[n],e.actionLog.push(e.currentActor.name+" started their turn")}},on=e=>{e.dungeon.winConditions.forEach(t=>{switch(t.type){case ae.KILL_ALL:const n=e.dungeon.layout.monsters.map(s=>s.health).reduce((s,i)=>s+i,0);t.fulfilled=n<=0;break;case ae.REACH_CELL:t.fulfilled=e.heroes.some(s=>{var i;s.position.x===((i=t.targetCell)==null?void 0:i.x)&&(s.position.y,t.targetCell.y)});break;case ae.KILL_ONE:const o=e.dungeon.layout.monsters.find(s=>s.name===t.targetMonster);t.fulfilled=o.health===0;break}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,n)=>t&&n,!0),e.dungeon.beaten&&(e.actionLog.push("All win conditions have been fulfilled"),e.actionLog.push("You have cleared "+e.dungeon.name))},sn=(e,t,n,o)=>{var i;const s=e.dungeon.layout.doors.find(r=>{var c;return r.x===((c=t.position)==null?void 0:c.x)&&r.y===t.position.y});if(s&&!s.locked){const r=an(t.position.x,(i=t.position)==null?void 0:i.y,n,o);if(s.side===r)return s.open=!0,!0}return s.locked&&e.actionLog.push("Door is locked"),!1},an=(e,t,n,o)=>{if(e===n){if(t>o)return I.UP;if(t<o)return I.DOWN}if(t===o){if(e>n)return I.LEFT;if(e<n)return I.RIGHT}},Ut=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const s=Oe(e.grid,t,n);(s===zt||s===Vt||s===Xt)&&(o=!1)}return o},xt=(e,t,n)=>{const o=Oe(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},Oe=(e,t,n)=>{let o;return e.forEach((s,i)=>{Le(s).forEach((r,c)=>{i===n&&c===t&&(o=r)})}),o},Mt=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,rn=e=>{const t=e.dungeon.layout.monsters.filter(n=>{var s;const o=Oe(e.dungeon.layout.grid,(s=n.position)==null?void 0:s.x,n.position.y);return e.dungeon.discoveredRooms.includes(o)&&n.health>0});t.length===0&&e.actionLog.push("No monsters can act"),t.forEach(n=>{const o=n.actions;for(;n.actions>0;){e.actionLog.push(n.name+" acted ");const s=e.heroes.filter(i=>{var r;return Mt(n.position,(r=i.position)==null?void 0:r.x,i.position.y)});if(s.length>0){const i=Math.floor(Math.random()*s.length);dn(e,n,s[i])}else ln(e,n)}n.actions=o})};function wt(e,t){return Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2))}const ln=(e,t)=>{const n=e.heroes.map(s=>({hero:s,dist:wt(s.position,t.position)})).sort((s,i)=>s.dist-i.dist)[0],o=cn(e,t.position);if(o.length>0){const s=o.map(i=>({pos:i,dist:wt(i,n.hero.position)})).sort((i,r)=>i.dist-r.dist)[0].pos;t.position=s,e.actionLog.push(t.name+" moved towards "+n.hero.name+" ("+s.x+","+s.y+")")}else e.actionLog.push(t.name+" could not move");t.actions--};let cn=(e,t)=>{const n=t.x,o=t.y,s=[];for(let i=n-1;i<=n+1;i++)for(let r=o-1;r<=o+1;r++)i===n&&r===o||Ut(e.dungeon.layout,i,r)&&xt(e.dungeon,i,r)&&s.push({x:i,y:r});return s.filter(i=>!e.heroes.find(r=>r.position.x===i.x&&r.position.y===i.y)).filter(i=>!e.dungeon.layout.monsters.find(c=>c.position.x===i.x&&c.position.y===i.y))};const dn=(e,t,n)=>{if(t.actions===1&&t.movement!==3){e.actionLog.push(n.name+" has no actions left to attack");return}if(n){const o=Ce(t.level,3),s=Math.max(o-n.defense,0);e.actionLog.push(t.name+" attacked "+n.name+" for "+s+" damage ("+o+"-"+n.defense+"="+s+")"),n.health-=s,n.health<=0&&(e.actionLog.push(t.name+" killed "+n.name),e.heroes=e.heroes.filter(i=>i!==n)),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--}},Kt=e=>e.movement<3?e.actions>1:e.actions>0,un=""+new URL("../assets/Dungeon_Tileset.b0da342a.png",import.meta.url).href,fn="data:image/png;base64,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";function hn(e){let t;return{c(){t=f("canvas"),this.h()},l(n){t=h(n,"CANVAS",{width:!0,height:!0,id:!0}),A(t).forEach(v),this.h()},h(){S(t,"width","860"),S(t,"height","750"),S(t,"id","gameBoard")},m(n,o){se(n,t,o)},p:ne,i:ne,o:ne,d(n){n&&v(t)}}}function gn(e,t,n){let{state:o}=t;Fe(()=>{const a=new Image;a.src=un;const p=new Image;p.src=fn,s(a,p),setInterval(()=>s(a,p),10)});const s=(a,p)=>{if(!o||!document)return;const g=document.getElementById("gameBoard"),u=g.getContext("2d");u.clearRect(0,0,g.width,g.height),o.dungeon.layout.grid.forEach((k,C)=>{Le(k).forEach((L,E)=>i(u,L,E,C,a))}),o.dungeon.layout.grid.forEach((k,C)=>{Le(k).forEach((L,E)=>r(u,L,E,C))}),o.dungeon.layout.grid.forEach((k,C)=>{Le(k).forEach((L,E)=>c(u,L,E,C))}),o.dungeon.layout.grid.forEach((k,C)=>{Le(k).forEach((L,E)=>d(u,L,E,C,p))})},i=(a,p,g,u,k)=>{m(p)?(a.beginPath(),a.strokeStyle="black",a.fillStyle="black",a.fillRect(g*64,u*64,64,64),a.stroke()):a.drawImage(k,0,7*16,16,16,g*64,u*64,64,64)},r=(a,p,g,u)=>{a.beginPath(),a.strokeStyle="black",a.rect(g*64,u*64,64,64),a.font="7px Arial",a.fillText(g+","+u,g*64+1,u*64+30),a.stroke()},c=(a,p,g,u)=>{const k=y(g,u);if(k&&!k.open&&!m(p))switch(a.fillStyle="brown",k.side){case I.RIGHT:{a.fillRect(g*64+62,u*64,4,64),k.locked&&(a.fillStyle="grey",a.fillRect(g*64+60,u*64+28,8,8));break}case I.LEFT:{a.fillRect(g*64-2,u*64,4,64),k.locked&&(a.fillStyle="grey",a.fillRect(g*64-4,u*64+28,8,8));break}case I.UP:{a.fillRect(g*64,u*64-2,64,4),k.locked&&(a.fillStyle="grey",a.fillRect(g*64+30,u*64-4,8,8));break}case I.DOWN:{a.fillRect(g*64,u*64+62,64,4),k.locked&&(a.fillStyle="grey",a.fillRect(g*64+28,u*64+60,8,8));break}}},d=(a,p,g,u,k)=>{a.beginPath();const C=o.heroes.find(L=>L.position.x===g&&L.position.y===u);if(C)a.beginPath(),a.arc(g*64+16,u*64+16,13,0,2*Math.PI),a.strokeStyle=C.colour,a.stroke(),a.drawImage(k,4*16,0,16,16,g*64,u*64,64,64);else{const L=o.dungeon.layout.monsters.find(E=>E.position.x===g&&E.position.y===u);if(L&&L.health>0&&!m(p)){a.beginPath(),a.strokeStyle=L.colour,a.fillStyle=L.colour,a.arc(g*64+16,u*64+16,10,0,2*Math.PI),a.stroke(),a.font="7px Arial",a.fillStyle="black";const E=L.name[0]+"("+L.health+")";switch(L.type){case P.ORCH:a.drawImage(k,64,16,16,16,g*64,u*64,64,64);break;case P.TROLL:a.drawImage(k,48,16,16,16,g*64,u*64,64,64);break;default:a.drawImage(k,16,16,16,16,g*64,u*64,64,64);break}a.fillText(E,g*64+8,u*64+16)}}a.stroke()},m=a=>a===" "||!o.dungeon.discoveredRooms.includes(a),y=(a,p)=>o.dungeon.layout.doors.find(g=>g.x===a&&g.y===p);return e.$$set=a=>{"state"in a&&n(0,o=a.state)},[o]}class mn extends Ge{constructor(t){super(),qe(this,t,gn,hn,Te,{state:0})}}function vn(e){let t;return{c(){t=f("canvas"),this.h()},l(n){t=h(n,"CANVAS",{id:!0,height:!0,width:!0}),A(t).forEach(v),this.h()},h(){S(t,"id","characterBoard"),S(t,"height","750"),S(t,"width","260")},m(n,o){se(n,t,o)},p:ne,i:ne,o:ne,d(n){n&&v(t)}}}const oe=180;function pn(e,t,n){let{state:o}=t;Fe(()=>{s(),setInterval(s,100)});const s=()=>{if(!o||!document)return;const c=document.getElementById("characterBoard"),d=c.getContext("2d");d.clearRect(0,0,c.width,c.height),d.stroke(),o.heroes.forEach((m,y)=>i(d,c,m,y)),o.heroes.forEach((m,y)=>r(d,m,y))},i=(c,d,m,y)=>{c.fillStyle=m.colour,c.fillRect(12,y*oe+12,d.width,oe-12),c.stroke(),c.fillStyle="black"},r=(c,d,m)=>{const a=(d===o.currentActor?"> "+d.name:d.name)+" - "+d.level+" ("+d.experience+")";c.strokeStyle="black",c.font="18px Arial",c.fillText(a,16,m*oe+30),c.fillText("HP: "+d.health,16,m*oe+50),c.fillText("Actions: "+d.actions,16,m*oe+70),c.fillText("Moves: "+d.movement,16,m*oe+90),c.stroke()};return e.$$set=c=>{"state"in c&&n(0,o=c.state)},[o]}class An extends Ge{constructor(t){super(),qe(this,t,pn,vn,Te,{state:0})}}function St(e){let t,n='<canvas width="860" height="100" id="logs"></canvas>';return{c(){t=f("div"),t.innerHTML=n,this.h()},l(o){t=h(o,"DIV",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-xcon9n"&&(t.innerHTML=n),this.h()},h(){S(t,"class","log svelte-60nygp")},m(o,s){se(o,t,s)},p:ne,d(o){o&&v(t)}}}function kn(e){let t,n,o,s,i,r,c,d,m,y,a,p,g,u,k="UL",C,L,E,ze="U",_e,ie,G,Ve="UR",He,re,q,Xe="Next",Ie,B,le,z,Ze="L",we,Ee,Se,ce,V,je="R",Be,de,X,Je="Search",Ne,N,ue,Z,Qe="DL",Pe,fe,j,$e="D",Ue,he,J,et="DR",xe,ge,Q,tt="Pick lock",Me,$,me,ee,nt="Save",Ke,ve,te,ot="Load",Ye,st=e[0].actionLog,be,We,at;o=new An({props:{state:e[0]}});function Yt(b){e[1](b)}let it={};e[0]!==void 0&&(it.state=e[0]),r=new mn({props:it}),Wt.push(()=>qt(r,"state",Yt));let x=St();return{c(){t=f("div"),n=f("div"),Et(o.$$.fragment),s=R(),i=f("div"),Et(r.$$.fragment),d=R(),m=f("div"),y=f("div"),a=f("table"),p=f("tr"),g=f("td"),u=f("button"),u.textContent=k,C=R(),L=f("td"),E=f("button"),E.textContent=ze,_e=R(),ie=f("td"),G=f("button"),G.textContent=Ve,He=R(),re=f("td"),q=f("button"),q.textContent=Xe,Ie=R(),B=f("tr"),le=f("td"),z=f("button"),z.textContent=Ze,we=R(),Ee=f("td"),Se=R(),ce=f("td"),V=f("button"),V.textContent=je,Be=R(),de=f("td"),X=f("button"),X.textContent=Je,Ne=R(),N=f("tr"),ue=f("td"),Z=f("button"),Z.textContent=Qe,Pe=R(),fe=f("td"),j=f("button"),j.textContent=$e,Ue=R(),he=f("td"),J=f("button"),J.textContent=et,xe=R(),ge=f("td"),Q=f("button"),Q.textContent=tt,Me=R(),$=f("tr"),me=f("td"),ee=f("button"),ee.textContent=nt,Ke=R(),ve=f("td"),te=f("button"),te.textContent=ot,Ye=R(),x.c(),this.h()},l(b){t=h(b,"DIV",{class:!0});var _=A(t);n=h(_,"DIV",{class:!0});var pe=A(n);bt(o.$$.fragment,pe),pe.forEach(v),s=D(_),i=h(_,"DIV",{class:!0});var Ae=A(i);bt(r.$$.fragment,Ae),Ae.forEach(v),_.forEach(v),d=D(b),m=h(b,"DIV",{class:!0});var ye=A(m);y=h(ye,"DIV",{class:!0});var rt=A(y);a=h(rt,"TABLE",{});var M=A(a);p=h(M,"TR",{});var K=A(p);g=h(K,"TD",{});var lt=A(g);u=h(lt,"BUTTON",{"data-svelte-h":!0}),O(u)!=="svelte-fw3uxo"&&(u.textContent=k),lt.forEach(v),C=D(K),L=h(K,"TD",{});var ct=A(L);E=h(ct,"BUTTON",{"data-svelte-h":!0}),O(E)!=="svelte-1jeoia6"&&(E.textContent=ze),ct.forEach(v),_e=D(K),ie=h(K,"TD",{});var dt=A(ie);G=h(dt,"BUTTON",{"data-svelte-h":!0}),O(G)!=="svelte-1p8c8vc"&&(G.textContent=Ve),dt.forEach(v),He=D(K),re=h(K,"TD",{});var ut=A(re);q=h(ut,"BUTTON",{"data-svelte-h":!0}),O(q)!=="svelte-1rtxc14"&&(q.textContent=Xe),ut.forEach(v),K.forEach(v),Ie=D(M),B=h(M,"TR",{});var Y=A(B);le=h(Y,"TD",{});var ft=A(le);z=h(ft,"BUTTON",{"data-svelte-h":!0}),O(z)!=="svelte-10dnpu6"&&(z.textContent=Ze),ft.forEach(v),we=D(Y),Ee=h(Y,"TD",{}),A(Ee).forEach(v),Se=D(Y),ce=h(Y,"TD",{});var ht=A(ce);V=h(ht,"BUTTON",{"data-svelte-h":!0}),O(V)!=="svelte-12287ni"&&(V.textContent=je),ht.forEach(v),Be=D(Y),de=h(Y,"TD",{});var gt=A(de);X=h(gt,"BUTTON",{"data-svelte-h":!0}),O(X)!=="svelte-cps1bu"&&(X.textContent=Je),gt.forEach(v),Y.forEach(v),Ne=D(M),N=h(M,"TR",{});var W=A(N);ue=h(W,"TD",{});var mt=A(ue);Z=h(mt,"BUTTON",{"data-svelte-h":!0}),O(Z)!=="svelte-1ji074i"&&(Z.textContent=Qe),mt.forEach(v),Pe=D(W),fe=h(W,"TD",{});var vt=A(fe);j=h(vt,"BUTTON",{"data-svelte-h":!0}),O(j)!=="svelte-li5tq6"&&(j.textContent=$e),vt.forEach(v),Ue=D(W),he=h(W,"TD",{});var pt=A(he);J=h(pt,"BUTTON",{"data-svelte-h":!0}),O(J)!=="svelte-3esmwe"&&(J.textContent=et),pt.forEach(v),xe=D(W),ge=h(W,"TD",{});var At=A(ge);Q=h(At,"BUTTON",{"data-svelte-h":!0}),O(Q)!=="svelte-sacog4"&&(Q.textContent=tt),At.forEach(v),W.forEach(v),Me=D(M),$=h(M,"TR",{});var Re=A($);me=h(Re,"TD",{});var kt=A(me);ee=h(kt,"BUTTON",{"data-svelte-h":!0}),O(ee)!=="svelte-1vr5zyk"&&(ee.textContent=nt),kt.forEach(v),Ke=D(Re),ve=h(Re,"TD",{});var Lt=A(ve);te=h(Lt,"BUTTON",{"data-svelte-h":!0}),O(te)!=="svelte-1m2jkw7"&&(te.textContent=ot),Lt.forEach(v),Re.forEach(v),M.forEach(v),rt.forEach(v),Ye=D(ye),x.l(ye),ye.forEach(v),this.h()},h(){S(n,"class","characterSide svelte-60nygp"),S(i,"class","boardSide svelte-60nygp"),S(t,"class","container svelte-60nygp"),S(y,"class","commands svelte-60nygp"),S(m,"class","container svelte-60nygp")},m(b,_){se(b,t,_),l(t,n),yt(o,n,null),l(t,s),l(t,i),yt(r,i,null),se(b,d,_),se(b,m,_),l(m,y),l(y,a),l(a,p),l(p,g),l(g,u),l(p,C),l(p,L),l(L,E),l(p,_e),l(p,ie),l(ie,G),l(p,He),l(p,re),l(re,q),l(a,Ie),l(a,B),l(B,le),l(le,z),l(B,we),l(B,Ee),l(B,Se),l(B,ce),l(ce,V),l(B,Be),l(B,de),l(de,X),l(a,Ne),l(a,N),l(N,ue),l(ue,Z),l(N,Pe),l(N,fe),l(fe,j),l(N,Ue),l(N,he),l(he,J),l(N,xe),l(N,ge),l(ge,Q),l(a,Me),l(a,$),l($,me),l(me,ee),l($,Ke),l($,ve),l(ve,te),l(m,Ye),x.m(m,null),be=!0,We||(at=[H(u,"click",function(){w(T("UL",e[0]))&&T("UL",e[0]).apply(this,arguments)}),H(E,"click",function(){w(T("U",e[0]))&&T("U",e[0]).apply(this,arguments)}),H(G,"click",function(){w(T("UR",e[0]))&&T("UR",e[0]).apply(this,arguments)}),H(q,"click",function(){w(It(e[0]))&&It(e[0]).apply(this,arguments)}),H(z,"click",function(){w(T("L",e[0]))&&T("L",e[0]).apply(this,arguments)}),H(V,"click",function(){w(T("R",e[0]))&&T("R",e[0]).apply(this,arguments)}),H(X,"click",function(){w(Ht(e[0]))&&Ht(e[0]).apply(this,arguments)}),H(Z,"click",function(){w(T("DL",e[0]))&&T("DL",e[0]).apply(this,arguments)}),H(j,"click",function(){w(T("D",e[0]))&&T("D",e[0]).apply(this,arguments)}),H(J,"click",function(){w(T("DR",e[0]))&&T("DR",e[0]).apply(this,arguments)}),H(Q,"click",function(){w(_t(e[0]))&&_t(e[0]).apply(this,arguments)}),H(ee,"click",function(){w(Ot(e[0]))&&Ot(e[0]).apply(this,arguments)}),H(te,"click",e[2])],We=!0)},p(b,[_]){e=b;const pe={};_&1&&(pe.state=e[0]),o.$set(pe);const Ae={};!c&&_&1&&(c=!0,Ae.state=e[0],Ft(()=>c=!1)),r.$set(Ae),_&1&&Te(st,st=e[0].actionLog)?(x.d(1),x=St(),x.c(),x.m(m,null)):x.p(e,_)},i(b){be||(Rt(o.$$.fragment,b),Rt(r.$$.fragment,b),be=!0)},o(b){Dt(o.$$.fragment,b),Dt(r.$$.fragment,b),be=!1},d(b){b&&(v(t),v(d),v(m)),Tt(o),Tt(r),x.d(b),We=!1,Gt(at)}}}function Ln(e,t,n){let o=Qt();Fe(()=>{i(),setInterval(i,500),setInterval(s,1e3)});const s=()=>{if(o.dungeon.beaten&&o.dungeon.nextDungeon){n(0,o.dungeon=o.dungeon.nextDungeon,o);const d=$t.filter(m=>!o.heroes.find(y=>m.name===y.name));o.heroes.push(...d),Nt(o.heroes,o.dungeon),n(0,o.actionLog=[],o),o.actionLog.push("You have reached "+o.dungeon.name)}},i=()=>{if(!o||!document)return;const d=document.getElementById("logs"),m=d.getContext("2d");m.clearRect(0,0,d.width,d.height),o.actionLog.slice(-10).reverse().forEach((y,a)=>{m.font="12px Arial",m.fillStyle="black",m.fillText("> "+y,2,(a+1)*12+2),m.stroke()})};function r(d){o=d,n(0,o)}return[o,r,()=>n(0,o=Jt())]}class yn extends Ge{constructor(t){super(),qe(this,t,Ln,kn,Te,{})}}export{yn as component};
