import{s as He,n as ce,o as Cn,b as Tn,f as Dn,r as $t}from"../chunks/scheduler.bc760b9c.js";import{S as sn,i as an,g as f,h as m,j as g,f as d,k as x,a as L,x as c,y as F,s as C,m as I,c as w,n as R,o as le,z as X,p as ln,t as ne,b as cn,d as V,e as ve,A as Zn,B as On,r as en,u as nn,v as tn,w as on,l as lt,C as io}from"../chunks/index.54d4ae92.js";const ao=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function yn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var j=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(j||{}),te=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(te||{}),re=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(re||{}),Ve=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(Ve||{}),be=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(be||{}),K=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(K||{}),P=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e[e.MAGIC=3]="MAGIC",e))(P||{});const Vn=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:P.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:P.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:P.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:P.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:P.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Fn=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:P.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:P.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:P.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],lo=[{name:"Chain mail",type:P.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:P.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:P.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],ct=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:P.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:P.ARMOUR,movementReduction:0,value:0}],co="0",Ut="@",Qn=" ",Bn="?",Yn="#",Nn=(e,n,t,o)=>({type:e,name:n,position:{x:t,y:o},found:!1}),uo=(e,n,t,o)=>({type:e,name:o.name,position:{x:n,y:t},found:!1,item:o}),Ie=(e,n,t)=>({side:e,x:n,y:t,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),ut=(e,n,t)=>({...Ie(e,n,t),hidden:!0}),Ue=(e,n,t,o)=>{const r=Object.values(j).indexOf(n),s=Object.keys(j)[r];let i=re.LORD,a=2,l=2,u=4,y=4,v=4,p=Fn[0],O,A=ct[0];switch(e){case te.ORCH:{i=re.APPRENTICE,l=0,u=2,y=2,v=1,O=Fn[1];break}case te.TROLL:{i=re.KNIGHT,l=1,u=3,y=3,v=2,p=Fn[2],A=ct[1];break}}return e===te.YELLOW_DARK_LORD&&(a=3),{type:e,level:i,colour:n,actions:a,defense:l,health:u,maxHealth:y,experience:v,name:e+" ("+s+")",movement:3,maxMovement:3,position:{x:t,y:o},weapon:p,armour:A,incapacitated:!1,inventory:[],rangedWeapon:O}},fo=e=>{const n=e.currentActor;if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}const t=n.inventory.filter(l=>{var u;return(u=l.properties)==null?void 0:u[mt]}).map(l=>{var u;return h(e,`${n.name} used the effect of ${l.name} when searching`),(u=l.properties)==null?void 0:u[mt]}).reduce((l,u)=>l+u,0),o=_n(n.level,1+t);let r,s,i,a;o>=1?(r=Ao(e,n,o),r||(s=yo(e,n,o)),!r&&!s&&(i=ko(e,n,o)),!r&&!s&&!i&&(a=_o(e,n,o)),!r&&!s&&!i&&!a&&h(e,`${n.name} searched but found nothing`)):h(e,`${n.name} searched but found nothing`)},Gt=e=>{const n=e.currentActor;if(!n)return!1;const t=e.dungeon.layout.secrets.filter(o=>o.type===be.TRAP_DOOR).filter(o=>!o.found).find(o=>Rn(o.position,n.position));return t?(rn(e,mo(t),n,!1),h(e,`${n.name} fell into a pit and is incapacitated for one turn.`),n.movement=0,n.actions=0,n.incapacitated=!0,t.found=!0,!0):!1},Wt=(e,n)=>{const t=e.itemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.itemDeck.splice(t,1)},Yt=(e,n)=>{const t=e.magicItemDeck.findIndex(o=>o.type===n.type&&o.name===n.name);e.magicItemDeck.splice(t,1)},mo=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:j.Red,maxHealth:0,name:"Trap Door",level:re.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:P.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),ho=(e,n)=>e.dungeon.layout.doors.filter(t=>t.hidden).find(t=>xn({x:t.x,y:t.y},n.x,n.y)),po=(e,n)=>e.dungeon.layout.doors.filter(t=>t.trapped).find(t=>t.x===n.x&&t.y===n.y),go=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).find(t=>xn(t.position,n.x,n.y)),vo=(e,n)=>e.dungeon.layout.secrets.filter(t=>!t.found).filter(t=>t.type===be.TRAP_DOOR).find(t=>xn(t.position,n.x,n.y)),yo=(e,n,t)=>ho(e,n.position)?(h(e,`${n.name} searched (${t}) and found a hidden door`),!0):!1,ko=(e,n,t)=>{const o=po(e,n.position);return o?(h(e,`${n.name} searched (${t}) and found a trap in a door`),o.trapped=!1,!0):!1},_o=(e,n,t)=>{const o=go(e,n.position);if(o){switch(h(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,o.type){case be.EQUIPMENT:{let r=o.item??bo(e);if(r.amountInDeck>0)switch(Wt(e,r),h(e,`${n.name} equipped (${r.name})`),r.type){case P.ARMOUR:n.armour&&n.inventory.push(n.armour),n.armour=r;break;case P.SHIELD:n.shield&&n.inventory.push(n.shield),n.shield=r;break;case P.WEAPON:n.weapon&&n.inventory.push(n.weapon),n.weapon=r;break}break}case be.MAGIC_ITEM:{let r=o.item??Eo(e);r.amountInDeck>0&&(Yt(e,r),h(e,`${n.name} found (${r.name})`),n.inventory.push(r),r.pickup&&Jn[r.pickup](e,r,n));break}}return!0}return!1},bo=e=>{const n=e.itemDeck.length,t=Math.floor(Math.random()*n);return e.itemDeck[t]},Eo=e=>{const n=e.magicItemDeck.length,t=Math.floor(Math.random()*n);return e.magicItemDeck[t]},Ao=(e,n,t)=>{const o=vo(e,n.position);return o?(h(e,`${n.name} searched (${t}) and found ${o.name}`),o.found=!0,!0):!1},Ln=(e,n)=>(Vn[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:re.APPRENTICE,health:7,maxHealth:7,colour:n,experience:0,position:{x:-1,y:-1},weapon:Vn[0],incapacitated:!1,inventory:[]}),se=(e,n)=>{const t=n.currentActor;if(!t||t.actions===0)return;const o={x:t.position.x,y:t.position.y};switch(e){case"UL":o.x=t.position.x-1,o.y=t.position.y-1;break;case"U":o.y=t.position.y-1;break;case"UR":o.x=t.position.x+1,o.y=t.position.y-1;break;case"L":o.x=t.position.x-1;break;case"R":o.x=t.position.x+1;break;case"DL":o.x=t.position.x-1,o.y=t.position.y+1;break;case"D":o.y=t.position.y+1;break;case"DR":o.x=t.position.x+1,o.y=t.position.y+1;break}const r=Mn(n,o.x,o.y),s=!Kn(n.dungeon.layout,o.x,o.y),i=wn(n,o.x,o.y);if(!r&&!s){const a=Sn(n.dungeon,o.x,o.y);a?a&&(i?Ft(t,n,o):qt(t,n,o.x,o.y,1)):Io(n,t,o.x,o.y)&&An(t,n,o.x,o.y)}else h(n,`${t.name} could not make that move`);Gt(n)||$n(t)},qn=e=>{const n=e.currentActor;if(!n)return;if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}if(!kn(n)){h(e,`${n.name} has no actions left to pick lock`);return}const t=e.dungeon.layout.doors.find(o=>o.x===n.position.x&&o.y===n.position.y);t&&t.locked&&(_n(n.level,1)>=1?(t.locked=!1,h(e,`${n.name} managed to pick the lock`)):h(e,`${n.name} failed to pick the lock`),n.actions>1&&n.movement<3?n.actions-=2:n.actions--,n.movement=qe(n),n.actions==0&&(n.movement=0))},Kt=e=>{e.heroes.forEach((n,t)=>{n.position=e.dungeon.startingPositions[t],n.movement=qe(n),n.actions=2,n.health=n.maxHealth})},N=e=>e.heroes.filter(n=>n.health>0),dt=e=>{const n=e.currentActor;n&&(n.actions--,n.movement=qe(n),n.actions===0&&Pn(e))},kn=e=>e.movement<qe(e)?e.actions>1:e.actions>0,An=(e,n,t,o)=>{const r=Ge(n.dungeon.layout.grid,t,o);r&&n.dungeon.discoveredRooms.push(r),qt(e,n,e.position.x,e.position.y,1),h(n,`${e.name} opened a door`)},Ft=(e,n,t)=>{if(e.actions===1&&e.movement<e.maxMovement){h(n,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&Mo(n,e)){h(n,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const o=wo(n,t);o&&(rn(n,e,o,!1),o.health<=0&&Co(n,o,e),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},Xn=e=>{const n=e.currentActor;if(n){if(n.blinded){h(e,`${n.name} is blinded and may not search.`);return}if(!kn(n)){h(e,`${n.name} has no actions left to search`);return}fo(e),n.actions>1&&n.movement<qe(n)?n.actions-=2:n.actions--,n.actions==0&&(n.movement=0)}},wn=(e,n,t)=>e.dungeon.layout.monsters.some(o=>o.position.x===n&&o.position.y===t&&o.health>0),Mn=(e,n,t)=>N(e).some(o=>o.position.x===n&&o.position.y===t),$n=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=qe(e))),e.actions==0&&(e.movement=0)},To=e=>{N(e).forEach(n=>{const t=n.level;n.experience>=28?n.level=re.MASTER:n.experience>=18?n.level=re.LORD:n.experience>=10?n.level=re.HERO:n.experience>=4&&(n.level=re.KNIGHT),t!==n.level&&h(e,`${n.name} leveled up to ${n.level}`)})},Do=e=>{N(e).forEach(n=>n.experience+=4)},Oo=e=>{Ho(e).forEach(n=>{n.experience=0,n.health=n.maxHealth,n.movement=n.maxMovement,n.actions=2})},Vt=(e,n,t)=>!t.open&&!t.hidden&&(!t.locked||t.locked&&n)&&e.movement>0,qt=(e,n,t,o,r)=>{e.position.x=t,e.position.y=o;const s=n.dungeon.layout.notes.find(a=>Rn(a.position,e.position));s&&(n.dungeon.layout.doors.some(l=>l.hidden&&Rn(s.position,{x:l.x,y:l.y}))||h(n,`${e.name} reads: ${s.message}`)),n.dungeon.layout.monsters.some(a=>xn(e.position,a.position.x,a.position.y))?(h(n,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=r},Io=(e,n,t,o)=>{const r=e.dungeon.layout.doors.find(i=>i.x===n.position.x&&i.y===n.position.y),s=n.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[Xt]});if(r&&Vt(n,s,r)){r.locked&&s&&h(e,`${n.name} broke the locked door`);const i=Ro(n.position.x,n.position.y,t,o);if(r.side===i)return r.open=!0,r.trapped&&rn(e,oo(r),n,!1),!0}return r&&r.locked&&h(e,"Door is locked"),!1},Ro=(e,n,t,o)=>{if(e===t){if(n>o)return K.UP;if(n<o)return K.DOWN}if(n===o){if(e>t)return K.LEFT;if(e<t)return K.RIGHT}},Co=(e,n,t)=>{e.dungeon.layout.monsters=e.dungeon.layout.monsters.filter(o=>o!=n),h(e,`${t.name} killed ${n.name}`),e.dungeon.killCount++,t.experience+=n.experience},wo=(e,n)=>e.dungeon.layout.monsters.find(t=>Rn(t.position,n)),Mo=(e,n)=>ro(e,n).filter(t=>t!==n).length>0,Ho=e=>e.heroes.filter(n=>n.health<=0),$e="USED",ft="ATTACK_BONUS",mt="SEARCH_BONUS",Xt="BREAK_LOCK",ht="RE_ROLL_ATTACK",pt="DESCRIPTION",Un="ACTIVE",Gn="MOVEMENT_BONUS",gt="ACTIONS_BONUS",jt="RESET_ON",Zt="NEXT_TURN",xo="TRADE",Qt="NEXT_SCENARIO",Jt=[{name:"Healing Herbs",type:P.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,ACTIVE:!0,DESCRIPTION:"Chance to heal up to 3 wounds on one hero.",RESET_ON:[xo,Qt]},effect:"magicHerbsOnUse",reset:"magicHerbsOnReset"},{name:"Thousand League Boots",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives one additional step for each move action.",MOVEMENT_BONUS:1},pickup:"movementBonusOnPickup",drop:"movementBonusOnDrop"},{name:"Giants Glove",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional attack die. Breaks locked doors.",BREAK_DOOR:!0,ATTACK_BONUS:1}},{name:"Ring of Precision",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"May re-roll one completely missed attack.",RE_ROLL_ATTACK:!0}},{name:"Crown of Wisdom",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"One additional die roll when searching.",SEARCH_BONUS:1}},{name:"Sword of Chaos",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"A sword with a will of it's own. Use at your own peril."},effect:"chaosSwordOnUse"},{name:"Potion of Speed",type:P.MAGIC,value:0,amountInDeck:1,properties:{DESCRIPTION:"Gives 2 additional actions. Can only be used once.",USED:!1,ACTIONS_BONUS:2,ACTIVE:!0},effect:"potionOfSpeedOnUse"},{name:"Necklace of Light",type:P.MAGIC,value:0,amountInDeck:1,properties:{USED:!1,RESET_ON:[Zt],ACTIVE:!0},effect:"necklaceOfLightOnUse",reset:"necklaceOfLightOnReset"}],Jn={movementBonusOnPickup:(e,n,t)=>{var o,r;t.maxMovement+=(o=n.properties)==null?void 0:o[Gn],t.movement+=(r=n.properties)==null?void 0:r[Gn]}},Lo={movementBonusOnDrop:(e,n,t)=>{var o,r;t.maxMovement-1>0&&(t.maxMovement-=(o=n.properties)==null?void 0:o[Gn]),t.movement-1>=0&&(t.movement-=(r=n.properties)==null?void 0:r[Gn])}},No={magicHerbsOnUse:(e,n,t,o)=>{if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}if(!o){h(e,"No target was selected.");return}if(!kn(t)){h(e,`${t.name} has no actions left.`);return}if(n.properties){if(n.properties[$e]){h(e,`${n.name} has no uses left.`);return}n.properties[$e]=!0;let r=Math.min(_n(t.level,3),o.maxHealth-o.health);o.health+=r,h(e,`${t.name} used ${n.name} on ${o.name}, restoring ${r} HP`),t.actions--,t.movement=t.maxMovement}},chaosSwordOnUse:(e,n,t,o)=>{if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}},potionOfSpeedOnUse:(e,n,t)=>{var o,r,s;if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}(o=n.properties)!=null&&o[$e]?h(e,`${n.name} has been consumed.`):(t.actions+=(r=n.properties)==null?void 0:r[gt],n.properties&&(n.properties[$e]=!0),h(e,`${t.name} used ${n.name}, adding ${(s=n.properties)==null?void 0:s[gt]} actions`))},necklaceOfLightOnUse:(e,n,t,o)=>{var r;if(n.disabled){h(e,`${n.name} cannot be used at this moment.`);return}if(!o){h(e,"No target was selected.");return}if(!kn(t)){h(e,`${t.name} has no actions left.`);return}n.properties&&!((r=n.properties)!=null&&r[$e])&&(n.properties[$e]=!0,o.ignoredByMonsters=!0,t.actions--)}},St={magicHerbsOnReset:(e,n)=>{n.properties&&(n.properties[$e]=!1)},necklaceOfLightOnUse:(e,n)=>{n.properties&&(n.properties[$e]=!1),e.heroes.forEach(t=>t.ignoredByMonsters=!1)}},zt={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:Ve.KILL_ALL,fulfilled:!1},{type:Ve.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:2,y:5},{x:1,y:4},{x:1,y:5},{x:1,y:6}],discoveredRooms:["A"],layout:{grid:["            ######","            #EEEE#","         ####EEEE#","##### ####DDDEEEE#","#AAA###CCCC#######","#AAABBBCCCC###GGG#","#AAA###CCCCFFFGGG#","##### #CCCC###GGG#","      #CCCC#######","      #CCCCHHHIII#","      ########III#","             #III#","             #####"],corridors:["B","D","F","H"],doors:[Ie(K.RIGHT,3,5),Ie(K.RIGHT,6,5),Ie(K.RIGHT,10,6),Ie(K.RIGHT,13,6),Ie(K.RIGHT,10,9),Ie(K.RIGHT,13,9),Ie(K.RIGHT,12,3),ut(K.UP,9,4),ut(K.RIGHT,15,2)],monsters:[Ue(te.ORCH,j.Blue,10,8),Ue(te.ORCH,j.Red,13,9),Ue(te.TROLL,j.Red,16,2),Ue(te.TROLL,j.Yellow,14,7)],secrets:[Nn(be.EQUIPMENT,"Random Equipment",10,5),Nn(be.EQUIPMENT,"Random Equipment",13,1),Nn(be.EQUIPMENT,"Random Equipment",16,10),uo(be.MAGIC_ITEM,16,6,Jt[0])],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}],items:[]},killCount:0},Po={name:"Troll cave",beaten:!1,winConditions:[{type:Ve.KILL_ALL,fulfilled:!1}],nextDungeon:zt,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[Ie(K.RIGHT,3,9),Ie(K.RIGHT,6,9),Ie(K.UP,7,7),Ie(K.UP,7,4)],monsters:[Ue(te.ORCH,j.Green,6,9),Ue(te.ORCH,j.Yellow,8,10),Ue(te.ORCH,j.Red,7,5),Ue(te.ORCH,j.Red,9,3),Ue(te.TROLL,j.Green,6,1)],secrets:[Nn(be.NOTE,"Welcome to Drakriddarna",3,9)],notes:[],items:[],corridors:["D","E"]},killCount:0,events:[1,2,3,4,5,6]},Bo=[{name:"Large shield",type:P.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:P.SHIELD,amountInDeck:2,dice:1,value:1}],$o=()=>{const e=[];return Jt.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},Uo=()=>{const e=[];return Vn.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),lo.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),Bo.forEach(n=>{for(let t=0;t<n.amountInDeck;t++)e.push(n)}),e},ze={name:"Treasure of the Ice Dragon",dungeons:[Po,zt],itemDeck:Uo(),magicItemDeck:$o(),heroes:[Ln("Fearik",j.Yellow),Ln("Helbran",j.Red),Ln("Siedel",j.Green),Ln("Wulf",j.Blue)]},Go=e=>{const n=Vo(e);n.length===0&&h(e,"No monsters can act"),n.forEach(t=>{const o=t.actions;for(h(e,`${t.name} acted `);t.actions>0;){const r=ro(e,t).filter(a=>!a.ignoredByMonsters),s=Fo(e,t);switch(Wo(e,t,r,s)){case"MELEE_ATTACK":{const a=Ko(r);vt(e,t,a,!1);break}case"RANGED_ATTACK":{const a=Yo(s,t);vt(e,t,a,!0);break}case"MOVE":{Xo(e,t);break}}t.movement=qe(t)}t.actions=o,t.movement=qe(t)})},Wo=(e,n,t,o)=>t.length>0?"MELEE_ATTACK":n.rangedWeapon&&o.length>0&&n.rangedWeapon?Math.random()<.1?(h(e,`${n.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":"MOVE",Yo=(e,n)=>e.filter(t=>!t.shield).sort(t=>In(n.position,t.position)).sort((t,o)=>o.health-t.health||In(n.position,t.position)-In(n.position,o.position))[0],Ko=e=>e.sort((n,t)=>t.health-n.health)[0],Fo=(e,n)=>N(e).filter(t=>!t.ignoredByMonsters).filter(t=>{const o={x:n.position.x*48-24,y:n.position.y*48-24},r={x:t.position.x*48-24,y:t.position.y*48-24};return zn(o,n.position,r,t.position,e,[])}),Vo=e=>e.dungeon.layout.monsters.filter(n=>{const t=Ge(e.dungeon.layout.grid,n.position.x,n.position.y);return t&&e.dungeon.discoveredRooms.includes(t)&&n.health>0}),vt=(e,n,t,o)=>{rn(e,n,t,o),(n==null?void 0:n.actions)>1&&(n==null?void 0:n.movement)<3?n.actions-=2:n.actions--},qo=(e,n)=>N(e).map(t=>({hero:t,dist:In(t.position,n.position)})).sort((t,o)=>t.dist-o.dist)[0],Xo=(e,n)=>{const t=qo(e,n);for(;n.movement>0;){if(t.dist>1){const o=jo(e,n.position);if(o.length>0){const r=o.map(s=>({pos:s,dist:In(s,t.hero.position)})).sort((s,i)=>s.dist-i.dist)[0].pos;n.position=r,h(e,`${n.name} moved towards ${t.hero.name} (${r.x},${r.y})`)}else h(e,`${n.name} could not move`)}n.movement--}n.actions--},jo=(e,n)=>{const t=n.x,o=n.y,r=[];for(let s=t-1;s<=t+1;s++)for(let i=o-1;i<=o+1;i++)s===t&&i===o||Kn(e.dungeon.layout,s,i)&&Sn(e.dungeon,s,i)&&r.push({x:s,y:i});return r.filter(s=>!N(e).find(i=>i.position.x===s.x&&i.position.y===s.y)).filter(s=>!e.dungeon.layout.monsters.some(i=>i.position.x===s.x&&i.position.y===s.y))},Zo=(e,n)=>{if(n.effect&&e.currentActor){const t=No[n.effect];t(e,n,e.currentActor,e.targetActor),e.targetActor=void 0}},Qo=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>zo(t)).forEach(t=>{if(t.reset){const o=St[t.reset];o(e,t)}})})},Jo=e=>{e.heroes.forEach(n=>{n.inventory.filter(t=>So(t)).forEach(t=>{if(t.reset){const o=St[t.reset];o(e,t)}})})},So=e=>e.properties?(e.properties[jt]??[]).some(t=>t===Zt):!1,zo=e=>e.properties?(e.properties[jt]??[]).some(t=>t===Qt):!1,yt=[{name:"The Hungry Troll",number:1,description:"You suddenly hear a terrible roar echo in the halls behind you. It's the sound of a hungry troll",effect:"theHungryTroll",used:!1},{name:"The Sun Stone",number:2,description:"One of you kicks a pile of rubble, revealing a small, transparent crystal. It radiates a warm, yellow light turning all nearby trolls to stone.",effect:"sunStone",used:!1},{name:"The Time Portal",number:3,description:"You notice how everything around you seem to move slower, as if time it self had slowed down.",effect:"timePortal",used:!1},{name:"The Fountain of Youth",number:4,description:"You hear the weak sound of water running from a wall. When you taste it, you feel stronger than before",effect:"fountainOfYouth",used:!1},{name:"Sleeping Gas Cloud",number:5,description:"Noxious gas seeps through a hole in the wall, making you feel heavy and sleepy.",effect:"sleepingGasCloud",used:!1},{name:"The Lost Orch",number:6,description:"You hear a snarling filled with rage somewhere behind you. You quickly realise there were more monsters here than you thought.",effect:"theLostOrch",used:!1},{name:"The Dragons Breath",number:7,description:"The flames of your torches start to flicker and soon the dungeon is completely dark.",effect:"theDragonsBreath",used:!1},{name:"Landslide",number:8,description:"The ground starts shaking, and you hear a loud crash, as if the ceiling had fallen down.",effect:"landslide",used:!1},{name:"The Magic Node",number:9,description:"You feel a strange, powerful magic course through you. You feel invigorated by it as you press on.",effect:"fountainOfYouth",used:!1},{name:"Foresight",number:10,description:"You see before you a powerful object, hidden behind thick walls.",effect:"foresight",used:!1},{name:"Earthquake",number:11,description:"The whole room starts shaking and you are thrown to the ground. Stones fall from the ceiling and walls and with terror you realise that you ar caught in an earhtquake.",effect:"earthquake",used:!1},{name:"The Magic Storm",number:12,description:"An unsettling wind blows through the dungeon. You freeze as a green glow emanates from one of your magical items",effect:"theMagicStorm",used:!1},{name:"The Elemental Weapon",number:13,description:"A flame suddenly shoots from a silver clad stone in the ceiling, moving towards one of your weapons. The weapon becomes engulfed in flames, feeling more powerful than before.",effect:"theElementalWeapon",used:!1},{name:"The Orch Drums",number:14,description:"You hear the sound of drums from deep below you. As the sound draws nearer, you realise the orchs are on the march.",effect:"theOrchDrums",used:!1},{name:"The Symbol of Weakness",number:15,description:"You walk past a strange symbol on the wall. An evil, yellow glow emanates from it. All of you suddenly feel weaker.",effect:"theSymbolOfWeakness",used:!1}],eo=e=>e.events?jn(yt.filter(n=>{var t;return(t=e==null?void 0:e.events)==null?void 0:t.includes(n.number)})):jn(yt),no=e=>{const n=e.eventDeck.filter(t=>!t.used);return n.length>0?n[0]:(jn(e.eventDeck),no(e))},er={sunStone:(e,n)=>{ge(e,n);const t=N(e).length-1,o=Math.floor(Math.random()*t),r=N(e)[o],s=Ge(e.dungeon.layout.grid,r.position.x,r.position.y);e.dungeon.layout.monsters.filter(i=>i.type===te.TROLL).filter(i=>Ge(e.dungeon.layout.grid,i.position.x,i.position.y)===s).forEach(i=>{h(e,`${i.name} was killed by the Sun Stone`),i.health=0}),n.used=!0},theHungryTroll:(e,n)=>{ge(e,n),kt(e,te.TROLL),n.used=!0},timePortal:(e,n)=>{ge(e,n),e.heroes.forEach(t=>t.actions++),n.used=!0},fountainOfYouth:(e,n)=>{ge(e,n),N(e).forEach(t=>{if(t.health<t.maxHealth){const o=_n(t.level,3);t.health+=Math.min(o,t.maxHealth-t.health)}}),n.used=!0},sleepingGasCloud:(e,n)=>{ge(e,n),N(e).forEach(t=>{t.actions=Math.max(1,t.actions-1)}),n.used=!0},theLostOrch:(e,n)=>{ge(e,n),kt(e,te.ORCH),n.used=!0},theDragonsBreath:(e,n)=>{ge(e,n),N(e).forEach(t=>t.blinded=!0),n.used=!0},landslide:(e,n)=>{ge(e,n);const o=e.dungeon.layout.corridors.filter(i=>!ar(e,i)).filter(i=>e.dungeon.discoveredRooms.includes(i)).length-1,r=Math.floor(Math.random()*o),s=e.dungeon.layout.corridors[r];e.dungeon.collapsedCorridor=s,e.dungeon.layout.grid=e.dungeon.layout.grid.map(i=>i.replaceAll(s,Bn)),n.used=!0},foreSight:(e,n)=>{if(ge(e,n),e.dungeon.layout.secrets.filter(o=>o.type===be.EQUIPMENT||o.type===be.MAGIC_ITEM).filter(o=>!o.found).filter(o=>o.item).filter(o=>{const r=Ge(e.dungeon.layout.grid,o.position.x,o.position.y)??"";return!e.dungeon.discoveredRooms.includes(r)}).length>0){const o=e.dungeon.layout.secrets.pop();o&&o.item&&(h(e,`You sense the object is close to (${o.position.x+2},${o.position.y-1})`),e.dungeon.layout.items.push({item:o.item,position:o.position}))}n.used=!0},earthquake:(e,n)=>{ge(e,n);const t=to(e),o={name:"boulder",type:P.WEAPON,value:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,properties:[],amountInDeck:0,ignoresShield:!1,ignoresArmour:!1},r={name:"Earthquake",actions:0,health:0,maxMovement:0,position:{x:0,y:0},weapon:o,level:re.APPRENTICE,maxHealth:0,movement:0,experience:0,colour:j.Red,inventory:[],defense:0};e.dungeon.layout.monsters.filter(s=>s.type===te.TROLL).filter(s=>Ge(e.dungeon.layout.grid,s.position.x,s.position.y)===t).forEach(s=>rn(e,r,s,!1)),N(e).filter(s=>Ge(e.dungeon.layout.grid,s.position.x,s.position.y)===t).forEach(s=>rn(e,r,s,!1)),n.used=!0},theMagicStorm:(e,n)=>{var o;ge(e,n);const t=N(e).filter(r=>r.inventory.filter(s=>!s.disabled).some(s=>s.type===P.MAGIC));if(t.length>0){const r=t.length-1,s=Math.floor(Math.random()*r),i=t[s],a=i.inventory.filter(l=>l.type===P.MAGIC);if(a.length>0){const l=a.length-1,u=Math.floor(Math.random()*l),y=a[u];y.disabled=!0,!((o=y.properties)!=null&&o[Un])&&y.pickup&&y.drop&&Lo[y.drop](e,y,i)}}n.used=!0},theElementalWeapon:(e,n)=>{ge(e,n);const t=N(e),o=t.length-1,r=Math.floor(Math.random()*o),s=t[r];s.weapon.elemental=!0,n.used=!0},theOrchDrums:(e,n)=>{ge(e,n),e.dungeon.layout.monsters.filter(t=>t.type===te.ORCH).forEach(t=>t.actions=3),n.used=!0},theSymbolOfWeakness:(e,n)=>{ge(e,n),N(e).forEach(t=>t.weakened=!0),n.used=!0}},nr=e=>{N(e).some(n=>n.weapon.elemental)&&(h(e,"The magic storm calmed down"),N(e).forEach(n=>{n.inventory.forEach(t=>{var o;!((o=t.properties)!=null&&o[Un])&&t.pickup&&Jn[t.pickup](e,t,n),t.disabled=!1})}))},tr=e=>{e.eventDeck.filter(t=>!t.used).length===0&&(sr(e),or(e),nr(e)),ir(e),rr(e)},or=e=>{const n=e.dungeon.collapsedCorridor;n&&(h(e,"The collapsed corridor cleared up."),e.dungeon.layout.grid=e.dungeon.layout.grid.map(t=>t.replaceAll(Bn,n)),e.dungeon.collapsedCorridor=void 0)},rr=e=>{N(e).some(n=>n.blinded)&&(h(e,"You light your torches again."),N(e).forEach(n=>n.blinded=!1))},sr=e=>{N(e).some(n=>n.weapon.elemental)&&(h(e,"The elemental magic died off."),N(e).forEach(n=>n.weapon.elemental=!1))},ir=e=>{N(e).some(n=>n.weakened)&&(h(e,"Your strength returns to you."),N(e).forEach(n=>n.weakened=!1))},to=e=>{const n=e.dungeon.discoveredRooms.length-1,t=Math.floor(Math.random()*n);return e.dungeon.discoveredRooms[t]},kt=(e,n)=>{const t=e.dungeon.layout.monsters.filter(a=>a.type===n);if(t.length===4)return;const r=to(e),s=[j.Red,j.Green,j.Yellow,j.Blue];t.forEach(a=>{const l=s.indexOf(a.colour);l!==-1&&s.splice(l,1)});let i=!1;for(let a=0;a<e.dungeon.layout.grid.length;a++){const l=Hn(e.dungeon.layout.grid[a]);for(let u=0;u<l.length;u++)if(l[u]===r&&!Mn(e,u,a)&&!wn(e,u,a)){e.dungeon.layout.monsters.push(Ue(n,s[0],u,a)),i=!0;break}if(i)break}},ge=(e,n)=>{h(e,`${n.description}`),h(e,`${n.number}. ${n.name}`)},jn=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e.forEach(o=>o.used=!1),e},ar=(e,n)=>{const t=[];return e.dungeon.layout.grid.forEach((o,r)=>{Hn(o).forEach((s,i)=>{s===n&&t.push(Mn(e,i,r)||wn(e,i,r))})}),t.some(o=>o)},_t=e=>{h(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},bt=()=>{const e=localStorage.getItem("state");if(e){const n=JSON.parse(e);return n.currentActor=n.heroes.find(t=>{var o;return t.name===((o=n.currentActor)==null?void 0:o.name)}),h(n,"Game loaded."),n}},lr=()=>{const e={heroes:ze.heroes,dungeon:ze.dungeons[0],currentActor:ze.heroes[0],actionLog:[`Playing '${ze.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:Et(ze.itemDeck),magicItemDeck:Et(ze.magicItemDeck),settings:{cellSize:48,debug:!1},eventDeck:eo(ze.dungeons[0])};return Kt(e),e},Et=e=>{let n=e.length,t;for(;n>0;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},Hn=e=>{let n=[];for(let t=0;t<e.length;t++)n.push(e[t]);return n},_n=(e,n)=>{let t=[];for(let o=0;o<n;o++)t.push(Math.floor(Math.random()*6)+1);switch(e){case re.APPRENTICE:t=t.filter(o=>o===5);break;case re.KNIGHT:case re.HERO:t=t.filter(o=>o>=4);break;case re.LORD:case re.MASTER:t=t.filter(o=>o>=3);break}return t.length},qe=e=>{var n;return e.maxMovement-(((n=e.armour)==null?void 0:n.movementReduction)??0)},Pn=e=>{if(cr(e),e.currentActor!==void 0){h(e,`${e.currentActor.name} ended their turn`);let t=N(e).indexOf(e.currentActor)+1;if(t===N(e).length&&(Go(e),t=0,Jo(e)),N(e)[t].incapacitated&&(h(e,`${N(e)[t].name} is no longer incapacitated.`),N(e)[t].incapacitated=!1,t++),e.currentActor.actions=2,e.currentActor.movement=qe(e.currentActor),e.currentActor=N(e)[t],t===0){tr(e);const o=no(e);er[o.effect](e,o)}h(e,`${e.currentActor.name} started their turn`)}},cr=e=>{var n;e.dungeon.winConditions.forEach(t=>{var o;switch(t.type){case Ve.KILL_ALL:{const r=e.dungeon.layout.monsters.map(s=>s.health).reduce((s,i)=>s+i,0);t.fulfilled=r<=0;break}case Ve.REACH_CELL:{t.fulfilled=N(e).some(r=>{var s;return r.position.x===((s=t.targetCell)==null?void 0:s.x)&&r.position.y===t.targetCell.y});break}case Ve.KILL_ALL_OF_TYPE:{t.fulfilled=e.dungeon.layout.monsters.filter(r=>r.type===t.targetMonsterType).some(r=>r.health>0);break}case Ve.OPEN_DOOR:{t.fulfilled=((o=e.dungeon.layout.doors.find(r=>{var s,i;return r.x===((s=t.targetCell)==null?void 0:s.x)&&r.y===((i=t.targetCell)==null?void 0:i.y)}))==null?void 0:o.open)??!1;break}case Ve.KILL_AT_LEAST:{t.fulfilled=(t.killMinCount?t.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,o)=>t&&o,!0),e.dungeon.beaten&&(h(e,"All win conditions have been fulfilled"),h(e,`You have cleared ${e.dungeon.name}`),h(e,`Press 'Next' to move on to the next level: ${(n=e.dungeon.nextDungeon)==null?void 0:n.name}`))},oo=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:j.Red,maxHealth:0,name:"Door",level:re.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:P.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Kn=(e,n,t)=>{let o=!0;if(n<0||n>=e.grid[0].length||t<0||t>=e.grid.length)o=!1;else{const r=Ge(e.grid,n,t);(r===co||r===Ut||r===Qn||r===Yn)&&(o=!1)}return o},Sn=(e,n,t)=>{const o=Ge(e.layout.grid,n,t);return o?e.discoveredRooms.includes(o):!1},Ge=(e,n,t)=>{let o;return e.forEach((r,s)=>{Hn(r).forEach((i,a)=>{s===t&&a===n&&(o=i)})}),o},xn=(e,n,t)=>e.x===n&&e.y===t||e.x===n-1&&e.y===t||e.x===n-1&&e.y===t-1||e.x===n&&e.y===t-1||e.x===n+1&&e.y===t-1||e.x===n+1&&e.y===t||e.x===n+1&&e.y===t+1||e.x===n&&e.y===t+1||e.x===n-1&&e.y===t+1,ur=(e,n,t,o)=>{var s;const r=((s=o.armour)==null?void 0:s.defense)??o.defense;return`${e} damage (${n}-(${r}+${t})=${e})`},Rn=(e,n)=>e.x===n.x&&e.y===n.y,h=(e,n)=>{e.actionLog=[n,...e.actionLog]},rn=(e,n,t,o)=>{var E,M;let r=n.weapon;o&&n.rangedWeapon&&(r=n.rangedWeapon);let s=0,i=0;r.ignoresArmour?t.armour&&h(e,`${t.name}'s armour was useless against ${r.name} `):s=((E=t.armour)==null?void 0:E.defense)??t.defense,r.ignoresShield?t.shield&&h(e,`${t.name}'s shield was useless against ${r.name} `):i=_n(t.level,((M=t.shield)==null?void 0:M.dice)??0);const a=n.inventory.filter(T=>{var k;return(k=T==null?void 0:T.properties)==null?void 0:k[ht]}).some(T=>{var k;return h(e,`${n.name} used the effect of ${T.name} when attacking`),(k=T.properties)==null?void 0:k[ht]}),l=n.inventory.filter(T=>{var k;return(k=T==null?void 0:T.properties)==null?void 0:k[ft]}).map(T=>{var k;return h(e,`${n.name} used the effect of ${T.name} when attacking`),(k=T.properties)==null?void 0:k[ft]}).reduce((T,k)=>T+k,0);let u=n.blinded?1:0,y=n.weakened?1:0,v=n.weapon.elemental?1:0;const p=l+v,O=u+y,A=_n(n.level,r.dice+p-O);let U=Math.max(A-(s+i),0);U===0&&a&&(h(e,`${n.name} missed but got another chance`),U=Math.max(A-(s+i),0)),t.health-=U,h(e,`${n.name} attacked ${t.name} with ${r.name} for ${ur(U,A,i,t)}`),t.health<=0&&(h(e,`${n.name} killed ${t.name}`),t.health=0,t.level=re.APPRENTICE)},dr=(e,n)=>{const t=document.getElementById("gameBoardContainer"),o=document.getElementById("gameBoard");if(t&&o){const r=e.x*n,s=e.y*n,i=o.offsetWidth,a=o.offsetHeight;t.scrollLeft=Math.round(r/i),t.scrollTop=Math.round(s/a),console.log(`scrolling to ${t.scrollLeft} x ${t.scrollTop}`)}},fr=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],e.eventDeck=eo(e.dungeon),Do(e),To(e),Oo(e),Kt(e),Qo(e),dr({x:e.dungeon.startingPositions[0].x,y:e.dungeon.startingPositions[0].y},e.settings.cellSize))},In=(e,n)=>Math.sqrt(Math.pow(e.x-(n==null?void 0:n.x),2)+Math.pow(e.y-(n==null?void 0:n.y),2)),zn=(e,n,t,o,r,s)=>{const i=mr(e,t),a={x:Math.round((i.x+24)/48),y:Math.round((i.y+24)/48)},l=Ge(r.dungeon.layout.grid,a.x,a.y);return a.x===o.x&&a.y===o.y?(s.push(a),!0):l===Yn||l===Ut?!1:(a.x===n.x&&a.y===n.y||s.some(u=>u.x===a.x&&u.y===a.y)||s.push(a),zn(i,n,t,o,r,s))},mr=(e,n)=>{const t=e.x,o=e.y,r=n.x-t,s=n.y-o,i=r/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2),a=s/Math.pow(Math.pow(r,2)+Math.pow(s,2),1/2);let l=Math.round(i+t),u=Math.round(a+o);return{x:l,y:u}},ro=(e,n)=>N(e).filter(t=>xn(n.position,t.position.x,t.position.y)),hr=""+new URL("../assets/Dungeon_Tileset.cc6b3754.png",import.meta.url).href,pr="data:image/png;base64,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",gr=(e,n)=>{const t=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),r=Math.min(t,o),s=Math.max(t,o),i=r,a=s-r;let l=Math.sqrt(2);return a===0&&(l=1),Math.floor(l*i+a)},vr=(e,n)=>{const t=e.currentActor,o=e.dungeon.layout.items.find(s=>Rn(s.position,t.position));if(o){const s=o.item;s.type===P.MAGIC?Yt(e,s):Wt(e,s);const i=e.dungeon.layout.items.indexOf(o);if(e.dungeon.layout.items.splice(i,1),h(e,`${t.name} picked up ${s.name}`),t.inventory.push(s),s.pickup){const a=Jn[s.pickup];a(e,s,t)}return}const r=e.dungeon.layout.doors.find(s=>s.x===t.position.x&&s.y===t.position.y);if(r){const s=t.inventory.some(i=>{var a;return(a=i.properties)==null?void 0:a[Xt]});if(Vt(t,s,r)){switch(r.locked&&s&&h(e,`${t.name} broke the locked door`),r.open=!0,r.trapped&&rn(e,oo(r),t,!1),r.side){case K.RIGHT:An(t,e,n.x+1,n.y);break;case K.LEFT:An(t,e,n.x-1,n.y);break;case K.DOWN:An(t,e,n.x,n.y+1);break;case K.UP:An(t,e,n.x,n.y-1);break}$n(t)}else if(r.locked&&!r.hidden){if(!kn(t)){h(e,`${t.name} has no actions left`);return}h(e,"Door is locked"),qn(e),$n(t)}}else{if(!kn(t)){h(e,`${t.name} has no actions left`);return}Xn(e)}},yr=(e,n)=>{const t=e.currentActor;if(t.actions===0){h(e,`${t.name} has no actions left`);return}const o=Kn(e.dungeon.layout,n.x,n.y),r=gr(t.position,n);if(console.log("distance: "+r),o){const s=Mn(e,n.x,n.y),i=wn(e,n.x,n.y);if(!s&&!i&&r<=t.movement){if(t.position=n,t.movement-=r,Gt(e))return}else i&&(r<=t.weapon.range?Ft(t,e,n):h(e,"Monster is out of range"))}$n(t)},kr=(e,n,t)=>{const o=document.getElementById("gameBoard");if(!o)return;const r=o.getBoundingClientRect(),s=Math.min(Math.floor((e.clientX-r.left)/n),t.dungeon.layout.grid[0].length-1),i=Math.min(Math.floor((e.clientY-r.top)/n),t.dungeon.layout.grid.length-1),a=t.dungeon.layout.grid[i][s],l=t.currentActor;s===l.position.x&&i===l.position.y?vr(t,{x:s,y:i}):t.dungeon.discoveredRooms.includes(a)&&yr(t,{x:s,y:i})},_r=(e,n,t,o,r)=>{N(o).forEach(i=>{br(e,i,n,t)}),Dr(e,o,t),Or(e,o,t)},br=(e,n,t,o)=>{const r=n.position.x,s=n.position.y;e.drawImage(t,4*16,0,16,16,r*o,s*o,o,o),Er(e,n,r,s,o),Tr(e,n,r,s,o),Ar(e,n,r,s,o)},Er=(e,n,t,o,r)=>{const s=e.fillStyle,i=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let a=0;a<n.actions;a++)e.fillRect(t*r+4+6*a,o*r+r-12,5,5),e.rect(t*r+4+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle="blue";for(let a=0;a<n.movement;a++)e.fillRect(t*r+r-22+6*a,o*r+r-12,5,5),e.rect(t*r+r-22+6*a,o*r+r-12,5,5),e.stroke();e.fillStyle=s,e.strokeStyle=i},Ar=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t*r+4,o*r,r-8,4),e.fillStyle="green",e.fillRect(t*r+4,o*r,(r-8)*(n.health/n.maxHealth),4),e.rect(t*r+4,o*r,r-8,4),e.stroke()},Tr=(e,n,t,o,r)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(t*r+4,o*r+(r-6),r-8,4),e.stroke()},Dr=(e,n,t)=>{const o=n.currentActor;if(o){for(let r=o.position.x-o.movement;r<=o.position.x+o.movement;r++)for(let s=o.position.y-o.movement;s<=o.position.y+o.movement;s++)if(Sn(n.dungeon,r,s)){const a=wn(n,r,s),l=Mn(n,r,s),u=Kn(n.dungeon.layout,r,s);!l&&!a&&u&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(r*t,s*t,t,t),e.stroke())}}},Or=(e,n,t)=>{const o=n.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t+t/3,o.position.y*t),e.moveTo(o.position.x*t,o.position.y*t),e.lineTo(o.position.x*t,o.position.y*t+t/3),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t),e.moveTo(o.position.x*t+t,o.position.y*t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3,o.position.y*t+t),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t,o.position.y*t+t/3*2),e.moveTo(o.position.x*t+t,o.position.y*t+t),e.lineTo(o.position.x*t+t/3*2,o.position.y*t+t),e.stroke(),e.lineWidth=1)},Ir=(e,n,t,o,r)=>{o.dungeon.layout.monsters.forEach(s=>{Rr(e,n,o,s,t,r)})},Rr=(e,n,t,o,r,s)=>{const i=t.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&Nr(i,t)){switch(o.type){case te.ORCH:Cr(e,n,r,o);break;case te.TROLL:wr(e,n,r,o);break;default:Mr(e,n,r,o);break}Hr(e,o,r),xr(e,o,r),Lr(e,o,t.heroes,t,r,s)}},Cr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},wr=(e,n,t,o)=>{e.drawImage(n,t,16,16,16,o.position.x*t,o.position.y*t,t,t)},Mr=(e,n,t,o)=>{e.drawImage(n,16,16,16,16,o.position.x*t,o.position.y*t,t,t)},Hr=(e,n,t)=>{e.beginPath(),e.strokeStyle=n.colour,e.fillStyle=n.colour,e.fillRect(n.position.x*t+4,n.position.y*t+(t-6),t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},xr=(e,n,t)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n.position.x*t+4,n.position.y*t,t-8,4),e.fillStyle="green",e.fillRect(n.position.x*t+4,n.position.y*t,(t-8)*(n.health/n.maxHealth),4),e.rect(n.position.x*t+4,n.position.y*t,t-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},Lr=(e,n,t,o,r,s)=>{s&&t.forEach(i=>{const a=[],l={x:n.position.x*48-24,y:n.position.y*48-24},u={x:i.position.x*48-24,y:i.position.y*48-24};if(zn(l,n.position,u,i.position,o,a)){const v=n.position.x,p=n.position.y,O=i.position.x,A=i.position.y;e.beginPath(),e.strokeStyle=n.colour,e.lineWidth=2,e.moveTo(v*r+r/2,p*r+r/2),e.lineTo(O*r+r/2,A*r+r/2),e.stroke(),e.lineWidth=1}})},Nr=(e,n)=>n.dungeon.discoveredRooms.includes(e),Pr=(e,n,t,o,r)=>{o.dungeon.layout.doors.forEach(s=>{Kr(e,n,t,o,s,r)})},Br=(e,n,t,o,r)=>{o.dungeon.layout.grid.forEach((s,i)=>{Hn(s).forEach((a,l)=>{Ur(e,n,o,a,l,i,t),Yr(e,a,o,l,i,t,r)})})},$r=(e,n,t,o)=>{o.dungeon.layout.secrets.filter(r=>r.found).forEach(r=>{switch(r.type){case be.TRAP_DOOR:Gr(e,n,t,r);break;default:Wr(e,n,t,r);break}})},Ur=(e,n,t,o,r,s,i)=>{Fr(o)||!t.dungeon.discoveredRooms.includes(o)&&o!==Qn?o===Bn?(e.drawImage(n,0,0,48,48,r*i,s*i,i,i),e.drawImage(n,5*48,0,48,48,r*i,s*i,i,i)):t.dungeon.discoveredRooms.some(a=>Tt(r,s,a,t))||Tt(r,s,Bn,t)?e.drawImage(n,48,0,48,48,r*i,s*i,i,i):At(e,r,s,i):Wn(o,t)?At(e,r,s,i):e.drawImage(n,0,0,48,48,r*i,s*i,i,i)},At=(e,n,t,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(n*o,t*o,o,o),e.stroke()},Gr=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,3*48,0,48,48,r*t,s*t,t,t)},Wr=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,4*48,0,48,48,r*t,s*t,t,t)},Yr=(e,n,t,o,r,s,i)=>{!i&&(Wn(n,t)||n===Yn)||(e.beginPath(),e.strokeStyle="black",e.rect(o*s,r*s,s,s),i&&(e.font="7px Arial",e.fillText(o+","+r,o*s+3,r*s+(s-3))),e.stroke())},Kr=(e,n,t,o,r,s)=>{const i=o.dungeon.layout.grid[r.y][r.x];if(r&&!r.hidden&&!r.open&&!Wn(i,o))switch(e.fillStyle="brown",r.side){case K.RIGHT:{e.fillRect(r.x*t+(t-2),r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t-4),r.y*t+(t/2-4),8,8));break}case K.LEFT:{e.fillRect(r.x*t-2,r.y*t,4,t),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t-4,r.y*t+(t/2-4),8,8));break}case K.UP:{e.fillRect(r.x*t,r.y*t-2,t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t-4,8,8));break}case K.DOWN:{e.fillRect(r.x*t,r.y*t+(t-2),t,4),r.locked&&s&&(e.fillStyle="grey",e.fillRect(r.x*t+(t/2-4),r.y*t+(t-4),8,8));break}}s&&!Wn(i,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${r.hidden?"H":"-"}/${r.trapped?"T"+r.trapAttacks:"-"}/${r.locked?"L":"-"}]`,r.x*t,r.y*t+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(r.x*t,r.y*t,t,t))},Fr=e=>e===Yn,Wn=(e,n)=>e===Qn||!n.dungeon.discoveredRooms.includes(e),Tt=(e,n,t,o)=>{if(!o)return;const r=Math.max(e-1,0),s=Math.max(n-1,0),i=Math.min(n+1,o.dungeon.layout.grid.length-1),a=Math.min(e+1,o.dungeon.layout.grid[0].length-1);for(let l=r;l<=a;l++)for(let u=s;u<=i;u++){const y=o.dungeon.layout.grid[u];if(Hn(y)[l]===t)return!0}return!1},Vr=(e,n,t,o)=>{o.dungeon.layout.items.forEach(r=>{switch(r.item.type){case P.MAGIC:qr(e,n,t,r);break}})},qr=(e,n,t,o)=>{const r=o.position.x,s=o.position.y;e.drawImage(n,0,48,48,48,r*t,s*t,t,t)};function Xr(e){let n,t,o,r;return{c(){n=f("div"),t=f("canvas"),this.h()},l(s){n=m(s,"DIV",{style:!0,class:!0,id:!0});var i=g(n);t=m(i,"CANVAS",{width:!0,height:!0,id:!0}),g(t).forEach(d),i.forEach(d),this.h()},h(){x(t,"width",e[0]*40),x(t,"height",e[0]*30),x(t,"id","gameBoard"),x(n,"style",e[2]()),x(n,"class","dungeon svelte-a4uhtl"),x(n,"id","gameBoardContainer")},m(s,i){L(s,n,i),c(n,t),o||(r=F(t,"click",e[1]),o=!0)},p:ce,i:ce,o:ce,d(s){s&&d(n),o=!1,r()}}}function jr(e,n,t){let{state:o}=n,{debugMode:r}=n,s,i;const a=(o==null?void 0:o.settings.cellSize)??48;i=window.innerHeight,s=document.getElementById("footer").offsetHeight,Cn(()=>{const v=new Image;v.src=hr;const p=new Image;p.src=pr,setInterval(()=>l(v,p),10)});const l=(v,p)=>{if(!o||!document)return;const O=document.getElementById("gameBoard"),A=O.getContext("2d");A.clearRect(0,0,O.width,O.height),A.fillStyle="black",A.fillRect(0,0,O.width,O.height),Br(A,v,a,o,r),$r(A,v,a,o),Vr(A,v,a,o),Pr(A,v,a,o,r),Ir(A,p,a,o,r),_r(A,p,a,o)},u=v=>{kr(v,a,o)},y=()=>`max-height: ${i-s-20}px; max-width: ${a*40}`;return e.$$set=v=>{"state"in v&&t(3,o=v.state),"debugMode"in v&&t(4,r=v.debugMode)},[a,u,y,o,r]}class Zr extends sn{constructor(n){super(),an(this,n,jr,Xr,He,{state:3,debugMode:4})}}function Dt(e){let n,t="Use",o,r;return{c(){n=f("button"),n.textContent=t},l(s){n=m(s,"BUTTON",{"data-svelte-h":!0}),X(n)!=="svelte-3f43k6"&&(n.textContent=t)},m(s,i){L(s,n,i),o||(r=F(n,"click",e[2]),o=!0)},p:ce,d(s){s&&d(n),o=!1,r()}}}function Qr(e){var O,A,U;let n,t,o,r=e[0].name+"",s,i,a,l,u,y=((O=e[0].properties)==null?void 0:O[pt])+"",v,p=((A=e[0].properties)==null?void 0:A[Un])&&!((U=e[0].properties)!=null&&U[$e])&&Dt(e);return{c(){n=f("div"),t=f("span"),p&&p.c(),o=C(),s=I(r),i=C(),a=f("div"),l=f("span"),u=I(" "),v=I(y),this.h()},l(E){n=m(E,"DIV",{class:!0});var M=g(n);t=m(M,"SPAN",{class:!0});var T=g(t);p&&p.l(T),o=w(T),s=R(T,r),T.forEach(d),i=w(M),a=m(M,"DIV",{class:!0});var k=g(a);l=m(k,"SPAN",{class:!0});var G=g(l);u=R(G," "),v=R(G,y),G.forEach(d),k.forEach(d),M.forEach(d),this.h()},h(){x(t,"class","svelte-16r3uh2"),x(l,"class","svelte-16r3uh2"),x(a,"class","description svelte-16r3uh2"),x(n,"class","item-card svelte-16r3uh2")},m(E,M){L(E,n,M),c(n,t),p&&p.m(t,null),c(t,o),c(t,s),c(n,i),c(n,a),c(a,l),c(l,u),c(l,v)},p(E,[M]){var T,k,G;(T=E[0].properties)!=null&&T[Un]&&!((k=E[0].properties)!=null&&k[$e])?p?p.p(E,M):(p=Dt(E),p.c(),p.m(t,o)):p&&(p.d(1),p=null),M&1&&r!==(r=E[0].name+"")&&le(s,r),M&1&&y!==(y=((G=E[0].properties)==null?void 0:G[pt])+"")&&le(v,y)},i:ce,o:ce,d(E){E&&d(n),p&&p.d()}}}function Jr(e,n,t){let{item:o}=n,{state:r}=n;const s=()=>Zo(r,o);return e.$$set=i=>{"item"in i&&t(0,o=i.item),"state"in i&&t(1,r=i.state)},[o,r,s]}class Sr extends sn{constructor(n){super(),an(this,n,Jr,Qr,He,{item:0,state:1})}}function Ot(e,n,t){const o=e.slice();return o[5]=n[t],o[6]=n,o[7]=t,o}function It(e){let n,t,o;function r(i){e[3](i,e[5],e[6],e[7])}let s={state:e[1]};return e[5]!==void 0&&(s.item=e[5]),n=new Sr({props:s}),Tn.push(()=>On(n,"item",r)),{c(){en(n.$$.fragment)},l(i){nn(n.$$.fragment,i)},m(i,a){tn(n,i,a),o=!0},p(i,a){e=i;const l={};a&2&&(l.state=e[1]),!t&&a&1&&(t=!0,l.item=e[5],Dn(()=>t=!1)),n.$set(l)},i(i){o||(V(n.$$.fragment,i),o=!0)},o(i){ne(n.$$.fragment,i),o=!1},d(i){on(n,i)}}}function Rt(e){let n,t,o=yn(e[0]),r=[];for(let i=0;i<o.length;i+=1)r[i]=It(Ot(e,o,i));const s=i=>ne(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=ve()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=ve()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);L(i,n,a),t=!0},p(i,a){if(a&3){o=yn(i[0]);let l;for(l=0;l<o.length;l+=1){const u=Ot(i,o,l);r[l]?(r[l].p(u,a),V(r[l],1)):(r[l]=It(u),r[l].c(),V(r[l],1),r[l].m(n.parentNode,n))}for(ln(),l=o.length;l<r.length;l+=1)s(l);cn()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)V(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)ne(r[a]);t=!1},d(i){i&&d(n),Zn(r,i)}}}function zr(e){let n,t,o="Inventory",r,s=e[2],i,a=Rt(e);return{c(){n=f("div"),t=f("span"),t.textContent=o,r=C(),a.c(),this.h()},l(l){n=m(l,"DIV",{class:!0});var u=g(n);t=m(u,"SPAN",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-5cqt1m"&&(t.textContent=o),r=w(u),a.l(u),u.forEach(d),this.h()},h(){x(t,"class","svelte-17j3oea"),x(n,"class","inventory svelte-17j3oea")},m(l,u){L(l,n,u),c(n,t),c(n,r),a.m(n,null),i=!0},p(l,[u]){u&4&&He(s,s=l[2])?(ln(),ne(a,1,1,ce),cn(),a=Rt(l),a.c(),V(a,1),a.m(n,null)):a.p(l,u)},i(l){i||(V(a),i=!0)},o(l){ne(a),i=!1},d(l){l&&d(n),a.d(l)}}}function es(e,n,t){let{inventory:o}=n,{state:r}=n,s=!1;Cn(()=>{i(),setInterval(i,100)});const i=()=>{t(2,s=!s)};function a(l,u,y,v){y[v]=l,t(0,o)}return e.$$set=l=>{"inventory"in l&&t(0,o=l.inventory),"state"in l&&t(1,r=l.state)},[o,r,s,a]}class ns extends sn{constructor(n){super(),an(this,n,es,zr,He,{inventory:0,state:1})}}function Ct(e){let n;return{c(){n=I("*")},l(t){n=R(t,"*")},m(t,o){L(t,n,o)},d(t){t&&d(n)}}}function ts(e){let n;return{c(){n=I("Unselect")},l(t){n=R(t,"Unselect")},m(t,o){L(t,n,o)},d(t){t&&d(n)}}}function os(e){let n;return{c(){n=I("Target")},l(t){n=R(t,"Target")},m(t,o){L(t,n,o)},d(t){t&&d(n)}}}function rs(e){let n;return{c(){n=I("None (0)")},l(t){n=R(t,"None (0)")},m(t,o){L(t,n,o)},p:ce,d(t){t&&d(n)}}}function ss(e){let n=e[0].armour.name+"",t,o,r=e[0].armour.defense+"",s,i;return{c(){t=I(n),o=I(" ("),s=I(r),i=I(")")},l(a){t=R(a,n),o=R(a," ("),s=R(a,r),i=R(a,")")},m(a,l){L(a,t,l),L(a,o,l),L(a,s,l),L(a,i,l)},p(a,l){l&1&&n!==(n=a[0].armour.name+"")&&le(t,n),l&1&&r!==(r=a[0].armour.defense+"")&&le(s,r)},d(a){a&&(d(t),d(o),d(s),d(i))}}}function is(e){let n;return{c(){n=I("None (0)")},l(t){n=R(t,"None (0)")},m(t,o){L(t,n,o)},p:ce,d(t){t&&d(n)}}}function as(e){let n=e[0].shield.name+"",t,o,r=e[0].shield.dice+"",s,i;return{c(){t=I(n),o=I(" ("),s=I(r),i=I(")")},l(a){t=R(a,n),o=R(a," ("),s=R(a,r),i=R(a,")")},m(a,l){L(a,t,l),L(a,o,l),L(a,s,l),L(a,i,l)},p(a,l){l&1&&n!==(n=a[0].shield.name+"")&&le(t,n),l&1&&r!==(r=a[0].shield.dice+"")&&le(s,r)},d(a){a&&(d(t),d(o),d(s),d(i))}}}function wt(e){let n,t,o,r;function s(a){e[4](a)}let i={state:e[1]};return e[0].inventory!==void 0&&(i.inventory=e[0].inventory),t=new ns({props:i}),Tn.push(()=>On(t,"inventory",s)),{c(){n=f("div"),en(t.$$.fragment),this.h()},l(a){n=m(a,"DIV",{class:!0});var l=g(n);nn(t.$$.fragment,l),l.forEach(d),this.h()},h(){x(n,"class","equipment")},m(a,l){L(a,n,l),tn(t,n,null),r=!0},p(a,l){const u={};l&2&&(u.state=a[1]),!o&&l&1&&(o=!0,u.inventory=a[0].inventory,Dn(()=>o=!1)),t.$set(u)},i(a){r||(V(t.$$.fragment,a),r=!0)},o(a){ne(t.$$.fragment,a),r=!1},d(a){a&&d(n),on(t)}}}function Mt(e){let n,t,o,r=e[0].name+"",s,i,a,l,u=e[0].level+"",y,v,p=e[0].experience+"",O,A,U,E,M,T,k,G,W=e[0].health+"",B,ue,S,_,H=e[0].actions+"",$,Z,Q,de,Y=e[0].movement+"",xe,Le,J,Re="Equipment:",Ce,ye,fe,We,ke=e[0].weapon.name+"",Ze,Qe,we=e[0].weapon.dice+"",Ee,un,Je,me,Me,dn,Ae,ie,Ye,z,fn,mn,ee=e[1].targetActor===e[0]&&Ct();function Ne(b,D){return b[1].targetActor!==b[0]?os:ts}let Se=Ne(e),_e=Se(e);function Xe(b,D){return b[0].armour?ss:rs}let Te=Xe(e),he=Te(e);function hn(b,D){return b[0].shield?as:is}let Pe=hn(e),oe=Pe(e),q=e[0]===e[1].currentActor&&wt(e);return{c(){n=f("div"),t=f("div"),o=f("b"),ee&&ee.c(),s=I(r),i=I(" -"),a=C(),l=f("b"),y=I(u),v=I(" ("),O=I(p),A=I(")"),U=C(),E=f("span"),M=f("button"),_e.c(),T=C(),k=f("span"),G=I("HP: "),B=I(W),ue=C(),S=f("span"),_=I("Actions: "),$=I(H),Z=C(),Q=f("span"),de=I("Moves: "),xe=I(Y),Le=C(),J=f("span"),J.textContent=Re,Ce=C(),ye=f("div"),fe=f("span"),We=I("🗡️ "),Ze=I(ke),Qe=I(" ("),Ee=I(we),un=I(")"),Je=C(),me=f("span"),Me=I(`🧱
      `),he.c(),dn=C(),Ae=f("span"),ie=I(`🛡️
      `),oe.c(),Ye=C(),q&&q.c(),this.h()},l(b){n=m(b,"DIV",{class:!0,style:!0});var D=g(n);t=m(D,"DIV",{class:!0});var Be=g(t);o=m(Be,"B",{class:!0});var ae=g(o);ee&&ee.l(ae),s=R(ae,r),i=R(ae," -"),ae.forEach(d),a=w(Be),l=m(Be,"B",{class:!0});var pe=g(l);y=R(pe,u),v=R(pe," ("),O=R(pe,p),A=R(pe,")"),pe.forEach(d),Be.forEach(d),U=w(D),E=m(D,"SPAN",{class:!0});var bn=g(E);M=m(bn,"BUTTON",{});var En=g(M);_e.l(En),En.forEach(d),bn.forEach(d),T=w(D),k=m(D,"SPAN",{class:!0});var pn=g(k);G=R(pn,"HP: "),B=R(pn,W),pn.forEach(d),ue=w(D),S=m(D,"SPAN",{class:!0});var gn=g(S);_=R(gn,"Actions: "),$=R(gn,H),gn.forEach(d),Z=w(D),Q=m(D,"SPAN",{class:!0});var De=g(Q);de=R(De,"Moves: "),xe=R(De,Y),De.forEach(d),Le=w(D),J=m(D,"SPAN",{class:!0,"data-svelte-h":!0}),X(J)!=="svelte-1ue18fw"&&(J.textContent=Re),Ce=w(D),ye=m(D,"DIV",{class:!0});var Ke=g(ye);fe=m(Ke,"SPAN",{class:!0});var Fe=g(fe);We=R(Fe,"🗡️ "),Ze=R(Fe,ke),Qe=R(Fe," ("),Ee=R(Fe,we),un=R(Fe,")"),Fe.forEach(d),Je=w(Ke),me=m(Ke,"SPAN",{class:!0});var vn=g(me);Me=R(vn,`🧱
      `),he.l(vn),vn.forEach(d),dn=w(Ke),Ae=m(Ke,"SPAN",{class:!0});var Oe=g(Ae);ie=R(Oe,`🛡️
      `),oe.l(Oe),Oe.forEach(d),Ke.forEach(d),Ye=w(D),q&&q.l(D),D.forEach(d),this.h()},h(){x(o,"class","svelte-pgtred"),x(l,"class","svelte-pgtred"),x(t,"class","hero-title svelte-pgtred"),x(E,"class","svelte-pgtred"),x(k,"class","svelte-pgtred"),x(S,"class","svelte-pgtred"),x(Q,"class","svelte-pgtred"),x(J,"class","svelte-pgtred"),x(fe,"class","svelte-pgtred"),x(me,"class","svelte-pgtred"),x(Ae,"class","svelte-pgtred"),x(ye,"class","equipment"),x(n,"class","hero-card svelte-pgtred"),lt(n,"background-color",e[0].colour)},m(b,D){L(b,n,D),c(n,t),c(t,o),ee&&ee.m(o,null),c(o,s),c(o,i),c(t,a),c(t,l),c(l,y),c(l,v),c(l,O),c(l,A),c(n,U),c(n,E),c(E,M),_e.m(M,null),c(n,T),c(n,k),c(k,G),c(k,B),c(n,ue),c(n,S),c(S,_),c(S,$),c(n,Z),c(n,Q),c(Q,de),c(Q,xe),c(n,Le),c(n,J),c(n,Ce),c(n,ye),c(ye,fe),c(fe,We),c(fe,Ze),c(fe,Qe),c(fe,Ee),c(fe,un),c(ye,Je),c(ye,me),c(me,Me),he.m(me,null),c(ye,dn),c(ye,Ae),c(Ae,ie),oe.m(Ae,null),c(n,Ye),q&&q.m(n,null),z=!0,fn||(mn=F(M,"click",e[3]),fn=!0)},p(b,D){b[1].targetActor===b[0]?ee||(ee=Ct(),ee.c(),ee.m(o,s)):ee&&(ee.d(1),ee=null),(!z||D&1)&&r!==(r=b[0].name+"")&&le(s,r),(!z||D&1)&&u!==(u=b[0].level+"")&&le(y,u),(!z||D&1)&&p!==(p=b[0].experience+"")&&le(O,p),Se!==(Se=Ne(b))&&(_e.d(1),_e=Se(b),_e&&(_e.c(),_e.m(M,null))),(!z||D&1)&&W!==(W=b[0].health+"")&&le(B,W),(!z||D&1)&&H!==(H=b[0].actions+"")&&le($,H),(!z||D&1)&&Y!==(Y=b[0].movement+"")&&le(xe,Y),(!z||D&1)&&ke!==(ke=b[0].weapon.name+"")&&le(Ze,ke),(!z||D&1)&&we!==(we=b[0].weapon.dice+"")&&le(Ee,we),Te===(Te=Xe(b))&&he?he.p(b,D):(he.d(1),he=Te(b),he&&(he.c(),he.m(me,null))),Pe===(Pe=hn(b))&&oe?oe.p(b,D):(oe.d(1),oe=Pe(b),oe&&(oe.c(),oe.m(Ae,null))),b[0]===b[1].currentActor?q?(q.p(b,D),D&3&&V(q,1)):(q=wt(b),q.c(),V(q,1),q.m(n,null)):q&&(ln(),ne(q,1,1,()=>{q=null}),cn()),(!z||D&1)&&lt(n,"background-color",b[0].colour)},i(b){z||(V(q),z=!0)},o(b){ne(q),z=!1},d(b){b&&d(n),ee&&ee.d(),_e.d(),he.d(),oe.d(),q&&q.d(),fn=!1,mn()}}}function ls(e){let n=e[1].targetActor,t,o,r=Mt(e);return{c(){r.c(),t=ve()},l(s){r.l(s),t=ve()},m(s,i){r.m(s,i),L(s,t,i),o=!0},p(s,[i]){i&2&&He(n,n=s[1].targetActor)?(ln(),ne(r,1,1,ce),cn(),r=Mt(s),r.c(),V(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(V(r),o=!0)},o(s){ne(r),o=!1},d(s){s&&d(t),r.d(s)}}}function cs(e,n,t){let{hero:o}=n,{state:r}=n;const s=l=>{r.targetActor&&l===r.targetActor?t(1,r.targetActor=void 0,r):t(1,r.targetActor=l,r)},i=()=>s(o);function a(l){e.$$.not_equal(o.inventory,l)&&(o.inventory=l,t(0,o))}return e.$$set=l=>{"hero"in l&&t(0,o=l.hero),"state"in l&&t(1,r=l.state)},[o,r,s,i,a]}class so extends sn{constructor(n){super(),an(this,n,cs,ls,He,{hero:0,state:1})}}function Ht(e,n,t){const o=e.slice();return o[3]=n[t],o[5]=t,o}function us(e){let n,t,o,r;return t=new so({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),en(t.$$.fragment),o=C(),this.h()},l(s){n=m(s,"DIV",{class:!0});var i=g(n);nn(t.$$.fragment,i),o=w(i),i.forEach(d),this.h()},h(){x(n,"class","not-current-actor svelte-gyascg")},m(s,i){L(s,n,i),tn(t,n,null),c(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(V(t.$$.fragment,s),r=!0)},o(s){ne(t.$$.fragment,s),r=!1},d(s){s&&d(n),on(t)}}}function ds(e){let n,t,o,r;return t=new so({props:{hero:e[3],state:e[0]}}),{c(){n=f("div"),en(t.$$.fragment),o=C(),this.h()},l(s){n=m(s,"DIV",{class:!0});var i=g(n);nn(t.$$.fragment,i),o=w(i),i.forEach(d),this.h()},h(){x(n,"class","is-current-actor svelte-gyascg")},m(s,i){L(s,n,i),tn(t,n,null),c(n,o),r=!0},p(s,i){const a={};i&1&&(a.hero=s[3]),i&1&&(a.state=s[0]),t.$set(a)},i(s){r||(V(t.$$.fragment,s),r=!0)},o(s){ne(t.$$.fragment,s),r=!1},d(s){s&&d(n),on(t)}}}function xt(e){let n,t,o,r;const s=[ds,us],i=[];function a(l,u){return l[3]===l[0].currentActor?0:1}return n=a(e),t=i[n]=s[n](e),{c(){t.c(),o=ve()},l(l){t.l(l),o=ve()},m(l,u){i[n].m(l,u),L(l,o,u),r=!0},p(l,u){let y=n;n=a(l),n===y?i[n].p(l,u):(ln(),ne(i[y],1,1,()=>{i[y]=null}),cn(),t=i[n],t?t.p(l,u):(t=i[n]=s[n](l),t.c()),V(t,1),t.m(o.parentNode,o))},i(l){r||(V(t),r=!0)},o(l){ne(t),r=!1},d(l){l&&d(o),i[n].d(l)}}}function Lt(e){let n=e[1],t,o,r=xt(e);return{c(){r.c(),t=ve()},l(s){r.l(s),t=ve()},m(s,i){r.m(s,i),L(s,t,i),o=!0},p(s,i){i&2&&He(n,n=s[1])?(ln(),ne(r,1,1,ce),cn(),r=xt(s),r.c(),V(r,1),r.m(t.parentNode,t)):r.p(s,i)},i(s){o||(V(r),o=!0)},o(s){ne(r),o=!1},d(s){s&&d(t),r.d(s)}}}function fs(e){let n,t,o=yn(N(e[0])),r=[];for(let i=0;i<o.length;i+=1)r[i]=Lt(Ht(e,o,i));const s=i=>ne(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();n=ve()},l(i){for(let a=0;a<r.length;a+=1)r[a].l(i);n=ve()},m(i,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,a);L(i,n,a),t=!0},p(i,[a]){if(a&3){o=yn(N(i[0]));let l;for(l=0;l<o.length;l+=1){const u=Ht(i,o,l);r[l]?(r[l].p(u,a),V(r[l],1)):(r[l]=Lt(u),r[l].c(),V(r[l],1),r[l].m(n.parentNode,n))}for(ln(),l=o.length;l<r.length;l+=1)s(l);cn()}},i(i){if(!t){for(let a=0;a<o.length;a+=1)V(r[a]);t=!0}},o(i){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)ne(r[a]);t=!1},d(i){i&&d(n),Zn(r,i)}}}function ms(e,n,t){let{state:o}=n,r=!1;Cn(()=>{s(),setInterval(s,100)});const s=()=>{t(1,r=!r)};return e.$$set=i=>{"state"in i&&t(0,o=i.state)},[o,r]}class hs extends sn{constructor(n){super(),an(this,n,ms,fs,He,{state:0})}}function Nt(e,n,t){const o=e.slice();return o[2]=n[t],o[4]=t,o}function ps(e){let n,t,o=e[2]+"",r;return{c(){n=f("p"),t=I(">"),r=I(o),this.h()},l(s){n=m(s,"P",{class:!0});var i=g(n);t=R(i,">"),r=R(i,o),i.forEach(d),this.h()},h(){x(n,"class","svelte-axhg6g")},m(s,i){L(s,n,i),c(n,t),c(n,r)},p(s,i){i&1&&o!==(o=s[2]+"")&&le(r,o)},d(s){s&&d(n)}}}function Pt(e){let n,t=e[4]<25&&ps(e);return{c(){t&&t.c(),n=ve()},l(o){t&&t.l(o),n=ve()},m(o,r){t&&t.m(o,r),L(o,n,r)},p(o,r){o[4]<25&&t.p(o,r)},d(o){o&&d(n),t&&t.d(o)}}}function Bt(e){let n,t=yn(e[0]),o=[];for(let r=0;r<t.length;r+=1)o[r]=Pt(Nt(e,t,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();n=ve()},l(r){for(let s=0;s<o.length;s+=1)o[s].l(r);n=ve()},m(r,s){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(r,s);L(r,n,s)},p(r,s){if(s&1){t=yn(r[0]);let i;for(i=0;i<t.length;i+=1){const a=Nt(r,t,i);o[i]?o[i].p(a,s):(o[i]=Pt(a),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=t.length}},d(r){r&&d(n),Zn(o,r)}}}function gs(e){let n,t=e[0],o=Bt(e);return{c(){n=f("div"),o.c(),this.h()},l(r){n=m(r,"DIV",{class:!0});var s=g(n);o.l(s),s.forEach(d),this.h()},h(){x(n,"class","log svelte-axhg6g")},m(r,s){L(r,n,s),o.m(n,null)},p(r,[s]){s&1&&He(t,t=r[0])?(o.d(1),o=Bt(r),o.c(),o.m(n,null)):o.p(r,s)},i:ce,o:ce,d(r){r&&d(n),o.d(r)}}}function vs(e,n,t){let o=[],{state:r}=n;return Cn(()=>{setInterval(()=>{t(0,o=r.actionLog)},500)}),e.$$set=s=>{"state"in s&&t(1,r=s.state)},[o,r]}class ys extends sn{constructor(n){super(),an(this,n,vs,gs,He,{state:1})}}const{window:ks}=ao;function _s(e){let n,t,o,r,s="UL",i,a,l,u="U",y,v,p,O="UR",A,U,E,M="Next",T,k,G,W,B="L",ue,S,_,H,$,Z="R",Q,de,Y,xe="Search",Le,J,Re,Ce,ye="DL",fe,We,ke,Ze="D",Qe,we,Ee,un="DR",Je,me,Me,dn="Pick lock",Ae,ie,Ye,z,fn="Save",mn,ee,Ne,Se="Load",_e,Xe,Te,he="Debug",hn,Pe,oe,q="End action",b,D;return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=C(),a=f("td"),l=f("button"),l.textContent=u,y=C(),v=f("td"),p=f("button"),p.textContent=O,A=C(),U=f("td"),E=f("button"),E.textContent=M,T=C(),k=f("tr"),G=f("td"),W=f("button"),W.textContent=B,ue=C(),S=f("td"),_=C(),H=f("td"),$=f("button"),$.textContent=Z,Q=C(),de=f("td"),Y=f("button"),Y.textContent=xe,Le=C(),J=f("tr"),Re=f("td"),Ce=f("button"),Ce.textContent=ye,fe=C(),We=f("td"),ke=f("button"),ke.textContent=Ze,Qe=C(),we=f("td"),Ee=f("button"),Ee.textContent=un,Je=C(),me=f("td"),Me=f("button"),Me.textContent=dn,Ae=C(),ie=f("tr"),Ye=f("td"),z=f("button"),z.textContent=fn,mn=C(),ee=f("td"),Ne=f("button"),Ne.textContent=Se,_e=C(),Xe=f("td"),Te=f("button"),Te.textContent=he,hn=C(),Pe=f("td"),oe=f("button"),oe.textContent=q},l(Be){n=m(Be,"TABLE",{});var ae=g(n);t=m(ae,"TR",{});var pe=g(t);o=m(pe,"TD",{});var bn=g(o);r=m(bn,"BUTTON",{"data-svelte-h":!0}),X(r)!=="svelte-1vu0fc2"&&(r.textContent=s),bn.forEach(d),i=w(pe),a=m(pe,"TD",{});var En=g(a);l=m(En,"BUTTON",{"data-svelte-h":!0}),X(l)!=="svelte-m1j18o"&&(l.textContent=u),En.forEach(d),y=w(pe),v=m(pe,"TD",{});var pn=g(v);p=m(pn,"BUTTON",{"data-svelte-h":!0}),X(p)!=="svelte-8eygoe"&&(p.textContent=O),pn.forEach(d),A=w(pe),U=m(pe,"TD",{});var gn=g(U);E=m(gn,"BUTTON",{"data-svelte-h":!0}),X(E)!=="svelte-1axp1ke"&&(E.textContent=M),gn.forEach(d),pe.forEach(d),T=w(ae),k=m(ae,"TR",{});var De=g(k);G=m(De,"TD",{});var Ke=g(G);W=m(Ke,"BUTTON",{"data-svelte-h":!0}),X(W)!=="svelte-amyars"&&(W.textContent=B),Ke.forEach(d),ue=w(De),S=m(De,"TD",{}),g(S).forEach(d),_=w(De),H=m(De,"TD",{});var Fe=g(H);$=m(Fe,"BUTTON",{"data-svelte-h":!0}),X($)!=="svelte-2zfta0"&&($.textContent=Z),Fe.forEach(d),Q=w(De),de=m(De,"TD",{});var vn=g(de);Y=m(vn,"BUTTON",{"data-svelte-h":!0}),X(Y)!=="svelte-1kis6k4"&&(Y.textContent=xe),vn.forEach(d),De.forEach(d),Le=w(ae),J=m(ae,"TR",{});var Oe=g(J);Re=m(Oe,"TD",{});var et=g(Re);Ce=m(et,"BUTTON",{"data-svelte-h":!0}),X(Ce)!=="svelte-57p0uk"&&(Ce.textContent=ye),et.forEach(d),fe=w(Oe),We=m(Oe,"TD",{});var nt=g(We);ke=m(nt,"BUTTON",{"data-svelte-h":!0}),X(ke)!=="svelte-1nly394"&&(ke.textContent=Ze),nt.forEach(d),Qe=w(Oe),we=m(Oe,"TD",{});var tt=g(we);Ee=m(tt,"BUTTON",{"data-svelte-h":!0}),X(Ee)!=="svelte-7ds02w"&&(Ee.textContent=un),tt.forEach(d),Je=w(Oe),me=m(Oe,"TD",{});var ot=g(me);Me=m(ot,"BUTTON",{"data-svelte-h":!0}),X(Me)!=="svelte-90j6ve"&&(Me.textContent=dn),ot.forEach(d),Oe.forEach(d),Ae=w(ae),ie=m(ae,"TR",{});var je=g(ie);Ye=m(je,"TD",{});var rt=g(Ye);z=m(rt,"BUTTON",{"data-svelte-h":!0}),X(z)!=="svelte-fxtyz6"&&(z.textContent=fn),rt.forEach(d),mn=w(je),ee=m(je,"TD",{});var st=g(ee);Ne=m(st,"BUTTON",{"data-svelte-h":!0}),X(Ne)!=="svelte-1m2jkw7"&&(Ne.textContent=Se),st.forEach(d),_e=w(je),Xe=m(je,"TD",{});var it=g(Xe);Te=m(it,"BUTTON",{"data-svelte-h":!0}),X(Te)!=="svelte-5alhx0"&&(Te.textContent=he),it.forEach(d),hn=w(je),Pe=m(je,"TD",{});var at=g(Pe);oe=m(at,"BUTTON",{"data-svelte-h":!0}),X(oe)!=="svelte-1de77je"&&(oe.textContent=q),at.forEach(d),je.forEach(d),ae.forEach(d)},m(Be,ae){L(Be,n,ae),c(n,t),c(t,o),c(o,r),c(t,i),c(t,a),c(a,l),c(t,y),c(t,v),c(v,p),c(t,A),c(t,U),c(U,E),c(n,T),c(n,k),c(k,G),c(G,W),c(k,ue),c(k,S),c(k,_),c(k,H),c(H,$),c(k,Q),c(k,de),c(de,Y),c(n,Le),c(n,J),c(J,Re),c(Re,Ce),c(J,fe),c(J,We),c(We,ke),c(J,Qe),c(J,we),c(we,Ee),c(J,Je),c(J,me),c(me,Me),c(n,Ae),c(n,ie),c(ie,Ye),c(Ye,z),c(ie,mn),c(ie,ee),c(ee,Ne),c(ie,_e),c(ie,Xe),c(Xe,Te),c(ie,hn),c(ie,Pe),c(Pe,oe),b||(D=[F(r,"click",e[12]),F(l,"click",e[13]),F(p,"click",e[14]),F(E,"click",e[15]),F(W,"click",e[16]),F($,"click",e[17]),F(Y,"click",e[18]),F(Ce,"click",e[19]),F(ke,"click",e[20]),F(Ee,"click",e[21]),F(Me,"click",e[22]),F(z,"click",e[23]),F(Ne,"click",e[24]),F(Te,"click",e[25]),F(oe,"click",e[26])],b=!0)},p:ce,d(Be){Be&&d(n),b=!1,$t(D)}}}function bs(e){let n,t,o,r,s="Next",i,a,l,u="End action",y,v,p,O,A="Save",U,E,M,T="Load",k,G,W,B,ue="Debug",S,_;return{c(){n=f("table"),t=f("tr"),o=f("td"),r=f("button"),r.textContent=s,i=C(),a=f("td"),l=f("button"),l.textContent=u,y=C(),v=f("tr"),p=f("td"),O=f("button"),O.textContent=A,U=C(),E=f("td"),M=f("button"),M.textContent=T,k=C(),G=f("tr"),W=f("td"),B=f("button"),B.textContent=ue},l(H){n=m(H,"TABLE",{});var $=g(n);t=m($,"TR",{});var Z=g(t);o=m(Z,"TD",{});var Q=g(o);r=m(Q,"BUTTON",{"data-svelte-h":!0}),X(r)!=="svelte-1axp1ke"&&(r.textContent=s),Q.forEach(d),i=w(Z),a=m(Z,"TD",{});var de=g(a);l=m(de,"BUTTON",{"data-svelte-h":!0}),X(l)!=="svelte-1de77je"&&(l.textContent=u),de.forEach(d),Z.forEach(d),y=w($),v=m($,"TR",{});var Y=g(v);p=m(Y,"TD",{});var xe=g(p);O=m(xe,"BUTTON",{"data-svelte-h":!0}),X(O)!=="svelte-fxtyz6"&&(O.textContent=A),xe.forEach(d),U=w(Y),E=m(Y,"TD",{});var Le=g(E);M=m(Le,"BUTTON",{"data-svelte-h":!0}),X(M)!=="svelte-1m2jkw7"&&(M.textContent=T),Le.forEach(d),Y.forEach(d),k=w($),G=m($,"TR",{});var J=g(G);W=m(J,"TD",{});var Re=g(W);B=m(Re,"BUTTON",{"data-svelte-h":!0}),X(B)!=="svelte-5alhx0"&&(B.textContent=ue),Re.forEach(d),J.forEach(d),$.forEach(d)},m(H,$){L(H,n,$),c(n,t),c(t,o),c(o,r),c(t,i),c(t,a),c(a,l),c(n,y),c(n,v),c(v,p),c(p,O),c(v,U),c(v,E),c(E,M),c(n,k),c(n,G),c(G,W),c(W,B),S||(_=[F(r,"click",e[7]),F(l,"click",e[8]),F(O,"click",e[9]),F(M,"click",e[10]),F(B,"click",e[11])],S=!0)},p:ce,d(H){H&&d(n),S=!1,$t(_)}}}function Es(e){let n,t,o,r,s,i,a,l,u,y,v,p,O,A,U,E;o=new hs({props:{state:e[0]}});function M(_){e[5](_)}function T(_){e[6](_)}let k={};e[0]!==void 0&&(k.state=e[0]),e[1]!==void 0&&(k.debugMode=e[1]),s=new Zr({props:k}),Tn.push(()=>On(s,"state",M)),Tn.push(()=>On(s,"debugMode",T));function G(_,H){return _[2]<600?bs:_s}let W=G(e),B=W(e);function ue(_){e[27](_)}let S={};return e[0]!==void 0&&(S.state=e[0]),p=new ys({props:S}),Tn.push(()=>On(p,"state",ue)),{c(){n=f("div"),t=f("div"),en(o.$$.fragment),r=C(),en(s.$$.fragment),l=C(),u=f("div"),y=f("div"),B.c(),v=C(),en(p.$$.fragment),this.h()},l(_){n=m(_,"DIV",{class:!0});var H=g(n);t=m(H,"DIV",{class:!0});var $=g(t);nn(o.$$.fragment,$),$.forEach(d),r=w(H),nn(s.$$.fragment,H),H.forEach(d),l=w(_),u=m(_,"DIV",{class:!0,id:!0});var Z=g(u);y=m(Z,"DIV",{class:!0});var Q=g(y);B.l(Q),Q.forEach(d),v=w(Z),nn(p.$$.fragment,Z),Z.forEach(d),this.h()},h(){x(t,"class","characterSide svelte-8a7at9"),x(n,"class","container svelte-8a7at9"),x(y,"class","commands svelte-8a7at9"),x(u,"class","container svelte-8a7at9"),x(u,"id","footer")},m(_,H){L(_,n,H),c(n,t),tn(o,t,null),c(n,r),tn(s,n,null),L(_,l,H),L(_,u,H),c(u,y),B.m(y,null),c(u,v),tn(p,u,null),A=!0,U||(E=F(ks,"keydown",io(e[4])),U=!0)},p(_,[H]){const $={};H&1&&($.state=_[0]),o.$set($);const Z={};!i&&H&1&&(i=!0,Z.state=_[0],Dn(()=>i=!1)),!a&&H&2&&(a=!0,Z.debugMode=_[1],Dn(()=>a=!1)),s.$set(Z),W===(W=G(_))&&B?B.p(_,H):(B.d(1),B=W(_),B&&(B.c(),B.m(y,null)));const Q={};!O&&H&1&&(O=!0,Q.state=_[0],Dn(()=>O=!1)),p.$set(Q)},i(_){A||(V(o.$$.fragment,_),V(s.$$.fragment,_),V(p.$$.fragment,_),A=!0)},o(_){ne(o.$$.fragment,_),ne(s.$$.fragment,_),ne(p.$$.fragment,_),A=!1},d(_){_&&(d(n),d(l),d(u)),on(o),on(s),B.d(),on(p),U=!1,E()}}}function As(e,n,t){let o=lr(),r=o.settings.debug,s;Cn(()=>{setInterval(()=>fr(o),1e3)}),s=window.innerWidth,console.log(s);const i=()=>{t(1,r=!r),t(0,o.settings.debug=r,o)};function a(Y){switch(Y.key){case"6":case"d":se("R",o);break;case"9":case"e":se("UR",o);break;case"8":case"w":se("U",o);break;case"7":case"q":se("UL",o);break;case"4":case"a":se("L",o);break;case"1":case"z":se("DL",o);break;case"2":case"x":se("D",o);break;case"3":case"c":se("DR",o);break;case"0":case" ":Pn(o);break;case"-":case"r":qn(o);break;case"+":case"f":Xn(o);break}}function l(Y){o=Y,t(0,o)}function u(Y){r=Y,t(1,r)}const y=()=>Pn(o),v=()=>dt(o),p=()=>_t(o),O=()=>t(0,o=bt()),A=()=>i(),U=()=>se("UL",o),E=()=>se("U",o),M=()=>se("UR",o),T=()=>Pn(o),k=()=>se("L",o),G=()=>se("R",o),W=()=>Xn(o),B=()=>se("DL",o),ue=()=>se("D",o),S=()=>se("DR",o),_=()=>qn(o),H=()=>_t(o),$=()=>t(0,o=bt()),Z=()=>i(),Q=()=>dt(o);function de(Y){o=Y,t(0,o)}return[o,r,s,i,a,l,u,y,v,p,O,A,U,E,M,T,k,G,W,B,ue,S,_,H,$,Z,Q,de]}class Os extends sn{constructor(n){super(),an(this,n,As,Es,He,{})}}export{Os as component};
