import{s as Ze,n as _e,o as yt,b as nn,f as on,r as Rn,i as Ae}from"../chunks/scheduler.ba2ce6c0.js";import{S as dt,i as At,g as p,h as v,j as k,f as g,k as L,a as S,x as A,y as V,m as y,s as H,n as B,c as O,z as ee,l as ln,o as se,e as Re,d as me,p as wt,b as Pt,t as Ee,A as hn,r as rt,u as at,v as ct,w as ut,B as sn,C as Dn}from"../chunks/index.6f434070.js";function ht(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var Y=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(Y||{}),j=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(j||{}),z=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(z||{}),Se=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(Se||{}),be=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(be||{}),w=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(w||{}),U=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e))(U||{});const Tt=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:U.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:U.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:U.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:U.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:U.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],rn=[{name:"Orch Sword",range:99,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:U.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:U.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Tn=[{name:"Chain mail",type:U.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:U.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:U.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],an=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:U.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:U.ARMOUR,movementReduction:0,value:0}],Hn="0",On="@",vt=" ",Ht="#",Ln=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),fe=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),cn=(e,t,n)=>({...fe(e,t,n),hidden:!0}),Ne=(e,t,n,o)=>{const l=Object.values(Y).indexOf(t),s=Object.keys(Y)[l];let r=z.LORD,u=2,c=2,b=4,T=4,M=4,x=rn[0],G=an[0];switch(e){case j.ORCH:{r=z.APPRENTICE,c=0,b=2,T=2,M=1;break}case j.TROLL:{r=z.KNIGHT,c=1,b=3,T=3,M=2,x=rn[1],G=an[1];break}}return e===j.YELLOW_DARK_LORD&&(u=3),{type:e,level:r,colour:t,actions:u,defense:c,health:b,maxHealth:T,experience:M,name:e+" ("+s+")",movement:3,maxMovement:3,position:{x:n,y:o},weapon:x,armour:G,incapacitated:!1,inventory:[]}},wn=e=>{const t=e.currentActor,n=Et(t.level,1);let o,l,s,r;n>=1?(o=zn(e,t,n),o||(l=Gn(e,t,n)),!o&&!l&&(s=$n(e,t,n)),!o&&!l&&!s&&(r=Yn(e,t,n)),!o&&!l&&!s&&!r&&I(e,`${t.name} searched but found nothing`)):I(e,`${t.name} searched but found nothing`)},In=e=>{const t=e.currentActor;if(!t)return!1;const n=e.dungeon.layout.secrets.filter(o=>o.type===be.TRAP_DOOR).filter(o=>!o.found).find(o=>Lt(o.position,t.position));return n?(ft(e,Pn(n),t),I(e,`${t.name} fell into a pit and is incapacitated for one turn.`),t.movement=0,t.actions=0,t.incapacitated=!0,n.found=!0,!0):!1},Pn=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:Y.Red,maxHealth:0,name:"Trap Door",level:z.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:U.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),Sn=(e,t)=>e.dungeon.layout.doors.filter(n=>n.hidden).find(n=>nt({x:n.x,y:n.y},t.x,t.y)),Nn=(e,t)=>e.dungeon.layout.doors.filter(n=>n.trapped).find(n=>n.x===t.x&&n.y===t.y),Mn=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).find(n=>nt(n.position,t.x,t.y)),Un=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).filter(n=>n.type===be.TRAP_DOOR).find(n=>nt(n.position,t.x,t.y)),Gn=(e,t,n)=>Sn(e,t.position)?(I(e,`${t.name} searched (${n}) and found a hidden door`),!0):!1,$n=(e,t,n)=>{const o=Nn(e,t.position);return o?(I(e,`${t.name} searched (${n}) and found a trap in a door`),o.trapped=!1,!0):!1},Yn=(e,t,n)=>{const o=Mn(e,t.position);if(o){switch(I(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,o.type){case be.EQUIPMENT:{let l=o.item??Fn(e);switch(Wn(e,l),I(e,`${t.name} equipped (${l.name})`),l.type){case U.ARMOUR:t.armour&&t.inventory.push(t.armour),t.armour=l;break;case U.SHIELD:t.shield&&t.inventory.push(t.shield),t.shield=l;break;case U.WEAPON:t.weapon&&t.inventory.push(t.weapon),t.weapon=l;break}}}return!0}return!1},Fn=e=>{const t=e.itemDeck.length,n=Math.floor(Math.random()*t);return e.itemDeck[n]},Wn=(e,t)=>{const n=e.itemDeck.findIndex(o=>o.type===t.type&&o.name===t.name);e.itemDeck.splice(n,1)},zn=(e,t,n)=>{const o=Un(e,t.position);return o?(I(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},En={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:Se.KILL_ALL,fulfilled:!1},{type:Se.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[fe(w.RIGHT,2,4),fe(w.RIGHT,5,4),fe(w.RIGHT,9,5),fe(w.RIGHT,12,5),fe(w.RIGHT,9,8),fe(w.RIGHT,12,8),fe(w.RIGHT,11,2),cn(w.UP,9,3),cn(w.RIGHT,15,1)],monsters:[Ne(j.ORCH,Y.Blue,9,7),Ne(j.ORCH,Y.Red,12,8),Ne(j.TROLL,Y.Red,15,1),Ne(j.TROLL,Y.Yellow,13,6)],secrets:[{type:be.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:be.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:be.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item"},{type:be.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},xn={name:"Troll cave",beaten:!1,winConditions:[{type:Se.KILL_ALL,fulfilled:!1}],nextDungeon:En,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[fe(w.RIGHT,3,9),fe(w.RIGHT,6,9),fe(w.UP,7,7),fe(w.UP,7,4)],monsters:[Ne(j.ORCH,Y.Green,6,9),Ne(j.ORCH,Y.Yellow,8,10),Ne(j.ORCH,Y.Red,7,5),Ne(j.ORCH,Y.Red,9,3),Ne(j.TROLL,Y.Green,6,1)],secrets:[Ln(be.TRAP_DOOR,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},qn=[{name:"Large shield",type:U.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:U.SHIELD,amountInDeck:2,dice:1,value:1}],pt=(e,t)=>(Tt[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:z.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Tt[0],incapacitated:!1,inventory:[]}),Kn=()=>{const e=[];return Tt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Tn.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),qn.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),e},st={name:"Treasure of the Ice Dragon",dungeons:[xn,En],itemDeck:Kn(),heroes:[pt("Fearik",Y.Yellow),pt("Helbran",Y.Red),pt("Siedel",Y.Green),pt("Wulf",Y.Blue)]},un=e=>{I(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Xn=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),I(t,"Game loaded."),t}},Vn=()=>{const e={heroes:st.heroes,dungeon:st.dungeons[0],currentActor:st.heroes[0],actionLog:[`Playing '${st.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:jn(st.itemDeck)};return kn(e),e},jn=e=>{let t=e.length,n;for(;t>0;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e},kn=e=>{e.heroes.forEach((t,n)=>{t.position=e.dungeon.startingPositions[n],t.movement=qe(t),t.actions=2,t.health=t.maxHealth})},tt=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},St=(e,t,n)=>e.dungeon.layout.monsters.some(o=>o.position.x===t&&o.position.y===n&&o.health>0),Nt=(e,t,n)=>W(e).some(o=>o.position.x===t&&o.position.y===n),It=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=qe(e))),e.actions==0&&(e.movement=0)},P=(e,t)=>{const n=t.currentActor;if(!n||n.actions===0)return;let o=n.position.x,l=n.position.y;switch(e){case"UL":o=n.position.x-1,l=n.position.y-1;break;case"U":l=n.position.y-1;break;case"UR":o=n.position.x+1,l=n.position.y-1;break;case"L":o=n.position.x-1;break;case"R":o=n.position.x+1;break;case"DL":o=n.position.x-1,l=n.position.y+1;break;case"D":l=n.position.y+1;break;case"DR":o=n.position.x+1,l=n.position.y+1;break}const s=Nt(t,o,l),r=!Bt(t.dungeon.layout,o,l),u=St(t,o,l);if(!s&&!r){const c=Mt(t.dungeon,o,l);c?c&&(u?Cn(n,t,o,l):Qn(n,t,o,l,1)):Jn(t,n,o,l)&&it(n,t,o,l)}else I(t,`${n.name} could not make that move`);In(t)||It(n)},Qn=(e,t,n,o,l)=>{e.position.x=n,e.position.y=o;const s=t.dungeon.layout.notes.find(u=>Lt(u.position,e.position));s&&(t.dungeon.layout.doors.some(c=>c.hidden&&Lt(s.position,{x:c.x,y:c.y}))||I(t,`${e.name} reads: ${s.message}`)),t.dungeon.layout.monsters.some(u=>nt(e.position,u.position.x,u.position.y))?(I(t,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=l},it=(e,t,n,o)=>{const l=bt(t.dungeon.layout.grid,n,o);l&&t.dungeon.discoveredRooms.push(l),Qn(e,t,e.position.x,e.position.y,1),I(t,`${e.name} opened a door`)},Cn=(e,t,n,o)=>{if(e.actions===1&&e.movement!==3){I(t,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&W(t).filter(r=>r!==e).filter(r=>nt(e.position,r.position.x,r.position.y)).length>0){I(t,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const l=t.dungeon.layout.monsters.find(s=>s.position.x===n&&s.position.y===o);l&&(ft(t,e,l),l.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(s=>s!=l),I(t,`${e.name} killed ${l.name}`),t.dungeon.killCount++,e.experience+=l.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},Et=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case z.APPRENTICE:n=n.filter(o=>o===5);break;case z.KNIGHT:case z.HERO:n=n.filter(o=>o>=4);break;case z.LORD:case z.MASTER:n=n.filter(o=>o>=3);break}return n.length},kt=e=>{const t=e.currentActor;if(!t)return;if(!Ct(t)){I(e,`${t.name} has no actions left to pick lock`);return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(Et(t.level,1)>=1?(n.locked=!1,I(e,`${t.name} managed to pick the lock`)):I(e,`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=qe(t),t.actions==0&&(t.movement=0))},qe=e=>{var t;return e.maxMovement-(((t=e.armour)==null?void 0:t.movementReduction)??0)},Qt=e=>{const t=e.currentActor;if(t){if(!Ct(t)){I(e,`${t.name} has no actions left to search`);return}wn(e),t.actions>1&&t.movement<qe(t)?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)}},Ot=e=>{if(Zn(e),e.currentActor!==void 0){I(e,`${e.currentActor.name} ended their turn`);let n=W(e).indexOf(e.currentActor)+1;n===W(e).length&&(to(e),n=0),W(e)[n].incapacitated&&(I(e,`${W(e)[n].name} is no longer incapacitated.`),W(e)[n].incapacitated=!1,n++),e.currentActor.actions=2,e.currentActor.movement=qe(e.currentActor),e.currentActor=W(e)[n],I(e,`${e.currentActor.name} started their turn`)}},Zn=e=>{var t;e.dungeon.winConditions.forEach(n=>{var o;switch(n.type){case Se.KILL_ALL:{const l=e.dungeon.layout.monsters.map(s=>s.health).reduce((s,r)=>s+r,0);n.fulfilled=l<=0;break}case Se.REACH_CELL:{n.fulfilled=W(e).some(l=>{var s;return l.position.x===((s=n.targetCell)==null?void 0:s.x)&&l.position.y===n.targetCell.y});break}case Se.KILL_ALL_OF_TYPE:{n.fulfilled=e.dungeon.layout.monsters.filter(l=>l.type===n.targetMonsterType).some(l=>l.health>0);break}case Se.OPEN_DOOR:{n.fulfilled=((o=e.dungeon.layout.doors.find(l=>{var s,r;return l.x===((s=n.targetCell)==null?void 0:s.x)&&l.y===((r=n.targetCell)==null?void 0:r.y)}))==null?void 0:o.open)??!1;break}case Se.KILL_AT_LEAST:{n.fulfilled=(n.killMinCount?n.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(n=>n.fulfilled).reduce((n,o)=>n&&o,!0),e.dungeon.beaten&&(I(e,"All win conditions have been fulfilled"),I(e,`You have cleared ${e.dungeon.name}`),I(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},yn=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:Y.Red,maxHealth:0,name:"Door",level:z.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:U.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Jn=(e,t,n,o)=>{const l=e.dungeon.layout.doors.find(s=>s.x===t.position.x&&s.y===t.position.y);if(l&&!l.locked){const s=eo(t.position.x,t.position.y,n,o);if(l.side===s)return l.open=!0,l.trapped&&ft(e,yn(l),t),!0}return l&&l.locked&&I(e,"Door is locked"),!1},eo=(e,t,n,o)=>{if(e===n){if(t>o)return w.UP;if(t<o)return w.DOWN}if(t===o){if(e>n)return w.LEFT;if(e<n)return w.RIGHT}},Bt=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const l=bt(e.grid,t,n);(l===Hn||l===On||l===vt||l===Ht)&&(o=!1)}return o},Mt=(e,t,n)=>{const o=bt(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},bt=(e,t,n)=>{let o;return e.forEach((l,s)=>{tt(l).forEach((r,u)=>{s===n&&u===t&&(o=r)})}),o},nt=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,to=e=>{const t=e.dungeon.layout.monsters.filter(n=>{const o=bt(e.dungeon.layout.grid,n.position.x,n.position.y);return o&&e.dungeon.discoveredRooms.includes(o)&&n.health>0});t.length===0&&I(e,"No monsters can act"),t.forEach(n=>{const o=n.actions;for(I(e,`${n.name} acted `);n.actions>0;){const l=W(e).filter(s=>nt(n.position,s.position.x,s.position.y));if(l.length>0){const s=Math.floor(Math.random()*l.length);so(e,n,l[s])}else{for(;n.movement>0;)no(e,n);n.actions--,n.movement=qe(n)}}n.actions=o,n.movement=qe(n)})},dn=(e,t)=>Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2)),no=(e,t)=>{const n=W(e).map(o=>({hero:o,dist:dn(o.position,t.position)})).sort((o,l)=>o.dist-l.dist)[0];if(n.dist>1){const o=oo(e,t.position);if(o.length>0){const l=o.map(s=>({pos:s,dist:dn(s,n.hero.position)})).sort((s,r)=>s.dist-r.dist)[0].pos;t.position=l,I(e,`${t.name} moved towards ${n.hero.name} (${l.x},${l.y})`)}else I(e,`${t.name} could not move`)}t.movement--};let oo=(e,t)=>{const n=t.x,o=t.y,l=[];for(let s=n-1;s<=n+1;s++)for(let r=o-1;r<=o+1;r++)s===n&&r===o||Bt(e.dungeon.layout,s,r)&&Mt(e.dungeon,s,r)&&l.push({x:s,y:r});return l.filter(s=>!W(e).find(r=>r.position.x===s.x&&r.position.y===s.y)).filter(s=>!e.dungeon.layout.monsters.find(u=>u.position.x===s.x&&u.position.y===s.y))};const lo=(e,t,n,o)=>{var s;const l=((s=o.armour)==null?void 0:s.defense)??o.defense;return`${e} damage (${t}-(${l}+${n})=${e})`},so=(e,t,n)=>{if(t.actions===1&&t.movement!==3){I(e,`${n.name} has no actions left to attack`);return}n&&(ft(e,t,n),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--)},Ct=e=>e.movement<qe(e)?e.actions>1:e.actions>0,Lt=(e,t)=>e.x===t.x&&e.y===t.y,I=(e,t)=>{e.actionLog=[t,...e.actionLog]},W=e=>e.heroes.filter(t=>t.health>0),io=e=>e.heroes.filter(t=>t.health<=0),ft=(e,t,n)=>{var u,c;let o=0,l=0;t.weapon.ignoresArmour?n.armour&&I(e,`${n.name}'s armour was useless against ${t.weapon.name} `):o=((u=n.armour)==null?void 0:u.defense)??n.defense,t.weapon.ignoresShield?n.shield&&I(e,`${n.name}'s shield was useless against ${t.weapon.name} `):l=Et(n.level,((c=n.shield)==null?void 0:c.dice)??0);const s=Et(t.level,t.weapon.dice),r=Math.max(s-(o+l),0);n.health-=r,I(e,`${t.name} attacked ${n.name} with ${t.weapon.name} for ${lo(r,s,l,n)}`),n.health<=0&&(I(e,`${t.name} killed ${n.name}`),n.health=0,n.level=z.APPRENTICE)},ro=e=>{W(e).forEach(t=>{const n=t.level;t.experience>=28?t.level=z.MASTER:t.experience>=18?t.level=z.LORD:t.experience>=10?t.level=z.HERO:t.experience>=4&&(t.level=z.KNIGHT),n!==t.level&&I(e,`${t.name} leveled up to ${t.level}`)})},ao=e=>{W(e).forEach(t=>t.experience+=4)},co=e=>{io(e).forEach(t=>{t.experience=0,t.health=t.maxHealth,t.movement=t.maxMovement,t.actions=2})},uo=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],ao(e),ro(e),co(e),kn(e))},Ao="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",fo="data:image/png;base64,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",mo=(e,t)=>{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y),l=Math.min(n,o),s=Math.max(n,o),r=l,u=s-l;let c=Math.sqrt(2);return u===0&&(c=1),Math.floor(c*r+u)},go=(e,t,n)=>{const o=e.currentActor,l=e.dungeon.layout.doors.find(s=>s.x===o.position.x&&s.y===o.position.y);if(l){if(!l.open&&!l.hidden&&!l.locked){switch(l.open=!0,l.trapped&&ft(e,yn(l),o),l.side){case w.RIGHT:it(o,e,t+1,n);break;case w.LEFT:it(o,e,t-1,n);break;case w.DOWN:it(o,e,t,n+1);break;case w.UP:it(o,e,t,n-1);break}It(o)}else if(l.locked&&!l.hidden){if(!Ct(o)){I(e,`${o.name} has no actions left`);return}I(e,"Door is locked"),kt(e),It(o)}}else{if(!Ct(o)){I(e,`${o.name} has no actions left`);return}Qt(e)}},po=(e,t,n)=>{const o=e.currentActor;if(o.actions===0){I(e,`${o.name} has no actions left`);return}const l=Bt(e.dungeon.layout,t,n),s=mo(o.position,{x:t,y:n});if(console.log("distance: "+s),l){const r=Nt(e,t,n),u=St(e,t,n);if(!r&&!u&&s<=o.movement){if(o.position={x:t,y:n},o.movement-=s,In(e))return}else u&&(s<=o.weapon.range?Cn(o,e,t,n):I(e,"Monster is out of range"))}It(o)},vo=(e,t,n)=>{const o=n.currentActor,l=document.getElementById("gameBoard");if(!l)return;const s=l.getBoundingClientRect(),r=Math.min(Math.floor((e.clientX-s.left)/t),n.dungeon.layout.grid[0].length-1),u=Math.min(Math.floor((e.clientY-s.top)/t),n.dungeon.layout.grid.length-1),c=n.dungeon.layout.grid[u][r];r===o.position.x&&u===o.position.y?go(n,r,u):n.dungeon.discoveredRooms.includes(c)&&po(n,r,u)},ho=(e,t,n,o)=>{o.dungeon.layout.secrets.filter(l=>l.found).forEach(l=>{switch(l.type){case be.TRAP_DOOR:Io(e,t,n,l);break;default:Eo(e,t,n,l);break}})},Io=(e,t,n,o)=>{const l=o.position.x,s=o.position.y;e.drawImage(t,3*48,0,48,48,l*n,s*n,n,n)},Eo=(e,t,n,o)=>{const l=o.position.x,s=o.position.y;e.drawImage(t,4*48,0,48,48,l*n,s*n,n,n)};function ko(e){let t,n,o,l;return{c(){t=p("div"),n=p("canvas"),this.h()},l(s){t=v(s,"DIV",{style:!0,class:!0});var r=k(t);n=v(r,"CANVAS",{width:!0,height:!0,id:!0}),k(n).forEach(g),r.forEach(g),this.h()},h(){L(n,"width",i*40),L(n,"height",i*30),L(n,"id","gameBoard"),L(t,"style",e[1]()),L(t,"class","dungeon svelte-a4uhtl")},m(s,r){S(s,t,r),A(t,n),o||(l=V(n,"click",e[0]),o=!0)},p:_e,i:_e,o:_e,d(s){s&&g(t),o=!1,l()}}}const i=48;function Qo(e,t,n){let{state:o}=t,{debugMode:l=!0}=t,s,r;r=window.innerHeight,s=document.getElementById("footer").offsetHeight,yt(()=>{const a=new Image;a.src=Ao;const d=new Image;d.src=fo,c(a,d),setInterval(()=>c(a,d),10)});const u=(a,d,f)=>{const m=d.position.x,h=d.position.y;a.drawImage(f,4*16,0,16,16,m*i,h*i,i,i),q(a,d,m,h),G(a,d,m,h),ke(a,d,m,h)},c=(a,d)=>{if(!o||!document)return;const f=document.getElementById("gameBoard"),m=f.getContext("2d");m.clearRect(0,0,f.width,f.height),m.fillStyle="black",m.fillRect(0,0,f.width,f.height),o.dungeon.layout.grid.forEach((C,E)=>{tt(C).forEach((D,R)=>T(m,D,R,E,a))}),ho(m,a,i,o),o.dungeon.layout.grid.forEach((C,E)=>{tt(C).forEach((D,R)=>M(m,D,R,E))}),o.dungeon.layout.grid.forEach((C,E)=>{tt(C).forEach((D,R)=>x(m,D,R,E))}),o.dungeon.layout.grid.forEach((C,E)=>{tt(C).forEach((D,R)=>Ce(m,D,R,E,d))}),W(o).forEach(C=>{u(m,C,d)}),Qe(m,o.currentActor),te(m,o.currentActor)},b=(a,d,f)=>{a.beginPath(),a.strokeStyle="black",a.fillStyle="black",a.fillRect(d*i,f*i,i,i),a.stroke()},T=(a,d,f,m,h)=>{F(d)||!o.dungeon.discoveredRooms.includes(d)&&d!==vt?o.dungeon.discoveredRooms.some(C=>ge(f,m,C))?a.drawImage(h,48,0,48,48,f*i,m*i,i,i):b(a,f,m):ne(d)?b(a,f,m):a.drawImage(h,0,0,48,48,f*i,m*i,i,i)},M=(a,d,f,m)=>{d===vt||d===Ht||(a.beginPath(),a.strokeStyle="black",a.rect(f*i,m*i,i,i),l&&(a.font="7px Arial",a.fillText(f+","+m,f*i+3,m*i+(i-3))),a.stroke())},x=(a,d,f,m)=>{const h=Ue(f,m);if(h&&!h.hidden&&!h.open&&!ne(d))switch(a.fillStyle="brown",h.side){case w.RIGHT:{a.fillRect(f*i+(i-2),m*i,4,i),h.locked&&l&&(a.fillStyle="grey",a.fillRect(f*i+(i-4),m*i+(i/2-4),8,8)),h.trapped&&l&&(a.fillStyle="red",a.fillRect(f*i+(i-4),m*i+(i/2-4),4,4));break}case w.LEFT:{a.fillRect(f*i-2,m*i,4,i),h.locked&&l&&(a.fillStyle="grey",a.fillRect(f*i-4,m*i+(i/2-4),8,8)),h.trapped&&l&&(a.fillStyle="red",a.fillRect(f*i-4,m*i+(i/2-4),4,4));break}case w.UP:{a.fillRect(f*i,m*i-2,i,4),h.locked&&l&&(a.fillStyle="grey",a.fillRect(f*i+(i/2-4),m*i-4,8,8)),h.trapped&&l&&(a.fillStyle="red",a.fillRect(f*i+(i/2-4),m*i-4,4,4));break}case w.DOWN:{a.fillRect(f*i,m*i+(i-2),i,4),h.locked&&l&&(a.fillStyle="grey",a.fillRect(f*i+(i/2-4),m*i+(i-4),8,8)),h.trapped&&l&&(a.fillStyle="red",a.fillRect(f*i+(i/2-4),m*i+(i-4),4,4));break}}},G=(a,d,f,m)=>{a.beginPath(),a.strokeStyle=d.colour,a.fillStyle=d.colour,a.fillRect(f*i+4,m*i+(i-6),i-8,4),a.stroke()},Me=(a,d,f,m)=>{l&&f.forEach(h=>{const C=d.position.x,E=d.position.y,D=h.position.x,R=h.position.y;a.strokeStyle=d.colour,a.beginPath(),a.moveTo(C*i+i/2,E*i+i/2),a.lineTo(D*i+i/2,R*i+i/2),a.stroke()})},ke=(a,d,f,m)=>{a.beginPath(),a.strokeStyle="black",a.fillStyle="red",a.fillRect(f*i+4,m*i,i-8,4),a.fillStyle="green",a.fillRect(f*i+4,m*i,(i-8)*(d.health/d.maxHealth),4),a.rect(f*i+4,m*i,i-8,4),a.stroke()},q=(a,d,f,m)=>{var h=a.fillStyle,C=a.strokeStyle;a.strokeStyle="#080808",a.fillStyle="darkred";for(let E=0;E<d.actions;E++)a.fillRect(f*i+4+6*E,m*i+i-12,5,5),a.rect(f*i+4+6*E,m*i+i-12,5,5),a.stroke();a.fillStyle="blue";for(let E=0;E<d.movement;E++)a.fillRect(f*i+i-22+6*E,m*i+i-12,5,5),a.rect(f*i+i-22+6*E,m*i+i-12,5,5),a.stroke();a.fillStyle=h,a.strokeStyle=C},te=(a,d)=>{d===o.currentActor&&(a.beginPath(),a.strokeStyle="lightblue",a.lineWidth=2,a.moveTo(d.position.x*i,d.position.y*i),a.lineTo(d.position.x*i+i/3,d.position.y*i),a.moveTo(d.position.x*i,d.position.y*i),a.lineTo(d.position.x*i,d.position.y*i+i/3),a.moveTo(d.position.x*i+i,d.position.y*i),a.lineTo(d.position.x*i+i/3*2,d.position.y*i),a.moveTo(d.position.x*i+i,d.position.y*i),a.lineTo(d.position.x*i+i,d.position.y*i+i/3),a.moveTo(d.position.x*i,d.position.y*i+i),a.lineTo(d.position.x*i,d.position.y*i+i/3*2),a.moveTo(d.position.x*i,d.position.y*i+i),a.lineTo(d.position.x*i+i/3,d.position.y*i+i),a.moveTo(d.position.x*i+i,d.position.y*i+i),a.lineTo(d.position.x*i+i,d.position.y*i+i/3*2),a.moveTo(d.position.x*i+i,d.position.y*i+i),a.lineTo(d.position.x*i+i/3*2,d.position.y*i+i),a.stroke(),a.lineWidth=1)},Qe=(a,d)=>{if(d===o.currentActor&&l){for(let f=d.position.x-d.movement;f<=d.position.x+d.movement;f++)for(let m=d.position.y-d.movement;m<=d.position.y+d.movement;m++)if(Mt(o.dungeon,f,m)){const C=St(o,f,m),E=Nt(o,f,m),D=Bt(o.dungeon.layout,f,m);!E&&!C&&D&&(a.fillStyle="rgba(50, 50, 255, 0.08)",a.fillRect(f*i,m*i,i,i),a.stroke())}}},Ce=(a,d,f,m,h)=>{if(a.beginPath(),!o.heroes.find(E=>E.position.x===f&&E.position.y===m)){const E=o.dungeon.layout.monsters.find(D=>D.position.x===f&&D.position.y===m);if(E&&E.health>0&&!ne(d)){switch(E.type){case j.ORCH:a.drawImage(h,i,16,16,16,f*i,m*i,i,i);break;case j.TROLL:a.drawImage(h,i,16,16,16,f*i,m*i,i,i);break;default:a.drawImage(h,16,16,16,16,f*i,m*i,i,i);break}G(a,E,f,m),ke(a,E,f,m),Me(a,E,o.heroes)}}},ne=a=>a===vt||!o.dungeon.discoveredRooms.includes(a),F=a=>a===Ht,Ue=(a,d)=>o.dungeon.layout.doors.find(f=>f.x===a&&f.y===d),ge=(a,d,f)=>{if(!o)return;const m=Math.max(a-1,0),h=Math.max(d-1,0),C=Math.min(a+1,o.dungeon.layout.grid.length),E=Math.min(d+1,o.dungeon.layout.grid[0].length);for(let D=m;D<=C;D++)for(let R=h;R<=E;R++){const $=o.dungeon.layout.grid[R];if(tt($)[D]===f)return!0}return!1},ie=a=>{vo(a,i,o)},oe=()=>`max-height: ${r-s-20}px; max-width: ${i*40}`;return e.$$set=a=>{"state"in a&&n(2,o=a.state),"debugMode"in a&&n(3,l=a.debugMode)},[ie,oe,o,l]}class Co extends dt{constructor(t){super(),At(this,t,Qo,ko,Ze,{state:2,debugMode:3})}}function yo(e){let t;return{c(){t=y("None (0)")},l(n){t=B(n,"None (0)")},m(n,o){S(n,t,o)},p:_e,d(n){n&&g(t)}}}function Bo(e){let t=e[0].armour.name+"",n,o,l=e[0].armour.defense+"",s,r;return{c(){n=y(t),o=y(" ("),s=y(l),r=y(")")},l(u){n=B(u,t),o=B(u," ("),s=B(u,l),r=B(u,")")},m(u,c){S(u,n,c),S(u,o,c),S(u,s,c),S(u,r,c)},p(u,c){c&1&&t!==(t=u[0].armour.name+"")&&se(n,t),c&1&&l!==(l=u[0].armour.defense+"")&&se(s,l)},d(u){u&&(g(n),g(o),g(s),g(r))}}}function bo(e){let t;return{c(){t=y("None (0)")},l(n){t=B(n,"None (0)")},m(n,o){S(n,t,o)},p:_e,d(n){n&&g(t)}}}function _o(e){let t=e[0].shield.name+"",n,o,l=e[0].shield.dice+"",s,r;return{c(){n=y(t),o=y(" ("),s=y(l),r=y(")")},l(u){n=B(u,t),o=B(u," ("),s=B(u,l),r=B(u,")")},m(u,c){S(u,n,c),S(u,o,c),S(u,s,c),S(u,r,c)},p(u,c){c&1&&t!==(t=u[0].shield.name+"")&&se(n,t),c&1&&l!==(l=u[0].shield.dice+"")&&se(s,l)},d(u){u&&(g(n),g(o),g(s),g(r))}}}function Ro(e){let t,n,o,l=e[0].name+"",s,r,u,c,b=e[0].level+"",T,M,x=e[0].experience+"",G,Me,ke,q,te,Qe=e[0].health+"",Ce,ne,F,Ue,ge=e[0].actions+"",ie,oe,a,d,f=e[0].movement+"",m,h,C,E="Equipment:",D,R,$,re,Ge=e[0].weapon.name+"",$e,De,le=e[0].weapon.dice+"",Ke,Xe,K,Z,pe,Je,ae,Te;function ye(_,Q){return _[0].armour!=null?Bo:yo}let Ve=ye(e),X=Ve(e);function Ye(_,Q){return _[0].shield!=null?_o:bo}let ce=Ye(e),J=ce(e);return{c(){t=p("div"),n=p("div"),o=p("b"),s=y(l),r=y(" -"),u=H(),c=p("b"),T=y(b),M=y(" ("),G=y(x),Me=y(")"),ke=H(),q=p("span"),te=y("HP: "),Ce=y(Qe),ne=H(),F=p("span"),Ue=y("Actions: "),ie=y(ge),oe=H(),a=p("span"),d=y("Moves: "),m=y(f),h=H(),C=p("span"),C.textContent=E,D=H(),R=p("div"),$=p("span"),re=y("🗡️  "),$e=y(Ge),De=y(" ("),Ke=y(le),Xe=y(")"),K=H(),Z=p("span"),pe=y(`🧱
        `),X.c(),Je=H(),ae=p("span"),Te=y(`🛡️
            `),J.c(),this.h()},l(_){t=v(_,"DIV",{class:!0,style:!0});var Q=k(t);n=v(Q,"DIV",{class:!0});var ue=k(n);o=v(ue,"B",{class:!0});var et=k(o);s=B(et,l),r=B(et," -"),et.forEach(g),u=O(ue),c=v(ue,"B",{class:!0});var He=k(c);T=B(He,b),M=B(He," ("),G=B(He,x),Me=B(He,")"),He.forEach(g),ue.forEach(g),ke=O(Q),q=v(Q,"SPAN",{class:!0});var ve=k(q);te=B(ve,"HP: "),Ce=B(ve,Qe),ve.forEach(g),ne=O(Q),F=v(Q,"SPAN",{class:!0});var Oe=k(F);Ue=B(Oe,"Actions: "),ie=B(Oe,ge),Oe.forEach(g),oe=O(Q),a=v(Q,"SPAN",{class:!0});var he=k(a);d=B(he,"Moves: "),m=B(he,f),he.forEach(g),h=O(Q),C=v(Q,"SPAN",{class:!0,"data-svelte-h":!0}),ee(C)!=="svelte-1ue18fw"&&(C.textContent=E),D=O(Q),R=v(Q,"DIV",{class:!0});var Le=k(R);$=v(Le,"SPAN",{class:!0});var Be=k($);re=B(Be,"🗡️  "),$e=B(Be,Ge),De=B(Be," ("),Ke=B(Be,le),Xe=B(Be,")"),Be.forEach(g),K=O(Le),Z=v(Le,"SPAN",{class:!0});var we=k(Z);pe=B(we,`🧱
        `),X.l(we),we.forEach(g),Je=O(Le),ae=v(Le,"SPAN",{class:!0});var Ie=k(ae);Te=B(Ie,`🛡️
            `),J.l(Ie),Ie.forEach(g),Le.forEach(g),Q.forEach(g),this.h()},h(){L(o,"class","svelte-1jzprgd"),L(c,"class","svelte-1jzprgd"),L(n,"class","hero-title svelte-1jzprgd"),L(q,"class","svelte-1jzprgd"),L(F,"class","svelte-1jzprgd"),L(a,"class","svelte-1jzprgd"),L(C,"class","svelte-1jzprgd"),L($,"class","svelte-1jzprgd"),L(Z,"class","svelte-1jzprgd"),L(ae,"class","svelte-1jzprgd"),L(R,"class","equipment"),L(t,"class","hero-card svelte-1jzprgd"),ln(t,"background-color",e[0].colour)},m(_,Q){S(_,t,Q),A(t,n),A(n,o),A(o,s),A(o,r),A(n,u),A(n,c),A(c,T),A(c,M),A(c,G),A(c,Me),A(t,ke),A(t,q),A(q,te),A(q,Ce),A(t,ne),A(t,F),A(F,Ue),A(F,ie),A(t,oe),A(t,a),A(a,d),A(a,m),A(t,h),A(t,C),A(t,D),A(t,R),A(R,$),A($,re),A($,$e),A($,De),A($,Ke),A($,Xe),A(R,K),A(R,Z),A(Z,pe),X.m(Z,null),A(R,Je),A(R,ae),A(ae,Te),J.m(ae,null)},p(_,[Q]){Q&1&&l!==(l=_[0].name+"")&&se(s,l),Q&1&&b!==(b=_[0].level+"")&&se(T,b),Q&1&&x!==(x=_[0].experience+"")&&se(G,x),Q&1&&Qe!==(Qe=_[0].health+"")&&se(Ce,Qe),Q&1&&ge!==(ge=_[0].actions+"")&&se(ie,ge),Q&1&&f!==(f=_[0].movement+"")&&se(m,f),Q&1&&Ge!==(Ge=_[0].weapon.name+"")&&se($e,Ge),Q&1&&le!==(le=_[0].weapon.dice+"")&&se(Ke,le),Ve===(Ve=ye(_))&&X?X.p(_,Q):(X.d(1),X=Ve(_),X&&(X.c(),X.m(Z,null))),ce===(ce=Ye(_))&&J?J.p(_,Q):(J.d(1),J=ce(_),J&&(J.c(),J.m(ae,null))),Q&1&&ln(t,"background-color",_[0].colour)},i:_e,o:_e,d(_){_&&g(t),X.d(),J.d()}}}function Do(e,t,n){let{hero:o}=t;return e.$$set=l=>{"hero"in l&&n(0,o=l.hero)},[o]}class Bn extends dt{constructor(t){super(),At(this,t,Do,Ro,Ze,{hero:0})}}function An(e,t,n){const o=e.slice();return o[3]=t[n],o[5]=n,o}function To(e){let t,n,o,l;return n=new Bn({props:{hero:e[3]}}),{c(){t=p("div"),rt(n.$$.fragment),o=H(),this.h()},l(s){t=v(s,"DIV",{class:!0});var r=k(t);at(n.$$.fragment,r),o=O(r),r.forEach(g),this.h()},h(){L(t,"class","not-current-actor svelte-izfxty")},m(s,r){S(s,t,r),ct(n,t,null),A(t,o),l=!0},p(s,r){const u={};r&1&&(u.hero=s[3]),n.$set(u)},i(s){l||(me(n.$$.fragment,s),l=!0)},o(s){Ee(n.$$.fragment,s),l=!1},d(s){s&&g(t),ut(n)}}}function Ho(e){let t,n,o,l;return n=new Bn({props:{hero:e[3]}}),{c(){t=p("div"),rt(n.$$.fragment),o=H(),this.h()},l(s){t=v(s,"DIV",{class:!0});var r=k(t);at(n.$$.fragment,r),o=O(r),r.forEach(g),this.h()},h(){L(t,"class","is-current-actor svelte-izfxty")},m(s,r){S(s,t,r),ct(n,t,null),A(t,o),l=!0},p(s,r){const u={};r&1&&(u.hero=s[3]),n.$set(u)},i(s){l||(me(n.$$.fragment,s),l=!0)},o(s){Ee(n.$$.fragment,s),l=!1},d(s){s&&g(t),ut(n)}}}function fn(e){let t,n,o,l;const s=[Ho,To],r=[];function u(c,b){return c[3]===c[0].currentActor?0:1}return t=u(e),n=r[t]=s[t](e),{c(){n.c(),o=Re()},l(c){n.l(c),o=Re()},m(c,b){r[t].m(c,b),S(c,o,b),l=!0},p(c,b){let T=t;t=u(c),t===T?r[t].p(c,b):(wt(),Ee(r[T],1,1,()=>{r[T]=null}),Pt(),n=r[t],n?n.p(c,b):(n=r[t]=s[t](c),n.c()),me(n,1),n.m(o.parentNode,o))},i(c){l||(me(n),l=!0)},o(c){Ee(n),l=!1},d(c){c&&g(o),r[t].d(c)}}}function mn(e){let t=e[1],n,o,l=fn(e);return{c(){l.c(),n=Re()},l(s){l.l(s),n=Re()},m(s,r){l.m(s,r),S(s,n,r),o=!0},p(s,r){r&2&&Ze(t,t=s[1])?(wt(),Ee(l,1,1,_e),Pt(),l=fn(s),l.c(),me(l,1),l.m(n.parentNode,n)):l.p(s,r)},i(s){o||(me(l),o=!0)},o(s){Ee(l),o=!1},d(s){s&&g(n),l.d(s)}}}function Oo(e){let t,n,o=ht(W(e[0])),l=[];for(let r=0;r<o.length;r+=1)l[r]=mn(An(e,o,r));const s=r=>Ee(l[r],1,1,()=>{l[r]=null});return{c(){for(let r=0;r<l.length;r+=1)l[r].c();t=Re()},l(r){for(let u=0;u<l.length;u+=1)l[u].l(r);t=Re()},m(r,u){for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(r,u);S(r,t,u),n=!0},p(r,[u]){if(u&3){o=ht(W(r[0]));let c;for(c=0;c<o.length;c+=1){const b=An(r,o,c);l[c]?(l[c].p(b,u),me(l[c],1)):(l[c]=mn(b),l[c].c(),me(l[c],1),l[c].m(t.parentNode,t))}for(wt(),c=o.length;c<l.length;c+=1)s(c);Pt()}},i(r){if(!n){for(let u=0;u<o.length;u+=1)me(l[u]);n=!0}},o(r){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)Ee(l[u]);n=!1},d(r){r&&g(t),hn(l,r)}}}function Lo(e,t,n){let{state:o}=t,l=!1;yt(()=>{s(),setInterval(s,100)});const s=()=>{n(1,l=!l)};return e.$$set=r=>{"state"in r&&n(0,o=r.state)},[o,l]}class wo extends dt{constructor(t){super(),At(this,t,Lo,Oo,Ze,{state:0})}}function gn(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function Po(e){let t,n,o=e[2]+"",l;return{c(){t=p("p"),n=y(">"),l=y(o),this.h()},l(s){t=v(s,"P",{class:!0});var r=k(t);n=B(r,">"),l=B(r,o),r.forEach(g),this.h()},h(){L(t,"class","svelte-1xp6uq")},m(s,r){S(s,t,r),A(t,n),A(t,l)},p(s,r){r&1&&o!==(o=s[2]+"")&&se(l,o)},d(s){s&&g(t)}}}function pn(e){let t,n=e[4]<25&&Po(e);return{c(){n&&n.c(),t=Re()},l(o){n&&n.l(o),t=Re()},m(o,l){n&&n.m(o,l),S(o,t,l)},p(o,l){o[4]<25&&n.p(o,l)},d(o){o&&g(t),n&&n.d(o)}}}function vn(e){let t,n=ht(e[0]),o=[];for(let l=0;l<n.length;l+=1)o[l]=pn(gn(e,n,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();t=Re()},l(l){for(let s=0;s<o.length;s+=1)o[s].l(l);t=Re()},m(l,s){for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(l,s);S(l,t,s)},p(l,s){if(s&1){n=ht(l[0]);let r;for(r=0;r<n.length;r+=1){const u=gn(l,n,r);o[r]?o[r].p(u,s):(o[r]=pn(u),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(l){l&&g(t),hn(o,l)}}}function So(e){let t,n=e[0],o=vn(e);return{c(){t=p("div"),o.c(),this.h()},l(l){t=v(l,"DIV",{class:!0});var s=k(t);o.l(s),s.forEach(g),this.h()},h(){L(t,"class","log svelte-1xp6uq")},m(l,s){S(l,t,s),o.m(t,null)},p(l,[s]){s&1&&Ze(n,n=l[0])?(o.d(1),o=vn(l),o.c(),o.m(t,null)):o.p(l,s)},i:_e,o:_e,d(l){l&&g(t),o.d(l)}}}function No(e,t,n){let o=[],{state:l}=t;return yt(()=>{setInterval(()=>{n(0,o=l.actionLog)},1e3)}),e.$$set=s=>{"state"in s&&n(1,l=s.state)},[o,l]}class Mo extends dt{constructor(t){super(),At(this,t,No,So,Ze,{state:1})}}function Uo(e){let t,n,o,l,s,r,u,c,b,T,M,x,G,Me="UL",ke,q,te,Qe="U",Ce,ne,F,Ue="UR",ge,ie,oe,a="Next",d,f,m,h,C="L",E,D,R,$,re,Ge="R",$e,De,le,Ke="Search",Xe,K,Z,pe,Je="DL",ae,Te,ye,Ve="D",X,Ye,ce,J="DR",_,Q,ue,et="Pick lock",He,ve,Oe,he,Le="Save",Be,we,Ie,Ut="Load",_t,Pe,Rt,mt,Dt,Gt;o=new wo({props:{state:e[0]}});function bn(N){e[2](N)}let $t={};e[0]!==void 0&&($t.state=e[0]),s=new Co({props:$t}),nn.push(()=>sn(s,"state",bn));function _n(N){e[4](N)}let Yt={};return e[0]!==void 0&&(Yt.state=e[0]),Pe=new Mo({props:Yt}),nn.push(()=>sn(Pe,"state",_n)),{c(){t=p("div"),n=p("div"),rt(o.$$.fragment),l=H(),rt(s.$$.fragment),u=H(),c=p("div"),b=p("div"),T=p("table"),M=p("tr"),x=p("td"),G=p("button"),G.textContent=Me,ke=H(),q=p("td"),te=p("button"),te.textContent=Qe,Ce=H(),ne=p("td"),F=p("button"),F.textContent=Ue,ge=H(),ie=p("td"),oe=p("button"),oe.textContent=a,d=H(),f=p("tr"),m=p("td"),h=p("button"),h.textContent=C,E=H(),D=p("td"),R=H(),$=p("td"),re=p("button"),re.textContent=Ge,$e=H(),De=p("td"),le=p("button"),le.textContent=Ke,Xe=H(),K=p("tr"),Z=p("td"),pe=p("button"),pe.textContent=Je,ae=H(),Te=p("td"),ye=p("button"),ye.textContent=Ve,X=H(),Ye=p("td"),ce=p("button"),ce.textContent=J,_=H(),Q=p("td"),ue=p("button"),ue.textContent=et,He=H(),ve=p("tr"),Oe=p("td"),he=p("button"),he.textContent=Le,Be=H(),we=p("td"),Ie=p("button"),Ie.textContent=Ut,_t=H(),rt(Pe.$$.fragment),this.h()},l(N){t=v(N,"DIV",{class:!0});var de=k(t);n=v(de,"DIV",{class:!0});var ot=k(n);at(o.$$.fragment,ot),ot.forEach(g),l=O(de),at(s.$$.fragment,de),de.forEach(g),u=O(N),c=v(N,"DIV",{class:!0,id:!0});var je=k(c);b=v(je,"DIV",{class:!0});var lt=k(b);T=v(lt,"TABLE",{});var Fe=k(T);M=v(Fe,"TR",{});var We=k(M);x=v(We,"TD",{});var Ft=k(x);G=v(Ft,"BUTTON",{"data-svelte-h":!0}),ee(G)!=="svelte-fw3uxo"&&(G.textContent=Me),Ft.forEach(g),ke=O(We),q=v(We,"TD",{});var Wt=k(q);te=v(Wt,"BUTTON",{"data-svelte-h":!0}),ee(te)!=="svelte-1jeoia6"&&(te.textContent=Qe),Wt.forEach(g),Ce=O(We),ne=v(We,"TD",{});var zt=k(ne);F=v(zt,"BUTTON",{"data-svelte-h":!0}),ee(F)!=="svelte-1p8c8vc"&&(F.textContent=Ue),zt.forEach(g),ge=O(We),ie=v(We,"TD",{});var xt=k(ie);oe=v(xt,"BUTTON",{"data-svelte-h":!0}),ee(oe)!=="svelte-1rtxc14"&&(oe.textContent=a),xt.forEach(g),We.forEach(g),d=O(Fe),f=v(Fe,"TR",{});var ze=k(f);m=v(ze,"TD",{});var qt=k(m);h=v(qt,"BUTTON",{"data-svelte-h":!0}),ee(h)!=="svelte-10dnpu6"&&(h.textContent=C),qt.forEach(g),E=O(ze),D=v(ze,"TD",{}),k(D).forEach(g),R=O(ze),$=v(ze,"TD",{});var Kt=k($);re=v(Kt,"BUTTON",{"data-svelte-h":!0}),ee(re)!=="svelte-12287ni"&&(re.textContent=Ge),Kt.forEach(g),$e=O(ze),De=v(ze,"TD",{});var Xt=k(De);le=v(Xt,"BUTTON",{"data-svelte-h":!0}),ee(le)!=="svelte-cps1bu"&&(le.textContent=Ke),Xt.forEach(g),ze.forEach(g),Xe=O(Fe),K=v(Fe,"TR",{});var xe=k(K);Z=v(xe,"TD",{});var Vt=k(Z);pe=v(Vt,"BUTTON",{"data-svelte-h":!0}),ee(pe)!=="svelte-1ji074i"&&(pe.textContent=Je),Vt.forEach(g),ae=O(xe),Te=v(xe,"TD",{});var jt=k(Te);ye=v(jt,"BUTTON",{"data-svelte-h":!0}),ee(ye)!=="svelte-li5tq6"&&(ye.textContent=Ve),jt.forEach(g),X=O(xe),Ye=v(xe,"TD",{});var Zt=k(Ye);ce=v(Zt,"BUTTON",{"data-svelte-h":!0}),ee(ce)!=="svelte-3esmwe"&&(ce.textContent=J),Zt.forEach(g),_=O(xe),Q=v(xe,"TD",{});var Jt=k(Q);ue=v(Jt,"BUTTON",{"data-svelte-h":!0}),ee(ue)!=="svelte-sacog4"&&(ue.textContent=et),Jt.forEach(g),xe.forEach(g),He=O(Fe),ve=v(Fe,"TR",{});var gt=k(ve);Oe=v(gt,"TD",{});var en=k(Oe);he=v(en,"BUTTON",{"data-svelte-h":!0}),ee(he)!=="svelte-1vr5zyk"&&(he.textContent=Le),en.forEach(g),Be=O(gt),we=v(gt,"TD",{});var tn=k(we);Ie=v(tn,"BUTTON",{"data-svelte-h":!0}),ee(Ie)!=="svelte-1m2jkw7"&&(Ie.textContent=Ut),tn.forEach(g),gt.forEach(g),Fe.forEach(g),lt.forEach(g),_t=O(je),at(Pe.$$.fragment,je),je.forEach(g),this.h()},h(){L(n,"class","characterSide svelte-aelzqd"),L(t,"class","container svelte-aelzqd"),L(b,"class","commands svelte-aelzqd"),L(c,"class","container svelte-aelzqd"),L(c,"id","footer")},m(N,de){S(N,t,de),A(t,n),ct(o,n,null),A(t,l),ct(s,t,null),S(N,u,de),S(N,c,de),A(c,b),A(b,T),A(T,M),A(M,x),A(x,G),A(M,ke),A(M,q),A(q,te),A(M,Ce),A(M,ne),A(ne,F),A(M,ge),A(M,ie),A(ie,oe),A(T,d),A(T,f),A(f,m),A(m,h),A(f,E),A(f,D),A(f,R),A(f,$),A($,re),A(f,$e),A(f,De),A(De,le),A(T,Xe),A(T,K),A(K,Z),A(Z,pe),A(K,ae),A(K,Te),A(Te,ye),A(K,X),A(K,Ye),A(Ye,ce),A(K,_),A(K,Q),A(Q,ue),A(T,He),A(T,ve),A(ve,Oe),A(Oe,he),A(ve,Be),A(ve,we),A(we,Ie),A(c,_t),ct(Pe,c,null),mt=!0,Dt||(Gt=[V(window,"keydown",Dn(e[1])),V(G,"click",function(){Ae(P("UL",e[0]))&&P("UL",e[0]).apply(this,arguments)}),V(te,"click",function(){Ae(P("U",e[0]))&&P("U",e[0]).apply(this,arguments)}),V(F,"click",function(){Ae(P("UR",e[0]))&&P("UR",e[0]).apply(this,arguments)}),V(oe,"click",function(){Ae(Ot(e[0]))&&Ot(e[0]).apply(this,arguments)}),V(h,"click",function(){Ae(P("L",e[0]))&&P("L",e[0]).apply(this,arguments)}),V(re,"click",function(){Ae(P("R",e[0]))&&P("R",e[0]).apply(this,arguments)}),V(le,"click",function(){Ae(Qt(e[0]))&&Qt(e[0]).apply(this,arguments)}),V(pe,"click",function(){Ae(P("DL",e[0]))&&P("DL",e[0]).apply(this,arguments)}),V(ye,"click",function(){Ae(P("D",e[0]))&&P("D",e[0]).apply(this,arguments)}),V(ce,"click",function(){Ae(P("DR",e[0]))&&P("DR",e[0]).apply(this,arguments)}),V(ue,"click",function(){Ae(kt(e[0]))&&kt(e[0]).apply(this,arguments)}),V(he,"click",function(){Ae(un(e[0]))&&un(e[0]).apply(this,arguments)}),V(Ie,"click",e[3])],Dt=!0)},p(N,[de]){e=N;const ot={};de&1&&(ot.state=e[0]),o.$set(ot);const je={};!r&&de&1&&(r=!0,je.state=e[0],on(()=>r=!1)),s.$set(je);const lt={};!Rt&&de&1&&(Rt=!0,lt.state=e[0],on(()=>Rt=!1)),Pe.$set(lt)},i(N){mt||(me(o.$$.fragment,N),me(s.$$.fragment,N),me(Pe.$$.fragment,N),mt=!0)},o(N){Ee(o.$$.fragment,N),Ee(s.$$.fragment,N),Ee(Pe.$$.fragment,N),mt=!1},d(N){N&&(g(t),g(u),g(c)),ut(o),ut(s),ut(Pe),Dt=!1,Rn(Gt)}}}function Go(e,t,n){let o=Vn();yt(()=>{setInterval(()=>uo(o),1e3)});function l(c){switch(c.key){case"6":case"d":P("R",o);break;case"9":case"e":P("UR",o);break;case"8":case"w":P("U",o);break;case"7":case"q":P("UL",o);break;case"4":case"a":P("L",o);break;case"1":case"z":P("DL",o);break;case"2":case"x":P("D",o);break;case"3":case"c":P("DR",o);break;case"0":case" ":Ot(o);break;case"-":case"r":kt(o);break;case"+":case"f":Qt(o);break}}function s(c){o=c,n(0,o)}const r=()=>n(0,o=Xn());function u(c){o=c,n(0,o)}return[o,l,s,r,u]}class Fo extends dt{constructor(t){super(),At(this,t,Go,Uo,Ze,{})}}export{Fo as component};
