import{s as ze,n as he,o as Rn,b as Nn,f as Un,r as Ft}from"../chunks/scheduler.bc760b9c.js";import{S as pn,i as hn,g as d,h as A,j as p,f as u,k as B,a as R,x as c,y as x,m as v,s as C,n as I,c as _,z as $,l as Et,o as te,e as ve,d as ae,p as Vn,b as qn,t as Ae,A as Ht,r as dn,u as An,v as fn,w as gn,B as Gn,C as Kt}from"../chunks/index.54d4ae92.js";function Qn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var L=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(L||{}),X=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(X||{}),M=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(M||{}),He=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(He||{}),pe=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(pe||{}),D=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(D||{}),T=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e))(T||{});const Wn=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:T.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:T.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:T.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:T.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:T.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],$n=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:T.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:T.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:T.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Vt=[{name:"Chain mail",type:T.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:T.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:T.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],yt=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:T.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:T.ARMOUR,movementReduction:0,value:0}],qt="0",Ot="@",Xn=" ",Tn="#",Xt=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),re=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),kt=(e,t,n)=>({...re(e,t,n),hidden:!0}),Oe=(e,t,n,o)=>{const s=Object.values(L).indexOf(t),r=Object.keys(L)[s];let a=M.LORD,i=2,l=2,f=4,m=4,E=4,y=$n[0],b,w=yt[0];switch(e){case X.ORCH:{a=M.APPRENTICE,l=0,f=2,m=2,E=1,b=$n[1];break}case X.TROLL:{a=M.KNIGHT,l=1,f=3,m=3,E=2,y=$n[2],w=yt[1];break}}return e===X.YELLOW_DARK_LORD&&(i=3),{type:e,level:a,colour:t,actions:i,defense:l,health:f,maxHealth:m,experience:E,name:e+" ("+r+")",movement:3,maxMovement:3,position:{x:n,y:o},weapon:y,armour:w,incapacitated:!1,inventory:[],rangedWeapon:b}},wt={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:He.KILL_ALL,fulfilled:!1},{type:He.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[re(D.RIGHT,2,4),re(D.RIGHT,5,4),re(D.RIGHT,9,5),re(D.RIGHT,12,5),re(D.RIGHT,9,8),re(D.RIGHT,12,8),re(D.RIGHT,11,2),kt(D.UP,9,3),kt(D.RIGHT,15,1)],monsters:[Oe(X.ORCH,L.Blue,9,7),Oe(X.ORCH,L.Red,12,8),Oe(X.TROLL,L.Red,15,1),Oe(X.TROLL,L.Yellow,13,6)],secrets:[{type:pe.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:pe.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:pe.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item"},{type:pe.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},Zt={name:"Troll cave",beaten:!1,winConditions:[{type:He.KILL_ALL,fulfilled:!1}],nextDungeon:wt,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[re(D.RIGHT,3,9),re(D.RIGHT,6,9),re(D.UP,7,7),re(D.UP,7,4)],monsters:[Oe(X.ORCH,L.Green,6,9),Oe(X.ORCH,L.Yellow,8,10),Oe(X.ORCH,L.Red,7,5),Oe(X.ORCH,L.Red,9,3),Oe(X.TROLL,L.Green,6,1)],secrets:[Xt(pe.NOTE,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},jt=[{name:"Large shield",type:T.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:T.SHIELD,amountInDeck:2,dice:1,value:1}],Jt=e=>{const t=e.currentActor,n=bn(t.level,1);let o,s,r,a;n>=1?(o=lo(e,t,n),o||(s=oo(e,t,n)),!o&&!s&&(r=so(e,t,n)),!o&&!s&&!r&&(a=ro(e,t,n)),!o&&!s&&!r&&!a&&g(e,`${t.name} searched but found nothing`)):g(e,`${t.name} searched but found nothing`)},Lt=e=>{const t=e.currentActor;if(!t)return!1;const n=e.dungeon.layout.secrets.filter(o=>o.type===pe.TRAP_DOOR).filter(o=>!o.found).find(o=>Bn(o.position,t.position));return n?(En(e,St(n),t,!1),g(e,`${t.name} fell into a pit and is incapacitated for one turn.`),t.movement=0,t.actions=0,t.incapacitated=!0,n.found=!0,!0):!1},St=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:L.Red,maxHealth:0,name:"Trap Door",level:M.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:T.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),zt=(e,t)=>e.dungeon.layout.doors.filter(n=>n.hidden).find(n=>In({x:n.x,y:n.y},t.x,t.y)),eo=(e,t)=>e.dungeon.layout.doors.filter(n=>n.trapped).find(n=>n.x===t.x&&n.y===t.y),no=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).find(n=>In(n.position,t.x,t.y)),to=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).filter(n=>n.type===pe.TRAP_DOOR).find(n=>In(n.position,t.x,t.y)),oo=(e,t,n)=>zt(e,t.position)?(g(e,`${t.name} searched (${n}) and found a hidden door`),!0):!1,so=(e,t,n)=>{const o=eo(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found a trap in a door`),o.trapped=!1,!0):!1},ro=(e,t,n)=>{const o=no(e,t.position);if(o){switch(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,o.type){case pe.EQUIPMENT:{let s=o.item??ao(e);switch(io(e,s),g(e,`${t.name} equipped (${s.name})`),s.type){case T.ARMOUR:t.armour&&t.inventory.push(t.armour),t.armour=s;break;case T.SHIELD:t.shield&&t.inventory.push(t.shield),t.shield=s;break;case T.WEAPON:t.weapon&&t.inventory.push(t.weapon),t.weapon=s;break}}}return!0}return!1},ao=e=>{const t=e.itemDeck.length,n=Math.floor(Math.random()*t);return e.itemDeck[n]},io=(e,t)=>{const n=e.itemDeck.findIndex(o=>o.type===t.type&&o.name===t.name);e.itemDeck.splice(n,1)},lo=(e,t,n)=>{const o=to(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},kn=(e,t)=>(Wn[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:M.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Wn[0],incapacitated:!1,inventory:[]}),G=(e,t)=>{const n=t.currentActor;if(!n||n.actions===0)return;const o={x:n.position.x,y:n.position.y};switch(e){case"UL":o.x=n.position.x-1,o.y=n.position.y-1;break;case"U":o.y=n.position.y-1;break;case"UR":o.x=n.position.x+1,o.y=n.position.y-1;break;case"L":o.x=n.position.x-1;break;case"R":o.x=n.position.x+1;break;case"DL":o.x=n.position.x-1,o.y=n.position.y+1;break;case"D":o.y=n.position.y+1;break;case"DR":o.x=n.position.x+1,o.y=n.position.y+1;break}const s=jn(t,o.x,o.y),r=!Hn(t.dungeon.layout,o.x,o.y),a=Zn(t,o.x,o.y);if(!s&&!r){const i=Sn(t.dungeon,o.x,o.y);i?i&&(a?Pt(n,t,o):Mt(n,t,o.x,o.y,1)):go(t,n,o.x,o.y)&&un(n,t,o.x,o.y)}else g(t,`${n.name} could not make that move`);Lt(t)||_n(n)},Yn=e=>{const t=e.currentActor;if(!t)return;if(!Cn(t)){g(e,`${t.name} has no actions left to pick lock`);return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(bn(t.level,1)>=1?(n.locked=!1,g(e,`${t.name} managed to pick the lock`)):g(e,`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=we(t),t.actions==0&&(t.movement=0))},xt=e=>{e.heroes.forEach((t,n)=>{t.position=e.dungeon.startingPositions[n],t.movement=we(t),t.actions=2,t.health=t.maxHealth})},P=e=>e.heroes.filter(t=>t.health>0),co=e=>{const t=e.currentActor;t&&(t.actions--,t.movement=we(t),t.actions===0&&Kn(e))},Cn=e=>e.movement<we(e)?e.actions>1:e.actions>0,un=(e,t,n,o)=>{const s=vn(t.dungeon.layout.grid,n,o);s&&t.dungeon.discoveredRooms.push(s),Mt(e,t,e.position.x,e.position.y,1),g(t,`${e.name} opened a door`)},Pt=(e,t,n)=>{if(e.actions===1&&e.movement!==3){g(t,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&vo(t,e)){g(t,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const o=ho(t,n);o&&(En(t,e,o,!1),o.health<=0&&po(t,o,e),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},Fn=e=>{const t=e.currentActor;if(t){if(!Cn(t)){g(e,`${t.name} has no actions left to search`);return}Jt(e),t.actions>1&&t.movement<we(t)?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)}},Zn=(e,t,n)=>e.dungeon.layout.monsters.some(o=>o.position.x===t&&o.position.y===n&&o.health>0),jn=(e,t,n)=>P(e).some(o=>o.position.x===t&&o.position.y===n),_n=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=we(e))),e.actions==0&&(e.movement=0)},uo=e=>{P(e).forEach(t=>{const n=t.level;t.experience>=28?t.level=M.MASTER:t.experience>=18?t.level=M.LORD:t.experience>=10?t.level=M.HERO:t.experience>=4&&(t.level=M.KNIGHT),n!==t.level&&g(e,`${t.name} leveled up to ${t.level}`)})},Ao=e=>{P(e).forEach(t=>t.experience+=4)},fo=e=>{Io(e).forEach(t=>{t.experience=0,t.health=t.maxHealth,t.movement=t.maxMovement,t.actions=2})},Mt=(e,t,n,o,s)=>{e.position.x=n,e.position.y=o;const r=t.dungeon.layout.notes.find(i=>Bn(i.position,e.position));r&&(t.dungeon.layout.doors.some(l=>l.hidden&&Bn(r.position,{x:l.x,y:l.y}))||g(t,`${e.name} reads: ${r.message}`)),t.dungeon.layout.monsters.some(i=>In(e.position,i.position.x,i.position.y))?(g(t,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=s},go=(e,t,n,o)=>{const s=e.dungeon.layout.doors.find(r=>r.x===t.position.x&&r.y===t.position.y);if(s&&!s.locked){const r=mo(t.position.x,t.position.y,n,o);if(s.side===r)return s.open=!0,s.trapped&&En(e,Nt(s),t,!1),!0}return s&&s.locked&&g(e,"Door is locked"),!1},mo=(e,t,n,o)=>{if(e===n){if(t>o)return D.UP;if(t<o)return D.DOWN}if(t===o){if(e>n)return D.LEFT;if(e<n)return D.RIGHT}},po=(e,t,n)=>{e.dungeon.layout.monsters=e.dungeon.layout.monsters.filter(o=>o!=t),g(e,`${n.name} killed ${t.name}`),e.dungeon.killCount++,n.experience+=t.experience},ho=(e,t)=>e.dungeon.layout.monsters.find(n=>Bn(n.position,t)),vo=(e,t)=>Ut(e,t).filter(n=>n!==t).length>0,Io=e=>e.heroes.filter(t=>t.health<=0),Eo=()=>{const e=[];return Wn.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Vt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),jt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),e},cn={name:"Treasure of the Ice Dragon",dungeons:[Zt,wt],itemDeck:Eo(),heroes:[kn("Fearik",L.Yellow),kn("Helbran",L.Red),kn("Siedel",L.Green),kn("Wulf",L.Blue)]},yo=e=>{const t=bo(e);t.length===0&&g(e,"No monsters can act"),t.forEach(n=>{e.currentActor=n;const o=n.actions;for(g(e,`${n.name} acted `);n.actions>0;){const s=Ut(e,n),r=_o(e,n);switch(ko(e,n,s,r)){case"MELEE_ATTACK":{const i=Co(s);Qt(e,n,i,!1);break}case"RANGED_ATTACK":{const i=Qo(r,n);Qt(e,n,i,!0);break}case"MOVE":{Do(e,n);break}}n.movement=we(n)}n.actions=o,n.movement=we(n)})},ko=(e,t,n,o)=>n.length>0?"MELEE_ATTACK":t.rangedWeapon&&o.length>0&&t.rangedWeapon?Math.random()<.1?(g(e,`${t.name} decided to move despite seeing a target.`),"MOVE"):"RANGED_ATTACK":"MOVE",Qo=(e,t)=>e.filter(n=>!n.shield).sort(n=>mn(t.position,n.position)).sort((n,o)=>o.health-n.health||mn(t.position,n.position)-mn(t.position,o.position))[0],Co=e=>e.sort((t,n)=>n.health-t.health)[0],_o=(e,t)=>P(e).filter(n=>{const o={x:t.position.x*48-24,y:t.position.y*48-24},s={x:n.position.x*48-24,y:n.position.y*48-24};return zn(o,t.position,s,n.position,e,[])}),bo=e=>e.dungeon.layout.monsters.filter(t=>{const n=vn(e.dungeon.layout.grid,t.position.x,t.position.y);return n&&e.dungeon.discoveredRooms.includes(n)&&t.health>0}),Qt=(e,t,n,o)=>{En(e,t,n,o),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--},Bo=(e,t)=>P(e).map(n=>({hero:n,dist:mn(n.position,t.position)})).sort((n,o)=>n.dist-o.dist)[0],Do=(e,t)=>{const n=Bo(e,t);for(;t.movement>0;){if(n.dist>1){const o=Ro(e,t.position);if(o.length>0){const s=o.map(r=>({pos:r,dist:mn(r,n.hero.position)})).sort((r,a)=>r.dist-a.dist)[0].pos;t.position=s,g(e,`${t.name} moved towards ${n.hero.name} (${s.x},${s.y})`)}else g(e,`${t.name} could not move`)}t.movement--}t.actions--},Ro=(e,t)=>{const n=t.x,o=t.y,s=[];for(let r=n-1;r<=n+1;r++)for(let a=o-1;a<=o+1;a++)r===n&&a===o||Hn(e.dungeon.layout,r,a)&&Sn(e.dungeon,r,a)&&s.push({x:r,y:a});return s.filter(r=>!P(e).find(a=>a.position.x===r.x&&a.position.y===r.y)).filter(r=>!e.dungeon.layout.monsters.some(a=>a.position.x===r.x&&a.position.y===r.y))},To=e=>{g(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},Ho=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),g(t,"Game loaded."),t}},Oo=()=>{const e={heroes:cn.heroes,dungeon:cn.dungeons[0],currentActor:cn.heroes[0],actionLog:[`Playing '${cn.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:wo(cn.itemDeck)};return xt(e),e},wo=e=>{let t=e.length,n;for(;t>0;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e},Jn=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},bn=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case M.APPRENTICE:n=n.filter(o=>o===5);break;case M.KNIGHT:case M.HERO:n=n.filter(o=>o>=4);break;case M.LORD:case M.MASTER:n=n.filter(o=>o>=3);break}return n.length},we=e=>{var t;return e.maxMovement-(((t=e.armour)==null?void 0:t.movementReduction)??0)},Kn=e=>{if(Lo(e),e.currentActor!==void 0){g(e,`${e.currentActor.name} ended their turn`);let n=P(e).indexOf(e.currentActor)+1;n===P(e).length&&(yo(e),n=0),P(e)[n].incapacitated&&(g(e,`${P(e)[n].name} is no longer incapacitated.`),P(e)[n].incapacitated=!1,n++),e.currentActor.actions=2,e.currentActor.movement=we(e.currentActor),e.currentActor=P(e)[n],g(e,`${e.currentActor.name} started their turn`)}},Lo=e=>{var t;e.dungeon.winConditions.forEach(n=>{var o;switch(n.type){case He.KILL_ALL:{const s=e.dungeon.layout.monsters.map(r=>r.health).reduce((r,a)=>r+a,0);n.fulfilled=s<=0;break}case He.REACH_CELL:{n.fulfilled=P(e).some(s=>{var r;return s.position.x===((r=n.targetCell)==null?void 0:r.x)&&s.position.y===n.targetCell.y});break}case He.KILL_ALL_OF_TYPE:{n.fulfilled=e.dungeon.layout.monsters.filter(s=>s.type===n.targetMonsterType).some(s=>s.health>0);break}case He.OPEN_DOOR:{n.fulfilled=((o=e.dungeon.layout.doors.find(s=>{var r,a;return s.x===((r=n.targetCell)==null?void 0:r.x)&&s.y===((a=n.targetCell)==null?void 0:a.y)}))==null?void 0:o.open)??!1;break}case He.KILL_AT_LEAST:{n.fulfilled=(n.killMinCount?n.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(n=>n.fulfilled).reduce((n,o)=>n&&o,!0),e.dungeon.beaten&&(g(e,"All win conditions have been fulfilled"),g(e,`You have cleared ${e.dungeon.name}`),g(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},Nt=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:L.Red,maxHealth:0,name:"Door",level:M.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:T.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),Hn=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const s=vn(e.grid,t,n);(s===qt||s===Ot||s===Xn||s===Tn)&&(o=!1)}return o},Sn=(e,t,n)=>{const o=vn(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},vn=(e,t,n)=>{let o;return e.forEach((s,r)=>{Jn(s).forEach((a,i)=>{r===n&&i===t&&(o=a)})}),o},In=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,xo=(e,t,n,o)=>{var r;const s=((r=o.armour)==null?void 0:r.defense)??o.defense;return`${e} damage (${t}-(${s}+${n})=${e})`},Bn=(e,t)=>e.x===t.x&&e.y===t.y,g=(e,t)=>{e.actionLog=[t,...e.actionLog]},En=(e,t,n,o)=>{var f,m;let s=t.weapon;o&&t.rangedWeapon&&(s=t.rangedWeapon);let r=0,a=0;s.ignoresArmour?n.armour&&g(e,`${n.name}'s armour was useless against ${s.name} `):r=((f=n.armour)==null?void 0:f.defense)??n.defense,s.ignoresShield?n.shield&&g(e,`${n.name}'s shield was useless against ${s.name} `):a=bn(n.level,((m=n.shield)==null?void 0:m.dice)??0);const i=bn(t.level,s.dice),l=Math.max(i-(r+a),0);n.health-=l,g(e,`${t.name} attacked ${n.name} with ${s.name} for ${xo(l,i,a,n)}`),n.health<=0&&(g(e,`${t.name} killed ${n.name}`),n.health=0,n.level=M.APPRENTICE)},Po=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],Ao(e),uo(e),fo(e),xt(e))},mn=(e,t)=>Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2)),zn=(e,t,n,o,s,r)=>{const a=Mo(e,n),i={x:Math.round((a.x+24)/48),y:Math.round((a.y+24)/48)},l=vn(s.dungeon.layout.grid,i.x,i.y);return i.x===o.x&&i.y===o.y?(r.push(i),!0):l===Tn||l===Ot?!1:(i.x===t.x&&i.y===t.y||r.some(f=>f.x===i.x&&f.y===i.y)||r.push(i),zn(a,t,n,o,s,r))},Mo=(e,t)=>{const n=e.x,o=e.y,s=t.x-n,r=t.y-o,a=s/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2),i=r/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2);let l=Math.round(a+n),f=Math.round(i+o);return{x:l,y:f}},Ut=(e,t)=>P(e).filter(n=>In(t.position,n.position.x,n.position.y)),No="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",Uo="data:image/png;base64,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",Go=(e,t)=>{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y),s=Math.min(n,o),r=Math.max(n,o),a=s,i=r-s;let l=Math.sqrt(2);return i===0&&(l=1),Math.floor(l*a+i)},$o=(e,t)=>{const n=e.currentActor,o=e.dungeon.layout.doors.find(s=>s.x===n.position.x&&s.y===n.position.y);if(o){if(!o.open&&!o.hidden&&!o.locked&&n.movement>0){switch(o.open=!0,o.trapped&&En(e,Nt(o),n,!1),o.side){case D.RIGHT:un(n,e,t.x+1,t.y);break;case D.LEFT:un(n,e,t.x-1,t.y);break;case D.DOWN:un(n,e,t.x,t.y+1);break;case D.UP:un(n,e,t.x,t.y-1);break}_n(n)}else if(o.locked&&!o.hidden){if(!Cn(n)){g(e,`${n.name} has no actions left`);return}g(e,"Door is locked"),Yn(e),_n(n)}}else{if(!Cn(n)){g(e,`${n.name} has no actions left`);return}Fn(e)}},Wo=(e,t)=>{const n=e.currentActor;if(n.actions===0){g(e,`${n.name} has no actions left`);return}const o=Hn(e.dungeon.layout,t.x,t.y),s=Go(n.position,t);if(console.log("distance: "+s),o){const r=jn(e,t.x,t.y),a=Zn(e,t.x,t.y);if(!r&&!a&&s<=n.movement){if(n.position=t,n.movement-=s,Lt(e))return}else a&&(s<=n.weapon.range?Pt(n,e,t):g(e,"Monster is out of range"))}_n(n)},Yo=(e,t,n)=>{const o=document.getElementById("gameBoard");if(!o)return;const s=o.getBoundingClientRect(),r=Math.min(Math.floor((e.clientX-s.left)/t),n.dungeon.layout.grid[0].length-1),a=Math.min(Math.floor((e.clientY-s.top)/t),n.dungeon.layout.grid.length-1),i=n.dungeon.layout.grid[a][r],l=n.currentActor;r===l.position.x&&a===l.position.y?$o(n,{x:r,y:a}):n.dungeon.discoveredRooms.includes(i)&&Wo(n,{x:r,y:a})},Fo=(e,t,n,o,s)=>{P(o).forEach(a=>{Ko(e,a,t,n)}),Zo(e,o,n),jo(e,o,n)},Ko=(e,t,n,o)=>{const s=t.position.x,r=t.position.y;e.drawImage(n,4*16,0,16,16,s*o,r*o,o,o),Vo(e,t,s,r,o),Xo(e,t,s,r,o),qo(e,t,s,r,o)},Vo=(e,t,n,o,s)=>{const r=e.fillStyle,a=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let i=0;i<t.actions;i++)e.fillRect(n*s+4+6*i,o*s+s-12,5,5),e.rect(n*s+4+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle="blue";for(let i=0;i<t.movement;i++)e.fillRect(n*s+s-22+6*i,o*s+s-12,5,5),e.rect(n*s+s-22+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle=r,e.strokeStyle=a},qo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n*s+4,o*s,s-8,4),e.fillStyle="green",e.fillRect(n*s+4,o*s,(s-8)*(t.health/t.maxHealth),4),e.rect(n*s+4,o*s,s-8,4),e.stroke()},Xo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(n*s+4,o*s+(s-6),s-8,4),e.stroke()},Zo=(e,t,n)=>{const o=t.currentActor;if(o){for(let s=o.position.x-o.movement;s<=o.position.x+o.movement;s++)for(let r=o.position.y-o.movement;r<=o.position.y+o.movement;r++)if(Sn(t.dungeon,s,r)){const i=Zn(t,s,r),l=jn(t,s,r),f=Hn(t.dungeon.layout,s,r);!l&&!i&&f&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(s*n,r*n,n,n),e.stroke())}}},jo=(e,t,n)=>{const o=t.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n+n/3,o.position.y*n),e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n,o.position.y*n+n/3),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3,o.position.y*n+n),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n+n),e.stroke(),e.lineWidth=1)},Jo=(e,t,n,o,s)=>{o.dungeon.layout.monsters.forEach(r=>{So(e,t,o,r,n,s)})},So=(e,t,n,o,s,r)=>{const a=n.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&rs(a,n)){switch(o.type){case X.ORCH:zo(e,t,s,o);break;case X.TROLL:es(e,t,s,o);break;default:ns(e,t,s,o);break}ts(e,o,s),os(e,o,s),ss(e,o,n.heroes,n,s,r)}},zo=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},es=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},ns=(e,t,n,o)=>{e.drawImage(t,16,16,16,16,o.position.x*n,o.position.y*n,n,n)},ts=(e,t,n)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(t.position.x*n+4,t.position.y*n+(n-6),n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},os=(e,t,n)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t.position.x*n+4,t.position.y*n,n-8,4),e.fillStyle="green",e.fillRect(t.position.x*n+4,t.position.y*n,(n-8)*(t.health/t.maxHealth),4),e.rect(t.position.x*n+4,t.position.y*n,n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},ss=(e,t,n,o,s,r)=>{r&&n.forEach(a=>{const i=[],l={x:t.position.x*48-24,y:t.position.y*48-24},f={x:a.position.x*48-24,y:a.position.y*48-24};if(zn(l,t.position,f,a.position,o,i)){const E=t.position.x,y=t.position.y,b=a.position.x,w=a.position.y;e.beginPath(),e.strokeStyle=t.colour,e.lineWidth=2,e.moveTo(E*s+s/2,y*s+s/2),e.lineTo(b*s+s/2,w*s+s/2),e.stroke(),e.lineWidth=1}})},rs=(e,t)=>t.dungeon.discoveredRooms.includes(e),as=(e,t,n,o,s)=>{o.dungeon.layout.doors.forEach(r=>{fs(e,t,n,o,r,s)})},is=(e,t,n,o,s)=>{o.dungeon.layout.grid.forEach((r,a)=>{Jn(r).forEach((i,l)=>{cs(e,t,o,i,l,a,n),As(e,i,o,l,a,n,s)})})},ls=(e,t,n,o)=>{o.dungeon.layout.secrets.filter(s=>s.found).forEach(s=>{switch(s.type){case pe.TRAP_DOOR:us(e,t,n,s);break;default:ds(e,t,n,s);break}})},cs=(e,t,n,o,s,r,a)=>{gs(o)||!n.dungeon.discoveredRooms.includes(o)&&o!==Xn?n.dungeon.discoveredRooms.some(i=>ms(s,r,i,n))?e.drawImage(t,48,0,48,48,s*a,r*a,a,a):Ct(e,s,r,a):Dn(o,n)?Ct(e,s,r,a):e.drawImage(t,0,0,48,48,s*a,r*a,a,a)},Ct=(e,t,n,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(t*o,n*o,o,o),e.stroke()},us=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,3*48,0,48,48,s*n,r*n,n,n)},ds=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,4*48,0,48,48,s*n,r*n,n,n)},As=(e,t,n,o,s,r,a)=>{!a&&(Dn(t,n)||t===Tn)||(e.beginPath(),e.strokeStyle="black",e.rect(o*r,s*r,r,r),a&&(e.font="7px Arial",e.fillText(o+","+s,o*r+3,s*r+(r-3))),e.stroke())},fs=(e,t,n,o,s,r)=>{const a=o.dungeon.layout.grid[s.y][s.x];if(s&&!s.hidden&&!s.open&&!Dn(a,o))switch(e.fillStyle="brown",s.side){case D.RIGHT:{e.fillRect(s.x*n+(n-2),s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n-4),s.y*n+(n/2-4),8,8));break}case D.LEFT:{e.fillRect(s.x*n-2,s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n-4,s.y*n+(n/2-4),8,8));break}case D.UP:{e.fillRect(s.x*n,s.y*n-2,n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n-4,8,8));break}case D.DOWN:{e.fillRect(s.x*n,s.y*n+(n-2),n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n+(n-4),8,8));break}}r&&!Dn(a,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${s.hidden?"H":"-"}/${s.trapped?"T"+s.trapAttacks:"-"}/${s.locked?"L":"-"}]`,s.x*n,s.y*n+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(s.x*n,s.y*n,n,n))},gs=e=>e===Tn,Dn=(e,t)=>e===Xn||!t.dungeon.discoveredRooms.includes(e),ms=(e,t,n,o)=>{if(!o)return;const s=Math.max(e-1,0),r=Math.max(t-1,0),a=Math.min(e+1,o.dungeon.layout.grid.length),i=Math.min(t+1,o.dungeon.layout.grid[0].length);for(let l=s;l<=a;l++)for(let f=r;f<=i;f++){const m=o.dungeon.layout.grid[f];if(Jn(m)[l]===n)return!0}return!1};function ps(e){let t,n,o,s;return{c(){t=d("div"),n=d("canvas"),this.h()},l(r){t=A(r,"DIV",{style:!0,class:!0});var a=p(t);n=A(a,"CANVAS",{width:!0,height:!0,id:!0}),p(n).forEach(u),a.forEach(u),this.h()},h(){B(n,"width",Te*40),B(n,"height",Te*30),B(n,"id","gameBoard"),B(t,"style",e[1]()),B(t,"class","dungeon svelte-a4uhtl")},m(r,a){R(r,t,a),c(t,n),o||(s=x(n,"click",e[0]),o=!0)},p:he,i:he,o:he,d(r){r&&u(t),o=!1,s()}}}const Te=48;function hs(e,t,n){let{state:o}=t,{debugMode:s}=t,r,a;a=window.innerHeight,r=document.getElementById("footer").offsetHeight,Rn(()=>{const m=new Image;m.src=No;const E=new Image;E.src=Uo,setInterval(()=>i(m,E),10)});const i=(m,E)=>{if(!o||!document)return;const y=document.getElementById("gameBoard"),b=y.getContext("2d");b.clearRect(0,0,y.width,y.height),b.fillStyle="black",b.fillRect(0,0,y.width,y.height),is(b,m,Te,o,s),ls(b,m,Te,o),as(b,m,Te,o,s),Jo(b,E,Te,o,s),Fo(b,E,Te,o)},l=m=>{Yo(m,Te,o)},f=()=>`max-height: ${a-r-20}px; max-width: ${Te*40}`;return e.$$set=m=>{"state"in m&&n(2,o=m.state),"debugMode"in m&&n(3,s=m.debugMode)},[l,f,o,s]}class vs extends pn{constructor(t){super(),hn(this,t,hs,ps,ze,{state:2,debugMode:3})}}function Is(e){let t;return{c(){t=v("None (0)")},l(n){t=I(n,"None (0)")},m(n,o){R(n,t,o)},p:he,d(n){n&&u(t)}}}function Es(e){let t=e[0].armour.name+"",n,o,s=e[0].armour.defense+"",r,a;return{c(){n=v(t),o=v(" ("),r=v(s),a=v(")")},l(i){n=I(i,t),o=I(i," ("),r=I(i,s),a=I(i,")")},m(i,l){R(i,n,l),R(i,o,l),R(i,r,l),R(i,a,l)},p(i,l){l&1&&t!==(t=i[0].armour.name+"")&&te(n,t),l&1&&s!==(s=i[0].armour.defense+"")&&te(r,s)},d(i){i&&(u(n),u(o),u(r),u(a))}}}function ys(e){let t;return{c(){t=v("None (0)")},l(n){t=I(n,"None (0)")},m(n,o){R(n,t,o)},p:he,d(n){n&&u(t)}}}function ks(e){let t=e[0].shield.name+"",n,o,s=e[0].shield.dice+"",r,a;return{c(){n=v(t),o=v(" ("),r=v(s),a=v(")")},l(i){n=I(i,t),o=I(i," ("),r=I(i,s),a=I(i,")")},m(i,l){R(i,n,l),R(i,o,l),R(i,r,l),R(i,a,l)},p(i,l){l&1&&t!==(t=i[0].shield.name+"")&&te(n,t),l&1&&s!==(s=i[0].shield.dice+"")&&te(r,s)},d(i){i&&(u(n),u(o),u(r),u(a))}}}function Qs(e){let t,n,o,s=e[0].name+"",r,a,i,l,f=e[0].level+"",m,E,y=e[0].experience+"",b,w,Le,S,ie,W=e[0].health+"",Ie,Ee,Y,z,fe=e[0].actions+"",N,ye,F,en,ke=e[0].movement+"",U,Qe,K,on="Equipment:",Ye,V,Z,Ce,ee=e[0].weapon.name+"",Fe,Ke,le=e[0].weapon.dice+"",oe,nn,Ve,H,_e,ce,ue,qe;function xe(k,h){return k[0].armour?Es:Is}let se=xe(e),j=se(e);function tn(k,h){return k[0].shield?ks:ys}let ge=tn(e),O=ge(e);return{c(){t=d("div"),n=d("div"),o=d("b"),r=v(s),a=v(" -"),i=C(),l=d("b"),m=v(f),E=v(" ("),b=v(y),w=v(")"),Le=C(),S=d("span"),ie=v("HP: "),Ie=v(W),Ee=C(),Y=d("span"),z=v("Actions: "),N=v(fe),ye=C(),F=d("span"),en=v("Moves: "),U=v(ke),Qe=C(),K=d("span"),K.textContent=on,Ye=C(),V=d("div"),Z=d("span"),Ce=v("🗡️ "),Fe=v(ee),Ke=v(" ("),oe=v(le),nn=v(")"),Ve=C(),H=d("span"),_e=v(`🧱
      `),j.c(),ce=C(),ue=d("span"),qe=v(`🛡️
      `),O.c(),this.h()},l(k){t=A(k,"DIV",{class:!0,style:!0});var h=p(t);n=A(h,"DIV",{class:!0});var me=p(n);o=A(me,"B",{class:!0});var de=p(o);r=I(de,s),a=I(de," -"),de.forEach(u),i=_(me),l=A(me,"B",{class:!0});var Pe=p(l);m=I(Pe,f),E=I(Pe," ("),b=I(Pe,y),w=I(Pe,")"),Pe.forEach(u),me.forEach(u),Le=_(h),S=A(h,"SPAN",{class:!0});var Xe=p(S);ie=I(Xe,"HP: "),Ie=I(Xe,W),Xe.forEach(u),Ee=_(h),Y=A(h,"SPAN",{class:!0});var q=p(Y);z=I(q,"Actions: "),N=I(q,fe),q.forEach(u),ye=_(h),F=A(h,"SPAN",{class:!0});var be=p(F);en=I(be,"Moves: "),U=I(be,ke),be.forEach(u),Qe=_(h),K=A(h,"SPAN",{class:!0,"data-svelte-h":!0}),$(K)!=="svelte-1ue18fw"&&(K.textContent=on),Ye=_(h),V=A(h,"DIV",{class:!0});var J=p(V);Z=A(J,"SPAN",{class:!0});var Be=p(Z);Ce=I(Be,"🗡️ "),Fe=I(Be,ee),Ke=I(Be," ("),oe=I(Be,le),nn=I(Be,")"),Be.forEach(u),Ve=_(J),H=A(J,"SPAN",{class:!0});var Ze=p(H);_e=I(Ze,`🧱
      `),j.l(Ze),Ze.forEach(u),ce=_(J),ue=A(J,"SPAN",{class:!0});var De=p(ue);qe=I(De,`🛡️
      `),O.l(De),De.forEach(u),J.forEach(u),h.forEach(u),this.h()},h(){B(o,"class","svelte-pgtred"),B(l,"class","svelte-pgtred"),B(n,"class","hero-title svelte-pgtred"),B(S,"class","svelte-pgtred"),B(Y,"class","svelte-pgtred"),B(F,"class","svelte-pgtred"),B(K,"class","svelte-pgtred"),B(Z,"class","svelte-pgtred"),B(H,"class","svelte-pgtred"),B(ue,"class","svelte-pgtred"),B(V,"class","equipment"),B(t,"class","hero-card svelte-pgtred"),Et(t,"background-color",e[0].colour)},m(k,h){R(k,t,h),c(t,n),c(n,o),c(o,r),c(o,a),c(n,i),c(n,l),c(l,m),c(l,E),c(l,b),c(l,w),c(t,Le),c(t,S),c(S,ie),c(S,Ie),c(t,Ee),c(t,Y),c(Y,z),c(Y,N),c(t,ye),c(t,F),c(F,en),c(F,U),c(t,Qe),c(t,K),c(t,Ye),c(t,V),c(V,Z),c(Z,Ce),c(Z,Fe),c(Z,Ke),c(Z,oe),c(Z,nn),c(V,Ve),c(V,H),c(H,_e),j.m(H,null),c(V,ce),c(V,ue),c(ue,qe),O.m(ue,null)},p(k,[h]){h&1&&s!==(s=k[0].name+"")&&te(r,s),h&1&&f!==(f=k[0].level+"")&&te(m,f),h&1&&y!==(y=k[0].experience+"")&&te(b,y),h&1&&W!==(W=k[0].health+"")&&te(Ie,W),h&1&&fe!==(fe=k[0].actions+"")&&te(N,fe),h&1&&ke!==(ke=k[0].movement+"")&&te(U,ke),h&1&&ee!==(ee=k[0].weapon.name+"")&&te(Fe,ee),h&1&&le!==(le=k[0].weapon.dice+"")&&te(oe,le),se===(se=xe(k))&&j?j.p(k,h):(j.d(1),j=se(k),j&&(j.c(),j.m(H,null))),ge===(ge=tn(k))&&O?O.p(k,h):(O.d(1),O=ge(k),O&&(O.c(),O.m(ue,null))),h&1&&Et(t,"background-color",k[0].colour)},i:he,o:he,d(k){k&&u(t),j.d(),O.d()}}}function Cs(e,t,n){let{hero:o}=t;return e.$$set=s=>{"hero"in s&&n(0,o=s.hero)},[o]}class Gt extends pn{constructor(t){super(),hn(this,t,Cs,Qs,ze,{hero:0})}}function _t(e,t,n){const o=e.slice();return o[3]=t[n],o[5]=n,o}function _s(e){let t,n,o,s;return n=new Gt({props:{hero:e[3]}}),{c(){t=d("div"),dn(n.$$.fragment),o=C(),this.h()},l(r){t=A(r,"DIV",{class:!0});var a=p(t);An(n.$$.fragment,a),o=_(a),a.forEach(u),this.h()},h(){B(t,"class","not-current-actor svelte-izfxty")},m(r,a){R(r,t,a),fn(n,t,null),c(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&u(t),gn(n)}}}function bs(e){let t,n,o,s;return n=new Gt({props:{hero:e[3]}}),{c(){t=d("div"),dn(n.$$.fragment),o=C(),this.h()},l(r){t=A(r,"DIV",{class:!0});var a=p(t);An(n.$$.fragment,a),o=_(a),a.forEach(u),this.h()},h(){B(t,"class","is-current-actor svelte-izfxty")},m(r,a){R(r,t,a),fn(n,t,null),c(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&u(t),gn(n)}}}function bt(e){let t,n,o,s;const r=[bs,_s],a=[];function i(l,f){return l[3]===l[0].currentActor?0:1}return t=i(e),n=a[t]=r[t](e),{c(){n.c(),o=ve()},l(l){n.l(l),o=ve()},m(l,f){a[t].m(l,f),R(l,o,f),s=!0},p(l,f){let m=t;t=i(l),t===m?a[t].p(l,f):(Vn(),Ae(a[m],1,1,()=>{a[m]=null}),qn(),n=a[t],n?n.p(l,f):(n=a[t]=r[t](l),n.c()),ae(n,1),n.m(o.parentNode,o))},i(l){s||(ae(n),s=!0)},o(l){Ae(n),s=!1},d(l){l&&u(o),a[t].d(l)}}}function Bt(e){let t=e[1],n,o,s=bt(e);return{c(){s.c(),n=ve()},l(r){s.l(r),n=ve()},m(r,a){s.m(r,a),R(r,n,a),o=!0},p(r,a){a&2&&ze(t,t=r[1])?(Vn(),Ae(s,1,1,he),qn(),s=bt(r),s.c(),ae(s,1),s.m(n.parentNode,n)):s.p(r,a)},i(r){o||(ae(s),o=!0)},o(r){Ae(s),o=!1},d(r){r&&u(n),s.d(r)}}}function Bs(e){let t,n,o=Qn(P(e[0])),s=[];for(let a=0;a<o.length;a+=1)s[a]=Bt(_t(e,o,a));const r=a=>Ae(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();t=ve()},l(a){for(let i=0;i<s.length;i+=1)s[i].l(a);t=ve()},m(a,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,i);R(a,t,i),n=!0},p(a,[i]){if(i&3){o=Qn(P(a[0]));let l;for(l=0;l<o.length;l+=1){const f=_t(a,o,l);s[l]?(s[l].p(f,i),ae(s[l],1)):(s[l]=Bt(f),s[l].c(),ae(s[l],1),s[l].m(t.parentNode,t))}for(Vn(),l=o.length;l<s.length;l+=1)r(l);qn()}},i(a){if(!n){for(let i=0;i<o.length;i+=1)ae(s[i]);n=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Ae(s[i]);n=!1},d(a){a&&u(t),Ht(s,a)}}}function Ds(e,t,n){let{state:o}=t,s=!1;Rn(()=>{r(),setInterval(r,100)});const r=()=>{n(1,s=!s)};return e.$$set=a=>{"state"in a&&n(0,o=a.state)},[o,s]}class Rs extends pn{constructor(t){super(),hn(this,t,Ds,Bs,ze,{state:0})}}function Dt(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function Ts(e){let t,n,o=e[2]+"",s;return{c(){t=d("p"),n=v(">"),s=v(o),this.h()},l(r){t=A(r,"P",{class:!0});var a=p(t);n=I(a,">"),s=I(a,o),a.forEach(u),this.h()},h(){B(t,"class","svelte-1xp6uq")},m(r,a){R(r,t,a),c(t,n),c(t,s)},p(r,a){a&1&&o!==(o=r[2]+"")&&te(s,o)},d(r){r&&u(t)}}}function Rt(e){let t,n=e[4]<25&&Ts(e);return{c(){n&&n.c(),t=ve()},l(o){n&&n.l(o),t=ve()},m(o,s){n&&n.m(o,s),R(o,t,s)},p(o,s){o[4]<25&&n.p(o,s)},d(o){o&&u(t),n&&n.d(o)}}}function Tt(e){let t,n=Qn(e[0]),o=[];for(let s=0;s<n.length;s+=1)o[s]=Rt(Dt(e,n,s));return{c(){for(let s=0;s<o.length;s+=1)o[s].c();t=ve()},l(s){for(let r=0;r<o.length;r+=1)o[r].l(s);t=ve()},m(s,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(s,r);R(s,t,r)},p(s,r){if(r&1){n=Qn(s[0]);let a;for(a=0;a<n.length;a+=1){const i=Dt(s,n,a);o[a]?o[a].p(i,r):(o[a]=Rt(i),o[a].c(),o[a].m(t.parentNode,t))}for(;a<o.length;a+=1)o[a].d(1);o.length=n.length}},d(s){s&&u(t),Ht(o,s)}}}function Hs(e){let t,n=e[0],o=Tt(e);return{c(){t=d("div"),o.c(),this.h()},l(s){t=A(s,"DIV",{class:!0});var r=p(t);o.l(r),r.forEach(u),this.h()},h(){B(t,"class","log svelte-1xp6uq")},m(s,r){R(s,t,r),o.m(t,null)},p(s,[r]){r&1&&ze(n,n=s[0])?(o.d(1),o=Tt(s),o.c(),o.m(t,null)):o.p(s,r)},i:he,o:he,d(s){s&&u(t),o.d(s)}}}function Os(e,t,n){let o=[],{state:s}=t;return Rn(()=>{setInterval(()=>{n(0,o=s.actionLog)},500)}),e.$$set=r=>{"state"in r&&n(1,s=r.state)},[o,s]}class ws extends pn{constructor(t){super(),hn(this,t,Os,Hs,ze,{state:1})}}function Ls(e){let t,n,o,s,r,a,i,l,f,m,E,y,b,w,Le="UL",S,ie,W,Ie="U",Ee,Y,z,fe="UR",N,ye,F,en="Next",ke,U,Qe,K,on="L",Ye,V,Z,Ce,ee,Fe="R",Ke,le,oe,nn="Search",Ve,H,_e,ce,ue="DL",qe,xe,se,j="D",tn,ge,O,k="DR",h,me,de,Pe="Pick lock",Xe,q,be,J,Be="Save",Ze,De,je,et="Load",On,sn,Je,nt="Debug",wn,rn,Se,tt="End action",Ln,Re,xn,yn,Pn,ot;o=new Rs({props:{state:e[0]}});function $t(Q){e[3](Q)}function Wt(Q){e[4](Q)}let Mn={};e[0]!==void 0&&(Mn.state=e[0]),e[1]!==void 0&&(Mn.debugMode=e[1]),r=new vs({props:Mn}),Nn.push(()=>Gn(r,"state",$t)),Nn.push(()=>Gn(r,"debugMode",Wt));function Yt(Q){e[20](Q)}let st={};return e[0]!==void 0&&(st.state=e[0]),Re=new ws({props:st}),Nn.push(()=>Gn(Re,"state",Yt)),{c(){t=d("div"),n=d("div"),dn(o.$$.fragment),s=C(),dn(r.$$.fragment),l=C(),f=d("div"),m=d("div"),E=d("table"),y=d("tr"),b=d("td"),w=d("button"),w.textContent=Le,S=C(),ie=d("td"),W=d("button"),W.textContent=Ie,Ee=C(),Y=d("td"),z=d("button"),z.textContent=fe,N=C(),ye=d("td"),F=d("button"),F.textContent=en,ke=C(),U=d("tr"),Qe=d("td"),K=d("button"),K.textContent=on,Ye=C(),V=d("td"),Z=C(),Ce=d("td"),ee=d("button"),ee.textContent=Fe,Ke=C(),le=d("td"),oe=d("button"),oe.textContent=nn,Ve=C(),H=d("tr"),_e=d("td"),ce=d("button"),ce.textContent=ue,qe=C(),xe=d("td"),se=d("button"),se.textContent=j,tn=C(),ge=d("td"),O=d("button"),O.textContent=k,h=C(),me=d("td"),de=d("button"),de.textContent=Pe,Xe=C(),q=d("tr"),be=d("td"),J=d("button"),J.textContent=Be,Ze=C(),De=d("td"),je=d("button"),je.textContent=et,On=C(),sn=d("td"),Je=d("button"),Je.textContent=nt,wn=C(),rn=d("td"),Se=d("button"),Se.textContent=tt,Ln=C(),dn(Re.$$.fragment),this.h()},l(Q){t=A(Q,"DIV",{class:!0});var ne=p(t);n=A(ne,"DIV",{class:!0});var an=p(n);An(o.$$.fragment,an),an.forEach(u),s=_(ne),An(r.$$.fragment,ne),ne.forEach(u),l=_(Q),f=A(Q,"DIV",{class:!0,id:!0});var Me=p(f);m=A(Me,"DIV",{class:!0});var ln=p(m);E=A(ln,"TABLE",{});var Ne=p(E);y=A(Ne,"TR",{});var Ue=p(y);b=A(Ue,"TD",{});var rt=p(b);w=A(rt,"BUTTON",{"data-svelte-h":!0}),$(w)!=="svelte-1vu0fc2"&&(w.textContent=Le),rt.forEach(u),S=_(Ue),ie=A(Ue,"TD",{});var at=p(ie);W=A(at,"BUTTON",{"data-svelte-h":!0}),$(W)!=="svelte-m1j18o"&&(W.textContent=Ie),at.forEach(u),Ee=_(Ue),Y=A(Ue,"TD",{});var it=p(Y);z=A(it,"BUTTON",{"data-svelte-h":!0}),$(z)!=="svelte-8eygoe"&&(z.textContent=fe),it.forEach(u),N=_(Ue),ye=A(Ue,"TD",{});var lt=p(ye);F=A(lt,"BUTTON",{"data-svelte-h":!0}),$(F)!=="svelte-1axp1ke"&&(F.textContent=en),lt.forEach(u),Ue.forEach(u),ke=_(Ne),U=A(Ne,"TR",{});var Ge=p(U);Qe=A(Ge,"TD",{});var ct=p(Qe);K=A(ct,"BUTTON",{"data-svelte-h":!0}),$(K)!=="svelte-amyars"&&(K.textContent=on),ct.forEach(u),Ye=_(Ge),V=A(Ge,"TD",{}),p(V).forEach(u),Z=_(Ge),Ce=A(Ge,"TD",{});var ut=p(Ce);ee=A(ut,"BUTTON",{"data-svelte-h":!0}),$(ee)!=="svelte-2zfta0"&&(ee.textContent=Fe),ut.forEach(u),Ke=_(Ge),le=A(Ge,"TD",{});var dt=p(le);oe=A(dt,"BUTTON",{"data-svelte-h":!0}),$(oe)!=="svelte-1kis6k4"&&(oe.textContent=nn),dt.forEach(u),Ge.forEach(u),Ve=_(Ne),H=A(Ne,"TR",{});var $e=p(H);_e=A($e,"TD",{});var At=p(_e);ce=A(At,"BUTTON",{"data-svelte-h":!0}),$(ce)!=="svelte-57p0uk"&&(ce.textContent=ue),At.forEach(u),qe=_($e),xe=A($e,"TD",{});var ft=p(xe);se=A(ft,"BUTTON",{"data-svelte-h":!0}),$(se)!=="svelte-1nly394"&&(se.textContent=j),ft.forEach(u),tn=_($e),ge=A($e,"TD",{});var gt=p(ge);O=A(gt,"BUTTON",{"data-svelte-h":!0}),$(O)!=="svelte-7ds02w"&&(O.textContent=k),gt.forEach(u),h=_($e),me=A($e,"TD",{});var mt=p(me);de=A(mt,"BUTTON",{"data-svelte-h":!0}),$(de)!=="svelte-90j6ve"&&(de.textContent=Pe),mt.forEach(u),$e.forEach(u),Xe=_(Ne),q=A(Ne,"TR",{});var We=p(q);be=A(We,"TD",{});var pt=p(be);J=A(pt,"BUTTON",{"data-svelte-h":!0}),$(J)!=="svelte-fxtyz6"&&(J.textContent=Be),pt.forEach(u),Ze=_(We),De=A(We,"TD",{});var ht=p(De);je=A(ht,"BUTTON",{"data-svelte-h":!0}),$(je)!=="svelte-1m2jkw7"&&(je.textContent=et),ht.forEach(u),On=_(We),sn=A(We,"TD",{});var vt=p(sn);Je=A(vt,"BUTTON",{"data-svelte-h":!0}),$(Je)!=="svelte-1vbubr3"&&(Je.textContent=nt),vt.forEach(u),wn=_(We),rn=A(We,"TD",{});var It=p(rn);Se=A(It,"BUTTON",{"data-svelte-h":!0}),$(Se)!=="svelte-1de77je"&&(Se.textContent=tt),It.forEach(u),We.forEach(u),Ne.forEach(u),ln.forEach(u),Ln=_(Me),An(Re.$$.fragment,Me),Me.forEach(u),this.h()},h(){B(n,"class","characterSide svelte-aelzqd"),B(t,"class","container svelte-aelzqd"),B(m,"class","commands svelte-aelzqd"),B(f,"class","container svelte-aelzqd"),B(f,"id","footer")},m(Q,ne){R(Q,t,ne),c(t,n),fn(o,n,null),c(t,s),fn(r,t,null),R(Q,l,ne),R(Q,f,ne),c(f,m),c(m,E),c(E,y),c(y,b),c(b,w),c(y,S),c(y,ie),c(ie,W),c(y,Ee),c(y,Y),c(Y,z),c(y,N),c(y,ye),c(ye,F),c(E,ke),c(E,U),c(U,Qe),c(Qe,K),c(U,Ye),c(U,V),c(U,Z),c(U,Ce),c(Ce,ee),c(U,Ke),c(U,le),c(le,oe),c(E,Ve),c(E,H),c(H,_e),c(_e,ce),c(H,qe),c(H,xe),c(xe,se),c(H,tn),c(H,ge),c(ge,O),c(H,h),c(H,me),c(me,de),c(E,Xe),c(E,q),c(q,be),c(be,J),c(q,Ze),c(q,De),c(De,je),c(q,On),c(q,sn),c(sn,Je),c(q,wn),c(q,rn),c(rn,Se),c(f,Ln),fn(Re,f,null),yn=!0,Pn||(ot=[x(window,"keydown",Kt(e[2])),x(w,"click",e[5]),x(W,"click",e[6]),x(z,"click",e[7]),x(F,"click",e[8]),x(K,"click",e[9]),x(ee,"click",e[10]),x(oe,"click",e[11]),x(ce,"click",e[12]),x(se,"click",e[13]),x(O,"click",e[14]),x(de,"click",e[15]),x(J,"click",e[16]),x(je,"click",e[17]),x(Je,"click",e[18]),x(Se,"click",e[19])],Pn=!0)},p(Q,[ne]){const an={};ne&1&&(an.state=Q[0]),o.$set(an);const Me={};!a&&ne&1&&(a=!0,Me.state=Q[0],Un(()=>a=!1)),!i&&ne&2&&(i=!0,Me.debugMode=Q[1],Un(()=>i=!1)),r.$set(Me);const ln={};!xn&&ne&1&&(xn=!0,ln.state=Q[0],Un(()=>xn=!1)),Re.$set(ln)},i(Q){yn||(ae(o.$$.fragment,Q),ae(r.$$.fragment,Q),ae(Re.$$.fragment,Q),yn=!0)},o(Q){Ae(o.$$.fragment,Q),Ae(r.$$.fragment,Q),Ae(Re.$$.fragment,Q),yn=!1},d(Q){Q&&(u(t),u(l),u(f)),gn(o),gn(r),gn(Re),Pn=!1,Ft(ot)}}}function xs(e,t,n){let o=Oo(),s=!1;Rn(()=>{setInterval(()=>Po(o),1e3)});function r(N){switch(N.key){case"6":case"d":G("R",o);break;case"9":case"e":G("UR",o);break;case"8":case"w":G("U",o);break;case"7":case"q":G("UL",o);break;case"4":case"a":G("L",o);break;case"1":case"z":G("DL",o);break;case"2":case"x":G("D",o);break;case"3":case"c":G("DR",o);break;case"0":case" ":Kn(o);break;case"-":case"r":Yn(o);break;case"+":case"f":Fn(o);break}}function a(N){o=N,n(0,o)}function i(N){s=N,n(1,s)}const l=()=>G("UL",o),f=()=>G("U",o),m=()=>G("UR",o),E=()=>Kn(o),y=()=>G("L",o),b=()=>G("R",o),w=()=>Fn(o),Le=()=>G("DL",o),S=()=>G("D",o),ie=()=>G("DR",o),W=()=>Yn(o),Ie=()=>To(o),Ee=()=>n(0,o=Ho()),Y=()=>n(1,s=!s),z=()=>co(o);function fe(N){o=N,n(0,o)}return[o,s,r,a,i,l,f,m,E,y,b,w,Le,S,ie,W,Ie,Ee,Y,z,fe]}class Ns extends pn{constructor(t){super(),hn(this,t,xs,Ls,ze,{})}}export{Ns as component};
