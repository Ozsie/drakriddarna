import{s as Pe,n as ue,o as et,b as tn,f as nn,r as on,i as N}from"../chunks/scheduler.ba2ce6c0.js";import{S as tt,i as nt,g as p,h,j as k,f as v,k as K,a as pe,y as sn,r as Ot,s as D,u as St,c as w,z as _,x as u,v as _t,A as S,B as an,d as Mt,t as Pt,w as Nt}from"../chunks/index.c726ce2d.js";var H=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(H||{}),O=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(O||{}),G=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(G||{}),X=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(X||{}),me=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.DOOR="Door",e.NOTE="Note",e))(me||{}),L=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(L||{});const Ut=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1}],Kt=[{name:"Orch Sword/Bow",range:99,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4}],Yt=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4}],ln="0",rn="@",Me=" ",$e="#",An=(e,t,o,n)=>({type:e,name:t,position:{x:o,y:n},found:!1}),U=(e,t,o)=>({side:e,x:t,y:o,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),Gt=(e,t,o)=>({...U(e,t,o),hidden:!0}),$=(e,t,o,n)=>{const a=Object.values(H).indexOf(t),A=Object.keys(H)[a];let g=G.LORD,I=2,f=2,d=4,E=4,C=4,Q=Kt[0],F=Yt[0];switch(e){case O.ORCH:{g=G.APPRENTICE,f=0,d=2,E=2,C=1;break}case O.TROLL:{g=G.KNIGHT,f=1,d=3,E=3,C=2,Q=Kt[1],F=Yt[1];break}}return e===O.YELLOW_DARK_LORD&&(I=3),{type:e,level:g,colour:t,actions:I,defense:f,health:d,maxHealth:E,experience:C,name:e+" ("+A+")",movement:3,position:{x:o,y:n},weapon:Q,armour:F}},cn={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:X.KILL_ALL,fulfilled:!1},{type:X.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[U(L.RIGHT,2,4),U(L.RIGHT,5,4),U(L.RIGHT,9,5),U(L.RIGHT,12,5),U(L.RIGHT,9,8),U(L.RIGHT,12,8),U(L.RIGHT,11,2),Gt(L.UP,9,3),Gt(L.RIGHT,15,1)],monsters:[$(O.ORCH,H.Blue,9,7),$(O.ORCH,H.Red,12,8),$(O.TROLL,H.Red,15,1),$(O.TROLL,H.Yellow,13,6)],secrets:[{type:me.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:me.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:me.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item",item:{name:"Healing Herbs"}},{type:me.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},Ft={name:"Troll cave",beaten:!1,winConditions:[{type:X.KILL_ALL,fulfilled:!1}],nextDungeon:cn,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[U(L.RIGHT,3,9),U(L.RIGHT,6,9),U(L.UP,7,7),U(L.UP,7,4)],monsters:[$(O.ORCH,H.Green,6,9),$(O.ORCH,H.Yellow,8,10),$(O.ORCH,H.Red,7,5),$(O.ORCH,H.Red,9,3),$(O.TROLL,H.Green,6,1)],secrets:[An(me.NOTE,"Welcome to Drakriddarna",2,9)],notes:[]},killCount:0},Wt=e=>{e.actionLog.push("Game saved."),localStorage.setItem("state",JSON.stringify(e))},dn=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(o=>{var n;return o.name===((n=t.currentActor)==null?void 0:n.name)}),t.actionLog.push("Game loaded."),t}},gn=()=>{const e=Jt;return Xt(e,Ft),{heroes:e,dungeon:Ft,currentActor:e[0],actionLog:["Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."]}},_e=(e,t)=>(Ut[0].amountInDeck--,{name:e,actions:2,movement:3,defense:0,level:G.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Ut[0]}),Jt=[_e("Fearik",H.Yellow),_e("Helbran",H.Red),_e("Siedel",H.Green),_e("Wulf",H.Blue)],Xt=(e,t)=>{e.forEach((o,n)=>o.position=t.startingPositions[n])},Be=e=>{let t=[];for(let o=0;o<e.length;o++)t.push(e[o]);return t},$t=(e,t,o)=>e.dungeon.layout.monsters.some(n=>n.position.x===t&&n.position.y===o&&n.health>0),Vt=(e,t,o)=>e.heroes.some(n=>n.position.x===t&&n.position.y===o),T=(e,t)=>{const o=t.currentActor;if(!o||o.actions===0)return;let n=o.position.x,a=o.position.y;switch(e){case"UL":n=o.position.x-1,a=o.position.y-1;break;case"U":a=o.position.y-1;break;case"UR":n=o.position.x+1,a=o.position.y-1;break;case"L":n=o.position.x-1;break;case"R":n=o.position.x+1;break;case"DL":n=o.position.x-1,a=o.position.y+1;break;case"D":a=o.position.y+1;break;case"DR":n=o.position.x+1,a=o.position.y+1;break}const A=Vt(t,n,a),g=!ot(t.dungeon.layout,n,a),I=$t(t,n,a);if(!A&&!g){const f=it(t.dungeon,n,a);f?f&&(I?fn(o,t,n,a):Zt(o,t,n,a,1)):mn(t,o,n,a)&&un(o,t,n,a)}else t.actionLog.push(`${o.name} could not make that move`);o.movement===0&&(o.actions--,o.actions!==0&&(o.movement=3)),o.actions==0&&(o.movement=0)},Zt=(e,t,o,n,a)=>{e.position.x=o,e.position.y=n;const A=t.dungeon.layout.notes.find(I=>xt(I.position,e.position));A&&(t.dungeon.layout.doors.some(f=>f.hidden&&xt(A.position,{x:f.x,y:f.y}))||t.actionLog.push(`${e.name} reads: ${A.message}`)),t.dungeon.layout.monsters.some(I=>st(e.position,I.position.x,I.position.y))?(t.actionLog.push(`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=a},un=(e,t,o,n)=>{const a=Ne(t.dungeon.layout.grid,o,n);a&&t.dungeon.discoveredRooms.push(a),Zt(e,t,e.position.x,e.position.y,1),t.actionLog.push(`${e.name} opened a door`)},fn=(e,t,o,n)=>{var A;if(e.actions===1&&e.movement!==3){t.actionLog.push(`${e.name} has no actions left to attack`);return}const a=t.dungeon.layout.monsters.find(g=>g.position.x===o&&g.position.y===n);if(a){const g=((A=a.armour)==null?void 0:A.defense)??a.defense,I=Re(e.level,e.weapon.dice),f=Math.max(I-g,0);t.actionLog.push(`${e.name} attacked ${a.name} with ${e.weapon.name} for ${at(f,I,a)}`),a.health-=f,a.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(d=>d!=a),t.actionLog.push(`${e.name} killed ${a.name}`),t.dungeon.killCount++,e.experience+=a.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--}},Re=(e,t)=>{let o=[];for(let n=0;n<t;n++)o.push(Math.floor(Math.random()*6)+1);switch(e){case G.APPRENTICE:o=o.filter(n=>n===5);break;case G.KNIGHT:case G.HERO:o=o.filter(n=>n>=4);break;case G.LORD:case G.MASTER:o=o.filter(n=>n>=3);break}return o.length},Ve=e=>{const t=e.currentActor;if(!t)return;if(!jt(t)){e.actionLog.push(`${t.name} has no actions left to pick lock`);return}const o=e.dungeon.layout.doors.find(n=>n.x===t.position.x&&n.y===t.position.y);o&&o.locked&&(Re(t.level,1)>=1?(o.locked=!1,e.actionLog.push(`${t.name} managed to pick the lock`)):e.actionLog.push(`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=3,t.actions==0&&(t.movement=0))},Ze=e=>{const t=e.currentActor;if(!t)return;if(!jt(t)){e.actionLog.push(`${t.name} has no actions left to search`);return}const o=Re(t.level,1);if(o>=1){const n=e.dungeon.layout.doors.find(g=>g.hidden&&g.x===t.position.x&&g.y===t.position.y);n&&(e.actionLog.push(`${t.name} searched (${o}) and found a hidden door`),n.hidden=!1);const a=e.dungeon.layout.doors.find(g=>g.trapped&&g.x===t.position.x&&t.position.y);a&&!n&&(e.actionLog.push(`${t.name} searched (${o}) and found a trap in a door`),a.trapped=!1);const A=e.dungeon.layout.secrets.find(g=>st(g.position,t.position.x,t.position.y));A&&!a&&!n&&e.actionLog.push(`${t.name} searched (${o}) and found ${A.name}`),!n&&!a&&!A&&e.actionLog.push(`${t.name} searched (${o}) but found nothing`)}else e.actionLog.push(`${t.name} searched (${o}) but found nothing`);t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)},je=e=>{if(Bn(e),e.currentActor!==void 0){e.actionLog.push(`${e.currentActor.name} ended their turn`);let o=e.heroes.indexOf(e.currentActor)+1;o===e.heroes.length&&(hn(e),o=0),e.currentActor.actions=2,e.currentActor.movement=3,e.currentActor=e.heroes[o],e.actionLog.push(`${e.currentActor.name} started their turn`)}},Bn=e=>{e.dungeon.winConditions.forEach(t=>{var o;switch(t.type){case X.KILL_ALL:{const n=e.dungeon.layout.monsters.map(a=>a.health).reduce((a,A)=>a+A,0);t.fulfilled=n<=0;break}case X.REACH_CELL:{t.fulfilled=e.heroes.some(n=>{var a;return n.position.x===((a=t.targetCell)==null?void 0:a.x)&&n.position.y===t.targetCell.y});break}case X.KILL_ALL_OF_TYPE:{t.fulfilled=e.dungeon.layout.monsters.filter(n=>n.type===t.targetMonsterType).some(n=>n.health>0);break}case X.OPEN_DOOR:{t.fulfilled=((o=e.dungeon.layout.doors.find(n=>{var a,A;return n.x===((a=t.targetCell)==null?void 0:a.x)&&n.y===((A=t.targetCell)==null?void 0:A.y)}))==null?void 0:o.open)??!1;break}case X.KILL_AT_LEAST:{t.fulfilled=(t.killMinCount?t.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(t=>t.fulfilled).reduce((t,o)=>t&&o,!0),e.dungeon.beaten&&(e.actionLog.push("All win conditions have been fulfilled"),e.actionLog.push(`You have cleared ${e.dungeon.name}`))},mn=(e,t,o,n)=>{const a=e.dungeon.layout.doors.find(A=>A.x===t.position.x&&A.y===t.position.y);if(a&&!a.locked){const A=pn(t.position.x,t.position.y,o,n);if(a.side===A){if(a.open=!0,a.trapped){const g=Re(G.APPRENTICE,a.trapAttacks),I=Math.max(g-t.defense,0);e.actionLog.push(`Door was trapped. ${t.name} took ${at(I,g,t)}`),t.health-=I}return!0}}return a&&a.locked&&e.actionLog.push("Door is locked"),!1},pn=(e,t,o,n)=>{if(e===o){if(t>n)return L.UP;if(t<n)return L.DOWN}if(t===n){if(e>o)return L.LEFT;if(e<o)return L.RIGHT}},ot=(e,t,o)=>{let n=!0;if(t<0||t>=e.grid[0].length||o<0||o>=e.grid.length)n=!1;else{const a=Ne(e.grid,t,o);(a===ln||a===rn||a===Me||a===$e)&&(n=!1)}return n},it=(e,t,o)=>{const n=Ne(e.layout.grid,t,o);return n?e.discoveredRooms.includes(n):!1},Ne=(e,t,o)=>{let n;return e.forEach((a,A)=>{Be(a).forEach((g,I)=>{A===o&&I===t&&(n=g)})}),n},st=(e,t,o)=>e.x===t&&e.y===o||e.x===t-1&&e.y===o||e.x===t-1&&e.y===o-1||e.x===t&&e.y===o-1||e.x===t+1&&e.y===o-1||e.x===t+1&&e.y===o||e.x===t+1&&e.y===o+1||e.x===t&&e.y===o+1||e.x===t-1&&e.y===o+1,hn=e=>{const t=e.dungeon.layout.monsters.filter(o=>{const n=Ne(e.dungeon.layout.grid,o.position.x,o.position.y);return n&&e.dungeon.discoveredRooms.includes(n)&&o.health>0});t.length===0&&e.actionLog.push("No monsters can act"),t.forEach(o=>{const n=o.actions;for(;o.actions>0;){e.actionLog.push(`${o.name} acted `);const a=e.heroes.filter(A=>st(o.position,A.position.x,A.position.y));if(a.length>0){const A=Math.floor(Math.random()*a.length);vn(e,o,a[A])}else En(e,o)}o.actions=n})};function qt(e,t){return Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2))}const En=(e,t)=>{const o=e.heroes.map(a=>({hero:a,dist:qt(a.position,t.position)})).sort((a,A)=>a.dist-A.dist)[0],n=Cn(e,t.position);if(n.length>0){const a=n.map(A=>({pos:A,dist:qt(A,o.hero.position)})).sort((A,g)=>A.dist-g.dist)[0].pos;t.position=a,e.actionLog.push(`${t.name} moved towards ${o.hero.name} (${a.x},${a.y})`)}else e.actionLog.push(`${t.name} could not move`);t.actions--};let Cn=(e,t)=>{const o=t.x,n=t.y,a=[];for(let A=o-1;A<=o+1;A++)for(let g=n-1;g<=n+1;g++)A===o&&g===n||ot(e.dungeon.layout,A,g)&&it(e.dungeon,A,g)&&a.push({x:A,y:g});return a.filter(A=>!e.heroes.find(g=>g.position.x===A.x&&g.position.y===A.y)).filter(A=>!e.dungeon.layout.monsters.find(I=>I.position.x===A.x&&I.position.y===A.y))};const at=(e,t,o)=>{var a;const n=((a=o.armour)==null?void 0:a.defense)??o.defense;return`${e} damage (${t}-${n}=${e})`},vn=(e,t,o)=>{if(t.actions===1&&t.movement!==3){e.actionLog.push(`${o.name} has no actions left to attack`);return}if(o){const n=Re(t.level,t.weapon.dice),a=Math.max(n-o.defense,0);e.actionLog.push(`${t.name} attacked ${o.name} with ${t.weapon.name} for ${at(a,n,o)}`),o.health-=a,o.health<=0&&(e.actionLog.push(`${t.name} killed ${o.name}`),e.heroes=e.heroes.filter(A=>A!==o)),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--}},jt=e=>e.movement<3?e.actions>1:e.actions>0,xt=(e,t)=>e.x===t.x&&e.y===t.y,In="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABAKADAAQAAAABAAABAAAAAABn6hpJAAAGiklEQVR4Ae3dS47iMBAA0DDiDogT9g6JY7ELJ2IJnKKnMxpLSQRRHJzxRPWyCQZ/n1ulFiqT3eVy+W5mXs/nszkcDjNrN01u/dkd/63Y9Z973e/35ng85jb7qP7UmKfTafdR5xoT+EBg37V9PB6zurher83X19dq9WdNolepm0/udbvdmvP53LRtm9t0cf0aYy6erIahBH6FWq3FEiAwEBAABhwKBGIJCACx9ttqCQwEBIABhwKBWAICQKz9tloCAwEBYMChQCCWgAAQa7+tlsBAQAAYcCgQiCUgAMTab6slMBD4kwk4eKdwoUvXXZKxN3caXZZd7tWl5i5plztOv36NMfvje03glcDqAaA7O9ClD69xvTsLMJV7n+bRpQOXvJaO+XMWoOQ09EUgS2D1ANDNZu5Zg6yZ/1R+959Fjdz7GmPmeqlPYCzgO4CxiDKBQAICQKDNtlQCYwEBYCyiTCCQgAAQaLMtlcBYQAAYiygTCCQgAATabEslMBYQAMYiygQCCQgAgTbbUgmMBQSAsYgygUAC+9xc/bXr59q/y+mvkXtfY8xcL/UJ9AV2Oc8F6Dec87oLFms+R+DdWYCpuc3J2Z9qv+SzqTE9F2CJqDalBLKeC5A76NrPEXh3FmBqnjVy9muMOWXgMwJJwHcAScKdQEABASDgplsygSQgACQJdwIBBQSAgJtuyQSSgACQJNwJBBQQAAJuuiUTSAICQJJwJxBQQAAIuOmWTCAJCABJwp1AQIHsswD/m9G7swBT86yRs19jzCkDnxHoBPY1fre/JP3S3/df2q4/96kc/3699PrVmJ4LkHTcawj8k7MAay+sbdu1h3jZvxz/lyze3JCA7wA2tFmmSqC0gABQWlR/BDYkIABsaLNMlUBpAQGgtKj+CGxIQADY0GaZKoHSAgJAaVH9EdiQgACwoc0yVQKlBQSA0qL6I7AhAQFgQ5tlqgRKC6x+FmDt5wjUzrGvPX7pPwj9ESBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoJTAbwUM8lhPvL+bAAAAAElFTkSuQmCC",yn="data:image/png;base64,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";function kn(e){let t;return{c(){t=p("canvas"),this.h()},l(o){t=h(o,"CANVAS",{width:!0,height:!0,id:!0}),k(t).forEach(v),this.h()},h(){K(t,"width","860"),K(t,"height","750"),K(t,"id","gameBoard")},m(o,n){pe(o,t,n)},p:ue,i:ue,o:ue,d(o){o&&v(t)}}}const i=48;function Tn(e,t,o){let{state:n}=t,{debugMode:a=!0}=t;et(()=>{const s=new Image;s.src=In;const l=new Image;l.src=yn,A(s,l),setInterval(()=>A(s,l),10)});const A=(s,l)=>{if(!n||!document)return;const r=document.getElementById("gameBoard"),c=r.getContext("2d");c.clearRect(0,0,r.width,r.height),n.dungeon.layout.grid.forEach((m,y)=>{Be(m).forEach((B,R)=>g(c,B,R,y,s))}),n.dungeon.layout.grid.forEach((m,y)=>{Be(m).forEach((B,R)=>I(c,B,R,y))}),n.dungeon.layout.grid.forEach((m,y)=>{Be(m).forEach((B,R)=>f(c,B,R,y))}),n.dungeon.layout.grid.forEach((m,y)=>{Be(m).forEach((B,R)=>be(c,B,R,y,l))}),q(c,n.currentActor),F(c,n.currentActor)},g=(s,l,r,c,m)=>{ne(l)||!n.dungeon.discoveredRooms.includes(l)&&l!==Me?n.dungeon.discoveredRooms.some(y=>De(r,c,y))&&s.drawImage(m,48,0,48,48,r*i,c*i,i,i):te(l)?(s.beginPath(),s.strokeStyle="black",s.fillStyle="black",s.fillRect(r*i,c*i,i,i),s.stroke()):s.drawImage(m,0,0,48,48,r*i,c*i,i,i)},I=(s,l,r,c)=>{l===Me||l===$e||(s.beginPath(),s.strokeStyle="black",s.rect(r*i,c*i,i,i),a&&(s.font="7px Arial",s.fillText(r+","+c,r*i+3,c*i+(i-3))),s.stroke())},f=(s,l,r,c)=>{const m=x(r,c);if(m&&!m.hidden&&!m.open&&!te(l))switch(s.fillStyle="brown",m.side){case L.RIGHT:{s.fillRect(r*i+(i-2),c*i,4,i),m.locked&&a&&(s.fillStyle="grey",s.fillRect(r*i+(i-4),c*i+(i/2-4),8,8)),m.trapped&&a&&(s.fillStyle="red",s.fillRect(r*i+(i-4),c*i+(i/2-4),4,4));break}case L.LEFT:{s.fillRect(r*i-2,c*i,4,i),m.locked&&a&&(s.fillStyle="grey",s.fillRect(r*i-4,c*i+(i/2-4),8,8)),m.trapped&&a&&(s.fillStyle="red",s.fillRect(r*i-4,c*i+(i/2-4),4,4));break}case L.UP:{s.fillRect(r*i,c*i-2,i,4),m.locked&&a&&(s.fillStyle="grey",s.fillRect(r*i+(i/2-4),c*i-4,8,8)),m.trapped&&a&&(s.fillStyle="red",s.fillRect(r*i+(i/2-4),c*i-4,4,4));break}case L.DOWN:{s.fillRect(r*i,c*i+(i-2),i,4),m.locked&&a&&(s.fillStyle="grey",s.fillRect(r*i+(i/2-4),c*i+(i-4),8,8)),m.trapped&&a&&(s.fillStyle="red",s.fillRect(r*i+(i/2-4),c*i+(i-4),4,4));break}}},d=(s,l,r,c)=>{s.beginPath(),s.strokeStyle=l.colour,s.fillStyle=l.colour,s.fillRect(r*i+4,c*i+(i-6),i-8,4),s.stroke()},E=(s,l,r,c)=>{a&&r.forEach(m=>{const y=l.position.x,B=l.position.y,R=m.position.x,z=m.position.y;s.strokeStyle=l.colour,s.beginPath(),s.moveTo(y*i+i/2,B*i+i/2),s.lineTo(R*i+i/2,z*i+i/2),s.stroke()})},C=(s,l,r,c)=>{s.beginPath(),s.strokeStyle="black",s.fillStyle="red",s.fillRect(r*i+4,c*i,i-8,4),s.fillStyle="green",s.fillRect(r*i+4,c*i,(i-8)*(l.health/l.maxHealth),4),s.rect(r*i+4,c*i,i-8,4),s.stroke()},Q=(s,l,r,c)=>{var m=s.fillStyle,y=s.strokeStyle;s.strokeStyle="#080808",s.fillStyle="darkred";for(let B=0;B<l.actions;B++)s.fillRect(r*i+4+6*B,c*i+i-12,5,5),s.rect(r*i+4+6*B,c*i+i-12,5,5),s.stroke();s.fillStyle="blue";for(let B=0;B<l.movement;B++)s.fillRect(r*i+i-22+6*B,c*i+i-12,5,5),s.rect(r*i+i-22+6*B,c*i+i-12,5,5),s.stroke();s.fillStyle=m,s.strokeStyle=y},F=(s,l)=>{l===n.currentActor&&(s.beginPath(),s.strokeStyle="lightblue",s.lineWidth=2,s.moveTo(l.position.x*i,l.position.y*i),s.lineTo(l.position.x*i+i/3,l.position.y*i),s.moveTo(l.position.x*i,l.position.y*i),s.lineTo(l.position.x*i,l.position.y*i+i/3),s.moveTo(l.position.x*i+i,l.position.y*i),s.lineTo(l.position.x*i+i/3*2,l.position.y*i),s.moveTo(l.position.x*i+i,l.position.y*i),s.lineTo(l.position.x*i+i,l.position.y*i+i/3),s.moveTo(l.position.x*i,l.position.y*i+i),s.lineTo(l.position.x*i,l.position.y*i+i/3*2),s.moveTo(l.position.x*i,l.position.y*i+i),s.lineTo(l.position.x*i+i/3,l.position.y*i+i),s.moveTo(l.position.x*i+i,l.position.y*i+i),s.lineTo(l.position.x*i+i,l.position.y*i+i/3*2),s.moveTo(l.position.x*i+i,l.position.y*i+i),s.lineTo(l.position.x*i+i/3*2,l.position.y*i+i),s.stroke(),s.lineWidth=1)},q=(s,l)=>{if(l===n.currentActor&&a){for(let r=l.position.x-l.movement;r<=l.position.x+l.movement;r++)for(let c=l.position.y-l.movement;c<=l.position.y+l.movement;c++)if(it(n.dungeon,r,c)){const y=$t(n,r,c),B=Vt(n,r,c),R=ot(n.dungeon.layout,r,c);!B&&!y&&R&&(s.fillStyle="rgba(50, 50, 255, 0.08)",s.fillRect(r*i,c*i,i,i),s.stroke())}}},be=(s,l,r,c,m)=>{s.beginPath();const y=n.heroes.find(B=>B.position.x===r&&B.position.y===c);if(y)s.drawImage(m,4*16,0,16,16,r*i,c*i,i,i),Q(s,y,r,c),d(s,y,r,c),C(s,y,r,c);else{const B=n.dungeon.layout.monsters.find(R=>R.position.x===r&&R.position.y===c);if(B&&B.health>0&&!te(l)){switch(B.type){case O.ORCH:s.drawImage(m,i,16,16,16,r*i,c*i,i,i);break;case O.TROLL:s.drawImage(m,i,16,16,16,r*i,c*i,i,i);break;default:s.drawImage(m,16,16,16,16,r*i,c*i,i,i);break}d(s,B,r,c),C(s,B,r,c),E(s,B,n.heroes)}}},te=s=>s===Me||!n.dungeon.discoveredRooms.includes(s),ne=s=>s===$e,x=(s,l)=>n.dungeon.layout.doors.find(r=>r.x===s&&r.y===l),De=(s,l,r)=>{if(!n)return;const c=Math.max(s-1,0),m=Math.max(l-1,0),y=Math.min(s+1,n.dungeon.layout.grid.length),B=Math.min(l+1,n.dungeon.layout.grid[0].length);for(let R=c;R<=y;R++)for(let z=m;z<=B;z++){const M=n.dungeon.layout.grid[z];if(Be(M)[R]===r)return!0}return!1};return e.$$set=s=>{"state"in s&&o(0,n=s.state),"debugMode"in s&&o(1,a=s.debugMode)},[n,a]}class Qn extends tt{constructor(t){super(),nt(this,t,Tn,kn,Pe,{state:0,debugMode:1})}}function Ln(e){let t;return{c(){t=p("canvas"),this.h()},l(o){t=h(o,"CANVAS",{id:!0,height:!0,width:!0}),k(t).forEach(v),this.h()},h(){K(t,"id","characterBoard"),K(t,"height","750"),K(t,"width","260")},m(o,n){pe(o,t,n)},p:ue,i:ue,o:ue,d(o){o&&v(t)}}}const W=180;function Rn(e,t,o){let{state:n}=t;et(()=>{a(),setInterval(a,100)});const a=()=>{if(!n||!document)return;const f=document.getElementById("characterBoard"),d=f.getContext("2d");d.clearRect(0,0,f.width,f.height),d.stroke(),n.heroes.forEach((E,C)=>{A(d,f,E,C),g(d,E,C),I(d,E,C)})},A=(f,d,E,C)=>{f.fillStyle=E.colour,f.fillRect(12,C*W+12,d.width,W-12),f.stroke(),f.fillStyle="black"},g=(f,d,E)=>{const Q=(d===n.currentActor?"> "+d.name:d.name)+" - "+d.level+" ("+d.experience+")";f.strokeStyle="black",f.font="18px Arial",f.fillText(Q,16,E*W+30),f.fillText("HP: "+d.health,16,E*W+50),f.fillText("Actions: "+d.actions,16,E*W+70),f.fillText("Moves: "+d.movement,16,E*W+90),f.stroke()},I=(f,d,E)=>{f.fillText("Equipment",16,E*W+110),f.font="12px Arial",f.fillText("ðŸ—¡ï¸ "+d.weapon.name+" ("+d.weapon.dice+")",16,E*W+125);let C="None (0)",Q="None (0)";d.armour&&(C=d.armour.name+" ("+d.armour.defense+")"),d.shield&&(Q=d.shield.name+" ("+d.armour.dice+")"),f.fillText("ðŸ§± "+C,16,E*W+142),f.fillText("ðŸ›¡ï¸ "+Q,16,E*W+159)};return e.$$set=f=>{"state"in f&&o(0,n=f.state)},[n]}class bn extends tt{constructor(t){super(),nt(this,t,Rn,Ln,Pe,{state:0})}}function zt(e){let t,o='<canvas width="860" height="100" id="logs"></canvas>';return{c(){t=p("div"),t.innerHTML=o,this.h()},l(n){t=h(n,"DIV",{class:!0,"data-svelte-h":!0}),_(t)!=="svelte-xcon9n"&&(t.innerHTML=o),this.h()},h(){K(t,"class","log svelte-60nygp")},m(n,a){pe(n,t,a)},p:ue,d(n){n&&v(t)}}}function Dn(e){let t,o,n,a,A,g,I,f,d,E,C,Q,F,q,be="UL",te,ne,x,De="U",s,l,r,c="UR",m,y,B,R="Next",z,M,fe,oe,lt="L",Ue,we,Ke,he,ie,rt="R",Ye,Ee,se,At="Search",Ge,Y,Ce,ae,ct="DL",Fe,ve,le,dt="D",We,Ie,re,gt="DR",qe,ye,Ae,ut="Pick lock",xe,ce,ke,de,ft="Save",ze,Te,ge,Bt="Load",Je,mt=e[0].actionLog,He,Xe,pt;n=new bn({props:{state:e[0]}});function en(b){e[2](b)}let ht={};e[0]!==void 0&&(ht.state=e[0]),g=new Qn({props:ht}),tn.push(()=>sn(g,"state",en));let J=zt();return{c(){t=p("div"),o=p("div"),Ot(n.$$.fragment),a=D(),A=p("div"),Ot(g.$$.fragment),f=D(),d=p("div"),E=p("div"),C=p("table"),Q=p("tr"),F=p("td"),q=p("button"),q.textContent=be,te=D(),ne=p("td"),x=p("button"),x.textContent=De,s=D(),l=p("td"),r=p("button"),r.textContent=c,m=D(),y=p("td"),B=p("button"),B.textContent=R,z=D(),M=p("tr"),fe=p("td"),oe=p("button"),oe.textContent=lt,Ue=D(),we=p("td"),Ke=D(),he=p("td"),ie=p("button"),ie.textContent=rt,Ye=D(),Ee=p("td"),se=p("button"),se.textContent=At,Ge=D(),Y=p("tr"),Ce=p("td"),ae=p("button"),ae.textContent=ct,Fe=D(),ve=p("td"),le=p("button"),le.textContent=dt,We=D(),Ie=p("td"),re=p("button"),re.textContent=gt,qe=D(),ye=p("td"),Ae=p("button"),Ae.textContent=ut,xe=D(),ce=p("tr"),ke=p("td"),de=p("button"),de.textContent=ft,ze=D(),Te=p("td"),ge=p("button"),ge.textContent=Bt,Je=D(),J.c(),this.h()},l(b){t=h(b,"DIV",{class:!0});var P=k(t);o=h(P,"DIV",{class:!0});var Qe=k(o);St(n.$$.fragment,Qe),Qe.forEach(v),a=w(P),A=h(P,"DIV",{class:!0});var Le=k(A);St(g.$$.fragment,Le),Le.forEach(v),P.forEach(v),f=w(b),d=h(b,"DIV",{class:!0});var Oe=k(d);E=h(Oe,"DIV",{class:!0});var Et=k(E);C=h(Et,"TABLE",{});var V=k(C);Q=h(V,"TR",{});var Z=k(Q);F=h(Z,"TD",{});var Ct=k(F);q=h(Ct,"BUTTON",{"data-svelte-h":!0}),_(q)!=="svelte-fw3uxo"&&(q.textContent=be),Ct.forEach(v),te=w(Z),ne=h(Z,"TD",{});var vt=k(ne);x=h(vt,"BUTTON",{"data-svelte-h":!0}),_(x)!=="svelte-1jeoia6"&&(x.textContent=De),vt.forEach(v),s=w(Z),l=h(Z,"TD",{});var It=k(l);r=h(It,"BUTTON",{"data-svelte-h":!0}),_(r)!=="svelte-1p8c8vc"&&(r.textContent=c),It.forEach(v),m=w(Z),y=h(Z,"TD",{});var yt=k(y);B=h(yt,"BUTTON",{"data-svelte-h":!0}),_(B)!=="svelte-1rtxc14"&&(B.textContent=R),yt.forEach(v),Z.forEach(v),z=w(V),M=h(V,"TR",{});var j=k(M);fe=h(j,"TD",{});var kt=k(fe);oe=h(kt,"BUTTON",{"data-svelte-h":!0}),_(oe)!=="svelte-10dnpu6"&&(oe.textContent=lt),kt.forEach(v),Ue=w(j),we=h(j,"TD",{}),k(we).forEach(v),Ke=w(j),he=h(j,"TD",{});var Tt=k(he);ie=h(Tt,"BUTTON",{"data-svelte-h":!0}),_(ie)!=="svelte-12287ni"&&(ie.textContent=rt),Tt.forEach(v),Ye=w(j),Ee=h(j,"TD",{});var Qt=k(Ee);se=h(Qt,"BUTTON",{"data-svelte-h":!0}),_(se)!=="svelte-cps1bu"&&(se.textContent=At),Qt.forEach(v),j.forEach(v),Ge=w(V),Y=h(V,"TR",{});var ee=k(Y);Ce=h(ee,"TD",{});var Lt=k(Ce);ae=h(Lt,"BUTTON",{"data-svelte-h":!0}),_(ae)!=="svelte-1ji074i"&&(ae.textContent=ct),Lt.forEach(v),Fe=w(ee),ve=h(ee,"TD",{});var Rt=k(ve);le=h(Rt,"BUTTON",{"data-svelte-h":!0}),_(le)!=="svelte-li5tq6"&&(le.textContent=dt),Rt.forEach(v),We=w(ee),Ie=h(ee,"TD",{});var bt=k(Ie);re=h(bt,"BUTTON",{"data-svelte-h":!0}),_(re)!=="svelte-3esmwe"&&(re.textContent=gt),bt.forEach(v),qe=w(ee),ye=h(ee,"TD",{});var Dt=k(ye);Ae=h(Dt,"BUTTON",{"data-svelte-h":!0}),_(Ae)!=="svelte-sacog4"&&(Ae.textContent=ut),Dt.forEach(v),ee.forEach(v),xe=w(V),ce=h(V,"TR",{});var Se=k(ce);ke=h(Se,"TD",{});var wt=k(ke);de=h(wt,"BUTTON",{"data-svelte-h":!0}),_(de)!=="svelte-1vr5zyk"&&(de.textContent=ft),wt.forEach(v),ze=w(Se),Te=h(Se,"TD",{});var Ht=k(Te);ge=h(Ht,"BUTTON",{"data-svelte-h":!0}),_(ge)!=="svelte-1m2jkw7"&&(ge.textContent=Bt),Ht.forEach(v),Se.forEach(v),V.forEach(v),Et.forEach(v),Je=w(Oe),J.l(Oe),Oe.forEach(v),this.h()},h(){K(o,"class","characterSide svelte-60nygp"),K(A,"class","boardSide svelte-60nygp"),K(t,"class","container svelte-60nygp"),K(E,"class","commands svelte-60nygp"),K(d,"class","container svelte-60nygp")},m(b,P){pe(b,t,P),u(t,o),_t(n,o,null),u(t,a),u(t,A),_t(g,A,null),pe(b,f,P),pe(b,d,P),u(d,E),u(E,C),u(C,Q),u(Q,F),u(F,q),u(Q,te),u(Q,ne),u(ne,x),u(Q,s),u(Q,l),u(l,r),u(Q,m),u(Q,y),u(y,B),u(C,z),u(C,M),u(M,fe),u(fe,oe),u(M,Ue),u(M,we),u(M,Ke),u(M,he),u(he,ie),u(M,Ye),u(M,Ee),u(Ee,se),u(C,Ge),u(C,Y),u(Y,Ce),u(Ce,ae),u(Y,Fe),u(Y,ve),u(ve,le),u(Y,We),u(Y,Ie),u(Ie,re),u(Y,qe),u(Y,ye),u(ye,Ae),u(C,xe),u(C,ce),u(ce,ke),u(ke,de),u(ce,ze),u(ce,Te),u(Te,ge),u(d,Je),J.m(d,null),He=!0,Xe||(pt=[S(window,"keydown",an(e[1])),S(q,"click",function(){N(T("UL",e[0]))&&T("UL",e[0]).apply(this,arguments)}),S(x,"click",function(){N(T("U",e[0]))&&T("U",e[0]).apply(this,arguments)}),S(r,"click",function(){N(T("UR",e[0]))&&T("UR",e[0]).apply(this,arguments)}),S(B,"click",function(){N(je(e[0]))&&je(e[0]).apply(this,arguments)}),S(oe,"click",function(){N(T("L",e[0]))&&T("L",e[0]).apply(this,arguments)}),S(ie,"click",function(){N(T("R",e[0]))&&T("R",e[0]).apply(this,arguments)}),S(se,"click",function(){N(Ze(e[0]))&&Ze(e[0]).apply(this,arguments)}),S(ae,"click",function(){N(T("DL",e[0]))&&T("DL",e[0]).apply(this,arguments)}),S(le,"click",function(){N(T("D",e[0]))&&T("D",e[0]).apply(this,arguments)}),S(re,"click",function(){N(T("DR",e[0]))&&T("DR",e[0]).apply(this,arguments)}),S(Ae,"click",function(){N(Ve(e[0]))&&Ve(e[0]).apply(this,arguments)}),S(de,"click",function(){N(Wt(e[0]))&&Wt(e[0]).apply(this,arguments)}),S(ge,"click",e[3])],Xe=!0)},p(b,[P]){e=b;const Qe={};P&1&&(Qe.state=e[0]),n.$set(Qe);const Le={};!I&&P&1&&(I=!0,Le.state=e[0],nn(()=>I=!1)),g.$set(Le),P&1&&Pe(mt,mt=e[0].actionLog)?(J.d(1),J=zt(),J.c(),J.m(d,null)):J.p(e,P)},i(b){He||(Mt(n.$$.fragment,b),Mt(g.$$.fragment,b),He=!0)},o(b){Pt(n.$$.fragment,b),Pt(g.$$.fragment,b),He=!1},d(b){b&&(v(t),v(f),v(d)),Nt(n),Nt(g),J.d(b),Xe=!1,on(pt)}}}function wn(e,t,o){let n=gn();et(()=>{g(),setInterval(g,500),setInterval(A,1e3)});function a(d){switch(d.key){case"6":case"d":T("R",n);break;case"9":case"e":T("UR",n);break;case"8":case"w":T("U",n);break;case"7":case"q":T("UL",n);break;case"4":case"a":T("L",n);break;case"1":case"z":T("DL",n);break;case"2":case"x":T("D",n);break;case"3":case"c":T("DR",n);break;case"0":case" ":je(n);break;case"-":case"r":Ve(n);break;case"+":case"f":Ze(n);break}}const A=()=>{if(n.dungeon.beaten&&n.dungeon.nextDungeon){o(0,n.dungeon=n.dungeon.nextDungeon,n);const d=Jt.filter(E=>!n.heroes.find(C=>E.name===C.name));n.heroes.push(...d),Xt(n.heroes,n.dungeon),o(0,n.actionLog=[],n),n.actionLog.push("You have reached "+n.dungeon.name)}},g=()=>{if(!n||!document)return;const d=document.getElementById("logs"),E=d.getContext("2d");E.clearRect(0,0,d.width,d.height),n.actionLog.slice(-10).reverse().forEach((C,Q)=>{E.font="12px Arial",E.fillStyle="black",E.fillText("> "+C,2,(Q+1)*12+2),E.stroke()})};function I(d){n=d,o(0,n)}return[n,a,I,()=>o(0,n=dn())]}class Sn extends tt{constructor(t){super(),nt(this,t,wn,Dn,Pe,{})}}export{Sn as component};
