import{s as ze,n as me,o as Hn,b as $n,f as Gn,r as Kt,i as z}from"../chunks/scheduler.ba2ce6c0.js";import{S as hn,i as vn,g as A,h as c,j as p,f as d,k as b,a as T,x as u,y as M,m as I,s as Q,n as E,c as C,z as $,l as Et,o as ee,e as pe,d as se,p as Kn,b as Xn,t as Ae,A as Lt,r as fn,u as gn,v as mn,w as pn,B as Wn,C as Xt}from"../chunks/index.6f434070.js";function Qn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var P=(e=>(e.Red="#CD5C5C",e.Blue="#1E90FF",e.Green="#90EE90",e.Yellow="#FCFF4F",e))(P||{}),q=(e=>(e.ORCH="Orch",e.TROLL="Troll",e.GREEN_DARK_LORD="Green Dark Lord",e.BLUE_DARK_LORD="Blue Dark Lord",e.RED_DARK_LORD="Red Dark Lord",e.YELLOW_DARK_LORD="Yellow Dark Lord",e))(q||{}),N=(e=>(e.APPRENTICE="Apprentice",e.KNIGHT="Knight",e.HERO="Hero",e.LORD="Lord",e.MASTER="Master",e))(N||{}),De=(e=>(e[e.KILL_ALL=0]="KILL_ALL",e[e.KILL_ALL_OF_TYPE=1]="KILL_ALL_OF_TYPE",e[e.REACH_CELL=2]="REACH_CELL",e[e.OPEN_DOOR=3]="OPEN_DOOR",e[e.KILL_AT_LEAST=4]="KILL_AT_LEAST",e))(De||{}),ge=(e=>(e.EQUIPMENT="Equipment",e.MAGIC_ITEM="Magic Item",e.TRAP_DOOR="Trap Door",e.NOTE="Note",e))(ge||{}),B=(e=>(e.LEFT="Left",e.RIGHT="Right",e.UP="Up",e.DOWN="Down",e))(B||{}),H=(e=>(e[e.WEAPON=0]="WEAPON",e[e.ARMOUR=1]="ARMOUR",e[e.SHIELD=2]="SHIELD",e))(H||{});const Fn=[{name:"Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:0,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Two-handed Sword",range:1,dice:4,twoHanded:!0,useHearHeroes:!1,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1},{name:"Halberd",range:2,dice:3,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:2,ignoresShield:!1,ignoresArmour:!1},{name:"Flail",range:1,dice:4,twoHanded:!1,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:4,ignoresShield:!1,ignoresArmour:!1},{name:"Double Headed Axe",range:1,dice:4,twoHanded:!0,useHearHeroes:!0,amountInDeck:1,type:H.WEAPON,value:3,ignoresShield:!1,ignoresArmour:!1}],Yn=[{name:"Orch Sword",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1},{name:"Orch Bow",range:999,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},{name:"Troll Club",range:1,dice:3,twoHanded:!1,useHearHeroes:!0,amountInDeck:4,type:H.WEAPON,value:0,ignoresShield:!1,ignoresArmour:!1}],Vt=[{name:"Chain mail",type:H.ARMOUR,amountInDeck:2,defense:1,magicProtection:!1,movementReduction:0,value:2},{name:"Plate mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!1,movementReduction:1,value:3},{name:"Dragon Skin mail",type:H.ARMOUR,amountInDeck:1,defense:2,magicProtection:!0,movementReduction:0,value:4}],yt=[{name:"Orch Mail",defense:0,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0},{name:"Troll Skin",defense:1,magicProtection:!1,amountInDeck:4,type:H.ARMOUR,movementReduction:0,value:0}],jt="0",Pt="@",Vn=" ",On="#",Zt=(e,t,n,o)=>({type:e,name:t,position:{x:n,y:o},found:!1}),oe=(e,t,n)=>({side:e,x:t,y:n,locked:!1,trapped:!1,open:!1,hidden:!1,trapAttacks:0}),kt=(e,t,n)=>({...oe(e,t,n),hidden:!0}),Re=(e,t,n,o)=>{const s=Object.values(P).indexOf(t),r=Object.keys(P)[s];let a=N.LORD,i=2,l=2,f=4,m=4,h=4,y=Yn[0],D,x=yt[0];switch(e){case q.ORCH:{a=N.APPRENTICE,l=0,f=2,m=2,h=1,D=Yn[1];break}case q.TROLL:{a=N.KNIGHT,l=1,f=3,m=3,h=2,y=Yn[2],x=yt[1];break}}return e===q.YELLOW_DARK_LORD&&(i=3),{type:e,level:a,colour:t,actions:i,defense:l,health:f,maxHealth:m,experience:h,name:e+" ("+r+")",movement:3,maxMovement:3,position:{x:n,y:o},weapon:y,armour:x,incapacitated:!1,inventory:[],rangedWeapon:D}},Jt=e=>{const t=e.currentActor,n=bn(t.level,1);let o,s,r,a;n>=1?(o=lo(e,t,n),o||(s=oo(e,t,n)),!o&&!s&&(r=so(e,t,n)),!o&&!s&&!r&&(a=ro(e,t,n)),!o&&!s&&!r&&!a&&g(e,`${t.name} searched but found nothing`)):g(e,`${t.name} searched but found nothing`)},Mt=e=>{const t=e.currentActor;if(!t)return!1;const n=e.dungeon.layout.secrets.filter(o=>o.type===ge.TRAP_DOOR).filter(o=>!o.found).find(o=>qn(o.position,t.position));return n?(En(e,St(n),t),g(e,`${t.name} fell into a pit and is incapacitated for one turn.`),t.movement=0,t.actions=0,t.incapacitated=!0,n.found=!0,!0):!1},St=e=>({health:0,position:e.position,defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:P.Red,maxHealth:0,name:"Trap Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Falling",amountInDeck:0,dice:3,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!0},inventory:[]}),zt=(e,t)=>e.dungeon.layout.doors.filter(n=>n.hidden).find(n=>sn({x:n.x,y:n.y},t.x,t.y)),eo=(e,t)=>e.dungeon.layout.doors.filter(n=>n.trapped).find(n=>n.x===t.x&&n.y===t.y),no=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).find(n=>sn(n.position,t.x,t.y)),to=(e,t)=>e.dungeon.layout.secrets.filter(n=>!n.found).filter(n=>n.type===ge.TRAP_DOOR).find(n=>sn(n.position,t.x,t.y)),oo=(e,t,n)=>zt(e,t.position)?(g(e,`${t.name} searched (${n}) and found a hidden door`),!0):!1,so=(e,t,n)=>{const o=eo(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found a trap in a door`),o.trapped=!1,!0):!1},ro=(e,t,n)=>{const o=no(e,t.position);if(o){switch(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,o.type){case ge.EQUIPMENT:{let s=o.item??ao(e);switch(io(e,s),g(e,`${t.name} equipped (${s.name})`),s.type){case H.ARMOUR:t.armour&&t.inventory.push(t.armour),t.armour=s;break;case H.SHIELD:t.shield&&t.inventory.push(t.shield),t.shield=s;break;case H.WEAPON:t.weapon&&t.inventory.push(t.weapon),t.weapon=s;break}}}return!0}return!1},ao=e=>{const t=e.itemDeck.length,n=Math.floor(Math.random()*t);return e.itemDeck[n]},io=(e,t)=>{const n=e.itemDeck.findIndex(o=>o.type===t.type&&o.name===t.name);e.itemDeck.splice(n,1)},lo=(e,t,n)=>{const o=to(e,t.position);return o?(g(e,`${t.name} searched (${n}) and found ${o.name}`),o.found=!0,!0):!1},Nt={name:"The Three Gates of Power",beaten:!1,winConditions:[{type:De.KILL_ALL,fulfilled:!1},{type:De.OPEN_DOOR,targetCell:{x:15,y:1},fulfilled:!1}],startingPositions:[{x:1,y:4},{x:0,y:3},{x:0,y:4},{x:0,y:5}],discoveredRooms:["A"],layout:{grid:["            EEEE","            EEEE","         DDDEEEE","AAA   CCCC","AAABBBCCCC   GGG","AAA   CCCCFFFGGG","      CCCC   GGG","      CCCC","      CCCCHHHIII","             III","             III"],doors:[oe(B.RIGHT,2,4),oe(B.RIGHT,5,4),oe(B.RIGHT,9,5),oe(B.RIGHT,12,5),oe(B.RIGHT,9,8),oe(B.RIGHT,12,8),oe(B.RIGHT,11,2),kt(B.UP,9,3),kt(B.RIGHT,15,1)],monsters:[Re(q.ORCH,P.Blue,9,7),Re(q.ORCH,P.Red,12,8),Re(q.TROLL,P.Red,15,1),Re(q.TROLL,P.Yellow,13,6)],secrets:[{type:ge.EQUIPMENT,position:{x:9,y:4},found:!1,name:"Random Equipment"},{type:ge.EQUIPMENT,position:{x:12,y:0},found:!1,name:"Random Equipment"},{type:ge.MAGIC_ITEM,position:{x:15,y:5},found:!1,name:"Random Magic Item"},{type:ge.EQUIPMENT,position:{x:15,y:9},found:!1,name:"Random Equipment"}],notes:[{message:"Beyond stone and fire you shall find the Dread tunnel, the road to the Ice Dragons treasure.",position:{x:2,y:4}},{message:"The Gate of Water. <There is an image of a sea dragon under the text>",position:{x:9,y:8}},{message:"The Gate of Air. <There is an image of a pegasus under the text>",position:{x:9,y:5}},{message:"The Gate of Fire. <There is an image of a hippogriph under the text>",position:{x:9,y:3}}]},killCount:0},uo={name:"Troll cave",beaten:!1,winConditions:[{type:De.KILL_ALL,fulfilled:!1}],nextDungeon:Nt,startingPositions:[{x:2,y:9},{x:1,y:8},{x:1,y:9},{x:1,y:10}],discoveredRooms:["A"],layout:{grid:["     ######","     #CCCC#","     #CCCC#","     #CCCC#","     ##E###","      #E#  ","      #E## ","##### #BB# ","#AAA###BB# ","#AAADDDBB# ","#AAA###BB# ","##### #### "],doors:[oe(B.RIGHT,3,9),oe(B.RIGHT,6,9),oe(B.UP,7,7),oe(B.UP,7,4)],monsters:[Re(q.ORCH,P.Green,6,9),Re(q.ORCH,P.Yellow,8,10),Re(q.ORCH,P.Red,7,5),Re(q.ORCH,P.Red,9,3),Re(q.TROLL,P.Green,6,1)],secrets:[Zt(ge.NOTE,"Welcome to Drakriddarna",3,9)],notes:[]},killCount:0},Ao=[{name:"Large shield",type:H.SHIELD,amountInDeck:2,dice:2,value:2},{name:"Small shield",type:H.SHIELD,amountInDeck:2,dice:1,value:1}],kn=(e,t)=>(Fn[0].amountInDeck--,{name:e,actions:2,movement:3,maxMovement:3,defense:0,level:N.APPRENTICE,health:7,maxHealth:7,colour:t,experience:0,position:{x:-1,y:-1},weapon:Fn[0],incapacitated:!1,inventory:[]}),co=()=>{const e=[];return Fn.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Vt.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),Ao.forEach(t=>{for(let n=0;n<t.amountInDeck;n++)e.push(t)}),e},An={name:"Treasure of the Ice Dragon",dungeons:[uo,Nt],itemDeck:co(),heroes:[kn("Fearik",P.Yellow),kn("Helbran",P.Red),kn("Siedel",P.Green),kn("Wulf",P.Blue)]},Qt=e=>{g(e,"Game saved."),localStorage.setItem("state",JSON.stringify(e))},fo=()=>{const e=localStorage.getItem("state");if(e){const t=JSON.parse(e);return t.currentActor=t.heroes.find(n=>{var o;return n.name===((o=t.currentActor)==null?void 0:o.name)}),g(t,"Game loaded."),t}},go=()=>{const e={heroes:An.heroes,dungeon:An.dungeons[0],currentActor:An.heroes[0],actionLog:[`Playing '${An.name}'`,"Game Initialised","Each character has 2 actions. Move, Attack, Search or Pick Lock.","Each character can move 3 steps per action.","If another action is performed before moving 3 steps, the move is finished and both actions are consumed.","The rules of this game are harsh and unfair."],itemDeck:mo(An.itemDeck)};return xt(e),e},mo=e=>{let t=e.length,n;for(;t>0;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e},xt=e=>{e.heroes.forEach((t,n)=>{t.position=e.dungeon.startingPositions[n],t.movement=Te(t),t.actions=2,t.health=t.maxHealth})},jn=e=>{let t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t},Zn=(e,t,n)=>e.dungeon.layout.monsters.some(o=>o.position.x===t&&o.position.y===n&&o.health>0),Jn=(e,t,n)=>L(e).some(o=>o.position.x===t&&o.position.y===n),Cn=e=>{e.movement===0&&(e.actions--,e.actions!==0&&(e.movement=Te(e))),e.actions==0&&(e.movement=0)},R=(e,t)=>{const n=t.currentActor;if(!n||n.actions===0)return;let o=n.position.x,s=n.position.y;switch(e){case"UL":o=n.position.x-1,s=n.position.y-1;break;case"U":s=n.position.y-1;break;case"UR":o=n.position.x+1,s=n.position.y-1;break;case"L":o=n.position.x-1;break;case"R":o=n.position.x+1;break;case"DL":o=n.position.x-1,s=n.position.y+1;break;case"D":s=n.position.y+1;break;case"DR":o=n.position.x+1,s=n.position.y+1;break}const r=Jn(t,o,s),a=!wn(t.dungeon.layout,o,s),i=Zn(t,o,s);if(!r&&!a){const l=Sn(t.dungeon,o,s);l?l&&(i?$t(n,t,o,s):Ut(n,t,o,s,1)):ho(t,n,o,s)&&cn(n,t,o,s)}else g(t,`${n.name} could not make that move`);Mt(t)||Cn(n)},Ut=(e,t,n,o,s)=>{e.position.x=n,e.position.y=o;const r=t.dungeon.layout.notes.find(i=>qn(i.position,e.position));r&&(t.dungeon.layout.doors.some(l=>l.hidden&&qn(r.position,{x:l.x,y:l.y}))||g(t,`${e.name} reads: ${r.message}`)),t.dungeon.layout.monsters.some(i=>sn(e.position,i.position.x,i.position.y))?(g(t,`${e.name} walked by a monster and lost the momentum`),e.movement=0):e.movement-=s},cn=(e,t,n,o)=>{const s=In(t.dungeon.layout.grid,n,o);s&&t.dungeon.discoveredRooms.push(s),Ut(e,t,e.position.x,e.position.y,1),g(t,`${e.name} opened a door`)},$t=(e,t,n,o)=>{if(e.actions===1&&e.movement!==3){g(t,`${e.name} has no actions left to attack`);return}if(!e.weapon.useHearHeroes&&L(t).filter(a=>a!==e).filter(a=>sn(e.position,a.position.x,a.position.y)).length>0){g(t,`${e.name} could not use ${e.weapon.name} near a friend.`);return}const s=t.dungeon.layout.monsters.find(r=>r.position.x===n&&r.position.y===o);s&&(En(t,e,s,!1),s.health<=0&&(t.dungeon.layout.monsters=t.dungeon.layout.monsters.filter(r=>r!=s),g(t,`${e.name} killed ${s.name}`),t.dungeon.killCount++,e.experience+=s.experience),e.actions>1&&e.movement<3?e.actions-=2:e.actions--)},bn=(e,t)=>{let n=[];for(let o=0;o<t;o++)n.push(Math.floor(Math.random()*6)+1);switch(e){case N.APPRENTICE:n=n.filter(o=>o===5);break;case N.KNIGHT:case N.HERO:n=n.filter(o=>o>=4);break;case N.LORD:case N.MASTER:n=n.filter(o=>o>=3);break}return n.length},Ct=e=>{const t=e.currentActor;t&&(t.actions--,t.movement=Te(t),t.actions===0&&Dn(e))},Bn=e=>{const t=e.currentActor;if(!t)return;if(!Rn(t)){g(e,`${t.name} has no actions left to pick lock`);return}const n=e.dungeon.layout.doors.find(o=>o.x===t.position.x&&o.y===t.position.y);n&&n.locked&&(bn(t.level,1)>=1?(n.locked=!1,g(e,`${t.name} managed to pick the lock`)):g(e,`${t.name} failed to pick the lock`),t.actions>1&&t.movement<3?t.actions-=2:t.actions--,t.movement=Te(t),t.actions==0&&(t.movement=0))},Te=e=>{var t;return e.maxMovement-(((t=e.armour)==null?void 0:t.movementReduction)??0)},_n=e=>{const t=e.currentActor;if(t){if(!Rn(t)){g(e,`${t.name} has no actions left to search`);return}Jt(e),t.actions>1&&t.movement<Te(t)?t.actions-=2:t.actions--,t.actions==0&&(t.movement=0)}},Dn=e=>{if(po(e),e.currentActor!==void 0){g(e,`${e.currentActor.name} ended their turn`);let n=L(e).indexOf(e.currentActor)+1;n===L(e).length&&(Io(e),n=0),L(e)[n].incapacitated&&(g(e,`${L(e)[n].name} is no longer incapacitated.`),L(e)[n].incapacitated=!1,n++),e.currentActor.actions=2,e.currentActor.movement=Te(e.currentActor),e.currentActor=L(e)[n],g(e,`${e.currentActor.name} started their turn`)}},po=e=>{var t;e.dungeon.winConditions.forEach(n=>{var o;switch(n.type){case De.KILL_ALL:{const s=e.dungeon.layout.monsters.map(r=>r.health).reduce((r,a)=>r+a,0);n.fulfilled=s<=0;break}case De.REACH_CELL:{n.fulfilled=L(e).some(s=>{var r;return s.position.x===((r=n.targetCell)==null?void 0:r.x)&&s.position.y===n.targetCell.y});break}case De.KILL_ALL_OF_TYPE:{n.fulfilled=e.dungeon.layout.monsters.filter(s=>s.type===n.targetMonsterType).some(s=>s.health>0);break}case De.OPEN_DOOR:{n.fulfilled=((o=e.dungeon.layout.doors.find(s=>{var r,a;return s.x===((r=n.targetCell)==null?void 0:r.x)&&s.y===((a=n.targetCell)==null?void 0:a.y)}))==null?void 0:o.open)??!1;break}case De.KILL_AT_LEAST:{n.fulfilled=(n.killMinCount?n.killMinCount:0)<=e.dungeon.killCount;break}}}),e.dungeon.beaten=e.dungeon.winConditions.map(n=>n.fulfilled).reduce((n,o)=>n&&o,!0),e.dungeon.beaten&&(g(e,"All win conditions have been fulfilled"),g(e,`You have cleared ${e.dungeon.name}`),g(e,`Press 'Next' to move on to the next level: ${(t=e.dungeon.nextDungeon)==null?void 0:t.name}`))},Gt=e=>({health:0,position:{x:e.x,y:e.y},defense:0,experience:0,actions:0,movement:0,maxMovement:0,colour:P.Red,maxHealth:0,name:"Door",level:N.APPRENTICE,incapacitated:!1,weapon:{name:"Trap",amountInDeck:0,dice:e.trapAttacks,useHearHeroes:!0,twoHanded:!1,range:1,type:H.WEAPON,value:0,ignoresShield:!0,ignoresArmour:!1},inventory:[]}),ho=(e,t,n,o)=>{const s=e.dungeon.layout.doors.find(r=>r.x===t.position.x&&r.y===t.position.y);if(s&&!s.locked){const r=vo(t.position.x,t.position.y,n,o);if(s.side===r)return s.open=!0,s.trapped&&En(e,Gt(s),t,!1),!0}return s&&s.locked&&g(e,"Door is locked"),!1},vo=(e,t,n,o)=>{if(e===n){if(t>o)return B.UP;if(t<o)return B.DOWN}if(t===o){if(e>n)return B.LEFT;if(e<n)return B.RIGHT}},wn=(e,t,n)=>{let o=!0;if(t<0||t>=e.grid[0].length||n<0||n>=e.grid.length)o=!1;else{const s=In(e.grid,t,n);(s===jt||s===Pt||s===Vn||s===On)&&(o=!1)}return o},Sn=(e,t,n)=>{const o=In(e.layout.grid,t,n);return o?e.discoveredRooms.includes(o):!1},In=(e,t,n)=>{let o;return e.forEach((s,r)=>{jn(s).forEach((a,i)=>{r===n&&i===t&&(o=a)})}),o},sn=(e,t,n)=>e.x===t&&e.y===n||e.x===t-1&&e.y===n||e.x===t-1&&e.y===n-1||e.x===t&&e.y===n-1||e.x===t+1&&e.y===n-1||e.x===t+1&&e.y===n||e.x===t+1&&e.y===n+1||e.x===t&&e.y===n+1||e.x===t-1&&e.y===n+1,Io=e=>{const t=e.dungeon.layout.monsters.filter(n=>{const o=In(e.dungeon.layout.grid,n.position.x,n.position.y);return o&&e.dungeon.discoveredRooms.includes(o)&&n.health>0});t.length===0&&g(e,"No monsters can act"),t.forEach(n=>{const o=n.actions;for(g(e,`${n.name} acted `);n.actions>0;){const s=L(e).filter(r=>sn(n.position,r.position.x,r.position.y));if(s.length>0){const r=Math.floor(Math.random()*s.length);bt(e,n,s[r],!1)}else{const r=L(e).filter(a=>{const i={x:n.position.x*48-24,y:n.position.y*48-24},l={x:a.position.x*48-24,y:a.position.y*48-24};return zn(i,n.position,l,a.position,e,[])});if(r.length>0&&n.rangedWeapon){console.log(`${n.name} sees: ${r.map(i=>i.name).join(", ")}`);const a=Math.floor(Math.random()*r.length);bt(e,n,r[a],!0)}else{for(;n.movement>0;)Eo(e,n);n.actions--,n.movement=Te(n)}}}n.actions=o,n.movement=Te(n)})},Eo=(e,t)=>{const n=L(e).map(o=>({hero:o,dist:Bt(o.position,t.position)})).sort((o,s)=>o.dist-s.dist)[0];if(n.dist>1){const o=yo(e,t.position);if(o.length>0){const s=o.map(r=>({pos:r,dist:Bt(r,n.hero.position)})).sort((r,a)=>r.dist-a.dist)[0].pos;t.position=s,g(e,`${t.name} moved towards ${n.hero.name} (${s.x},${s.y})`)}else g(e,`${t.name} could not move`)}t.movement--};let yo=(e,t)=>{const n=t.x,o=t.y,s=[];for(let r=n-1;r<=n+1;r++)for(let a=o-1;a<=o+1;a++)r===n&&a===o||wn(e.dungeon.layout,r,a)&&Sn(e.dungeon,r,a)&&s.push({x:r,y:a});return s.filter(r=>!L(e).find(a=>a.position.x===r.x&&a.position.y===r.y)).filter(r=>!e.dungeon.layout.monsters.find(i=>i.position.x===r.x&&i.position.y===r.y))};const ko=(e,t,n,o)=>{var r;const s=((r=o.armour)==null?void 0:r.defense)??o.defense;return`${e} damage (${t}-(${s}+${n})=${e})`},bt=(e,t,n,o)=>{if(t.actions===1&&t.movement!==3){g(e,`${t.name} has no actions left to attack`);return}n&&(En(e,t,n,o),(t==null?void 0:t.actions)>1&&(t==null?void 0:t.movement)<3?t.actions-=2:t.actions--)},Rn=e=>e.movement<Te(e)?e.actions>1:e.actions>0,qn=(e,t)=>e.x===t.x&&e.y===t.y,g=(e,t)=>{e.actionLog=[t,...e.actionLog]},L=e=>e.heroes.filter(t=>t.health>0),Qo=e=>e.heroes.filter(t=>t.health<=0),En=(e,t,n,o)=>{var f,m;let s=t.weapon;o&&t.rangedWeapon&&(s=t.rangedWeapon);let r=0,a=0;s.ignoresArmour?n.armour&&g(e,`${n.name}'s armour was useless against ${s.name} `):r=((f=n.armour)==null?void 0:f.defense)??n.defense,s.ignoresShield?n.shield&&g(e,`${n.name}'s shield was useless against ${s.name} `):a=bn(n.level,((m=n.shield)==null?void 0:m.dice)??0);const i=bn(t.level,s.dice),l=Math.max(i-(r+a),0);n.health-=l,g(e,`${t.name} attacked ${n.name} with ${s.name} for ${ko(l,i,a,n)}`),n.health<=0&&(g(e,`${t.name} killed ${n.name}`),n.health=0,n.level=N.APPRENTICE)},Co=e=>{L(e).forEach(t=>{const n=t.level;t.experience>=28?t.level=N.MASTER:t.experience>=18?t.level=N.LORD:t.experience>=10?t.level=N.HERO:t.experience>=4&&(t.level=N.KNIGHT),n!==t.level&&g(e,`${t.name} leveled up to ${t.level}`)})},bo=e=>{L(e).forEach(t=>t.experience+=4)},Bo=e=>{Qo(e).forEach(t=>{t.experience=0,t.health=t.maxHealth,t.movement=t.maxMovement,t.actions=2})},_o=e=>{e.dungeon.beaten&&e.dungeon.nextDungeon&&(e.dungeon=e.dungeon.nextDungeon,e.actionLog=["You have reached "+e.dungeon.name],bo(e),Co(e),Bo(e),xt(e))},Bt=(e,t)=>Math.sqrt(Math.pow(e.x-(t==null?void 0:t.x),2)+Math.pow(e.y-(t==null?void 0:t.y),2)),zn=(e,t,n,o,s,r)=>{const a=Do(e,n),i={x:Math.round((a.x+24)/48),y:Math.round((a.y+24)/48)},l=In(s.dungeon.layout.grid,i.x,i.y);return i.x===o.x&&i.y===o.y?(r.push(i),!0):l===On||l===Pt?!1:(i.x===t.x&&i.y===t.y||r.some(f=>f.x===i.x&&f.y===i.y)||r.push(i),zn(a,t,n,o,s,r))},Do=(e,t)=>{const n=e.x,o=e.y,s=t.x-n,r=t.y-o,a=s/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2),i=r/Math.pow(Math.pow(s,2)+Math.pow(r,2),1/2);let l=Math.round(a+n),f=Math.round(i+o);return{x:l,y:f}},Ro="data:image/png;base64,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av8Y5Sy9/WMYKIMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgZsC/wFnqYWZIdKtqQAAAABJRU5ErkJggg==",To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAAgCAYAAADKbvy8AAAHzUlEQVRoge2af2gURxTHvydBhGKhObRwmJSq+0e9SDQhSU24BEEukBChEYwYgxRCTLg/KqEpEUJK00BCDKJ/HCZnaAm2NSk0lkoEzz9ET+PPREPUf+5qMSf5QzmFimhLYPvH5W1m92Z3Z3YvYsEHx+7OzuftzHv7Zt7OnAccUbw+1VgWTy14eHXNxI0OHivKu2HfBV5WTw4P/PFIDfLWrUXy2UvkrVsLANjVPq7KdMKpDsXrU3M35/HvAZa8G5b4/olJJO/dzbgX7ulacd6JHo8R5BmeZFf7uO2b5FQH+8Y1V/sBAKXr1wAAZj/9AoV/nUXL6WmtPqvDDcvqIKOFe7q4fbN7edzwTvXksGBFXRAj9xcBvFgqfYHvdn6Eby+90CkggxkbJKPDyLGRM/Hn37ojrg/jDAC2DkWUG9bYDvaN75+YRGd9rfGoPZPXf1He1BAO9GQMoSTNBTlYvf8EcLFLO792TjEqtmyQnQ6SeGrBowAqAFTUBTP4jy92IfnsJVbvP4HGrYrGuGV5krdtu9ktnZj1X5S3E1E9q3iFzQVpv/77y1daGXsuIrI6jIaw4o113bA86Z+Y5B5FxS0vo0eLwHhqwYNzURUAmgtqdHOXcR4DgNyz3XxDSugwihteluUNg+GeLoS6e8FeA0Couxfhni5dXV7/ZXizYVhWT0YERpqK8WXfeSSfvdSVs8lHc7VflxQ40WElbngRVvH6VNZAZMzczXm6xCHU3asZja1n7L8sb3y+Uz0ZMP0uHa5TLx2uUxWvT/3t8l2Vvcf+nOrg2N01L9P+4yd+0JWz12VlZWpZWVkGy9NDz5Xl2fps+2X0ELeKYMrScjfnofP6U7ScnkaouxfJe3fRPzGpZXHN1X5Emoq5BhTVYeYAp7wMG+ruRd627eisrzWN5ueJpOlzzfovyos8X0QPOVEbQus3faiDKYzpYc8TSTRX+zFy4YHpA0V1mEWRG16UDfd0ZRjvn5tn0Flfa8oC0I68/ovyZs93oodES2KoYWSI0vVr0JJI6h5AdczmPxkd2eZlWKPxqJxdBGDZ/h3r0ZJIgr4Bjf0X4XfevOkZuQDTxEWmHawNMj7E2TB9nkhqYfuc6QBFotmKhp0OXuOzwWebBSDcf1Hequ9O9KyyAiNNxToFitenRpqKpZzH0yHTeJaX7bhTlkS0/zJ8ttpB97gf8iS3nr4RKpPV4ZQXMUK2WCNvVSbDO5Fs6Xkv76BI7VG9TVmJfbm3wbrhnXAr4kDF6xPe+zLjUyp/2PB61tgmIyn1DYoqA9iQn48/fvoZuw804sn8PB7HbgslUYcOlkPxF2pl8QezGB6dEnaCE94px50DZecKIxsYiupWRmR5nvOKKgPCbFFlADNXYgCA3QcaAQAb8vNR0bjHNokyGhEAFH8hDh0sF0pCnPAinJk9uTvygaEo0Bq0/Gaxk7Er5xF+uKReUBfrvKLKAFLPFgAAhcWfY3b6Bj75bBPuXrttGuHEzlyJYfeBRsxO39DxIqL4CzEWmQMA3ElcxeBAG8Yic7iTmMoqb+yDHWdY3NZY0yw0MBQFRZJQw73Lq+ux1iDCD3MQ2rKI0JZFaV00/AHASOSUVj4SOQXF65N6qYy8iNxJXMWdxFXdtYzY8Yo3vetutIcVRysyedu2I9Tdq7FcQ2hRuCSx1qDt+B0YiiLWmt5QDQxFEdqyqKsTfphjqUfx+tSTO8qwd+qy5sAn8/MAoDu3mseoUxWNewBAmicdvOEMAL7+5qSjOdTIkwPZJTU7DoC2lMn+5SIjAim0yRkAhKKHjTQA2FdZo/vFWoOmemjo3Dt1Gb+WV+Fx7DaezM9jQ36+FonsuZmQMVjHifLs/DI8OoX4g1kAy8YzOs84H8nyvP1EO47+59NZX6vt2GcspfEiieYyswiiho9dOQ8g7byiUB8+2Lq8av9qbhoz4SMAzP9UZCwjnfsqa3TnIlEgwyve5f05duHYKMb9RNpcleF5S3EUfcOj/HmWuEhTMVpOT2vXgMkcyA6fADKGQ7OOAXznAcAHW4tRFOqz1dHR3oCqYAk62hvQ0d6A6d9HdedVwRLbTNKKtxJ6q9kto+97WwBAlw3SlpATHliOJF27/YU67tDB8gzu1tM32m5MPLXgiacWPBlZKA116SzSsr86iacWPPsqazTDvh7sAZCeiANDUbwe7MGMQDJw6/4jlBZs1K6PHhvH5eM7UHX4OjraGyxZcp4VXxUsAaK3M7LYjL/wLRmzpSuS1u0vBDBlup9nxw+PTmFwoA0A0MIMi4rXpw4OtGlDpsYtRSPLUR3T/4WSQopAY+SJDl9FoT5tuATSEc3OqXZJiIjIDMMiPDuM0bF/YhK5Z7u17TPW0LI8O+yxvFOOJGMINSYwJCLOI34mfARFoT5dUhMYiloOoWzjqoIluh9bxutEtnh2DhocaENnfa22kBxpKjZ1nghPwtvNF+HYTVxWuHMgOZHNImW+vciJr+bSb26sNaglMSJ6aAgsLdioOxcVJzzNKXRNzqLN053Hz3mMdWR4EqNjRDnevAlYfMiTYqtGWwk5kTJXEecpXp/a0d6AW/cfce+XFmy0TGKywQ8OtOnWH2n+EREr3movVeS5ZltKlvuBboV1vqzzKGKOHhvXHVeK19q89B1mdu2Gt9rXc/vc9/I/lf8AumRDnk2NWWYAAAAASUVORK5CYII=",Ho=(e,t)=>{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y),s=Math.min(n,o),r=Math.max(n,o),a=s,i=r-s;let l=Math.sqrt(2);return i===0&&(l=1),Math.floor(l*a+i)},Oo=(e,t,n)=>{const o=e.currentActor,s=e.dungeon.layout.doors.find(r=>r.x===o.position.x&&r.y===o.position.y);if(s){if(!s.open&&!s.hidden&&!s.locked&&o.movement>0){switch(s.open=!0,s.trapped&&En(e,Gt(s),o),s.side){case B.RIGHT:cn(o,e,t+1,n);break;case B.LEFT:cn(o,e,t-1,n);break;case B.DOWN:cn(o,e,t,n+1);break;case B.UP:cn(o,e,t,n-1);break}Cn(o)}else if(s.locked&&!s.hidden){if(!Rn(o)){g(e,`${o.name} has no actions left`);return}g(e,"Door is locked"),Bn(e),Cn(o)}}else{if(!Rn(o)){g(e,`${o.name} has no actions left`);return}_n(e)}},wo=(e,t,n)=>{const o=e.currentActor;if(o.actions===0){g(e,`${o.name} has no actions left`);return}const s=wn(e.dungeon.layout,t,n),r=Ho(o.position,{x:t,y:n});if(console.log("distance: "+r),s){const a=Jn(e,t,n),i=Zn(e,t,n);if(!a&&!i&&r<=o.movement){if(o.position={x:t,y:n},o.movement-=r,Mt(e))return}else i&&(r<=o.weapon.range?$t(o,e,t,n):g(e,"Monster is out of range"))}Cn(o)},Lo=(e,t,n)=>{const o=n.currentActor,s=document.getElementById("gameBoard");if(!s)return;const r=s.getBoundingClientRect(),a=Math.min(Math.floor((e.clientX-r.left)/t),n.dungeon.layout.grid[0].length-1),i=Math.min(Math.floor((e.clientY-r.top)/t),n.dungeon.layout.grid.length-1),l=n.dungeon.layout.grid[i][a];a===o.position.x&&i===o.position.y?Oo(n,a,i):n.dungeon.discoveredRooms.includes(l)&&wo(n,a,i)},Po=(e,t,n,o,s)=>{L(o).forEach(a=>{Mo(e,a,t,n)}),$o(e,o,n),Go(e,o,n)},Mo=(e,t,n,o)=>{const s=t.position.x,r=t.position.y;e.drawImage(n,4*16,0,16,16,s*o,r*o,o,o),No(e,t,s,r,o),Uo(e,t,s,r,o),xo(e,t,s,r,o)},No=(e,t,n,o,s)=>{const r=e.fillStyle,a=e.strokeStyle;e.strokeStyle="#080808",e.fillStyle="darkred";for(let i=0;i<t.actions;i++)e.fillRect(n*s+4+6*i,o*s+s-12,5,5),e.rect(n*s+4+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle="blue";for(let i=0;i<t.movement;i++)e.fillRect(n*s+s-22+6*i,o*s+s-12,5,5),e.rect(n*s+s-22+6*i,o*s+s-12,5,5),e.stroke();e.fillStyle=r,e.strokeStyle=a},xo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(n*s+4,o*s,s-8,4),e.fillStyle="green",e.fillRect(n*s+4,o*s,(s-8)*(t.health/t.maxHealth),4),e.rect(n*s+4,o*s,s-8,4),e.stroke()},Uo=(e,t,n,o,s)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(n*s+4,o*s+(s-6),s-8,4),e.stroke()},$o=(e,t,n)=>{const o=t.currentActor;if(o){for(let s=o.position.x-o.movement;s<=o.position.x+o.movement;s++)for(let r=o.position.y-o.movement;r<=o.position.y+o.movement;r++)if(Sn(t.dungeon,s,r)){const i=Zn(t,s,r),l=Jn(t,s,r),f=wn(t.dungeon.layout,s,r);!l&&!i&&f&&(e.fillStyle="rgba(50, 50, 255, 0.08)",e.fillRect(s*n,r*n,n,n),e.stroke())}}},Go=(e,t,n)=>{const o=t.currentActor;o&&(e.beginPath(),e.strokeStyle="lightblue",e.lineWidth=2,e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n+n/3,o.position.y*n),e.moveTo(o.position.x*n,o.position.y*n),e.lineTo(o.position.x*n,o.position.y*n+n/3),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n),e.moveTo(o.position.x*n+n,o.position.y*n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3,o.position.y*n+n),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n,o.position.y*n+n/3*2),e.moveTo(o.position.x*n+n,o.position.y*n+n),e.lineTo(o.position.x*n+n/3*2,o.position.y*n+n),e.stroke(),e.lineWidth=1)},Wo=(e,t,n,o,s)=>{o.dungeon.layout.monsters.forEach(r=>{Yo(e,t,o,r,n,s)})},Yo=(e,t,n,o,s,r)=>{const a=n.dungeon.layout.grid[o.position.y][o.position.x];if(o&&o.health>0&&Zo(a,n)){switch(o.type){case q.ORCH:Fo(e,t,s,o);break;case q.TROLL:qo(e,t,s,o);break;default:Ko(e,t,s,o);break}Xo(e,o,s),Vo(e,o,s),jo(e,o,n.heroes,n,s,r)}},Fo=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},qo=(e,t,n,o)=>{e.drawImage(t,n,16,16,16,o.position.x*n,o.position.y*n,n,n)},Ko=(e,t,n,o)=>{e.drawImage(t,16,16,16,16,o.position.x*n,o.position.y*n,n,n)},Xo=(e,t,n)=>{e.beginPath(),e.strokeStyle=t.colour,e.fillStyle=t.colour,e.fillRect(t.position.x*n+4,t.position.y*n+(n-6),n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},Vo=(e,t,n)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="red",e.fillRect(t.position.x*n+4,t.position.y*n,n-8,4),e.fillStyle="green",e.fillRect(t.position.x*n+4,t.position.y*n,(n-8)*(t.health/t.maxHealth),4),e.rect(t.position.x*n+4,t.position.y*n,n-8,4),e.stroke(),e.strokeStyle="black",e.fillStyle="black"},jo=(e,t,n,o,s,r)=>{r&&n.forEach(a=>{const i=[],l={x:t.position.x*48-24,y:t.position.y*48-24},f={x:a.position.x*48-24,y:a.position.y*48-24};if(zn(l,t.position,f,a.position,o,i)){const h=t.position.x,y=t.position.y,D=a.position.x,x=a.position.y;e.beginPath(),e.strokeStyle=t.colour,e.lineWidth=2,e.moveTo(h*s+s/2,y*s+s/2),e.lineTo(D*s+s/2,x*s+s/2),e.stroke(),e.lineWidth=1}})},Zo=(e,t)=>t.dungeon.discoveredRooms.includes(e),Jo=(e,t,n,o,s)=>{o.dungeon.layout.doors.forEach(r=>{ss(e,t,n,o,r,s)})},So=(e,t,n,o,s)=>{o.dungeon.layout.grid.forEach((r,a)=>{jn(r).forEach((i,l)=>{es(e,t,o,i,l,a,n),os(e,i,o,l,a,n,s)})})},zo=(e,t,n,o)=>{o.dungeon.layout.secrets.filter(s=>s.found).forEach(s=>{switch(s.type){case ge.TRAP_DOOR:ns(e,t,n,s);break;default:ts(e,t,n,s);break}})},es=(e,t,n,o,s,r,a)=>{rs(o)||!n.dungeon.discoveredRooms.includes(o)&&o!==Vn?n.dungeon.discoveredRooms.some(i=>as(s,r,i,n))?e.drawImage(t,48,0,48,48,s*a,r*a,a,a):_t(e,s,r,a):Tn(o,n)?_t(e,s,r,a):e.drawImage(t,0,0,48,48,s*a,r*a,a,a)},_t=(e,t,n,o)=>{e.beginPath(),e.strokeStyle="black",e.fillStyle="black",e.fillRect(t*o,n*o,o,o),e.stroke()},ns=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,3*48,0,48,48,s*n,r*n,n,n)},ts=(e,t,n,o)=>{const s=o.position.x,r=o.position.y;e.drawImage(t,4*48,0,48,48,s*n,r*n,n,n)},os=(e,t,n,o,s,r,a)=>{!a&&(Tn(t,n)||t===On)||(e.beginPath(),e.strokeStyle="black",e.rect(o*r,s*r,r,r),a&&(e.font="7px Arial",e.fillText(o+","+s,o*r+3,s*r+(r-3))),e.stroke())},ss=(e,t,n,o,s,r)=>{const a=o.dungeon.layout.grid[s.y][s.x];if(s&&!s.hidden&&!s.open&&!Tn(a,o))switch(e.fillStyle="brown",s.side){case B.RIGHT:{e.fillRect(s.x*n+(n-2),s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n-4),s.y*n+(n/2-4),8,8));break}case B.LEFT:{e.fillRect(s.x*n-2,s.y*n,4,n),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n-4,s.y*n+(n/2-4),8,8));break}case B.UP:{e.fillRect(s.x*n,s.y*n-2,n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n-4,8,8));break}case B.DOWN:{e.fillRect(s.x*n,s.y*n+(n-2),n,4),s.locked&&r&&(e.fillStyle="grey",e.fillRect(s.x*n+(n/2-4),s.y*n+(n-4),8,8));break}}r&&!Tn(a,o)&&(e.fillStyle="black",e.font="12px Arial",e.fillText(`[${s.hidden?"H":"-"}/${s.trapped?"T"+s.trapAttacks:"-"}/${s.locked?"L":"-"}]`,s.x*n,s.y*n+10),e.fillStyle="rgba(50, 255, 255, 0.28)",e.fillRect(s.x*n,s.y*n,n,n))},rs=e=>e===On,Tn=(e,t)=>e===Vn||!t.dungeon.discoveredRooms.includes(e),as=(e,t,n,o)=>{if(!o)return;const s=Math.max(e-1,0),r=Math.max(t-1,0),a=Math.min(e+1,o.dungeon.layout.grid.length),i=Math.min(t+1,o.dungeon.layout.grid[0].length);for(let l=s;l<=a;l++)for(let f=r;f<=i;f++){const m=o.dungeon.layout.grid[f];if(jn(m)[l]===n)return!0}return!1};function is(e){let t,n,o,s;return{c(){t=A("div"),n=A("canvas"),this.h()},l(r){t=c(r,"DIV",{style:!0,class:!0});var a=p(t);n=c(a,"CANVAS",{width:!0,height:!0,id:!0}),p(n).forEach(d),a.forEach(d),this.h()},h(){b(n,"width",_e*40),b(n,"height",_e*30),b(n,"id","gameBoard"),b(t,"style",e[1]()),b(t,"class","dungeon svelte-a4uhtl")},m(r,a){T(r,t,a),u(t,n),o||(s=M(n,"click",e[0]),o=!0)},p:me,i:me,o:me,d(r){r&&d(t),o=!1,s()}}}const _e=48;function ls(e,t,n){let{state:o}=t,{debugMode:s}=t,r,a;a=window.innerHeight,r=document.getElementById("footer").offsetHeight,Hn(()=>{const m=new Image;m.src=Ro;const h=new Image;h.src=To,setInterval(()=>i(m,h),10)});const i=(m,h)=>{if(!o||!document)return;const y=document.getElementById("gameBoard"),D=y.getContext("2d");D.clearRect(0,0,y.width,y.height),D.fillStyle="black",D.fillRect(0,0,y.width,y.height),So(D,m,_e,o,s),zo(D,m,_e,o),Jo(D,m,_e,o,s),Wo(D,h,_e,o,s),Po(D,h,_e,o)},l=m=>{Lo(m,_e,o)},f=()=>`max-height: ${a-r-20}px; max-width: ${_e*40}`;return e.$$set=m=>{"state"in m&&n(2,o=m.state),"debugMode"in m&&n(3,s=m.debugMode)},[l,f,o,s]}class us extends hn{constructor(t){super(),vn(this,t,ls,is,ze,{state:2,debugMode:3})}}function ds(e){let t;return{c(){t=I("None (0)")},l(n){t=E(n,"None (0)")},m(n,o){T(n,t,o)},p:me,d(n){n&&d(t)}}}function As(e){let t=e[0].armour.name+"",n,o,s=e[0].armour.defense+"",r,a;return{c(){n=I(t),o=I(" ("),r=I(s),a=I(")")},l(i){n=E(i,t),o=E(i," ("),r=E(i,s),a=E(i,")")},m(i,l){T(i,n,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&t!==(t=i[0].armour.name+"")&&ee(n,t),l&1&&s!==(s=i[0].armour.defense+"")&&ee(r,s)},d(i){i&&(d(n),d(o),d(r),d(a))}}}function cs(e){let t;return{c(){t=I("None (0)")},l(n){t=E(n,"None (0)")},m(n,o){T(n,t,o)},p:me,d(n){n&&d(t)}}}function fs(e){let t=e[0].shield.name+"",n,o,s=e[0].shield.dice+"",r,a;return{c(){n=I(t),o=I(" ("),r=I(s),a=I(")")},l(i){n=E(i,t),o=E(i," ("),r=E(i,s),a=E(i,")")},m(i,l){T(i,n,l),T(i,o,l),T(i,r,l),T(i,a,l)},p(i,l){l&1&&t!==(t=i[0].shield.name+"")&&ee(n,t),l&1&&s!==(s=i[0].shield.dice+"")&&ee(r,s)},d(i){i&&(d(n),d(o),d(r),d(a))}}}function gs(e){let t,n,o,s=e[0].name+"",r,a,i,l,f=e[0].level+"",m,h,y=e[0].experience+"",D,x,en,re,he,j=e[0].health+"",Ge,We,Z,ae,He=e[0].actions+"",Oe,ve,G,nn,Ie=e[0].movement+"",U,Ee,W,rn="Equipment:",Ye,Y,K,ye,J=e[0].weapon.name+"",Fe,qe,ie=e[0].weapon.dice+"",ne,tn,Ke,O,ke,le,ue,Xe;function we(k,v){return k[0].armour!=null?As:ds}let te=we(e),X=te(e);function on(k,v){return k[0].shield!=null?fs:cs}let ce=on(e),w=ce(e);return{c(){t=A("div"),n=A("div"),o=A("b"),r=I(s),a=I(" -"),i=Q(),l=A("b"),m=I(f),h=I(" ("),D=I(y),x=I(")"),en=Q(),re=A("span"),he=I("HP: "),Ge=I(j),We=Q(),Z=A("span"),ae=I("Actions: "),Oe=I(He),ve=Q(),G=A("span"),nn=I("Moves: "),U=I(Ie),Ee=Q(),W=A("span"),W.textContent=rn,Ye=Q(),Y=A("div"),K=A("span"),ye=I("ðŸ—¡ï¸  "),Fe=I(J),qe=I(" ("),ne=I(ie),tn=I(")"),Ke=Q(),O=A("span"),ke=I(`ðŸ§±
        `),X.c(),le=Q(),ue=A("span"),Xe=I(`ðŸ›¡ï¸
            `),w.c(),this.h()},l(k){t=c(k,"DIV",{class:!0,style:!0});var v=p(t);n=c(v,"DIV",{class:!0});var fe=p(n);o=c(fe,"B",{class:!0});var de=p(o);r=E(de,s),a=E(de," -"),de.forEach(d),i=C(fe),l=c(fe,"B",{class:!0});var Le=p(l);m=E(Le,f),h=E(Le," ("),D=E(Le,y),x=E(Le,")"),Le.forEach(d),fe.forEach(d),en=C(v),re=c(v,"SPAN",{class:!0});var Ve=p(re);he=E(Ve,"HP: "),Ge=E(Ve,j),Ve.forEach(d),We=C(v),Z=c(v,"SPAN",{class:!0});var F=p(Z);ae=E(F,"Actions: "),Oe=E(F,He),F.forEach(d),ve=C(v),G=c(v,"SPAN",{class:!0});var Qe=p(G);nn=E(Qe,"Moves: "),U=E(Qe,Ie),Qe.forEach(d),Ee=C(v),W=c(v,"SPAN",{class:!0,"data-svelte-h":!0}),$(W)!=="svelte-1ue18fw"&&(W.textContent=rn),Ye=C(v),Y=c(v,"DIV",{class:!0});var V=p(Y);K=c(V,"SPAN",{class:!0});var Ce=p(K);ye=E(Ce,"ðŸ—¡ï¸  "),Fe=E(Ce,J),qe=E(Ce," ("),ne=E(Ce,ie),tn=E(Ce,")"),Ce.forEach(d),Ke=C(V),O=c(V,"SPAN",{class:!0});var je=p(O);ke=E(je,`ðŸ§±
        `),X.l(je),je.forEach(d),le=C(V),ue=c(V,"SPAN",{class:!0});var be=p(ue);Xe=E(be,`ðŸ›¡ï¸
            `),w.l(be),be.forEach(d),V.forEach(d),v.forEach(d),this.h()},h(){b(o,"class","svelte-1jzprgd"),b(l,"class","svelte-1jzprgd"),b(n,"class","hero-title svelte-1jzprgd"),b(re,"class","svelte-1jzprgd"),b(Z,"class","svelte-1jzprgd"),b(G,"class","svelte-1jzprgd"),b(W,"class","svelte-1jzprgd"),b(K,"class","svelte-1jzprgd"),b(O,"class","svelte-1jzprgd"),b(ue,"class","svelte-1jzprgd"),b(Y,"class","equipment"),b(t,"class","hero-card svelte-1jzprgd"),Et(t,"background-color",e[0].colour)},m(k,v){T(k,t,v),u(t,n),u(n,o),u(o,r),u(o,a),u(n,i),u(n,l),u(l,m),u(l,h),u(l,D),u(l,x),u(t,en),u(t,re),u(re,he),u(re,Ge),u(t,We),u(t,Z),u(Z,ae),u(Z,Oe),u(t,ve),u(t,G),u(G,nn),u(G,U),u(t,Ee),u(t,W),u(t,Ye),u(t,Y),u(Y,K),u(K,ye),u(K,Fe),u(K,qe),u(K,ne),u(K,tn),u(Y,Ke),u(Y,O),u(O,ke),X.m(O,null),u(Y,le),u(Y,ue),u(ue,Xe),w.m(ue,null)},p(k,[v]){v&1&&s!==(s=k[0].name+"")&&ee(r,s),v&1&&f!==(f=k[0].level+"")&&ee(m,f),v&1&&y!==(y=k[0].experience+"")&&ee(D,y),v&1&&j!==(j=k[0].health+"")&&ee(Ge,j),v&1&&He!==(He=k[0].actions+"")&&ee(Oe,He),v&1&&Ie!==(Ie=k[0].movement+"")&&ee(U,Ie),v&1&&J!==(J=k[0].weapon.name+"")&&ee(Fe,J),v&1&&ie!==(ie=k[0].weapon.dice+"")&&ee(ne,ie),te===(te=we(k))&&X?X.p(k,v):(X.d(1),X=te(k),X&&(X.c(),X.m(O,null))),ce===(ce=on(k))&&w?w.p(k,v):(w.d(1),w=ce(k),w&&(w.c(),w.m(ue,null))),v&1&&Et(t,"background-color",k[0].colour)},i:me,o:me,d(k){k&&d(t),X.d(),w.d()}}}function ms(e,t,n){let{hero:o}=t;return e.$$set=s=>{"hero"in s&&n(0,o=s.hero)},[o]}class Wt extends hn{constructor(t){super(),vn(this,t,ms,gs,ze,{hero:0})}}function Dt(e,t,n){const o=e.slice();return o[3]=t[n],o[5]=n,o}function ps(e){let t,n,o,s;return n=new Wt({props:{hero:e[3]}}),{c(){t=A("div"),fn(n.$$.fragment),o=Q(),this.h()},l(r){t=c(r,"DIV",{class:!0});var a=p(t);gn(n.$$.fragment,a),o=C(a),a.forEach(d),this.h()},h(){b(t,"class","not-current-actor svelte-izfxty")},m(r,a){T(r,t,a),mn(n,t,null),u(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(se(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&d(t),pn(n)}}}function hs(e){let t,n,o,s;return n=new Wt({props:{hero:e[3]}}),{c(){t=A("div"),fn(n.$$.fragment),o=Q(),this.h()},l(r){t=c(r,"DIV",{class:!0});var a=p(t);gn(n.$$.fragment,a),o=C(a),a.forEach(d),this.h()},h(){b(t,"class","is-current-actor svelte-izfxty")},m(r,a){T(r,t,a),mn(n,t,null),u(t,o),s=!0},p(r,a){const i={};a&1&&(i.hero=r[3]),n.$set(i)},i(r){s||(se(n.$$.fragment,r),s=!0)},o(r){Ae(n.$$.fragment,r),s=!1},d(r){r&&d(t),pn(n)}}}function Rt(e){let t,n,o,s;const r=[hs,ps],a=[];function i(l,f){return l[3]===l[0].currentActor?0:1}return t=i(e),n=a[t]=r[t](e),{c(){n.c(),o=pe()},l(l){n.l(l),o=pe()},m(l,f){a[t].m(l,f),T(l,o,f),s=!0},p(l,f){let m=t;t=i(l),t===m?a[t].p(l,f):(Kn(),Ae(a[m],1,1,()=>{a[m]=null}),Xn(),n=a[t],n?n.p(l,f):(n=a[t]=r[t](l),n.c()),se(n,1),n.m(o.parentNode,o))},i(l){s||(se(n),s=!0)},o(l){Ae(n),s=!1},d(l){l&&d(o),a[t].d(l)}}}function Tt(e){let t=e[1],n,o,s=Rt(e);return{c(){s.c(),n=pe()},l(r){s.l(r),n=pe()},m(r,a){s.m(r,a),T(r,n,a),o=!0},p(r,a){a&2&&ze(t,t=r[1])?(Kn(),Ae(s,1,1,me),Xn(),s=Rt(r),s.c(),se(s,1),s.m(n.parentNode,n)):s.p(r,a)},i(r){o||(se(s),o=!0)},o(r){Ae(s),o=!1},d(r){r&&d(n),s.d(r)}}}function vs(e){let t,n,o=Qn(L(e[0])),s=[];for(let a=0;a<o.length;a+=1)s[a]=Tt(Dt(e,o,a));const r=a=>Ae(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();t=pe()},l(a){for(let i=0;i<s.length;i+=1)s[i].l(a);t=pe()},m(a,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,i);T(a,t,i),n=!0},p(a,[i]){if(i&3){o=Qn(L(a[0]));let l;for(l=0;l<o.length;l+=1){const f=Dt(a,o,l);s[l]?(s[l].p(f,i),se(s[l],1)):(s[l]=Tt(f),s[l].c(),se(s[l],1),s[l].m(t.parentNode,t))}for(Kn(),l=o.length;l<s.length;l+=1)r(l);Xn()}},i(a){if(!n){for(let i=0;i<o.length;i+=1)se(s[i]);n=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Ae(s[i]);n=!1},d(a){a&&d(t),Lt(s,a)}}}function Is(e,t,n){let{state:o}=t,s=!1;Hn(()=>{r(),setInterval(r,100)});const r=()=>{n(1,s=!s)};return e.$$set=a=>{"state"in a&&n(0,o=a.state)},[o,s]}class Es extends hn{constructor(t){super(),vn(this,t,Is,vs,ze,{state:0})}}function Ht(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function ys(e){let t,n,o=e[2]+"",s;return{c(){t=A("p"),n=I(">"),s=I(o),this.h()},l(r){t=c(r,"P",{class:!0});var a=p(t);n=E(a,">"),s=E(a,o),a.forEach(d),this.h()},h(){b(t,"class","svelte-1xp6uq")},m(r,a){T(r,t,a),u(t,n),u(t,s)},p(r,a){a&1&&o!==(o=r[2]+"")&&ee(s,o)},d(r){r&&d(t)}}}function Ot(e){let t,n=e[4]<25&&ys(e);return{c(){n&&n.c(),t=pe()},l(o){n&&n.l(o),t=pe()},m(o,s){n&&n.m(o,s),T(o,t,s)},p(o,s){o[4]<25&&n.p(o,s)},d(o){o&&d(t),n&&n.d(o)}}}function wt(e){let t,n=Qn(e[0]),o=[];for(let s=0;s<n.length;s+=1)o[s]=Ot(Ht(e,n,s));return{c(){for(let s=0;s<o.length;s+=1)o[s].c();t=pe()},l(s){for(let r=0;r<o.length;r+=1)o[r].l(s);t=pe()},m(s,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(s,r);T(s,t,r)},p(s,r){if(r&1){n=Qn(s[0]);let a;for(a=0;a<n.length;a+=1){const i=Ht(s,n,a);o[a]?o[a].p(i,r):(o[a]=Ot(i),o[a].c(),o[a].m(t.parentNode,t))}for(;a<o.length;a+=1)o[a].d(1);o.length=n.length}},d(s){s&&d(t),Lt(o,s)}}}function ks(e){let t,n=e[0],o=wt(e);return{c(){t=A("div"),o.c(),this.h()},l(s){t=c(s,"DIV",{class:!0});var r=p(t);o.l(r),r.forEach(d),this.h()},h(){b(t,"class","log svelte-1xp6uq")},m(s,r){T(s,t,r),o.m(t,null)},p(s,[r]){r&1&&ze(n,n=s[0])?(o.d(1),o=wt(s),o.c(),o.m(t,null)):o.p(s,r)},i:me,o:me,d(s){s&&d(t),o.d(s)}}}function Qs(e,t,n){let o=[],{state:s}=t;return Hn(()=>{setInterval(()=>{n(0,o=s.actionLog)},1e3)}),e.$$set=r=>{"state"in r&&n(1,s=r.state)},[o,s]}class Cs extends hn{constructor(t){super(),vn(this,t,Qs,ks,ze,{state:1})}}function bs(e){let t,n,o,s,r,a,i,l,f,m,h,y,D,x,en="UL",re,he,j,Ge="U",We,Z,ae,He="UR",Oe,ve,G,nn="Next",Ie,U,Ee,W,rn="L",Ye,Y,K,ye,J,Fe="R",qe,ie,ne,tn="Search",Ke,O,ke,le,ue="DL",Xe,we,te,X="D",on,ce,w,k="DR",v,fe,de,Le="Pick lock",Ve,F,Qe,V,Ce="Save",je,be,Ze,et="Load",Ln,an,Je,nt="Debug",Pn,ln,Se,tt="End action",Mn,Be,Nn,yn,xn,ot;o=new Es({props:{state:e[0]}});function Yt(_){e[3](_)}function Ft(_){e[4](_)}let Un={};e[0]!==void 0&&(Un.state=e[0]),e[1]!==void 0&&(Un.debugMode=e[1]),r=new us({props:Un}),$n.push(()=>Wn(r,"state",Yt)),$n.push(()=>Wn(r,"debugMode",Ft));function qt(_){e[7](_)}let st={};return e[0]!==void 0&&(st.state=e[0]),Be=new Cs({props:st}),$n.push(()=>Wn(Be,"state",qt)),{c(){t=A("div"),n=A("div"),fn(o.$$.fragment),s=Q(),fn(r.$$.fragment),l=Q(),f=A("div"),m=A("div"),h=A("table"),y=A("tr"),D=A("td"),x=A("button"),x.textContent=en,re=Q(),he=A("td"),j=A("button"),j.textContent=Ge,We=Q(),Z=A("td"),ae=A("button"),ae.textContent=He,Oe=Q(),ve=A("td"),G=A("button"),G.textContent=nn,Ie=Q(),U=A("tr"),Ee=A("td"),W=A("button"),W.textContent=rn,Ye=Q(),Y=A("td"),K=Q(),ye=A("td"),J=A("button"),J.textContent=Fe,qe=Q(),ie=A("td"),ne=A("button"),ne.textContent=tn,Ke=Q(),O=A("tr"),ke=A("td"),le=A("button"),le.textContent=ue,Xe=Q(),we=A("td"),te=A("button"),te.textContent=X,on=Q(),ce=A("td"),w=A("button"),w.textContent=k,v=Q(),fe=A("td"),de=A("button"),de.textContent=Le,Ve=Q(),F=A("tr"),Qe=A("td"),V=A("button"),V.textContent=Ce,je=Q(),be=A("td"),Ze=A("button"),Ze.textContent=et,Ln=Q(),an=A("td"),Je=A("button"),Je.textContent=nt,Pn=Q(),ln=A("td"),Se=A("button"),Se.textContent=tt,Mn=Q(),fn(Be.$$.fragment),this.h()},l(_){t=c(_,"DIV",{class:!0});var S=p(t);n=c(S,"DIV",{class:!0});var un=p(n);gn(o.$$.fragment,un),un.forEach(d),s=C(S),gn(r.$$.fragment,S),S.forEach(d),l=C(_),f=c(_,"DIV",{class:!0,id:!0});var Pe=p(f);m=c(Pe,"DIV",{class:!0});var dn=p(m);h=c(dn,"TABLE",{});var Me=p(h);y=c(Me,"TR",{});var Ne=p(y);D=c(Ne,"TD",{});var rt=p(D);x=c(rt,"BUTTON",{"data-svelte-h":!0}),$(x)!=="svelte-fw3uxo"&&(x.textContent=en),rt.forEach(d),re=C(Ne),he=c(Ne,"TD",{});var at=p(he);j=c(at,"BUTTON",{"data-svelte-h":!0}),$(j)!=="svelte-1jeoia6"&&(j.textContent=Ge),at.forEach(d),We=C(Ne),Z=c(Ne,"TD",{});var it=p(Z);ae=c(it,"BUTTON",{"data-svelte-h":!0}),$(ae)!=="svelte-1p8c8vc"&&(ae.textContent=He),it.forEach(d),Oe=C(Ne),ve=c(Ne,"TD",{});var lt=p(ve);G=c(lt,"BUTTON",{"data-svelte-h":!0}),$(G)!=="svelte-1rtxc14"&&(G.textContent=nn),lt.forEach(d),Ne.forEach(d),Ie=C(Me),U=c(Me,"TR",{});var xe=p(U);Ee=c(xe,"TD",{});var ut=p(Ee);W=c(ut,"BUTTON",{"data-svelte-h":!0}),$(W)!=="svelte-10dnpu6"&&(W.textContent=rn),ut.forEach(d),Ye=C(xe),Y=c(xe,"TD",{}),p(Y).forEach(d),K=C(xe),ye=c(xe,"TD",{});var dt=p(ye);J=c(dt,"BUTTON",{"data-svelte-h":!0}),$(J)!=="svelte-12287ni"&&(J.textContent=Fe),dt.forEach(d),qe=C(xe),ie=c(xe,"TD",{});var At=p(ie);ne=c(At,"BUTTON",{"data-svelte-h":!0}),$(ne)!=="svelte-cps1bu"&&(ne.textContent=tn),At.forEach(d),xe.forEach(d),Ke=C(Me),O=c(Me,"TR",{});var Ue=p(O);ke=c(Ue,"TD",{});var ct=p(ke);le=c(ct,"BUTTON",{"data-svelte-h":!0}),$(le)!=="svelte-1ji074i"&&(le.textContent=ue),ct.forEach(d),Xe=C(Ue),we=c(Ue,"TD",{});var ft=p(we);te=c(ft,"BUTTON",{"data-svelte-h":!0}),$(te)!=="svelte-li5tq6"&&(te.textContent=X),ft.forEach(d),on=C(Ue),ce=c(Ue,"TD",{});var gt=p(ce);w=c(gt,"BUTTON",{"data-svelte-h":!0}),$(w)!=="svelte-3esmwe"&&(w.textContent=k),gt.forEach(d),v=C(Ue),fe=c(Ue,"TD",{});var mt=p(fe);de=c(mt,"BUTTON",{"data-svelte-h":!0}),$(de)!=="svelte-sacog4"&&(de.textContent=Le),mt.forEach(d),Ue.forEach(d),Ve=C(Me),F=c(Me,"TR",{});var $e=p(F);Qe=c($e,"TD",{});var pt=p(Qe);V=c(pt,"BUTTON",{"data-svelte-h":!0}),$(V)!=="svelte-1vr5zyk"&&(V.textContent=Ce),pt.forEach(d),je=C($e),be=c($e,"TD",{});var ht=p(be);Ze=c(ht,"BUTTON",{"data-svelte-h":!0}),$(Ze)!=="svelte-1m2jkw7"&&(Ze.textContent=et),ht.forEach(d),Ln=C($e),an=c($e,"TD",{});var vt=p(an);Je=c(vt,"BUTTON",{"data-svelte-h":!0}),$(Je)!=="svelte-1vbubr3"&&(Je.textContent=nt),vt.forEach(d),Pn=C($e),ln=c($e,"TD",{});var It=p(ln);Se=c(It,"BUTTON",{"data-svelte-h":!0}),$(Se)!=="svelte-1ied6ec"&&(Se.textContent=tt),It.forEach(d),$e.forEach(d),Me.forEach(d),dn.forEach(d),Mn=C(Pe),gn(Be.$$.fragment,Pe),Pe.forEach(d),this.h()},h(){b(n,"class","characterSide svelte-aelzqd"),b(t,"class","container svelte-aelzqd"),b(m,"class","commands svelte-aelzqd"),b(f,"class","container svelte-aelzqd"),b(f,"id","footer")},m(_,S){T(_,t,S),u(t,n),mn(o,n,null),u(t,s),mn(r,t,null),T(_,l,S),T(_,f,S),u(f,m),u(m,h),u(h,y),u(y,D),u(D,x),u(y,re),u(y,he),u(he,j),u(y,We),u(y,Z),u(Z,ae),u(y,Oe),u(y,ve),u(ve,G),u(h,Ie),u(h,U),u(U,Ee),u(Ee,W),u(U,Ye),u(U,Y),u(U,K),u(U,ye),u(ye,J),u(U,qe),u(U,ie),u(ie,ne),u(h,Ke),u(h,O),u(O,ke),u(ke,le),u(O,Xe),u(O,we),u(we,te),u(O,on),u(O,ce),u(ce,w),u(O,v),u(O,fe),u(fe,de),u(h,Ve),u(h,F),u(F,Qe),u(Qe,V),u(F,je),u(F,be),u(be,Ze),u(F,Ln),u(F,an),u(an,Je),u(F,Pn),u(F,ln),u(ln,Se),u(f,Mn),mn(Be,f,null),yn=!0,xn||(ot=[M(window,"keydown",Xt(e[2])),M(x,"click",function(){z(R("UL",e[0]))&&R("UL",e[0]).apply(this,arguments)}),M(j,"click",function(){z(R("U",e[0]))&&R("U",e[0]).apply(this,arguments)}),M(ae,"click",function(){z(R("UR",e[0]))&&R("UR",e[0]).apply(this,arguments)}),M(G,"click",function(){z(Dn(e[0]))&&Dn(e[0]).apply(this,arguments)}),M(W,"click",function(){z(R("L",e[0]))&&R("L",e[0]).apply(this,arguments)}),M(J,"click",function(){z(R("R",e[0]))&&R("R",e[0]).apply(this,arguments)}),M(ne,"click",function(){z(_n(e[0]))&&_n(e[0]).apply(this,arguments)}),M(le,"click",function(){z(R("DL",e[0]))&&R("DL",e[0]).apply(this,arguments)}),M(te,"click",function(){z(R("D",e[0]))&&R("D",e[0]).apply(this,arguments)}),M(w,"click",function(){z(R("DR",e[0]))&&R("DR",e[0]).apply(this,arguments)}),M(de,"click",function(){z(Bn(e[0]))&&Bn(e[0]).apply(this,arguments)}),M(V,"click",function(){z(Qt(e[0]))&&Qt(e[0]).apply(this,arguments)}),M(Ze,"click",e[5]),M(Je,"click",e[6]),M(Se,"click",function(){z(Ct(e[0]))&&Ct(e[0]).apply(this,arguments)})],xn=!0)},p(_,[S]){e=_;const un={};S&1&&(un.state=e[0]),o.$set(un);const Pe={};!a&&S&1&&(a=!0,Pe.state=e[0],Gn(()=>a=!1)),!i&&S&2&&(i=!0,Pe.debugMode=e[1],Gn(()=>i=!1)),r.$set(Pe);const dn={};!Nn&&S&1&&(Nn=!0,dn.state=e[0],Gn(()=>Nn=!1)),Be.$set(dn)},i(_){yn||(se(o.$$.fragment,_),se(r.$$.fragment,_),se(Be.$$.fragment,_),yn=!0)},o(_){Ae(o.$$.fragment,_),Ae(r.$$.fragment,_),Ae(Be.$$.fragment,_),yn=!1},d(_){_&&(d(t),d(l),d(f)),pn(o),pn(r),pn(Be),xn=!1,Kt(ot)}}}function Bs(e,t,n){let o=go(),s=!1;Hn(()=>{setInterval(()=>_o(o),1e3)});function r(h){switch(h.key){case"6":case"d":R("R",o);break;case"9":case"e":R("UR",o);break;case"8":case"w":R("U",o);break;case"7":case"q":R("UL",o);break;case"4":case"a":R("L",o);break;case"1":case"z":R("DL",o);break;case"2":case"x":R("D",o);break;case"3":case"c":R("DR",o);break;case"0":case" ":Dn(o);break;case"-":case"r":Bn(o);break;case"+":case"f":_n(o);break}}function a(h){o=h,n(0,o)}function i(h){s=h,n(1,s)}const l=()=>n(0,o=fo()),f=()=>n(1,s=!s);function m(h){o=h,n(0,o)}return[o,s,r,a,i,l,f,m]}class Rs extends hn{constructor(t){super(),vn(this,t,Bs,bs,ze,{})}}export{Rs as component};
